<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Single-cell epigenetics – scOmicNotes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter6_dna.html" rel="next">
<link href="./chapter4_protein.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter5_epigenetics.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Single-cell epigenetics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">scOmicNotes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2_sequencing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single-cell sequencing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3_rna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Single-cell RNA-sequencing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4_protein.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">‘Single-cell’ proteomics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5_epigenetics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Single-cell epigenetics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6_dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">‘Single-cell’ DNA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7_crispr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Single-cell CRISPR editting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8_lineage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Single-cell lineage tracing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9_spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">‘Single-cell’ spatial transcriptomics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#primer-on-the-genome-epigenetics-and-enhancers" id="toc-primer-on-the-genome-epigenetics-and-enhancers" class="nav-link active" data-scroll-target="#primer-on-the-genome-epigenetics-and-enhancers"><span class="header-section-number">6.1</span> Primer on the genome, epigenetics, and enhancers</a></li>
  <li><a href="#the-zoo-of-epigenetic-modalities" id="toc-the-zoo-of-epigenetic-modalities" class="nav-link" data-scroll-target="#the-zoo-of-epigenetic-modalities"><span class="header-section-number">6.2</span> The zoo of epigenetic modalities</a></li>
  <li><a href="#glossary-of-terms-thatll-be-useful-throughout-this-chapter" id="toc-glossary-of-terms-thatll-be-useful-throughout-this-chapter" class="nav-link" data-scroll-target="#glossary-of-terms-thatll-be-useful-throughout-this-chapter"><span class="header-section-number">6.3</span> Glossary of terms that’ll be useful throughout this chapter</a></li>
  <li><a href="#x-multiome-joint-profiling-of-chromatin-accessibility-and-rna" id="toc-x-multiome-joint-profiling-of-chromatin-accessibility-and-rna" class="nav-link" data-scroll-target="#x-multiome-joint-profiling-of-chromatin-accessibility-and-rna"><span class="header-section-number">6.4</span> 10x Multiome – Joint profiling of chromatin accessibility and RNA</a>
  <ul>
  <li><a href="#primer-on-chromatin-accessibility-and-peaks" id="toc-primer-on-chromatin-accessibility-and-peaks" class="nav-link" data-scroll-target="#primer-on-chromatin-accessibility-and-peaks"><span class="header-section-number">6.4.1</span> Primer on chromatin accessibility and “peaks”</a></li>
  <li><a href="#brief-description-of-the-technology" id="toc-brief-description-of-the-technology" class="nav-link" data-scroll-target="#brief-description-of-the-technology"><span class="header-section-number">6.4.2</span> Brief description of the technology</a></li>
  </ul></li>
  <li><a href="#chromvar-the-most-commonly-used-method-to-assess-binding-regions" id="toc-chromvar-the-most-commonly-used-method-to-assess-binding-regions" class="nav-link" data-scroll-target="#chromvar-the-most-commonly-used-method-to-assess-binding-regions"><span class="header-section-number">6.5</span> ChromVAR: The most commonly used method to assess binding regions</a></li>
  <li><a href="#sec-atac_integration" id="toc-sec-atac_integration" class="nav-link" data-scroll-target="#sec-atac_integration"><span class="header-section-number">6.6</span> Deep-learning integration and translation of RNA and ATAC</a>
  <ul>
  <li><a href="#sec-diagonal_integration_unsupervised" id="toc-sec-diagonal_integration_unsupervised" class="nav-link" data-scroll-target="#sec-diagonal_integration_unsupervised"><span class="header-section-number">6.6.1</span> Strategy 1: Completely unsupervised approach to diagonal integration</a></li>
  <li><a href="#strategy-2-leveraging-more-biological-information-for-diagonal-integration" id="toc-strategy-2-leveraging-more-biological-information-for-diagonal-integration" class="nav-link" data-scroll-target="#strategy-2-leveraging-more-biological-information-for-diagonal-integration"><span class="header-section-number">6.6.2</span> Strategy 2: Leveraging more biological information for diagonal integration</a></li>
  <li><a href="#dont-forget-about-all-the-usual-multi-modal-integration-methods" id="toc-dont-forget-about-all-the-usual-multi-modal-integration-methods" class="nav-link" data-scroll-target="#dont-forget-about-all-the-usual-multi-modal-integration-methods"><span class="header-section-number">6.6.3</span> Don’t forget about all the usual multi-modal integration methods!</a></li>
  </ul></li>
  <li><a href="#brief-aside-transcription-factors" id="toc-brief-aside-transcription-factors" class="nav-link" data-scroll-target="#brief-aside-transcription-factors"><span class="header-section-number">6.7</span> Brief aside: Transcription factors</a></li>
  <li><a href="#gene-regulatory-networks-grn" id="toc-gene-regulatory-networks-grn" class="nav-link" data-scroll-target="#gene-regulatory-networks-grn"><span class="header-section-number">6.8</span> Gene regulatory networks (GRN)</a>
  <ul>
  <li><a href="#first-how-we-understand-the-elements-that-control-a-gene" id="toc-first-how-we-understand-the-elements-that-control-a-gene" class="nav-link" data-scroll-target="#first-how-we-understand-the-elements-that-control-a-gene"><span class="header-section-number">6.8.1</span> First: How we understand the elements that control a gene?</a></li>
  <li><a href="#grns-between-genes-and-tfs" id="toc-grns-between-genes-and-tfs" class="nav-link" data-scroll-target="#grns-between-genes-and-tfs"><span class="header-section-number">6.8.2</span> GRNs between genes and TFs</a></li>
  <li><a href="#grns-between-genes-enhancers-and-tfs" id="toc-grns-between-genes-enhancers-and-tfs" class="nav-link" data-scroll-target="#grns-between-genes-enhancers-and-tfs"><span class="header-section-number">6.8.3</span> GRNs between genes, enhancers, and TFs</a></li>
  </ul></li>
  <li><a href="#so-what-do-you-do-with-the-grn" id="toc-so-what-do-you-do-with-the-grn" class="nav-link" data-scroll-target="#so-what-do-you-do-with-the-grn"><span class="header-section-number">6.9</span> So… what do you do with the GRN?</a></li>
  <li><a href="#sec-grn_crazy" id="toc-sec-grn_crazy" class="nav-link" data-scroll-target="#sec-grn_crazy"><span class="header-section-number">6.10</span> What makes the field of GRN crazy?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Single-cell epigenetics</span></h1>
<p class="subtitle lead">Transcription factor scoring, diagonal integration, gene regulatory networks</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="primer-on-the-genome-epigenetics-and-enhancers" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="primer-on-the-genome-epigenetics-and-enhancers"><span class="header-section-number">6.1</span> Primer on the genome, epigenetics, and enhancers</h2>
<p>The genome is the complete set of DNA within an organism, encoding the instructions for life. While every cell in an organism typically contains the same genome, different cells exhibit distinct phenotypes and functions. This diversity arises not from changes in the underlying DNA sequence but from epigenetic regulation—heritable modifications that influence gene expression without altering the DNA itself. Epigenetics includes processes like DNA methylation, histone modification, and chromatin accessibility, all of which contribute to the dynamic regulation of gene activity in response to developmental cues and environmental signals.</p>
<p>Enhancers play a critical role in this regulatory landscape. These are DNA sequences that, while not coding for proteins themselves, can dramatically increase the transcription of target genes. Enhancers act by binding specific transcription factors, proteins that recognize and attach to DNA sequences to regulate gene expression. Some transcription factors require assistance from chaperone proteins, which ensure their proper folding and functionality, or pioneer proteins, which can access and open tightly packed chromatin to allow other factors to bind. This interplay highlights the complexity of the regulatory machinery that governs cellular function. See <a href="#fig-enhancer-promoter1" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> and <a href="#fig-enhancer-promoter2" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> to appreciate how complex this machinery is.</p>
<div class="block">
<div id="fig-enhancer-promoter1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-enhancer-promoter1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/enhancer-promoter.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-enhancer-promoter1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: From <span class="citation" data-cites="ito2022factors">Ito et al. (<a href="references.html#ref-ito2022factors" role="doc-biblioref">2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-enhancer-promoter2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-enhancer-promoter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/enhancer.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-enhancer-promoter2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: From <span class="citation" data-cites="claringbould2021enhancers">Claringbould and Zaugg (<a href="references.html#ref-claringbould2021enhancers" role="doc-biblioref">2021</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="the-zoo-of-epigenetic-modalities" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="the-zoo-of-epigenetic-modalities"><span class="header-section-number">6.2</span> The zoo of epigenetic modalities</h2>
<p>Epigenetics encompasses a vast array of molecular mechanisms that regulate gene expression without altering the underlying DNA sequence. These mechanisms include modifications to DNA, RNA, chromatin, and the spatial organization of the genome, collectively forming a complex regulatory landscape. Below are some of the key modalities studied in epigenetics:</p>
<ul>
<li><p><strong>DNA Accessibility</strong>: Techniques like ATAC-seq and DNase-seq measure how accessible DNA is to transcription factors and other regulatory proteins. Accessible regions often overlap with promoters and enhancers, providing critical insights into gene regulation. (This is what we’ll focus on this chapter.)</p></li>
<li><p><strong>DNA Methylation</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>: This modification, typically at cytosines in CpG dinucleotides, is a key epigenetic mark associated with gene silencing. Tools like bisulfite sequencing are used to map methylation patterns across the genome, revealing their roles in development and disease. See <a href="#fig-methylation1-1" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> and <a href="#fig-methylation1-2" class="quarto-xref">Figure&nbsp;<span>6.4</span></a>.</p></li>
</ul>
<div class="block">
<div id="fig-methylation1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-methylation1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/methylation1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-methylation1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: From <span class="citation" data-cites="gauba2021immunomodulation">Gauba et al. (<a href="references.html#ref-gauba2021immunomodulation" role="doc-biblioref">2021</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-methylation1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-methylation1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/methylation2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-methylation1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: From <span class="citation" data-cites="bruggeman2008using">Bruggeman-Everts (<a href="references.html#ref-bruggeman2008using" role="doc-biblioref">2008</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Hi-C and Genome Organization</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>: Hi-C measures chromatin interactions to reveal the three-dimensional structure of the genome. It uncovers features like topologically associating domains (TADs) and enhancer-promoter loops, which are crucial for understanding how spatial organization influences gene regulation. See <a href="#fig-hic1-1" class="quarto-xref">Figure&nbsp;<span>6.5</span></a> and <a href="#fig-hic1-2" class="quarto-xref">Figure&nbsp;<span>6.6</span></a>.</li>
</ul>
<div class="block">
<div id="fig-hic1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hic1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/hic1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hic1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: From <span class="citation" data-cites="ea2015contribution">Ea et al. (<a href="references.html#ref-ea2015contribution" role="doc-biblioref">2015</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-hic1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hic1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/hic2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hic1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: From <span class="citation" data-cites="liu2021seeing">N. Liu et al. (<a href="references.html#ref-liu2021seeing" role="doc-biblioref">2021</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Histone Modifications</strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>: Post-translational modifications, such as acetylation, methylation, and phosphorylation, occur on histone proteins and regulate chromatin structure. Techniques like ChIP-seq and the newer Cut &amp; Tag method are used to map these modifications and their role in gene expression at the bulk level. See <a href="#fig-histone1" class="quarto-xref">Figure&nbsp;<span>6.7</span></a> and <a href="#fig-histone2" class="quarto-xref">Figure&nbsp;<span>6.8</span></a>.</li>
</ul>
<div class="block">
<div id="fig-histone1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histone1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/histone1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histone1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: From <a href="https://opened.cuny.edu/courseware/lesson/684/student/?section=2" class="uri">https://opened.cuny.edu/courseware/lesson/684/student/?section=2</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-histone2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-histone2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/histone2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histone2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: From <span class="citation" data-cites="steinbach2017pten">Steinbach (<a href="references.html#ref-steinbach2017pten" role="doc-biblioref">2017</a>)</span>. (Note: This is an example of the “canonical” functions of common histone modifications. This is by no means exhaustive and guaranteed to hold true for all biological systems.)
</figcaption>
</figure>
</div>
</div>
<p>Some of you might be interested: Personally, I think one of the fascinating concepts based on histone modifications is <em>bivalent chromatin</em> (essentially, chromatin that is wrapped in such a way that is simultaneously activated and silenced), see <a href="#fig-bivalent1-1" class="quarto-xref">Figure&nbsp;<span>6.9</span></a> and <a href="#fig-bivalent1-2" class="quarto-xref">Figure&nbsp;<span>6.10</span></a>. It’s a particularly curious phenomenon that entire labs dedicate themselves to studying. See <span class="citation" data-cites="blanco2020bivalent">Blanco et al. (<a href="references.html#ref-blanco2020bivalent" role="doc-biblioref">2020</a>)</span> for an overview why this mechanism might be “beneficial.”</p>
<div class="block">
<div id="fig-bivalent1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bivalent1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/bivalent1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bivalent1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: From <span class="citation" data-cites="macrae2023regulation">Macrae, Fothergill-Robinson, and Ramalho-Santos (<a href="references.html#ref-macrae2023regulation" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-bivalent1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bivalent1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/bivalent2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bivalent1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: From <span class="citation" data-cites="glancy2024bivalent">Glancy, Choy, and Eckersley-Maslin (<a href="references.html#ref-glancy2024bivalent" role="doc-biblioref">2024</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>RNA Modifications (m6A and Pseudouridine)</strong>: Modifications like N6-methyladenosine (m6A) and pseudouridine occur on RNA molecules and are involved in processes like splicing, translation, and mRNA decay. See <a href="#fig-pseudouridine" class="quarto-xref">Figure&nbsp;<span>6.11</span></a> for what pseudouridine is, i.e., “a rotation of the uridine molecule.” These modifications add an epitranscriptomic layer to gene regulation.</li>
</ul>
<div class="block">
<div id="fig-pseudouridine" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pseudouridine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/pseudouridine.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pseudouridine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: From <span class="citation" data-cites="hamma2006pseudouridine">Hamma and Ferré-D’Amaré (<a href="references.html#ref-hamma2006pseudouridine" role="doc-biblioref">2006</a>)</span> about pseudouridine.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Untranslated Regions (UTRs)</strong>: Before talking about UTRs, it’s probably good to review what an mRNA fragment “looks like” at the different stages of transcription and translation, see <a href="#fig-utr1" class="quarto-xref">Figure&nbsp;<span>6.12</span></a>. The 5′ and 3′ UTRs contain regulatory elements that influence mRNA stability, localization, and translation efficiency. The 3′ UTR, in particular, serves as a binding platform for RNA-binding proteins and microRNAs, providing an additional layer of post-transcriptional gene regulation (<a href="#fig-utr2" class="quarto-xref">Figure&nbsp;<span>6.13</span></a> and <a href="#fig-utr3" class="quarto-xref">Figure&nbsp;<span>6.14</span></a>).</li>
</ul>
<div class="block">
<div id="fig-utr1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/utr2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: From <span class="citation" data-cites="niazi2023rna">Niazi (<a href="references.html#ref-niazi2023rna" role="doc-biblioref">2023</a>)</span>. Notice the splicing (i.e., “removal” of the introns – see <em>Alternative Splicing</em> below) and that the protein-coding region is <em>not</em> the only part of the mRNA transcript – there are also the UTRs and poly-A tail. <strong>NOTE</strong>: The transcription start site (TSS) is <em>not</em> the same place as the promoter. The promoter is usually an un-transcribed region upstream of the TSS, while the TSS is where transcription actually starts.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-utr2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utr2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/utr1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utr2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: From <span class="citation" data-cites="mignone2002untranslated">Mignone et al. (<a href="references.html#ref-mignone2002untranslated" role="doc-biblioref">2002</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-utr3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/utr3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.14: From <a href="https://www.cambio.co.uk/9/257/applications/methods/in-vitro-transcription/mrna-therapeutics/" class="uri">https://www.cambio.co.uk/9/257/applications/methods/in-vitro-transcription/mrna-therapeutics/</a>.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Alternative Splicing</strong>: This post-transcriptional process generates multiple mRNA isoforms from the same gene, expanding the proteomic diversity, see <a href="#fig-alternativesplicing1" class="quarto-xref">Figure&nbsp;<span>6.15</span></a>. <strong>This is a combinatorial explosion of isoforms.</strong> While not traditionally classified as epigenetic, splicing often intersects with chromatin modifications and RNA-binding proteins, blurring the lines between transcriptional and post-transcriptional regulation.</li>
</ul>
<div class="block">
<div id="fig-alternativesplicing1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-alternativesplicing1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/alternativesplicing1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-alternativesplicing1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.15: From <span class="citation" data-cites="chen2015alternative">J. Chen and Weiss (<a href="references.html#ref-chen2015alternative" role="doc-biblioref">2015</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Alternative Polyadenylation (APA)</strong>: APA generates transcript isoforms with different 3′ ends, affecting mRNA stability, localization, and translation, see <a href="#fig-apa1" class="quarto-xref">Figure&nbsp;<span>6.16</span></a>. By selecting distinct cleavage sites, APA alters the <em>3′ UTR length</em> without affecting the poly-A tail itself, thereby modulating interactions with regulatory factors such as microRNAs and RNA-binding proteins.</li>
</ul>
<div class="block">
<div id="fig-apa1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-apa1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/apa1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-apa1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.16: From <span class="citation" data-cites="li2022population">L. Li et al. (<a href="references.html#ref-li2022population" role="doc-biblioref">2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>Efforts like the ENCODE project (<a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7061942/" class="uri">https://pmc.ncbi.nlm.nih.gov/articles/PMC7061942/</a>) have systematically mapped these modalities across cell types and tissues, creating a comprehensive resource for understanding genome function. ENCODE has provided invaluable datasets on DNA accessibility, histone modifications, and RNA-binding proteins, enabling researchers to uncover how epigenetic and transcriptomic layers work together to drive cellular processes.</p>
<p>Finally, tools like MPRA (Massively Parallel Reporter Assays) are revolutionizing how we study enhancers and regulatory sequences. MPRA allows researchers to test thousands of DNA fragments for their regulatory activity, providing functional validation for epigenetic marks. This growing zoo of modalities continues to expand our understanding of how the genome is dynamically regulated in health and disease.</p>
<p>See <a href="#fig-epigenetic2-1" class="quarto-xref">Figure&nbsp;<span>6.17</span></a> for some courageous figures that try to display multiple types of epigenetic modifications all at once. See <span class="citation" data-cites="lim2024advances">Lim et al. (<a href="references.html#ref-lim2024advances" role="doc-biblioref">2024</a>)</span> for a broad overview about the different types of technologies to sequence different omics and layers of epigenetics, and how they are getting computationally put together.</p>
<div class="block">
<div id="fig-epigenetic2-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-epigenetic2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/epigenetic2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-epigenetic2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.17: From <a href="https://www.sc-best-practices.org/chromatin_accessibility/introduction.html" class="uri">https://www.sc-best-practices.org/chromatin_accessibility/introduction.html</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-epigenetic2-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-epigenetic2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/epigenetic3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-epigenetic2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.18: From <a href="https://www.whatisepigenetics.com/type-2-diabetes-mellitus-and-epigenetics" class="uri">https://www.whatisepigenetics.com/type-2-diabetes-mellitus-and-epigenetics</a>.
</figcaption>
</figure>
</div>
</div>
<!-- {\color{red}(DNA accessibility, methylation, Hi-C, histone modification, and a bit of APA. Mention Cut & Tag and MPRA. m6A and pseduouridine. Alternative splicing)} Talk about ENCODE <https://pmc.ncbi.nlm.nih.gov/articles/PMC7061942/>. -->
<p><strong>Some videos to look at for fun</strong></p>
<ul>
<li>“Why human brain cells grow so slowly” (Nature videos): <a href="https://www.youtube.com/watch?v=lIJkc6tulus" class="uri">https://www.youtube.com/watch?v=lIJkc6tulus</a></li>
<li>“What is epigenetics? - Carlos Guerrero-Bosagna” (TED-Ed): <a href="https://www.youtube.com/watch?v=_aAhcNjmvhc" class="uri">https://www.youtube.com/watch?v=_aAhcNjmvhc</a></li>
</ul>
</section>
<section id="glossary-of-terms-thatll-be-useful-throughout-this-chapter" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="glossary-of-terms-thatll-be-useful-throughout-this-chapter"><span class="header-section-number">6.3</span> Glossary of terms that’ll be useful throughout this chapter</h2>
<ul>
<li><strong>Chromatin</strong>: The complex of DNA and histone proteins that packages the genome, regulating accessibility for transcription factors and other regulatory elements.</li>
<li><strong>Histone</strong>: A protein that DNA wraps around to form nucleosomes, playing a key role in chromatin structure and epigenetic regulation through modifications such as methylation and acetylation. Eight histone proteins can come together to make up something called a <em>nucleosome</em>.</li>
<li><strong>Enhancer</strong>: A DNA region that enhances gene transcription, often located far from the transcription start site (TSS), and accessible in open chromatin regions detected by ATAC-seq.</li>
<li><strong>Promoter</strong>: A regulatory DNA region typically located upstream of a gene’s TSS, where RNA polymerase and transcription factors bind to initiate transcription.</li>
<li><strong>Transcription Start Site (TSS)</strong>: The location where RNA polymerase begins transcribing a gene, often marked by open chromatin and specific histone modifications.</li>
<li><strong>Intron/Exon</strong>: Exons are coding regions of a gene included in the mature mRNA, while introns are non-coding regions removed during splicing.</li>
<li><strong>Spliced/Unspliced mRNA</strong>: Spliced mRNA has undergone intron removal and is ready for translation, while unspliced mRNA still contains introns and provides insights into transcriptional dynamics in single-cell RNA-seq.</li>
<li><strong>Peak</strong>: A region of open chromatin identified in data such as ATAC-seq or ChIP-seq experiments, corresponding to accessible regulatory elements such as promoters and enhancers.</li>
<li><strong>Motif</strong>: A short, recurring DNA sequence recognized by transcription factors, often enriched in ATAC-seq peaks to infer regulatory activity.</li>
<li><strong>Transcription Factor</strong>: A protein that binds to DNA motifs to regulate gene expression, often influencing cell state and identity.</li>
<li><strong>Pioneer Factor</strong>: A specialized transcription factor capable of binding closed chromatin and initiating chromatin remodeling to make DNA accessible for transcription.</li>
</ul>
</section>
<section id="x-multiome-joint-profiling-of-chromatin-accessibility-and-rna" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="x-multiome-joint-profiling-of-chromatin-accessibility-and-rna"><span class="header-section-number">6.4</span> 10x Multiome – Joint profiling of chromatin accessibility and RNA</h2>
<p>The 10x Multiome allows researchers to simultaneously profile <strong>gene expression</strong> (RNA) and <strong>chromatin accessibility</strong> (ATAC) at the single-cell level. This provides a comprehensive view of transcriptional and regulatory states within the same cells, enabling deeper insights into gene regulation and cell type characterization.</p>
<section id="primer-on-chromatin-accessibility-and-peaks" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="primer-on-chromatin-accessibility-and-peaks"><span class="header-section-number">6.4.1</span> Primer on chromatin accessibility and “peaks”</h3>
<p>Chromatin accessibility refers to the degree to which DNA is physically accessible to regulatory proteins such as transcription factors, RNA polymerase, and other elements of the transcriptional machinery. In eukaryotic cells, DNA is wrapped around histone proteins to form chromatin, which can exist in a <em>closed</em> or <em>open</em> state. Open chromatin regions are more likely to contain active regulatory elements such as promoters and enhancers, while closed chromatin regions are generally associated with transcriptional repression. Profiling chromatin accessibility provides insights into which regulatory elements are active in a given cell state, offering a complementary perspective to RNA-seq data.</p>
<p>In single-cell ATAC-seq experiments, accessible chromatin regions are identified as <em>peaks</em>, which represent DNA regions where the transposase enzyme preferentially inserts sequencing adapters. These peaks correspond to genomic loci where nucleosomes are absent or displaced, indicating active regulatory sites. Peaks are typically mapped to gene promoters, enhancers, or other functional elements to infer regulatory activity. By integrating chromatin accessibility with gene expression data from the same cells, 10x Multiome enables researchers to connect regulatory regions with their target genes, uncovering how chromatin structure influences transcriptional programs and cell fate decisions.</p>
<p>The resulting data often looks like <a href="#fig-track-data-peak" class="quarto-xref">Figure&nbsp;<span>6.19</span></a>, where, for each genomic region, you can define “peaks” where there are regions of accessible DNA.</p>
<div class="block">
<div id="fig-track-data-peak" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-track-data-peak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/track-data-peak.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-track-data-peak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.19: From <a href="https://stuartlab.org/signac/articles/mouse_brain_vignette" class="uri">https://stuartlab.org/signac/articles/mouse_brain_vignette</a>. The gray bars on the bottom (i.e., “Peaks”) are derived based on the tracks shown up top (in different colors, based on the average accessibility at each base pair of the reference DNA for different cells of various cell types). The blue horizon bar (i.e., “Genes”) tells you roughly where the introns and exons of a particular gene is.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="brief-description-of-the-technology" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="brief-description-of-the-technology"><span class="header-section-number">6.4.2</span> Brief description of the technology</h3>
<p>The following are the high-level steps involved in performing single-cell multiome sequencing using the 10x Genomics Multiome ATAC + Gene Expression platform:</p>
<div class="block">
<div id="fig-atac-left" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-atac-left-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/atac2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-atac-left-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.20: From <span class="citation" data-cites="buenrostro2015atac">Buenrostro et al. (<a href="references.html#ref-buenrostro2015atac" role="doc-biblioref">2015</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-atac-right" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-atac-right-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/atac1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-atac-right-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.21: From <a href="https://www.quickbiology.com/ngs-services/atac-seq-service" class="uri">https://www.quickbiology.com/ngs-services/atac-seq-service</a>.
</figcaption>
</figure>
</div>
</div>
<ol type="1">
<li><strong>Tissue Dissociation and Cell Isolation</strong>:<br>
Tissues are dissociated into a single-cell suspension using enzymatic or mechanical methods. Cells are isolated via fluorescence-activated cell sorting (FACS) or other methods to ensure viable, intact cells for profiling both RNA and chromatin.</li>
<li><strong>Transposition and RNA Capture</strong>:<br>
Cells are incubated with a transposase enzyme that fragments DNA in open chromatin regions and tags them with sequencing adapters. Simultaneously, RNA is captured via hybridization to barcoded beads containing poly(dT) sequences, enabling downstream transcriptomic profiling.</li>
<li><strong>Droplet Generation</strong>:<br>
Using the 10x Chromium instrument, individual cells are encapsulated into oil-based droplets along with barcoded gel beads. Each bead contains unique barcodes for both RNA and chromatin, ensuring that data from both modalities are linked to the same cell.</li>
<li><strong>Reverse Transcription and Transposition Amplification</strong>:<br>
RNA is reverse-transcribed into complementary DNA (cDNA) within the droplets. Transposed DNA fragments are amplified via PCR to enrich for regions of open chromatin.</li>
<li><strong>Droplet Breakage and Cleanup</strong>:<br>
Droplets are broken, and the barcoded nucleic acids are recovered. Separate workflows are used to process RNA-derived cDNA and transposed DNA fragments.</li>
<li><strong>Library Preparation</strong>:<br>
The cDNA and DNA libraries are prepared in parallel:
<ul>
<li><strong>RNA Library</strong>: Includes additional steps for amplification and adapter ligation to finalize the gene expression library.</li>
<li><strong>ATAC Library</strong>: Focuses on chromatin accessibility, with library preparation steps optimized for sequencing transposed DNA.</li>
</ul></li>
<li><strong>High-Throughput Sequencing</strong>:<br>
The prepared RNA and ATAC libraries are sequenced on an Illumina platform, typically with paired-end reads to capture both transcriptomic and chromatin information.</li>
<li><strong>Data Alignment and Integration</strong>:<br>
Sequencing reads are mapped to the genome, with RNA reads assigned to transcripts and ATAC reads aligned to open chromatin regions. Barcode information is used to link the RNA and chromatin profiles back to individual cells, enabling multi-modal analyses.</li>
</ol>
<p><strong>Brief note about peak-calling.</strong><br>
Peak-calling is the computational process of identifying regions of open chromatin from ATAC-seq data, where transposase insertion events are enriched. These peaks represent accessible regulatory elements such as promoters, enhancers, and transcription factor binding sites. Peak-calling algorithms, such as MACS2 or the cellranger-atac pipeline (see <a href="#fig-peak-calling" class="quarto-xref">Figure&nbsp;<span>6.22</span></a>), detect significant enrichments in sequencing reads while accounting for background noise and sequencing biases. In single-cell ATAC-seq, peak-calling is often performed at the population level or adapted to sparse single-cell data by aggregating similar cells. Accurate peak-calling is essential for interpreting chromatin accessibility patterns and linking regulatory regions to gene expression.</p>
<div class="block">
<div id="fig-peak-calling" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-peak-calling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/peak-calling.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peak-calling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.22: From <a href="https://www.10xgenomics.com/support/software/cell-ranger-arc/latest/algorithms-overview/algorithms-overview" class="uri">https://www.10xgenomics.com/support/software/cell-ranger-arc/latest/algorithms-overview/algorithms-overview</a>. You can see that ATAC-seq measures these DNA fragments, and a “peak” is a computational object that denotes a high concentration of overlapping fragments.
</figcaption>
</figure>
</div>
</div>
<p><strong>Further reading.</strong><br>
See <span class="citation" data-cites="mansisidor2022chromatin">Mansisidor and Risca (<a href="references.html#ref-mansisidor2022chromatin" role="doc-biblioref">2022</a>)</span>, <span class="citation" data-cites="miao2021multi">Miao et al. (<a href="references.html#ref-miao2021multi" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="teichmann2020method">Teichmann and Efremova (<a href="references.html#ref-teichmann2020method" role="doc-biblioref">2020</a>)</span> for an in-depth dive on the biological insights from this omic (among many, many review papers). Two things are of note: 1) modeling scATAC-seq data is not as straight-forward as scRNA-seq (see <span class="citation" data-cites="miao2024uniform">Miao and Kim (<a href="references.html#ref-miao2024uniform" role="doc-biblioref">2024</a>)</span>, <span class="citation" data-cites="martens2024modeling">Martens et al. (<a href="references.html#ref-martens2024modeling" role="doc-biblioref">2024</a>)</span>), 2) almost all the scRNA-seq methods we have discussed in <a href="chapter2.qmd">Chapter 2</a> and <a href="chapter3.qmd">Chapter 3</a> have a counterpart developed specifically to model scATAC-seq data. For example, peakVI <span class="citation" data-cites="ashuach2022peakvi">Ashuach et al. (<a href="references.html#ref-ashuach2022peakvi" role="doc-biblioref">2022</a>)</span> is a commonly used method to compute the low-dimensional embedding for scATAC-seq data.</p>
</section>
</section>
<section id="chromvar-the-most-commonly-used-method-to-assess-binding-regions" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="chromvar-the-most-commonly-used-method-to-assess-binding-regions"><span class="header-section-number">6.5</span> ChromVAR: The most commonly used method to assess binding regions</h2>
<p>ChromVAR (short for Chromatin Variability Across Regions, <span class="citation" data-cites="schep2017chromvar">Schep et al. (<a href="references.html#ref-schep2017chromvar" role="doc-biblioref">2017</a>)</span>) is a computational tool designed to analyze chromatin accessibility data, such as those generated from ATAC-seq or single-cell ATAC-seq experiments. Its primary goal is to quantify variability in chromatin accessibility across predefined genomic regions, such as transcription factor binding motifs or enhancers, and link these patterns to regulatory factors that drive cell state differences.</p>
<p><strong>What the heck is a motif?</strong> A <strong>motif</strong> is a short, recurring DNA sequence pattern that is recognized and bound by specific transcription factors (TFs) to regulate gene expression, see <a href="#fig-motif" class="quarto-xref">Figure&nbsp;<span>6.23</span></a>. These motifs are typically found in promoters, enhancers, and other regulatory regions of the genome. Motifs are often represented as <em>position weight matrices (PWMs)</em>, which describe the probability of observing each nucleotide (A, T, C, G) at a given position in the sequence. Identifying motif enrichment in chromatin accessibility data helps infer which transcription factors are active in a given cell type or condition. ChromVAR leverages these motifs to assess whether specific transcription factors are driving chromatin accessibility changes, providing insights into cell-type-specific regulatory programs.</p>
<div class="block">
<div id="fig-motif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-motif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/motif.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-motif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.23: From <span class="citation" data-cites="habib2007analysis">Habib (<a href="references.html#ref-habib2007analysis" role="doc-biblioref">2007</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p><strong>Sidenote about motifs.</strong> If you work on scATAC-seq or ChIP-seq data long enough, you’ll eventually need to learn about: 1) how to detect potential binding sites in your data, and 2) how to find a database of “known” motifs. For the first point, HOMER <span class="citation" data-cites="heinz2010simple">Heinz et al. (<a href="references.html#ref-heinz2010simple" role="doc-biblioref">2010</a>)</span> is a <em>very</em> common bioinformatics tool. It takes in a bunch of DNA regions, and then finds DNA motifs that are significantly enriched as well as which potential TF might match those motifs, see <a href="#fig-homer" class="quarto-xref">Figure&nbsp;<span>6.24</span></a>. For the second point, JASPAR is one of the more common databases of TFs, see <a href="https://jaspar.elixir.no/" class="uri">https://jaspar.elixir.no/</a> and <span class="citation" data-cites="fornes2020jaspar">Fornes et al. (<a href="references.html#ref-fornes2020jaspar" role="doc-biblioref">2020</a>)</span>. In R, the Bioconductor package is called <code>JASPAR2020</code>.</p>
<div class="block">
<div id="fig-homer" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-homer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/homer.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-homer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.24: From <a href="http://homer.ucsd.edu/homer//motif/motifFinding.html" class="uri">http://homer.ucsd.edu/homer//motif/motifFinding.html</a>.
</figcaption>
</figure>
</div>
</div>
<p><strong>Details of ChromVAR.</strong> ChromVAR works by computing <strong>deviation scores</strong>, which measure how much the accessibility of a given set of regions (e.g., those containing a specific transcription factor motif) varies across cells or samples. This enables the identification of transcription factors that are likely active and driving regulatory differences within the dataset. See <a href="#fig-chromvar" class="quarto-xref">Figure&nbsp;<span>6.25</span></a>.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The input for a ChromVAR analysis is: 1) $ _+^{np}$ for the <span class="math inline">\(n\)</span> cells and <span class="math inline">\(p\)</span> peaks, 2) the specific locations of the <span class="math inline">\(p\)</span> peaks along the reference genome (for example, in humans, this could be the <code>hg38</code> reference genome, and in R, this is typically managed by the <code>GenomicRanges</code> BioConductor package, and 3) a database of TF motifs, such as JASPAR. (*Technically*), you don’t actually pass Item #2 or #3 as input. ChromVAR already expects you to have matched peaks to motifs using some method, for instance, <code>motifmatchr</code>. This matching is where, technically, Item #2 and #3 are used.) The output is then a new matrix <span class="math inline">\(Y \in \mathbb{R}^{n\times d}\)</span> where <span class="math inline">\(d\)</span> is the number of TFs, and entry <span class="math inline">\(Y_{ij}\)</span> denotes the excess variability of the TF <span class="math inline">\(j\)</span>’s accessibility in cell <span class="math inline">\(i\)</span>, relative to a set of “background” DNA regions that have similar qualities as TF <span class="math inline">\(j\)</span>.</p>
</div>
<p>Here’s how it works: 1. <strong>Input Data</strong>: The input consists of a <strong>binary peak-by-cell matrix</strong> (e.g., from single-cell ATAC-seq), where each entry indicates whether a specific genomic region (peak) is accessible in a given cell. A set of <strong>motif annotations</strong> (e.g., binding motifs for transcription factors) is provided to group peaks into motif-associated sets.</p>
<p><strong>Importantly</strong>: To run ChromVAR, you <em>must</em> have a reference genome. You are about to scan the genome for locations where a motif can bind to a particular DNA sequence in the reference genome. That is, you’re thinking about the specific base pair sequence of the DNA. 2. <strong>Region Set Aggregation</strong>: Peaks are grouped into sets based on the motifs. For each cell <span class="math inline">\(i\)</span> and each motif-associated region set <span class="math inline">\(k\)</span>, ChromVAR computes the <strong>aggregate accessibility</strong>: <span class="math display">\[
   A_{ik} = \sum_{j \in S_k} X_{ij},
   \]</span> where <span class="math inline">\(S_k\)</span> is the set of peaks <span class="math inline">\(j\)</span>’s associated with motif <span class="math inline">\(k\)</span>.</p>
<p>In simple terms, you’re adding up all the peaks that contain a relevant motif.) This sum (for cell <span class="math inline">\(i\)</span>) is normalized against all other cells (i.e., across all cells, how many counts were mapped to these peaks. 3. <strong>Sampling a set of background peaks</strong>: One of ChromVAR’s most important steps is carefully choosing a set of “background peaks,” i.e., peaks that are not the ones associated with motif <span class="math inline">\(k\)</span>, but have similar biological qualities. ChromVAR typically controls for two important things to do this: the GC content of a peak region and the region’s fragment length. (GC content is adjusted for since PCR tends to favor GC-rich regions.) Then, for every peak that contains motif <span class="math inline">\(k\)</span>, it samples many different peaks that has similar GC content and fragment length to the particular peak. This loops over all the peaks associated with motif <span class="math inline">\(k\)</span>, and the aggregate set of sampled peak is called the set of background peaks. 4. <strong>Deviation Scores</strong>: The <strong>deviation score</strong> quantifies how much the accessibility for a motif-associated region set deviates from what is expected under a background distribution. ChromVAR uses a binomial model to compute the expected accessibility, and the deviation score <span class="math inline">\(D_{kj}\)</span> is defined as the z-score: <span class="math display">\[
   Y_{ik} = \frac{A_{ik} - \mathbb{E}[A_{ik}]}{\text{SD}[A_{ik}]},
   \]</span> where <span class="math inline">\(\mathbb{E}[A_{ik}]\)</span> and <span class="math inline">\(\text{SD}[A_{ik}]\)</span> are the expected mean and standard deviation of the accessibility for motif <span class="math inline">\(k\)</span> under the background model. This matrix <span class="math inline">\(Y\)</span> (over all the cells and all motifs) is the output.</p>
<div class="block">
<div id="fig-chromvar" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chromvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/chromvar.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chromvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.25: From <span class="citation" data-cites="schep2017chromvar">Schep et al. (<a href="references.html#ref-schep2017chromvar" role="doc-biblioref">2017</a>)</span>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="sec-atac_integration" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sec-atac_integration"><span class="header-section-number">6.6</span> Deep-learning integration and translation of RNA and ATAC</h2>
<p>Single-cell multi-omic data integration is challenging due to the lack of one-to-one correspondence between cells across different assays. While many experimental technologies allow simultaneous measurement of multiple omics modalities (e.g., RNA and chromatin accessibility), most single-cell datasets include only one modality. This creates the challenge of integrating data from different omics layers with distinct feature spaces (e.g., genes in scRNA-seq vs.&nbsp;chromatin regions in scATAC-seq). We call this <em>diagonal integration</em> since we simultaneously have different cells in each dataset <em>and</em> different features (since these are two different omics). See <a href="#fig-integration-types" class="quarto-xref">Figure&nbsp;<span>6.26</span></a>.</p>
<p>Our goal can be thought of as one of two things (which are essentially equivalent):</p>
<ul>
<li><p><strong>Matching</strong>: How do we match a cell in the first omic to the “best” corresponding cell in the second omic, so we can “pretend” we were able able to sequence paired multi-omic data?</p></li>
<li><p><strong>Imputation of missing omics</strong>: For the cells where we only sequenced the first omic, can we predict what the expressions of these cells would had been if we sequenced the second omic? And vice versa, can we predict the first omic for the cells where we only sequenced the second omic?</p></li>
</ul>
<p>Upon first glance, it seems surprising that anyone can do you anything at all.</p>
<div class="block">
<div id="fig-integration-types" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-integration-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/integration-types.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-integration-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.26: From <span class="citation" data-cites="argelaguet2021computational">Argelaguet et al. (<a href="references.html#ref-argelaguet2021computational" role="doc-biblioref">2021</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<section id="sec-diagonal_integration_unsupervised" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="sec-diagonal_integration_unsupervised"><span class="header-section-number">6.6.1</span> Strategy 1: Completely unsupervised approach to diagonal integration</h3>
<p>In the first broad category we’ll talk about here, we seek to diagonally integrate <span class="math inline">\(X \in \mathbb{R}^{n_x \times p_x}\)</span> and <span class="math inline">\(Y \in \mathbb{R}^{n_y \times p_y}\)</span>, two single-cell datasets on different omics (i.e., the <span class="math inline">\(p_x\)</span> features in the first omic are different from the <span class="math inline">\(p_y\)</span> features in the second omic). Here, we are <em>not</em> willing to make any biological assumptions on how these two omics are related.</p>
<p><strong>A typical choice: SCOT.</strong><br>
SCOT (Single-Cell alignment with Optimal Transport) addresses diagonal integration using the Gromov-Wasserstein optimal transport framework <span class="citation" data-cites="demetci2022scot">Demetci et al. (<a href="references.html#ref-demetci2022scot" role="doc-biblioref">2022</a>)</span>. The key idea is to align datasets from different modalities while preserving their intrinsic geometric structures. SCOT constructs <span class="math inline">\(k\)</span>-nearest neighbor (k-NN) graphs for each dataset and computes intra-domain pairwise distance matrices. The alignment is achieved by finding a probabilistic coupling matrix <span class="math inline">\(\mathbf{G}\)</span> that minimizes the discrepancy between these intra-domain distances.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The inputs to SCOT are: 1) 2 different single-cell datasets <span class="math inline">\(X \in \mathbb{R}^{n_x \times p_x}\)</span> and <span class="math inline">\(Y \in \mathbb{R}^{n_y \times p_y}\)</span>, each measuring a different omic (i.e., different features) on a different set of cells. The primary output is a matching between (not necessarily 1-to-1) cells in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> so you computationally pretend you have paired multi-omic data for your downstream procedures.</p>
</div>
<div class="block">
<p><strong>Brief aside on Wasserstein distance</strong>: The Wasserstein distance, rooted in optimal transport theory, measures the effort required to morph one probability distribution into another. This can be intuitively understood using the <em>“moving pile of sand”</em> analogy: given two distributions, we seek the most efficient way to move mass from one distribution to another while minimizing transportation cost.</p>
<p>Mathematically, given two discrete distributions <span class="math inline">\(\mu = \sum_{i=1}^{n} p_i \delta_{x_i}\)</span> and <span class="math inline">\(\nu = \sum_{j=1}^{m} q_j \delta_{y_j}\)</span>, the classic optimal transport problem finds a coupling matrix <span class="math inline">\(\mathbf{G} \in \mathbb{R}^{n \times m}\)</span> that minimizes the transport cost:</p>
<p><span class="math display">\[
W_c(\mu, \nu) = \min_{\mathbf{G} \in \Pi(\mu, \nu)} \sum_{i=1}^{n} \sum_{j=1}^{m} c(x_i, y_j) G_{ij},
\]</span></p>
<p>where <span class="math inline">\(c(x_i, y_j)\)</span> represents the cost of moving mass from <span class="math inline">\(x_i\)</span> to <span class="math inline">\(y_j\)</span>, and <span class="math inline">\(\Pi(\mu, \nu)\)</span> is the set of all valid transport plans satisfying the marginal constraints:</p>
<p><span class="math display">\[
\sum_{j=1}^{m} G_{ij} = p_i, \quad \sum_{i=1}^{n} G_{ij} = q_j, \quad G_{ij} \geq 0.
\]</span></p>
</div>
<p>The Gromov-Wasserstein (GW) distance uses optimal transport by aligning the pairwise distances of cell <em>with</em> each omic. Given distance matrices <span class="math inline">\(\mathbf{D}^{X}\)</span> and <span class="math inline">\(\mathbf{D}^{Y}\)</span> for datasets <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (one for each omic), the GW problem is <span class="math display">\[
\operatorname{GW}(\mu, \nu) = \min_{\mathbf{G} \in \Pi(\mu, \nu)} \sum_{i,k} \sum_{j,l} L(D^X_{ik}, D^Y_{jl}) G_{ij} G_{kl},
\]</span> where <span class="math inline">\(L(D^X_{ik}, D^Y_{jl})\)</span> quantifies how much the transport plan distorts local geometric structures. SCOT uses this framework to learn an alignment between single-cell datasets by computing the optimal <span class="math inline">\(\mathbf{G}\)</span>, followed by a barycentric projection to bring the datasets into a common space.</p>
<div class="block">
<div id="fig-glue" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-glue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/scot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-glue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.27: From <span class="citation" data-cites="demetci2022scot">Demetci et al. (<a href="references.html#ref-demetci2022scot" role="doc-biblioref">2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block2">
<p><strong>A simple analogy</strong>: To understand SCOT, consider the following analogy. Let’s say in the first omic, we measured 4 cells: {A, B, C, D}, where we infer that cell-pairs {A,B}, {B,C}, and {A,D} are similar (based on their expression profiles in the first omic). In the second omic, we measured 4 cells: {I, II, III, IV}, where we infer that cell-pairs {II,IV}, {IV,III}, and {II,I} are similar (based on their expression profiles in the second omic). From this, we can infer that a reasonable matching is, {A, II}, {B, IV}, {C, III}, and {D,I}. You can imagine that the Wasserstein framework is apply this logic much more formally and robustly.</p>
</div>
<p><strong>A brief note on other approaches.</strong><br>
You’re really driving in the dark with these approaches since you’re blindly trusting that both omics have to stem “from the same manifold,” loosely speaking. This flavor of diagonal integration essentially boils down to <em>manifold alignment</em> – how can you “align” two different omics, where you trust that this computation alignment tells you how the two omics are aligned. (However, for certain pairs of omics, you really have no other choice, so this comment isn’t necessarily a criticism. It is more of a cautionary warning for you to think carefully on how would you even know you had a sensible integration.) A common addition in recent years for these diagonal integration methods is <em>not</em> to require all cells to be matched, see <span class="citation" data-cites="cao2022manifold">K. Cao, Hong, and Wan (<a href="references.html#ref-cao2022manifold" role="doc-biblioref">2022</a>)</span>. This addition complicates the computation, but enables you to allow for biological signal in one omic that is not recapitulated in the other. See <span class="citation" data-cites="xu2022diagonal">Xu and McCord (<a href="references.html#ref-xu2022diagonal" role="doc-biblioref">2022</a>)</span> for more commentary.</p>
</section>
<section id="strategy-2-leveraging-more-biological-information-for-diagonal-integration" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="strategy-2-leveraging-more-biological-information-for-diagonal-integration"><span class="header-section-number">6.6.2</span> Strategy 2: Leveraging more biological information for diagonal integration</h3>
<p>Unlike the methods in <a href="#sec-diagonal_integration_unsupervised" class="quarto-xref"><span>Section 6.6.1</span></a>, what if you <em>do</em> have biological insights about how the two omics are related? Then certainly, you should be able to perform a much more powerful diagonal integration if your biological insights are correct.</p>
<p><strong>A typical choice: GLUE.</strong><br>
Graph-Linked Unified Embedding (GLUE), as the name suggests, everages prior biological knowledge to construct a <em>guidance graph</em>, where nodes represent features (e.g., genes or ATAC peaks) and edges represent regulatory interactions (e.g., enhancer-promoter links) <span class="citation" data-cites="cao2022multi">Z.-J. Cao and Gao (<a href="references.html#ref-cao2022multi" role="doc-biblioref">2022</a>)</span>. This graph links omics-specific feature spaces, enabling joint learning of regulatory relationships and cell embeddings. By combining the guidance graph with observed data, GLUE infers regulatory interactions in a Bayesian-like manner. This enables the identification of cis-regulatory relationships, such as enhancer-gene links, and provides insights into transcription factor (TF) activity.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The inputs to GLUE are: 1) <span class="math inline">\(K\)</span> different single-cell datasets <span class="math inline">\(X^{(k)} \in \mathbb{R}^{n_k \times p_k}\)</span> for each <span class="math inline">\(k \in \{1,\ldots,K\}\)</span>, each measuring a different omic (i.e., different features) on a different set of cells, and 2) a graph <span class="math inline">\(\mathcal{G}\)</span> that connects the <span class="math inline">\({p_k}_{k=1}^{K}\)</span>. (This is the guidance graph, and this gets treated as another “dataset” in some sense.) The primary output is <span class="math inline">\(\hat{X}^{(k_1;k_2)} \in \mathbb{R}^{n_{k_1} \times p_{k_2}}\)</span>. That is, this is the “best guess” of expression in the <span class="math inline">\((k_2)\)</span>-th omic for the cells in <span class="math inline">\((k_1)\)</span>-th omic.</p>
</div>
<p>Importantly, separate variational autoencoders (VAEs) are trained for each omics layer, producing omics-specific low-dimensional cell embeddings. A shared latent embedding is aligned across modalities through adversarial learning and guided by the regulatory graph.</p>
<p>Some of the modeling details:</p>
<ol type="1">
<li><strong>Guidance Graph</strong>: Let <span class="math inline">\(p=\sum_{k=1}^{K}p_k\)</span>, which denotes the total number of features across all <span class="math inline">\(K\)</span> omics. The guidance graph <span class="math inline">\(\mathcal{G} = (\mathcal{V}, \mathcal{E})\)</span> connects features across omics layers, with edges weighted by interaction confidence, where <span class="math inline">\(\mathcal{V}\)</span> denotes all <span class="math inline">\(p\)</span> features. The feature embeddings <span class="math inline">\(V\)</span> are learned to reconstruct this graph, roughly:</li>
</ol>
<p><span class="math display">\[
\log p(\mathcal{G}  | V) = \sum_{(i, j) \in \mathcal{E} } \big[\log \sigma(s_{ij} v_i^\top v_j) + \sum_{j' : (i,j') \notin \mathcal{E}} \log\big(1-\sigma(s_{ij'}v_i^\top v_{j'}\big)\big],
\]</span> where <span class="math inline">\(\sigma\)</span> is the sigmoid function, <span class="math inline">\(s\_{ij}\)</span> indicates edge polarity, and <span class="math inline">\(v_i, v_j\)</span> are feature embeddings. We’ll need to learn the graph convolution network encoder to learn <span class="math inline">\(V\)</span> from <span class="math inline">\(\mathcal{G}\)</span> (please see the paper for this – this is a bit complicated to explain concisely), as well as the parameters <span class="math inline">\(\{s_{ij}\}_{i,j\in\{1,\ldots,p\}}\)</span> (which is the “decoder” for the graph, in a sense).</p>
<p>This <span class="math inline">\(V\)</span> is a matrix with number of rows equal to the total number of features in <span class="math inline">\(\mathcal{G}\)</span>, and the number of columns equal to the latent dimension. We can subset the rows specific to the <span class="math inline">\(k\)</span>-th omic to get the matrix (with less rows) <span class="math inline">\(V^{(k)}\)</span>.</p>
<ol start="2" type="1">
<li><strong>Autoencoder for Cell Embeddings</strong>: Each omics layer <span class="math inline">\(k\)</span> has its own autoencoder that generates cell embeddings <span class="math inline">\(U\)</span> from observed data <span class="math inline">\(X^{(k)}\)</span>:</li>
</ol>
<p><span class="math display">\[
p_{\text{decoder }k}(x^{(k)}_i | u_i, V^{(k)}) = \text{NB}(x^{(k)}_i; \text{mean vector}, \text{dispersion vector}),
\]</span></p>
<p>where <span class="math inline">\(\text{NB}\)</span> is a negative binomial distribution for modeling count data. Here, <span class="math inline">\(U\)</span> is the “common” embedding across any of the <span class="math inline">\(K\)</span> omics. (I’m using the notation <span class="math inline">\(x^{(k)}_i\)</span> to denote the the <span class="math inline">\(i\)</span>th cell in the <span class="math inline">\(k\)</span>-th omic, which is a row in <span class="math inline">\(X^{(k)}\)</span> – I apologize for this confusion notation, there’s a lot of things flying around.) Importantly, this “decoder” takes in the cell embedding <span class="math inline">\(U\)</span> and the latent embeddings for all the features for the <span class="math inline">\(k\)</span>-th omic, <span class="math inline">\(V^{(k)}\)</span>. This is accompanied by a encoder for each omic to yield its posterior Gaussian distribution,</p>
<p><span class="math display">\[
q_{\text{encoder }k}(u_i | x^{(k)}_i) = \text{N}(\text{some mean}, \text{some covariance}).
\]</span></p>
<p>We’ll also need to train all <span class="math inline">\(K\)</span> encoders and “decoders”.</p>
<p>The important formula to see how this works is the Equation (9) in the paper, which, in the notation in the notes here, would be,</p>
<p><span class="math display">\[
\begin{aligned}
&amp;  \big\{\text{The imputed expected expression of feature $j$ in omic $k$}\big\} = \big\{\text{The $j$-th coordiate of: }\\
&amp; \text{SoftMax}\Big(\alpha \odot (V^{(k)})^\top u_i+ \beta \Big)\big\} \cdot \big\{\text{Observed library size of the cell in omic $k$}\big\}.
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\odot\)</span> denotes the Hadamard product<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, (i.e., entry-wise product). Note: 1) <span class="math inline">\(V^{(k)}\)</span> is a matrix that has rows equal to the number of features in the <span class="math inline">\(k\)</span>-th omic, and columns equal to the latent dimension. <span class="math inline">\(u_i\)</span> is a vector of length equal to the number of latent dimensions. Therefore, <span class="math inline">\((V^{(k)})^\top u_i\)</span> is a vector of length equal to the number of features in the <span class="math inline">\(k\)</span>-th omic. 2) This isn’t the decoder you might be familiar with hidden layers of linear transformations followed by activation functions. Instead, this is more-or-less a straightforward linear transformation that takes the feature embeddings and cell embeddings<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<ol start="3" type="1">
<li><strong>Adversarial Alignment</strong>: A discriminator <span class="math inline">\(D\)</span> is trained to classify omics layers based on cell embeddings <span class="math inline">\(u\)</span>. Encoders are updated to fool the discriminator, aligning embeddings across modalities:</li>
</ol>
<p><span class="math display">\[
    - \sum_k \mathbb{E}_{X^{(K)}} \left[ \log D_k(\text{discriminator}(U)) \right],
\]</span></p>
<p>where <span class="math inline">\(D_k\)</span> is the the multiclass classification cross entropy, and the discriminator is a function that is being adversarially trained to try to distinguish between the <span class="math inline">\(K\)</span> omics. The data encoders can then be trained in the opposite direction to fool the discriminator, ultimately leading to the alignment of cell embeddings from different omics layers.</p>
<ol start="4" type="1">
<li><strong>Overall Objective</strong>: The total loss combines data reconstruction, graph reconstruction, and adversarial alignment. That is, the discriminator is training to minimize</li>
</ol>
<p>Error when predicting which omic the input data came from based on the embedding <span class="math inline">\(U\)</span>, while, simultaneously, the encoders and decoders are trying to maximize</p>
<p><span class="math display">\[
    \begin{aligned}
    &amp;\lambda_{\mathcal{G}} \cdot \text{Log-likelihood of generating graph $\mathcal{G}$ based on feature embedding }V +\\
    &amp;\lambda_{D} \cdot \text{The confusion of discriminator $D$ predicting the omic based on }U +\\
    &amp;\Big[\sum_{k=1}^{K}\text{Log-likelihood of generating data from omic $k$ based on } U \text{ and }V\Big],
    \end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\lambda_{\mathcal{G}}\)</span> and <span class="math inline">\(\lambda_{D}\)</span> are hyperparameters.</p>
<div class="block">
<div id="fig-glue2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-glue2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/glue.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-glue2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.28: From <span class="citation" data-cites="cao2022multi">Z.-J. Cao and Gao (<a href="references.html#ref-cao2022multi" role="doc-biblioref">2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>Conceptually: 1) The adversarial discriminatory is working “against” you, and trying to predict if a cell’s embedding comes from one omic or the other. The better the adversary can do this, the more it means that you (GLUE) did not yet properly align the two omics. 2) The guidance graph is (at a high level) about orienting this alignment. As opposed to unsupervised integration methods that purely rely on geometric relations, GLUE uses this guidance graph to help determine, “If there are multiple ‘rotations’ of the omics to align them, which particular ‘rotation’ makes the most sense?”</p>
<p><strong>A brief note on other approaches.</strong><br>
There are fewer methods in this category, and these methods are a lot harder for a third-party to benchmark since they heavily rely on the biological information you’re using. However, for some examples, integrating single-cell RNA and proteins, you can look at <span class="citation" data-cites="zhu2021robust">B. Zhu et al. (<a href="references.html#ref-zhu2021robust" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="chen2023integration">S. Chen et al. (<a href="references.html#ref-chen2023integration" role="doc-biblioref">2024</a>)</span>. For single-cell RNA and ATAC, you can look at <span class="citation" data-cites="zhang2022scdart">Z. Zhang, Yang, and Zhang (<a href="references.html#ref-zhang2022scdart" role="doc-biblioref">2022</a>)</span> in addition to GLUE.</p>
</section>
<section id="dont-forget-about-all-the-usual-multi-modal-integration-methods" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="dont-forget-about-all-the-usual-multi-modal-integration-methods"><span class="header-section-number">6.6.3</span> Don’t forget about all the usual multi-modal integration methods!</h3>
<p>Don’t forget that, similar to how there’s a TotalVI for CITE-seq data, there are <em>a lot</em> of vertical integration methods for RNA-ATAC multiome data. See the end of <span class="quarto-unresolved-ref">?sec-union_totalvi</span> for some benchmarking papers. I’ve seen a couple more often than others: WNN <span class="citation" data-cites="hao2020integrated">Hao et al. (<a href="references.html#ref-hao2020integrated" role="doc-biblioref">2021</a>)</span> and MultiVI <span class="citation" data-cites="ashuach2023multivi">Ashuach et al. (<a href="references.html#ref-ashuach2023multivi" role="doc-biblioref">2023</a>)</span> (see <a href="#fig-multivi" class="quarto-xref">Figure&nbsp;<span>6.29</span></a>, a deep-learning method).</p>
<div class="block">
<div id="fig-multivi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multivi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/multivi.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multivi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.29: From <span class="citation" data-cites="ashuach2023multivi">Ashuach et al. (<a href="references.html#ref-ashuach2023multivi" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p><strong>Translation between omics.</strong><br>
A related task in paired multiome data is: given the RNA profile, can we use translate this into the ATAC profile, and vice versa? At a high level, this is not too different from using an integration of paired multiome data. You simply use one omic’s encoder, and then another omic’s decoder. There are some important engineering differences to facilitate this idea. You can see Polarbear (<span class="citation" data-cites="zhang2022multimodal">R. Zhang et al. (<a href="references.html#ref-zhang2022multimodal" role="doc-biblioref">2022</a>)</span>, see <a href="#fig-polarbear" class="quarto-xref">Figure&nbsp;<span>6.30</span></a>) and BABEL <span class="citation" data-cites="wu2021babel">Wu et al. (<a href="references.html#ref-wu2021babel" role="doc-biblioref">2021</a>)</span> for examples.</p>
<div class="block">
<div id="fig-polarbear" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-polarbear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/polarbear.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-polarbear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.30: From <span class="citation" data-cites="zhang2022multimodal">R. Zhang et al. (<a href="references.html#ref-zhang2022multimodal" role="doc-biblioref">2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>Returning back to the idea of “union” or “intersection” of information in <span class="quarto-unresolved-ref">?rem-union-intersection</span>, the ability to translate from one omic to another necessarily means you are conceptually more focused on learning the “intersection” of information.</p>
<p><strong>Mosaic integration.</strong><br>
What if you have many omics across many datasets, and some of your datasets are paired? We usually call this <em>mosaic integration</em>, where we essentially are “putting the mosaic together” using puzzle pieces of different datasets. In this task, we often have some mixture of paired multiome datasets and some single-omic datasets. See <a href="#fig-scmomat" class="quarto-xref">Figure&nbsp;<span>6.31</span></a> for an example. Two methods to look at as an example of this are scMoMaT <span class="citation" data-cites="zhang2023scmomat">Z. Zhang et al. (<a href="references.html#ref-zhang2023scmomat" role="doc-biblioref">2023</a>)</span> and Cobalt <span class="citation" data-cites="gong2021cobolt">Gong, Zhou, and Purdom (<a href="references.html#ref-gong2021cobolt" role="doc-biblioref">2021</a>)</span>.</p>
<div class="block">
<div id="fig-scmomat" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scmomat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/scmomat.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scmomat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.31: From <span class="citation" data-cites="zhang2023scmomat">Z. Zhang et al. (<a href="references.html#ref-zhang2023scmomat" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="brief-aside-transcription-factors" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="brief-aside-transcription-factors"><span class="header-section-number">6.7</span> Brief aside: Transcription factors</h2>
<p>Transcription factors (TFs) are proteins that regulate gene expression by binding to specific DNA sequences, often within promoters or enhancers, to activate or repress transcription, see <a href="#fig-transcription-factor" class="quarto-xref">Figure&nbsp;<span>6.32</span></a>. They play a crucial role in controlling cellular identity, development, and response to environmental signals. TFs recognize distinct motifs, short DNA sequence patterns, and their binding can be influenced by chromatin accessibility, co-factors, and post-translational modifications. Some TFs act as pioneer factors, capable of binding to condensed chromatin and initiating the process of opening DNA for transcriptional activation. By integrating chromatin accessibility data with known TF motifs, methods like ChromVAR can infer which TFs are actively shaping regulatory landscapes in different cell states.</p>
<p>This TFs will play a big role in the next section, when we start discussing gene regulatory networks.</p>
<div class="block">
<div id="fig-transcription-factor" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transcription-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/transcription-factor2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transcription-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.32: (Top): From <span class="citation" data-cites="leiz2021technologies">Leiz et al. (<a href="references.html#ref-leiz2021technologies" role="doc-biblioref">2021</a>)</span>.<br>
(Bottom left): From <a href="https://en.wikipedia.org/wiki/Transcription_factor" class="uri">https://en.wikipedia.org/wiki/Transcription_factor</a>.<br>
(Bottom right): From <a href="https://digfir-published.macmillanusa.com/life11e/life11e_ch16_11.html" class="uri">https://digfir-published.macmillanusa.com/life11e/life11e_ch16_11.html</a>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="gene-regulatory-networks-grn" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="gene-regulatory-networks-grn"><span class="header-section-number">6.8</span> Gene regulatory networks (GRN)</h2>
<p>Gene regulatory networks (GRNs) describe the intricate interactions between genes, transcription factors, enhancers, and other regulatory elements that control gene expression. Understanding these networks is critical for deciphering how normal cellular functions are maintained and how dysregulation leads to disease. In the context of single-cell and multi-omics data, GRNs provide a framework for linking chromatin accessibility, transcription factor activity, and gene expression dynamics to uncover the molecular basis of health and disease. See <a href="#fig-grn-intro1" class="quarto-xref">Figure&nbsp;<span>6.33</span></a> for the overarching theme of GRNs, where you might start building a GRN via a simple gene co-expression analysis (i.e., “connecting” genes that are correlated), but then later start leveraging biological insights (i.e., which genes are transcription factors, and where TFs bind to accessible chromatin regions, etc.) in later steps.</p>
<div class="block">
<div id="fig-grn-intro1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grn-intro1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/grn-intro1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grn-intro1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.33: From <span class="citation" data-cites="badia2023gene">Badia-i-Mompel et al. (<a href="references.html#ref-badia2023gene" role="doc-biblioref">2023</a>)</span>
</figcaption>
</figure>
</div>
</div>
<p>(Note about this section: We’re going to use the words “enhancer,” “cis-regulatory element” (CREs), and “peak” interchangeably.)</p>
<section id="first-how-we-understand-the-elements-that-control-a-gene" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="first-how-we-understand-the-elements-that-control-a-gene"><span class="header-section-number">6.8.1</span> First: How we understand the elements that control a gene?</h3>
<p>A gene’s expression is governed by multiple regulatory elements, including promoters, enhancers, and transcription factors. Promoters serve as the binding sites for RNA polymerase and general transcription factors, initiating transcription. Enhancers, often located far from the gene they regulate, recruit transcription factors and co-activators to increase transcriptional output.</p>
<p>Typically, a GRN falls into two types: 1) how do TFs bind to certain enhancer regions that cause a change in the downstream gene’s expression, or 2) how do enhancer regions themselves open and close to regulate a downstream gene’s expression. (I know, this is about to get a bit wonky.)</p>
<p><a href="#fig-linked-peak-schematic" class="quarto-xref">Figure&nbsp;<span>6.34</span></a> shows the overall schematic of how to link enhancers (i.e., a peak region, sometimes also called a cis-regulatory element, CRE) to its target gene. See <a href="#fig-linked-peak" class="quarto-xref">Figure&nbsp;<span>6.35</span></a> for how results for linked-peaks is often reported, where the “height” of the arc is the p-value about testing if a peak is linked to a particular gene. See <a href="https://stuartlab.org/signac/articles/pbmc_multiomic" class="uri">https://stuartlab.org/signac/articles/pbmc_multiomic</a> and <a href="https://www.archrproject.com/bookdown/peak2genelinkage-with-archr.html" class="uri">https://www.archrproject.com/bookdown/peak2genelinkage-with-archr.html</a> for examples of how to do this analysis in practice. You can also check out <a href="https://singlecell.broadinstitute.org/single_cell/features/2024-11-21-visualize-and-filter-multiome-atac-data" class="uri">https://singlecell.broadinstitute.org/single_cell/features/2024-11-21-visualize-and-filter-multiome-atac-data</a> for web portals for this.</p>
<div class="block">
<div id="fig-linked-peak-schematic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linked-peak-schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/linked-peak-schematic1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linked-peak-schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.34: (Left): From <span class="citation" data-cites="xie2023robust">Xie et al. (<a href="references.html#ref-xie2023robust" role="doc-biblioref">2023</a>)</span>. (Right): From <span class="citation" data-cites="leblanc2023major">Leblanc and Lettre (<a href="references.html#ref-leblanc2023major" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-linked-peak" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linked-peak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/linked-peak1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linked-peak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.35: (Left): From <span class="citation" data-cites="adams2022single">Adams et al. (<a href="references.html#ref-adams2022single" role="doc-biblioref">2022</a>)</span>.<br>
(Right): From <span class="citation" data-cites="ma2020chromatin">Ma et al. (<a href="references.html#ref-ma2020chromatin" role="doc-biblioref">2020</a>)</span>. (These types of plots usually focus on one particular element. When you see these plots, it’s not usually immediately obvious if the plots are showing if: 1) a gene is being regulated by many CREs, or if 2) a CRE regulates many genes.)
</figcaption>
</figure>
</div>
</div>
<p><strong>TF footprints.</strong><br>
TF footprinting is a computational approach used to infer transcription factor (TF) binding at specific genomic loci by analyzing patterns of chromatin accessibility at single-nucleotide resolution, often using ATAC-seq or DNase-seq data, see <a href="#fig-tf-footprint" class="quarto-xref">Figure&nbsp;<span>6.36</span></a>. Unlike ChromVAR, which assesses motif activity by quantifying motif accessibility variation across cells or conditions, footprinting explicitly identifies regions where TFs are bound by detecting protected sites flanked by regions of high accessibility. This provides direct evidence of TF occupancy, distinguishing between motif presence and actual binding, thereby refining motif enrichment results from ChromVAR and uncovering context-specific regulatory interactions. See <a href="https://www.archrproject.com/bookdown/footprinting-with-archr.html" class="uri">https://www.archrproject.com/bookdown/footprinting-with-archr.html</a> and <a href="https://stuartlab.org/signac/1.2.0/articles/footprint" class="uri">https://stuartlab.org/signac/1.2.0/articles/footprint</a> for more details.</p>
<div class="block">
<div id="fig-tf-footprint" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tf-footprint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/tf_footprint1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tf-footprint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.36: (Left) From <span class="citation" data-cites="siersbaek2014molecular">Siersbæk et al. (<a href="references.html#ref-siersbaek2014molecular" role="doc-biblioref">2014</a>)</span>.<br>
(Right) From <a href="https://www.archrproject.com/bookdown/footprinting-with-archr.html" class="uri">https://www.archrproject.com/bookdown/footprinting-with-archr.html</a>.
</figcaption>
</figure>
</div>
</div>
<p><strong>A conceptual way to understand our goal.</strong><br>
What we are hoping to do is to, essentially, learn the relations peaks and genes across <em>all</em> the peaks and genes. By doing this, we can piece together a graph, which becomes our GRN. See <a href="#fig-grn-intro3" class="quarto-xref">Figure&nbsp;<span>6.37</span></a>.</p>
<div class="block">
<div id="fig-grn-intro3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grn-intro3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/grn-intro3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grn-intro3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.37: From <span class="citation" data-cites="kim2023gene">D. Kim et al. (<a href="references.html#ref-kim2023gene" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>If you are interested in GRNs (which is popular topic for more statistical/computation-leaning students), be aware that there are almost an endless list of GRN methods, see <a href="#fig-grn-table" class="quarto-xref">Figure&nbsp;<span>6.38</span></a>. As we will discuss in <a href="#sec-grn_crazy" class="quarto-xref"><span>Section 6.10</span></a>, it is a nontrivial research question to even know “which method works the best.”</p>
<div class="block">
<div id="fig-grn-table" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grn-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/grn_table.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grn-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.38: From <span class="citation" data-cites="loers2024single">Loers and Vermeirssen (<a href="references.html#ref-loers2024single" role="doc-biblioref">2024</a>)</span>. This is the list for methods at the time of the authors’ writing for multi-omic GRNs. If you include the methods that were designed for solely scRNA-seq, the list becomes unbelievably long.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="grns-between-genes-and-tfs" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="grns-between-genes-and-tfs"><span class="header-section-number">6.8.2</span> GRNs between genes and TFs</h3>
<p>Transcription factors serve as key regulators in GRNs by binding to DNA motifs and either activating or repressing gene expression. The strength and specificity of TF-gene interactions are influenced by chromatin accessibility, cooperative binding with other TFs, and post-translational modifications. The advantage of using GRNs that only model TFs and their target genes (which could involve other TFs) is that the graph is much more manageable to think about. Here, the peaks (measuring regions of chromatin accessibility) allow you to determine: 1) how a TF might bind a peak, and 2) how that peak might influence a gene. All the peaks nearby a gene get “merged” in the modeling as one element altogether.</p>
<p><strong>A typical choice: Pando.</strong><br>
Pando <span class="citation" data-cites="fleck2023inferring">Fleck et al. (<a href="references.html#ref-fleck2023inferring" role="doc-biblioref">2023</a>)</span> infers GRNs by modeling the relationship between gene expression, transcription factor (TF) activity, and chromatin accessibility using a regression-based framework. See <a href="#fig-pando" class="quarto-xref">Figure&nbsp;<span>6.39</span></a>.</p>
<div class="block">
<div id="fig-pando" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pando-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/pando1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pando-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.39: From <span class="citation" data-cites="fleck2023inferring">Fleck et al. (<a href="references.html#ref-fleck2023inferring" role="doc-biblioref">2023</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div class="block3">
<p><strong>Input/Output.</strong> The inputs to Pando are: 1) a paired multiome dataset for <span class="math inline">\(n\)</span> cells, containing both RNA and ATAC features, and 2) a database of TFs and their motifs.<br>
The primary output is a directed and weighted graph among genes (of which some genes are transcription factors).</p>
</div>
<p>The inference procedure follows these steps:<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<ol type="1">
<li><p><strong>Candidate Regulatory Regions</strong>:<br>
Pando identifies candidate regulatory regions by linking chromatin peaks to nearby genes using either the <code>Signac</code> or <code>GREAT</code> <span class="citation" data-cites="mclean2010great">McLean et al. (<a href="references.html#ref-mclean2010great" role="doc-biblioref">2010</a>)</span> method. It considers a defined upstream and downstream distance relative to the gene’s transcription start site (TSS) or gene body. This gives a potential set of peaks for each gene.</p></li>
<li><p><strong>TF-Peak Associations</strong>:<br>
It selects peaks that overlap TF binding motifs and computes correlations between peak accessibility and target gene expression. A threshold is applied to filter TF-gene and peak-gene pairs based on correlation strength. This filters down the list of possible peaks that might facilitate an interaction between a TF and its regulated gene.</p></li>
<li><p><strong>Regression Model</strong>:<br>
Pando fits a regression model for each target gene <span class="math inline">\(g_i\)</span>, estimating the relationship between gene expression and TF activity at its regulatory regions. The general model is: <span id="eq-pando"><span class="math display">\[
g_i \approx \sum_{j} \beta_j (TF_j \circ P_j)
\tag{6.1}\]</span></span> where <span class="math inline">\(TF_j\)</span> is the expression of transcription factor <span class="math inline">\(j\)</span> (i.e., this is another gene’s expression, but this particular gene is deemed a transcription factor based on a database), <span class="math inline">\(P_j\)</span> is the accessibility of the associated peaks, <span class="math inline">\(\circ\)</span> represents an interaction term (which can be additive, multiplicative, or both), and <span class="math inline">\(\beta_j\)</span> denotes the inferred regulatory coefficient. By default, Pando fits a linear regression (i.e., generalized linear model for the Gaussian family), where the all the involved data (i.e., gene expression, transcription factor, etc.) has been already log-normalized.</p>
<p>(Yes – this is as straightforward statistically as it gets. More on this later in <a href="#sec-grn_crazy" class="quarto-xref"><span>Section 6.10</span></a>.)</p></li>
<li><p><strong>Statistical Filtering and Adjustment</strong>:<br>
Pando applies a multiple-testing correction (e.g., false discovery rate (FDR) adjustment) to the estimated coefficients from the linear regression and removes insignificant regulatory interactions. The resulting network consists of target genes, TF regulators, and their associated regulatory elements, allowing for further functional analyses.</p></li>
</ol>
<p>See <a href="#fig-pando-graph" class="quarto-xref">Figure&nbsp;<span>6.40</span></a> for an example of the resulting graph (subsetted to a particular TF).</p>
<div class="block">
<div id="fig-pando-graph" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pando-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/pando_graph.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pando-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.40: From <span class="citation" data-cites="fleck2023inferring">Fleck et al. (<a href="references.html#ref-fleck2023inferring" role="doc-biblioref">2023</a>)</span>. This is the sub-network focusing on the TF GLI3 and all its downstream TFs (other named genes) and other genes (in gray circles).
</figcaption>
</figure>
</div>
</div>
</section>
<section id="grns-between-genes-enhancers-and-tfs" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="grns-between-genes-enhancers-and-tfs"><span class="header-section-number">6.8.3</span> GRNs between genes, enhancers, and TFs</h3>
<p>If you want “higher resolution” and want to model the specific interactions between particular peaks and their intermediary role between the TF and gene, you might instead want to use a GRN that models the interactions between all 3 elements – TFs, the peaks, and the target genes. (Recall, even though you might only be modeling the 2000 highly variable genes with many a couple hundred TFs, you have on the order of 300,000 peaks. So these graphs are incomprehensibly large, to the point you need to think carefully about why you want to learn such a large graph in the first place.)</p>
<p><strong>A typical choice: SCENIC+.</strong><br>
SCENIC+ <span class="citation" data-cites="bravo2023scenic">Bravo González-Blas et al. (<a href="references.html#ref-bravo2023scenic" role="doc-biblioref">2023</a>)</span> infers enhancer-driven gene regulatory networks (eGRNs) by integrating transcription factor (TF) binding motifs, chromatin accessibility, and gene expression data. See the workflow in <a href="#fig-scenic" class="quarto-xref">Figure&nbsp;<span>6.41</span></a>.</p>
<div class="block">
<div id="fig-scenic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scenic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/scenic.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scenic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.41: From <span class="citation" data-cites="bravo2023scenic">Bravo González-Blas et al. (<a href="references.html#ref-bravo2023scenic" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div class="block3">
<p><strong>Input/Output.</strong> The inputs to SCENIC+ are: 1) a paired multiome dataset for <span class="math inline">\(n\)</span> cells, containing both RNA and ATAC features, and 2) a database of TFs and their motifs.<br>
The primary output is a directed and weighted graph among enhancer regions and genes (of which some genes are transcription factors).</p>
</div>
<p>The inference process follows these steps:</p>
<ul>
<li><p><strong>Identification of Candidate Enhancers</strong>:<br>
SCENIC+ processes single-cell chromatin accessibility data (scATAC-seq) using <code>pycisTopic</code>, which identifies differentially accessible regions (DARs) and groups co-accessible regions into enhancer candidates. These candidate enhancers are expected to contain key transcription factor binding sites (TFBSs).</p></li>
<li><p><strong>Motif Enrichment Analysis</strong>:<br>
SCENIC+ uses a large curated database of over 30,000 TF motifs, implemented in <code>pycisTarget</code>, to identify significant motif enrichments within enhancer regions. Two motif enrichment methods are employed:</p>
<ul>
<li><em>cisTarget</em>: A ranking-based approach that scores each genomic region based on motif presence and selects the most significantly enriched motifs.<br>
</li>
<li><em>Differential Enrichment of Motifs (DEM)</em>: A statistical Wilcoxon rank-sum test to identify differentially enriched motifs across enhancer sets.</li>
</ul></li>
<li><p><strong>TF-Enhancer-Gene Association</strong>:<br>
The next step links candidate enhancers to their target genes using correlation-based methods. A gradient-boosting regression model (<code>GRNBoost2</code>, <span class="citation" data-cites="moerman2019grnboost2">Moerman et al. (<a href="references.html#ref-moerman2019grnboost2" role="doc-biblioref">2019</a>)</span>) is applied to quantify the importance of both TFs and enhancer candidates for each target gene. The model assigns importance scores to enhancer–gene pairs, refining direct regulatory interactions.</p></li>
<li><p><strong>eRegulon Construction</strong>:<br>
False discovery rate (FDR) correction is used to filter spurious TF-enhancer-gene associations. The final GRN consists of enhancer-driven regulons (eRegulons), where each TF is linked to a set of enhancer regions and target genes. The regulatory directionality (activation/repression) is inferred using correlation measures.</p></li>
</ul>
<p>See <a href="#fig-scenic-graph" class="quarto-xref">Figure&nbsp;<span>6.42</span></a> for an example of the resulting graph (subsetted to a particular TF).</p>
<div class="block">
<div id="fig-scenic-graph" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scenic-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/scenic_graph.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scenic-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.42: From <span class="citation" data-cites="bravo2023scenic">Bravo González-Blas et al. (<a href="references.html#ref-bravo2023scenic" role="doc-biblioref">2023</a>)</span>. This is the sub-network focusing particular TFs (all named in larger text), as well as the CREs (in diamonds) and other target genes (in circles, named with smaller text.)
</figcaption>
</figure>
</div>
</div>
<p><strong>A brief note about other methods.</strong><br>
Most GRNs fall in this category nowadays. You can see LINGER (see <a href="#fig-linger" class="quarto-xref">Figure&nbsp;<span>6.43</span></a>), which basically follows the same logic as in SCENIC+ but instead uses a deep-learning approach to predict relations between TFs and enhancers on target genes, as one of many examples.</p>
<div class="block">
<div id="fig-linger" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linger-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/linger.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linger-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.43: From <span class="citation" data-cites="yuan2024inferring">Yuan and Duren (<a href="references.html#ref-yuan2024inferring" role="doc-biblioref">2024</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="so-what-do-you-do-with-the-grn" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="so-what-do-you-do-with-the-grn"><span class="header-section-number">6.9</span> So… what do you do with the GRN?</h2>
<ul>
<li><p><strong>Generative modeling of cell types/states (Computational)</strong>:<br>
In some sense, a GRN is a very fancy “correlation matrix” of sorts. This means if you had the GRN, you could hypothetically label cells better since you could: 1) see the cell’s gene expression profile, and 2) know beforehand the “correlation” between genes. With these two ingredients, you could calculate a better “likelihood” a given cell corresponds to the cell type/state of this particular GRN.</p></li>
<li><p><strong>Encoding longitudinal information about the cascading effect of perturbations (Computational, Biological)</strong>:<br>
Since the gene network, in principle, encapsulates how events unfold in a cell, it (in some sense) contains longitudinal information. We typically call this a “cascade” (i.e., how changes in one genomic regions affect other genomic regions over time). See <span class="citation" data-cites="ng2021cascading">Ng et al. (<a href="references.html#ref-ng2021cascading" role="doc-biblioref">2021</a>)</span>. This is one of the main reasons people study GRNs. For instance, <span class="citation" data-cites="fleck2023inferring">Fleck et al. (<a href="references.html#ref-fleck2023inferring" role="doc-biblioref">2023</a>)</span> subset the overall GRN to learn how the GRN changes during brain development. <span class="citation" data-cites="bravo2023scenic">Bravo González-Blas et al. (<a href="references.html#ref-bravo2023scenic" role="doc-biblioref">2023</a>)</span> shows how using the GRN can improve upon our understanding of fate commitment during differentiation. <span class="citation" data-cites="wang2023dictys">L. Wang et al. (<a href="references.html#ref-wang2023dictys" role="doc-biblioref">2023</a>)</span> explicitly models how time affects the GRN via an ordinary differential equation model (ODE). These are just to name a few methods that explicitly are thinking about how our learning of the GRN helps us better understand time dynamics.</p></li>
<li><p><strong>Potential therapeutic targets (Biological)</strong>:<br>
If you knew how the genomic cascade works, then <em>hypothetically</em>, you have roadmap on which genomic region to edit. This is basically the start of the motivation of CRISPR knockouts – if I knew how a particular transcription factor influences many downstream genes, then if I silence or knock out the particular gene producing that TF, then I could manipulate a lot of the transcriptomic activity (and allegedly, a lot of proteomics and biological processes). So the GRN gives me a roadmap on which TF might be a good candidate to knock out in order to prevent any deleterious pathways from activating.</p></li>
<li><p><strong>Understanding the functional impact of SNPs in non-coding regions (Computational, Biological)</strong>:<br>
This will be a much bigger theme when we discuss SNPs in the next chapter, <a href="chapter6_dna.html#sec-genetics_basics" class="quarto-xref"><span>Section 7.1</span></a>. Most of our SNPs are in non-coding regions, and we <em>know</em> that many of these SNPs have some potential effect on a disease from GWAS studies. However, it’s hard to know <em>why</em> these SNPs have a regulatory effect. By learning a GRN, we learn how different enhancer regions affect genes, so we might suspect that if a particular genetic variation lies in that enhancer region, the role of that SNP <em>might</em> be to impact that regulatory effect. (Technically, you need to do a massively parallelized report assay (MPRA, a different wetlab experiment) to actually demonstrate that the SNP <em>actually</em> impacts regulation. We’ll discuss this more later in <a href="chapter6_dna.html#sec-genetics_basics" class="quarto-xref"><span>Section 7.1</span></a>.)</p></li>
<li><p><strong>Cellular memory (Biological)</strong>:<br>
There is a long history of trying to understand if GRNs contribute to the “memory” of a cell. After all, you might ask about: if I stimulate a cell, if a cell is infected by a pathogen, etc., after this event subsides, does the cell “remember” what it just went through? There is no “brain” for the cell, so either you think: 1) cells are Markovian in some sense – they no memory of how it interacted with its environment, or 2) there is some long-term way for cells to alter something about itself to contribute to “memory.” This gets pretty fascinating biologically pretty quick. How would a cell even store memory? It’s likely not through the DNA is you don’t expect cells to naturally acquire many mutations in the DNA over time (hold that thought when we discuss <span class="quarto-unresolved-ref">?sec-dna_structural_variation</span>). It’s likely not through the mRNA or proteins since both degrade, either on the time-scale of hours <span class="citation" data-cites="wang2002precision">Y. Wang et al. (<a href="references.html#ref-wang2002precision" role="doc-biblioref">2002</a>)</span> or a couple days <span class="citation" data-cites="rusilowicz2022protein">Rusilowicz-Jones, Urbé, and Clague (<a href="references.html#ref-rusilowicz2022protein" role="doc-biblioref">2022</a>)</span>, respectively. Then, we turn to possibly something epigenetic. After all, DNA methylation can be inherited from one generation to another (not just on the cell level, but also on the organism level) <span class="citation" data-cites="zhang2021epigenetic">Y. Zhang and Sirard (<a href="references.html#ref-zhang2021epigenetic" role="doc-biblioref">2021</a>)</span>. So it is possible that GRNs (not quite about DNA methylation, but still epigenetic in flavor) are also stable enough (without extreme external stimuli) that they hold information about a cell’s memory? This is the premise of a lot of basic biology interest in GRNs, see <span class="citation" data-cites="almeida2021employing">Almeida et al. (<a href="references.html#ref-almeida2021employing" role="doc-biblioref">2021</a>)</span> for example. For instance, there is preliminary evidence that stress changes the GRN of certain brain cells <span class="citation" data-cites="von2022multiomic">Ziegler et al. (<a href="references.html#ref-von2022multiomic" role="doc-biblioref">2022</a>)</span>. See <span class="citation" data-cites="cha2020single">Cha and Lee (<a href="references.html#ref-cha2020single" role="doc-biblioref">2020</a>)</span> for a review of GRN in relation to diseases, or a focus on Alzheimer’s disease <span class="citation" data-cites="gupta2022single">Gupta et al. (<a href="references.html#ref-gupta2022single" role="doc-biblioref">2022</a>)</span>.</p></li>
</ul>
<p><strong>Brief note about transcriptomic bursting.</strong><br>
Gene expression is inherently stochastic, occurring in bursts rather than as a continuous process, due to the random activation and inactivation of transcriptional machinery. This transcriptomic bursting means that the expression levels of individual genes fluctuate over time, making it unreliable to infer stable co-expression patterns from a single time point, see <a href="#fig-bursting" class="quarto-xref">Figure&nbsp;<span>6.44</span></a>. Instead of focusing on transient expression snapshots, studying gene regulatory networks (GRNs) provides a more robust framework for understanding gene interactions over longer timescales. GRNs capture how transcription factors (TFs) regulate target genes by binding to enhancer regions, establishing regulatory relationships that persist beyond momentary transcriptional fluctuations. By analyzing GRNs, researchers can infer the underlying structure of transcriptional control, allowing for a deeper understanding of cellular processes that remain stable despite the randomness. See <span class="citation" data-cites="tang2023modelling">Tang et al. (<a href="references.html#ref-tang2023modelling" role="doc-biblioref">2023</a>)</span> for an overview of modeling transcriptomic bursting from single-cell data.</p>
<div class="block">
<div id="fig-bursting" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bursting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/bursting2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bursting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.44: (Top) From <span class="citation" data-cites="zhang2024transcriptional">Q. Zhang et al. (<a href="references.html#ref-zhang2024transcriptional" role="doc-biblioref">2024</a>)</span>. (The figure shows that on average, transcription starts and stops on the time-scale of hours in humans.)<br>
(Bottom) From <span class="citation" data-cites="jiang2017scale">Jiang, Zhang, and Li (<a href="references.html#ref-jiang2017scale" role="doc-biblioref">2017</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="sec-grn_crazy" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="sec-grn_crazy"><span class="header-section-number">6.10</span> What makes the field of GRN crazy?</h2>
<div class="block">
<p><strong>NOTE: Everything in this section is Kevin’s extremely opinionated opinions.</strong></p>
</div>
<p>There’s a lot of side notes I need to make about GRNs, since a lot of students become interested in GRNs from many different angles. First off, a couple notes about how I think about GRNs:</p>
<ul>
<li><p><strong>Direction of causality is dictated by biology</strong>:<br>
Part of the reason a lot of GRNs can “get away” with such simple statistics is that the directionality of edges is dictated by biology, not math. After all, we have a pretty reasonable understanding that TFs need to bind to certain regions to modulate a gene’s expression.</p></li>
<li><p><strong>Keeping in mind the time-scale of cells used when learning the GRN</strong>:<br>
Which cells did you use to train the GRN? Did you use cells of many different cell types/states, or many different stages of progression? If so, then your GRN might be capturing <em>any</em> possible interaction between TFs and genes, and not be specific to a particular cellular state. This is to say – you need to think hard about what your GRN represents in terms of time. Does your GRN represent something more <em>instantaneous</em> (i.e., specific to a cell or a meta-cell), and you think the GRN itself is changing as the cells change? Or does your GRN represent any possible interaction between any TF or any gene, but if you were given a particular cell, you can’t quite determine if the specific TF is regulating a specific gene at that moment?</p>
<p><em>Sidenote 1</em>: Even if you wanted to interpret your GRN with no time context, you’ll be in trouble. First, you need variation in your data to learn GRNs. (If all your cells literally had the same expression in RNA and ATAC, you would no ability to learn the GRN.) So you <em>must</em> have some variation among your cells. So the real question is: is that variation due to some underlying biological dynamics?</p>
<p><em>Sidenote 2</em>: This means you should be aware of Simpson’s paradox<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> when working with GRNs. See <span class="citation" data-cites="li2024dissecting">J. J. Li et al. (<a href="references.html#ref-li2024dissecting" role="doc-biblioref">2024</a>)</span> for a cell-biology specific example of Simpon’s paradox.</p></li>
</ul>
<p>As a sidenote, it is important that different methods assume (by default) a different distance between a peak and its regulated gene, see <a href="#fig-peak-gene-length" class="quarto-xref">Figure&nbsp;<span>6.45</span></a>. Also note that this distance isn’t even necessarily distance (since often, you might expect more enhancers to be upstream of a gene’s TSS than downstream). Also, the way different methods “weigh” the total regulatory effect of all the CREs on a gene might differ.</p>
<div class="block">
<div id="fig-peak-gene-length" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-peak-gene-length-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/peak-gene-length.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peak-gene-length-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.45: From <span class="citation" data-cites="loers2024single">Loers and Vermeirssen (<a href="references.html#ref-loers2024single" role="doc-biblioref">2024</a>)</span>
</figcaption>
</figure>
</div>
</div>
<p><strong>Why do we (as a field) focus on “causal” edges, instead of simply “correlation” edges?</strong></p>
<p>A <em>lot</em> of the methods I noted are placing edges between 2 elements simply based on correlation. If you are statistics-leaning student, this might leave a bad taste in your mouth since either: 1) you are aware of the differences between correlation and conditional independence, and/or 2) you are aware of the differences between correlation and causation (say, in the counterfactual sense).</p>
<p>As for conditional independence, methods to learn gene regulatory networks via conditional independence have fallen out of favor, <em>not</em> because the statistical goal is not worthwhile, but (in my impression), the scientific improvement in our biological understanding hasn’t been substantially large enough to warrant such a massively more complicated estimation procedure. (If you can figure out a way to convincingly articulate that conditional independence networks starkly gives you a more accurate picture of biology, there is a lot of reward. However, to do this, you need to have a very rigorous biological understand on how you’ll do this, likely with a lot of wetlab experiments to back you up.</p>
<p>As for causality, an ideal goal might be to only place edges if perturbing one element necessarily <em>causes</em> a change in the downstream element. We will return back to this when we discuss CRISPR knockouts in <span class="quarto-unresolved-ref">?sec-chapter_7</span>. However, suffice to say, for now, this is extremely challenging for many aspects:</p>
<ul>
<li><p><strong>Limitations of data collection</strong>:<br>
Unlike a clinical trial, in single-cell biology, we are measuring everything at once, <em>and</em> we kill the cell to sequence the cell. This means: 1) we cannot accurately be sure about the direction of causality, since we need to estimate the “age” of a cell and the “timeline” of a cell. (After all, a foundation of causal inference is that you can say definitely someone got a treatment <em>before</em> you measure the outcome.) In our cell biology setting, you are measuring all the peaks and gene expression at the same time, so how can you be so definitive on the direction of causality?</p>
<p>Even if you retort and set up a longitudinal CRISPR experiment, since you have to kill (lyse) the cell to sequence it, you can only get longitudinal information about the overall petri dish, not longitudinal information about specific cells. (Technically, this aspect isn’t the worst limitation. After all, in an observational study, if you analyze enough people, you can know if a drug caused a change in someone’s blood pressure even if you didn’t measure someone’s blood pressure before they took the drug. <em>However</em>, in our single-cell context, since we can never observe <em>both</em> pre-treatment and post-treatment, it is hard to stratify the “treatment effect” of a CRISPR knockout, unless you’re working with a mostly homogeneous cell line where there’s basically no variation among the cells.</p></li>
<li><p><strong>Are we really learning causal effects if we don’t know all the middle-men in transcription?</strong><br>
Even if you say that a particular TF “causes” a change in downstream gene’s expression, does this <em>really</em> make sense unless you are honing in on the specific pathway and mechanisms? After all, the grand holy grail of cell biology is to articulate the specific set of events. If your hard work of causal inference is only amounts to stating two things are causally related, but you are not able to say explicitly how (in a bio-mechanistic sense), is your finding advancing biology, or is it just a slight improvement in the statistics?</p>
<p>See <a href="#fig-apoptosis" class="quarto-xref">Figure&nbsp;<span>6.46</span></a> for an example of the type of mechanisms a cell biologists wants to uncover at the end of the day. It’s a very literal sequence of events of how certain biological processes unfold.</p></li>
</ul>
<div class="block">
<div id="fig-apoptosis" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-apoptosis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/apoptosis.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-apoptosis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.46: From <span class="citation" data-cites="taylor2008apoptosis">Taylor, Cullen, and Martin (<a href="references.html#ref-taylor2008apoptosis" role="doc-biblioref">2008</a>)</span>
</figcaption>
</figure>
</div>
</div>
<ul>
<li><p><strong>What is exactly is the “treatment”?</strong><br>
This is more of a philosophical aspect – if you do not have a way to actually perturb a biological element (i.e., we do not have the technology to actually safely alter a particular cell element), is it even that important to learn the true causality? For instance, if I tell you that learning how to fly will definitely cause you to live past 100 years, would you really be that interested in my finding?</p></li>
<li><p><strong>Do CRISPR knockouts actually recapitulate what naturally happens?</strong><br>
The most common way to validate a GRN is to perform a CRISPR knockout and measure what happens to the resulting cells. (We’ll discuss this more in <span class="quarto-unresolved-ref">?sec-chapter_7</span>.) This is great to validate a computational method’s GRN. However, it doesn’t necessarily recapitulate what happens naturally in the body during differentiation or a disease’s progression. For example, if I gave you a drug that cured cancer but caused you to turn into a vampire, would this be a viable discovery?</p></li>
</ul>
<div class="block2">
<p><strong>So what does this mean for me?</strong><br>
Despite this shortcomings of existing GRNs, technological limitations have never stopped ambitious researchers to find creative solutions. When you work on GRNs, the biggest question is to have a research plan on how to validate your GRN (nowadays, it’s typically done with a CRISPR knockout experiment, but it can also involve some computational validation) and what you are planning to demonstrate its importance downstream for new biological insights.</p>
</div>
<p><strong>A brief note on related topics.</strong><br>
See <span class="citation" data-cites="loers2024single">Loers and Vermeirssen (<a href="references.html#ref-loers2024single" role="doc-biblioref">2024</a>)</span> and <span class="citation" data-cites="kim2023gene">D. Kim et al. (<a href="references.html#ref-kim2023gene" role="doc-biblioref">2023</a>)</span> for <em>fantastic</em> overviews on GRNs learned from multi-omic data. Remember that GRNs have existed way before paired multiome data has been around. See <span class="citation" data-cites="karamveer2024approaches">Karamveer and Uzun (<a href="references.html#ref-karamveer2024approaches" role="doc-biblioref">2024</a>)</span>, <span class="citation" data-cites="stock2024topological">Stock et al. (<a href="references.html#ref-stock2024topological" role="doc-biblioref">2024</a>)</span> for overviews not specific to learning GRNs from multi-omic data. See <span class="citation" data-cites="garbulowski2024genespider2">Garbulowski et al. (<a href="references.html#ref-garbulowski2024genespider2" role="doc-biblioref">2024</a>)</span>, <span class="citation" data-cites="cannoodt2021spearheading">Cannoodt et al. (<a href="references.html#ref-cannoodt2021spearheading" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="pratapa2020benchmarking">Pratapa et al. (<a href="references.html#ref-pratapa2020benchmarking" role="doc-biblioref">2020</a>)</span> for an example of how to synthetically generate a gene regulatory network and the corresponding scRNA-seq data (to benchmark methods).</p>
<p>Also, note that there are some network methods that have nodes for each genomic feature <em>and</em> cells, see <a href="#fig-simba" class="quarto-xref">Figure&nbsp;<span>6.47</span></a>. Some example of methods are SIMBA <span class="citation" data-cites="chen2024simba">H. Chen et al. (<a href="references.html#ref-chen2024simba" role="doc-biblioref">2024</a>)</span> and CellWalker2 <span class="citation" data-cites="hu2024cellwalker2">Hu, Przytycki, and Pollard (<a href="references.html#ref-hu2024cellwalker2" role="doc-biblioref">2024</a>)</span>.</p>
<div class="block">
<div id="fig-simba" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simba-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap5/simba.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simba-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.47: From <span class="citation" data-cites="chen2024simba">H. Chen et al. (<a href="references.html#ref-chen2024simba" role="doc-biblioref">2024</a>)</span>
</figcaption>
</figure>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-adams2022single" class="csl-entry" role="listitem">
Adams, Levi, Min Kyung Song, Yoshiaki Tanaka, and Yoon-Seong Kim. 2022. <span>“Single-Nuclei Paired Multiomic Analysis of Young, Aged, and Parkinson’s Disease Human Midbrain Reveals Age-and Disease-Associated Glial Changes and Their Contribution to Parkinson’s Disease.”</span> <em>MedRxiv</em>, 2022–01.
</div>
<div id="ref-almeida2021employing" class="csl-entry" role="listitem">
Almeida, Nathalia, Matthew WH Chung, Elena M Drudi, Elise N Engquist, Eva Hamrud, Abigail Isaacson, Victoria SK Tsang, Fiona M Watt, and Francesca M Spagnoli. 2021. <span>“Employing Core Regulatory Circuits to Define Cell Identity.”</span> <em>The EMBO Journal</em> 40 (10): e106785.
</div>
<div id="ref-argelaguet2021computational" class="csl-entry" role="listitem">
Argelaguet, Ricard, Anna SE Cuomo, Oliver Stegle, and John C Marioni. 2021. <span>“Computational Principles and Challenges in Single-Cell Data Integration.”</span> <em>Nature Biotechnology</em> 39 (10): 1202–15.
</div>
<div id="ref-ashuach2023multivi" class="csl-entry" role="listitem">
Ashuach, Tal, Mariano I Gabitto, Rohan V Koodli, Giuseppe-Antonio Saldi, Michael I Jordan, and Nir Yosef. 2023. <span>“MultiVI: Deep Generative Model for the Integration of Multimodal Data.”</span> <em>Nature Methods</em>, 1–10.
</div>
<div id="ref-ashuach2022peakvi" class="csl-entry" role="listitem">
Ashuach, Tal, Daniel A Reidenbach, Adam Gayoso, and Nir Yosef. 2022. <span>“PeakVI: A Deep Generative Model for Single-Cell Chromatin Accessibility Analysis.”</span> <em>Cell Reports Methods</em> 2 (3).
</div>
<div id="ref-badia2023gene" class="csl-entry" role="listitem">
Badia-i-Mompel, Pau, Lorna Wessels, Sophia Müller-Dott, Rémi Trimbour, Ricardo O Ramirez Flores, Ricard Argelaguet, and Julio Saez-Rodriguez. 2023. <span>“Gene Regulatory Network Inference in the Era of Single-Cell Multi-Omics.”</span> <em>Nature Reviews Genetics</em> 24 (11): 739–54.
</div>
<div id="ref-blanco2020bivalent" class="csl-entry" role="listitem">
Blanco, Enrique, Mar González-Ramı́rez, Anna Alcaine-Colet, Sergi Aranda, and Luciano Di Croce. 2020. <span>“The Bivalent Genome: Characterization, Structure, and Regulation.”</span> <em>Trends in Genetics</em> 36 (2): 118–31.
</div>
<div id="ref-bravo2023scenic" class="csl-entry" role="listitem">
Bravo González-Blas, Carmen, Seppe De Winter, Gert Hulselmans, Nikolai Hecker, Irina Matetovici, Valerie Christiaens, Suresh Poovathingal, Jasper Wouters, Sara Aibar, and Stein Aerts. 2023. <span>“<span>SCENIC+</span>: Single-Cell Multiomic Inference of Enhancers and Gene Regulatory Networks.”</span> <em>Nature Methods</em> 20 (9): 1355–67.
</div>
<div id="ref-bruggeman2008using" class="csl-entry" role="listitem">
Bruggeman-Everts, Fieke. 2008. <span>“Using Mouse Models to Identify the Molecular Mechanisms Mediating Gene by Environment Interactions in Depressive Illness.”</span> PhD thesis. <a href="https://www.researchgate.net/publication/233413663_Using_mouse_models_to_identify_the_molecular_mechanisms_mediating_gene_by_environment_interactions_in_depressive_illness">https://www.researchgate.net/publication/233413663_Using_mouse_models_to_identify_the_molecular_mechanisms_mediating_gene_by_environment_interactions_in_depressive_illness</a>.
</div>
<div id="ref-buenrostro2015atac" class="csl-entry" role="listitem">
Buenrostro, Jason D, Beijing Wu, Howard Y Chang, and William J Greenleaf. 2015. <span>“ATAC-Seq: A Method for Assaying Chromatin Accessibility Genome-Wide.”</span> <em>Current Protocols in Molecular Biology</em> 109 (1): 21–29.
</div>
<div id="ref-cannoodt2021spearheading" class="csl-entry" role="listitem">
Cannoodt, Robrecht, Wouter Saelens, Louise Deconinck, and Yvan Saeys. 2021. <span>“Spearheading Future Omics Analyses Using Dyngen, a Multi-Modal Simulator of Single Cells.”</span> <em>Nature Communications</em> 12 (1): 3942.
</div>
<div id="ref-cao2022manifold" class="csl-entry" role="listitem">
Cao, Kai, Yiguang Hong, and Lin Wan. 2022. <span>“Manifold Alignment for Heterogeneous Single-Cell Multi-Omics Data Integration Using Pamona.”</span> <em>Bioinformatics</em> 38 (1): 211–19.
</div>
<div id="ref-cao2022multi" class="csl-entry" role="listitem">
Cao, Zhi-Jie, and Ge Gao. 2022. <span>“Multi-Omics Single-Cell Data Integration and Regulatory Inference with Graph-Linked Embedding.”</span> <em>Nature Biotechnology</em> 40 (10): 1458–66.
</div>
<div id="ref-cha2020single" class="csl-entry" role="listitem">
Cha, Junha, and Insuk Lee. 2020. <span>“Single-Cell Network Biology for Resolving Cellular Heterogeneity in Human Diseases.”</span> <em>Experimental &amp; Molecular Medicine</em> 52 (11): 1798–808.
</div>
<div id="ref-chang2024droplet" class="csl-entry" role="listitem">
Chang, Lei, Yang Xie, Brett Taylor, Zhaoning Wang, Jiachen Sun, Ethan J Armand, Shreya Mishra, et al. 2024. <span>“Droplet Hi-c Enables Scalable, Single-Cell Profiling of Chromatin Architecture in Heterogeneous Tissues.”</span> <em>Nature Biotechnology</em>, 1–14.
</div>
<div id="ref-chen2024simba" class="csl-entry" role="listitem">
Chen, Huidong, Jayoung Ryu, Michael E Vinyard, Adam Lerer, and Luca Pinello. 2024. <span>“SIMBA: Single-Cell Embedding Along with Features.”</span> <em>Nature Methods</em> 21 (6): 1003–13.
</div>
<div id="ref-chen2015alternative" class="csl-entry" role="listitem">
Chen, J, and WA Weiss. 2015. <span>“Alternative Splicing in Cancer: Implications for Biology and Therapy.”</span> <em>Oncogene</em> 34 (1): 1–14.
</div>
<div id="ref-chen2023integration" class="csl-entry" role="listitem">
Chen, Shuxiao, Bokai Zhu, Sijia Huang, John W Hickey, Kevin Z Lin, Michael Snyder, William J Greenleaf, Garry P Nolan, Nancy R Zhang, and Zongming Ma. 2024. <span>“Integration of Spatial and Single-Cell Data Across Modalities with Weakly Linked Features.”</span> <em>Nature Biotechnology</em> 42 (7): 1096–106.
</div>
<div id="ref-claringbould2021enhancers" class="csl-entry" role="listitem">
Claringbould, Annique, and Judith B Zaugg. 2021. <span>“Enhancers in Disease: Molecular Basis and Emerging Treatment Strategies.”</span> <em>Trends in Molecular Medicine</em> 27 (11): 1060–73.
</div>
<div id="ref-demetci2022scot" class="csl-entry" role="listitem">
Demetci, Pinar, Rebecca Santorella, Björn Sandstede, William Stafford Noble, and Ritambhara Singh. 2022. <span>“SCOT: Single-Cell Multi-Omics Alignment with Optimal Transport.”</span> <em>Journal of Computational Biology</em> 29 (1): 3–18.
</div>
<div id="ref-ea2015contribution" class="csl-entry" role="listitem">
Ea, Vuthy, Marie-Odile Baudement, Annick Lesne, and Thierry Forné. 2015. <span>“Contribution of Topological Domains and Loop Formation to 3D Chromatin Organization.”</span> <em>Genes</em> 6 (3): 734–50.
</div>
<div id="ref-fleck2023inferring" class="csl-entry" role="listitem">
Fleck, Jonas Simon, Sophie Martina Johanna Jansen, Damian Wollny, Fides Zenk, Makiko Seimiya, Akanksha Jain, Ryoko Okamoto, et al. 2023. <span>“Inferring and Perturbing Cell Fate Regulomes in Human Brain Organoids.”</span> <em>Nature</em> 621 (7978): 365–72.
</div>
<div id="ref-fornes2020jaspar" class="csl-entry" role="listitem">
Fornes, Oriol, Jaime A Castro-Mondragon, Aziz Khan, Robin Van der Lee, Xi Zhang, Phillip A Richmond, Bhavi P Modi, et al. 2020. <span>“JASPAR 2020: Update of the Open-Access Database of Transcription Factor Binding Profiles.”</span> <em>Nucleic Acids Research</em> 48 (D1): D87–92.
</div>
<div id="ref-gabbutt2022fluctuating" class="csl-entry" role="listitem">
Gabbutt, Calum, Ryan O. Schenck, Daniel J. Weisenberger, Christopher Kimberley, Alison Berner, Jacob Househam, Eszter Lakatos, et al. 2022. <span>“Fluctuating Methylation Clocks for Cell Lineage Tracing at High Temporal Resolution in Human Tissues.”</span> <em>Nature Biotechnology</em> 40 (5): 720–30.
</div>
<div id="ref-garbulowski2024genespider2" class="csl-entry" role="listitem">
Garbulowski, Mateusz, Thomas Hillerton, Daniel Morgan, Deniz Seçilmiş, Lisbet Sonnhammer, Andreas Tjärnberg, Torbjörn EM Nordling, and Erik LL Sonnhammer. 2024. <span>“GeneSPIDER2: Large Scale GRN Simulation and Benchmarking with Perturbed Single-Cell Data.”</span> <em>NAR Genomics and Bioinformatics</em> 6 (3): lqae121.
</div>
<div id="ref-gauba2021immunomodulation" class="csl-entry" role="listitem">
Gauba, Kavya, Shruti Gupta, Jyoti Shekhawat, Praveen Sharma, Dharmveer Yadav, and Mithu Banerjee. 2021. <span>“Immunomodulation by Epigenome Alterations in Mycobacterium Tuberculosis Infection.”</span> <em>Tuberculosis</em> 128: 102077.
</div>
<div id="ref-glancy2024bivalent" class="csl-entry" role="listitem">
Glancy, Eleanor, Natalie Choy, and Melanie A Eckersley-Maslin. 2024. <span>“Bivalent Chromatin: A Developmental Balancing Act Tipped in Cancer.”</span> <em>Biochemical Society Transactions</em> 52 (1): 217–29.
</div>
<div id="ref-gong2021cobolt" class="csl-entry" role="listitem">
Gong, Boying, Yun Zhou, and Elizabeth Purdom. 2021. <span>“Cobolt: Integrative Analysis of Multimodal Single-Cell Sequencing Data.”</span> <em>Genome Biology</em> 22: 1–21.
</div>
<div id="ref-gupta2022single" class="csl-entry" role="listitem">
Gupta, Chirag, Jielin Xu, Ting Jin, Saniya Khullar, Xiaoyu Liu, Sayali Alatkar, Feixiong Cheng, and Daifeng Wang. 2022. <span>“Single-Cell Network Biology Characterizes Cell Type Gene Regulation for Drug Repurposing and Phenotype Prediction in Alzheimer’s Disease.”</span> <em>PLOS Computational Biology</em> 18 (7): e1010287.
</div>
<div id="ref-habib2007analysis" class="csl-entry" role="listitem">
Habib, Naomi. 2007. <em>Analysis of DNA Motifs Based on a Novel Motif Comparison Method</em>. Hebrew University of Jerusalem.
</div>
<div id="ref-hamma2006pseudouridine" class="csl-entry" role="listitem">
Hamma, Tomoko, and Adrian R Ferré-D’Amaré. 2006. <span>“Pseudouridine Synthases.”</span> <em>Chemistry &amp; Biology</em> 13 (11): 1125–35.
</div>
<div id="ref-hao2020integrated" class="csl-entry" role="listitem">
Hao, Yuhan, Stephanie Hao, Erica Andersen-Nissen, William M Mauck, Shiwei Zheng, Andrew Butler, Maddie Jane Lee, et al. 2021. <span>“Integrated Analysis of Multimodal Single-Cell Data.”</span> <em>Cell</em> 184 (13): 3573–87.
</div>
<div id="ref-heinz2010simple" class="csl-entry" role="listitem">
Heinz, Sven, Christopher Benner, Nathanael Spann, Eric Bertolino, Yin C Lin, Peter Laslo, Jason X Cheng, Cornelis Murre, Harinder Singh, and Christopher K Glass. 2010. <span>“Simple Combinations of Lineage-Determining Transcription Factors Prime Cis-Regulatory Elements Required for Macrophage and b Cell Identities.”</span> <em>Molecular Cell</em> 38 (4): 576–89.
</div>
<div id="ref-hernando2019ageing" class="csl-entry" role="listitem">
Hernando-Herraez, Irene, Brendan Evano, Thomas Stubbs, Pierre-Henri Commere, Marc Jan Bonder, Stephen Clark, Simon Andrews, Shahragim Tajbakhsh, and Wolf Reik. 2019. <span>“Ageing Affects DNA Methylation Drift and Transcriptional Cell-to-Cell Variability in Mouse Muscle Stem Cells.”</span> <em>Nature Communications</em> 10 (1): 4361.
</div>
<div id="ref-hu2024cellwalker2" class="csl-entry" role="listitem">
Hu, Zhirui, Pawel F Przytycki, and Katherine S Pollard. 2024. <span>“CellWalker2: Multi-Omic Discovery of Hierarchical Cell Type Relationships and Their Associations with Genomic Annotations.”</span> <em>bioRxiv</em>.
</div>
<div id="ref-ito2022factors" class="csl-entry" role="listitem">
Ito, Shinsuke, Nando Dulal Das, Takashi Umehara, and Haruhiko Koseki. 2022. <span>“Factors and Mechanisms That Influence Chromatin-Mediated Enhancer–Promoter Interactions and Transcriptional Regulation.”</span> <em>Cancers</em> 14 (21): 5404.
</div>
<div id="ref-jiang2017scale" class="csl-entry" role="listitem">
Jiang, Yuchao, Nancy R Zhang, and Mingyao Li. 2017. <span>“SCALE: Modeling Allele-Specific Gene Expression by Single-Cell RNA Sequencing.”</span> <em>Genome Biology</em> 18: 1–15.
</div>
<div id="ref-karamveer2024approaches" class="csl-entry" role="listitem">
Karamveer, and Yasin Uzun. 2024. <span>“Approaches for Benchmarking Single-Cell Gene Regulatory Network Methods.”</span> <em>Bioinformatics and Biology Insights</em> 18: 11779322241287120.
</div>
<div id="ref-kim2023gene" class="csl-entry" role="listitem">
Kim, Daniel, Andy Tran, Hani Jieun Kim, Yingxin Lin, Jean Yee Hwa Yang, and Pengyi Yang. 2023. <span>“Gene Regulatory Network Reconstruction: Harnessing the Power of Single-Cell Multi-Omic Data.”</span> <em>NPJ Systems Biology and Applications</em> 9 (1): 51.
</div>
<div id="ref-kim2017dna" class="csl-entry" role="listitem">
Kim, Mirang, and Joseph Costello. 2017. <span>“<span>DNA</span> Methylation: An Epigenetic Mark of Cellular Memory.”</span> <em>Experimental &amp; Molecular Medicine</em> 49 (4): e322–22.
</div>
<div id="ref-leblanc2023major" class="csl-entry" role="listitem">
Leblanc, Francis JA, and Guillaume Lettre. 2023. <span>“Major Cell-Types in Multiomic Single-Nucleus Datasets Impact Statistical Modeling of Links Between Regulatory Sequences and Target Genes.”</span> <em>Scientific Reports</em> 13 (1): 3924.
</div>
<div id="ref-leiz2021technologies" class="csl-entry" role="listitem">
Leiz, Janna, Maria Rutkiewicz, Carmen Birchmeier, Udo Heinemann, and Kai M Schmidt-Ott. 2021. <span>“Technologies for Profiling the Impact of Genomic Variants on Transcription Factor Binding.”</span> <em>Medizinische Genetik</em> 33 (2): 147–55.
</div>
<div id="ref-li2024dissecting" class="csl-entry" role="listitem">
Li, Jingyi Jessica, Heather J Zhou, Peter J Bickel, and Xin Tong. 2024. <span>“Dissecting Gene Expression Heterogeneity: Generalized Pearson Correlation Squares and the k-Lines Clustering Algorithm.”</span> <em>Journal of the American Statistical Association</em>, 1–14.
</div>
<div id="ref-li2022population" class="csl-entry" role="listitem">
Li, Lei, Yumei Li, Xudong Zou, Fuduan Peng, Ya Cui, Eric J Wagner, and Wei Li. 2022. <span>“Population-Scale Genetic Control of Alternative Polyadenylation and Its Association with Human Diseases.”</span> <em>Quantitative Biology</em> 10 (1): 44–54.
</div>
<div id="ref-lim2024advances" class="csl-entry" role="listitem">
Lim, Jongsu, Chanho Park, Minjae Kim, Hyukhee Kim, Junil Kim, and Dong-Sung Lee. 2024. <span>“Advances in Single-Cell Omics and Multiomics for High-Resolution Molecular Profiling.”</span> <em>Experimental &amp; Molecular Medicine</em> 56 (3): 515–26.
</div>
<div id="ref-liu2021dna" class="csl-entry" role="listitem">
Liu, Hanqing, Jingtian Zhou, Wei Tian, Chongyuan Luo, Anna Bartlett, Andrew Aldridge, Jacinta Lucero, et al. 2021. <span>“<span>DNA</span> Methylation Atlas of the Mouse Brain at Single-Cell Resolution.”</span> <em>Nature</em> 598 (7879): 120–28.
</div>
<div id="ref-liu2021seeing" class="csl-entry" role="listitem">
Liu, Ning, Wai Yee Low, Hamid Alinejad-Rokny, Stephen Pederson, Timothy Sadlon, Simon Barry, and James Breen. 2021. <span>“Seeing the Forest Through the Trees: Prioritising Potentially Functional Interactions from Hi-c.”</span> <em>Epigenetics &amp; Chromatin</em> 14 (1): 41.
</div>
<div id="ref-loers2024single" class="csl-entry" role="listitem">
Loers, Jens Uwe, and Vanessa Vermeirssen. 2024. <span>“A Single-Cell Multimodal View on Gene Regulatory Network Inference from Transcriptomics and Chromatin Accessibility Data.”</span> <em>Briefings in Bioinformatics</em> 25 (5): bbae382.
</div>
<div id="ref-ma2020chromatin" class="csl-entry" role="listitem">
Ma, Sai, Bing Zhang, Lindsay M LaFave, Andrew S Earl, Zachary Chiang, Yan Hu, Jiarui Ding, et al. 2020. <span>“Chromatin Potential Identified by Shared Single-Cell Profiling of <span>RNA</span> and Chromatin.”</span> <em>Cell</em> 183 (4): 1103–16.
</div>
<div id="ref-macrae2023regulation" class="csl-entry" role="listitem">
Macrae, Trisha A, Julie Fothergill-Robinson, and Miguel Ramalho-Santos. 2023. <span>“Regulation, Functions and Transmission of Bivalent Chromatin During Mammalian Development.”</span> <em>Nature Reviews Molecular Cell Biology</em> 24 (1): 6–26.
</div>
<div id="ref-mansisidor2022chromatin" class="csl-entry" role="listitem">
Mansisidor, Andrés R, and Viviana I Risca. 2022. <span>“Chromatin Accessibility: Methods, Mechanisms, and Biological Insights.”</span> <em>Nucleus</em> 13 (1): 238–78.
</div>
<div id="ref-martens2024modeling" class="csl-entry" role="listitem">
Martens, Laura D, David S Fischer, Vicente A Yépez, Fabian J Theis, and Julien Gagneur. 2024. <span>“Modeling Fragment Counts Improves Single-Cell ATAC-Seq Analysis.”</span> <em>Nature Methods</em> 21 (1): 28–31.
</div>
<div id="ref-mclean2010great" class="csl-entry" role="listitem">
McLean, Cory Y, Dave Bristor, Michael Hiller, Shoa L Clarke, Bruce T Schaar, Craig B Lowe, Aaron M Wenger, and Gill Bejerano. 2010. <span>“GREAT Improves Functional Interpretation of Cis-Regulatory Regions.”</span> <em>Nature Biotechnology</em> 28 (5): 495–501.
</div>
<div id="ref-miao2021multi" class="csl-entry" role="listitem">
Miao, Zhen, Benjamin D Humphreys, Andrew P McMahon, and Junhyong Kim. 2021. <span>“Multiomics Integration in the Age of Million Single Cell Data.”</span> <em>Nature Reviews Nephrology</em> 17 (11): 710–24.
</div>
<div id="ref-miao2024uniform" class="csl-entry" role="listitem">
Miao, Zhen, and Junhyong Kim. 2024. <span>“Uniform Quantification of Single-Nucleus ATAC-Seq Data with Paired-Insertion Counting (PIC) and a Model-Based Insertion Rate Estimator.”</span> <em>Nature Methods</em> 21 (1): 32–36.
</div>
<div id="ref-mignone2002untranslated" class="csl-entry" role="listitem">
Mignone, Flavio, Carmela Gissi, Sabino Liuni, and Graziano Pesole. 2002. <span>“Untranslated Regions of mRNAs.”</span> <em>Genome Biology</em> 3: 1–10.
</div>
<div id="ref-moerman2019grnboost2" class="csl-entry" role="listitem">
Moerman, Thomas, Sara Aibar Santos, Carmen Bravo González-Blas, Jaak Simm, Yves Moreau, Jan Aerts, and Stein Aerts. 2019. <span>“GRNBoost2 and Arboreto: Efficient and Scalable Inference of Gene Regulatory Networks.”</span> <em>Bioinformatics</em> 35 (12): 2159–61.
</div>
<div id="ref-ng2021cascading" class="csl-entry" role="listitem">
Ng, Bernard, William Casazza, Nam Hee Kim, Chendi Wang, Farnush Farhadi, Shinya Tasaki, David A Bennett, Philip L De Jager, Christopher Gaiteri, and Sara Mostafavi. 2021. <span>“Cascading Epigenomic Analysis for Identifying Disease Genes from the Regulatory Landscape of GWAS Variants.”</span> <em>PLoS Genetics</em> 17 (11): e1009918.
</div>
<div id="ref-niazi2023rna" class="csl-entry" role="listitem">
Niazi, Sarfaraz K. 2023. <span>“RNA Therapeutics: A Healthcare Paradigm Shift.”</span> <em>Biomedicines</em> 11 (5): 1275.
</div>
<div id="ref-pratapa2020benchmarking" class="csl-entry" role="listitem">
Pratapa, Aditya, Amogh P Jalihal, Jeffrey N Law, Aditya Bharadwaj, and TM Murali. 2020. <span>“Benchmarking Algorithms for Gene Regulatory Network Inference from Single-Cell Transcriptomic Data.”</span> <em>Nature Methods</em> 17 (2): 147–54.
</div>
<div id="ref-rusilowicz2022protein" class="csl-entry" role="listitem">
Rusilowicz-Jones, Emma V, Sylvie Urbé, and Michael J Clague. 2022. <span>“Protein Degradation on the Global Scale.”</span> <em>Molecular Cell</em> 82 (8): 1414–23.
</div>
<div id="ref-schep2017chromvar" class="csl-entry" role="listitem">
Schep, Alicia N, Beijing Wu, Jason D Buenrostro, and William J Greenleaf. 2017. <span>“<span class="nocase">chromVAR</span>: Inferring Transcription-Factor-Associated Accessibility from Single-Cell Epigenomic Data.”</span> <em>Nature Methods</em> 14 (10): 975–78.
</div>
<div id="ref-siersbaek2014molecular" class="csl-entry" role="listitem">
Siersbæk, Rasmus, Songjoon Baek, Atefeh Rabiee, Ronni Nielsen, Sofie Traynor, Nicholas Clark, Albin Sandelin, et al. 2014. <span>“Molecular Architecture of Transcription Factor Hotspots in Early Adipogenesis.”</span> <em>Cell Reports</em> 7 (5): 1434–42.
</div>
<div id="ref-steinbach2017pten" class="csl-entry" role="listitem">
Steinbach, Nicole. 2017. <em>PTEN Affects Gene Expression and Histone Modifications and Plays a Role in the Regulation of Transcription</em>. Columbia University.
</div>
<div id="ref-stock2024topological" class="csl-entry" role="listitem">
Stock, Marco, Niclas Popp, Jonathan Fiorentino, and Antonio Scialdone. 2024. <span>“Topological Benchmarking of Algorithms to Infer Gene Regulatory Networks from Single-Cell RNA-Seq Data.”</span> <em>Bioinformatics</em>, btae267.
</div>
<div id="ref-tang2023modelling" class="csl-entry" role="listitem">
Tang, Wenhao, Andreas Christ Sølvsten Jørgensen, Samuel Marguerat, Philipp Thomas, and Vahid Shahrezaei. 2023. <span>“Modelling Capture Efficiency of Single Cell RNA-Sequencing Data Improves Inference of Transcriptome-Wide Burst Kinetics.”</span> <em>bioRxiv</em>, 2023–03.
</div>
<div id="ref-taylor2008apoptosis" class="csl-entry" role="listitem">
Taylor, Rebecca C, Sean P Cullen, and Seamus J Martin. 2008. <span>“Apoptosis: Controlled Demolition at the Cellular Level.”</span> <em>Nature Reviews Molecular Cell Biology</em> 9 (3): 231–41.
</div>
<div id="ref-teichmann2020method" class="csl-entry" role="listitem">
Teichmann, Sarah, and Mirjana Efremova. 2020. <span>“Method of the Year 2019: Single-Cell Multimodal Omics.”</span> <em>Nature Methods</em> 17 (1): 2020.
</div>
<div id="ref-trapp2021profiling" class="csl-entry" role="listitem">
Trapp, Alexandre, Csaba Kerepesi, and Vadim N Gladyshev. 2021. <span>“Profiling Epigenetic Age in Single Cells.”</span> <em>Nature Aging</em> 1 (12): 1189–1201.
</div>
<div id="ref-wang2023dictys" class="csl-entry" role="listitem">
Wang, Lingfei, Nikolaos Trasanidis, Ting Wu, Guanlan Dong, Michael Hu, Daniel E Bauer, and Luca Pinello. 2023. <span>“Dictys: Dynamic Gene Regulatory Network Dissects Developmental Continuum with Single-Cell Multiomics.”</span> <em>Nature Methods</em> 20: 1368–78.
</div>
<div id="ref-wang2002precision" class="csl-entry" role="listitem">
Wang, Yulei, Chih Long Liu, John D Storey, Robert J Tibshirani, Daniel Herschlag, and Patrick O Brown. 2002. <span>“Precision and Functional Specificity in mRNA Decay.”</span> <em>Proceedings of the National Academy of Sciences</em> 99 (9): 5860–65.
</div>
<div id="ref-wu2021babel" class="csl-entry" role="listitem">
Wu, Kevin E, Kathryn E Yost, Howard Y Chang, and James Zou. 2021. <span>“<span>BABEL</span> Enables Cross-Modality Translation Between Multiomic Profiles at Single-Cell Resolution.”</span> <em>Proceedings of the National Academy of Sciences</em> 118 (15).
</div>
<div id="ref-xie2023robust" class="csl-entry" role="listitem">
Xie, Fangming, Ethan J Armand, Zizhen Yao, Hanqing Liu, Anna Bartlett, M Margarita Behrens, Yang Eric Li, et al. 2023. <span>“Robust Enhancer-Gene Regulation Identified by Single-Cell Transcriptomes and Epigenomes.”</span> <em>Cell Genomics</em> 3 (7).
</div>
<div id="ref-xu2022diagonal" class="csl-entry" role="listitem">
Xu, Yang, and Rachel Patton McCord. 2022. <span>“Diagonal Integration of Multimodal Single-Cell Data: Potential Pitfalls and Paths Forward.”</span> <em>Nature Communications</em> 13 (1): 3505.
</div>
<div id="ref-yuan2024inferring" class="csl-entry" role="listitem">
Yuan, Qiuyue, and Zhana Duren. 2024. <span>“Inferring Gene Regulatory Networks from Single-Cell Multiome Data Using Atlas-Scale External Data.”</span> <em>Nature Biotechnology</em>, 1–11.
</div>
<div id="ref-zhang2024transcriptional" class="csl-entry" role="listitem">
Zhang, Qiuyu, Wenjie Cao, Jiaqi Wang, Yihao Yin, Rui Sun, Zunyi Tian, Yuhan Hu, Yalan Tan, and Ben-gong Zhang. 2024. <span>“Transcriptional Bursting Dynamics in Gene Expression.”</span> <em>Frontiers in Genetics</em> 15: 1451461.
</div>
<div id="ref-zhang2022multimodal" class="csl-entry" role="listitem">
Zhang, Ran, Laetitia Meng-Papaxanthos, Jean-philippe Vert, and William Stafford Noble. 2022. <span>“Multimodal Single-Cell Translation and Alignment with Semi-Supervised Learning.”</span> <em>Journal of Computational Biology</em> 29 (11): 1198–1212.
</div>
<div id="ref-zhang2021epigenetic" class="csl-entry" role="listitem">
Zhang, Ying, and Marc-André Sirard. 2021. <span>“Epigenetic Inheritance of Acquired Traits Through DNA Methylation.”</span> <em>Animal Frontiers</em> 11 (6): 19–27.
</div>
<div id="ref-zhang2023scmomat" class="csl-entry" role="listitem">
Zhang, Ziqi, Haoran Sun, Ragunathan Mariappan, Xi Chen, Xinyu Chen, Mika S Jain, Mirjana Efremova, Sarah A Teichmann, Vaibhav Rajan, and Xiuwei Zhang. 2023. <span>“scMoMaT Jointly Performs Single Cell Mosaic Integration and Multi-Modal Bio-Marker Detection.”</span> <em>Nature Communications</em> 14 (1): 384.
</div>
<div id="ref-zhang2022scdart" class="csl-entry" role="listitem">
Zhang, Ziqi, Chengkai Yang, and Xiuwei Zhang. 2022. <span>“scDART: Integrating Unmatched scRNA-Seq and scATAC-Seq Data and Learning Cross-Modality Relationship Simultaneously.”</span> <em>Genome Biology</em> 23 (1): 139.
</div>
<div id="ref-zhu2021robust" class="csl-entry" role="listitem">
Zhu, Bokai, Shuxiao Chen, Yunhao Bai, Han Chen, Nilanjan Mukherjee, Gustavo Vazquez, David R McIlwain, et al. 2021. <span>“Robust Single-Cell Matching and Multi-Modal Analysis Using Shared and Distinct Features Reveals Orchestrated Immune Responses.”</span> <em>bioRxiv</em>.
</div>
<div id="ref-zhu2021joint" class="csl-entry" role="listitem">
Zhu, Chenxu, Yanxiao Zhang, Yang Eric Li, Jacinta Lucero, M Margarita Behrens, and Bing Ren. 2021. <span>“Joint Profiling of Histone Modifications and Transcriptome in Single Cells from Mouse Brain.”</span> <em>Nature Methods</em>, 1–10.
</div>
<div id="ref-von2022multiomic" class="csl-entry" role="listitem">
Ziegler, Lukas M von, Amalia Floriou-Servou, Rebecca Waag, Rebecca R Das Gupta, Oliver Sturman, Katharina Gapp, Christina A Maat, et al. 2022. <span>“Multiomic Profiling of the Acute Stress Response in the Mouse Hippocampus.”</span> <em>Nature Communications</em> 13 (1): 1824.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The technology to measure this at single-cell resolution is still being developed (see snmC-seq2 <span class="citation" data-cites="liu2021dna">H. Liu et al. (<a href="references.html#ref-liu2021dna" role="doc-biblioref">2021</a>)</span>), and is particularly interesting due to methylation’s relation to cellular memory <span class="citation" data-cites="kim2017dna">M. Kim and Costello (<a href="references.html#ref-kim2017dna" role="doc-biblioref">2017</a>)</span> and molecular clocks <span class="citation" data-cites="hernando2019ageing">Hernando-Herraez et al. (<a href="references.html#ref-hernando2019ageing" role="doc-biblioref">2019</a>)</span>; <span class="citation" data-cites="trapp2021profiling">Trapp, Kerepesi, and Gladyshev (<a href="references.html#ref-trapp2021profiling" role="doc-biblioref">2021</a>)</span>; <span class="citation" data-cites="gabbutt2022fluctuating">Gabbutt et al. (<a href="references.html#ref-gabbutt2022fluctuating" role="doc-biblioref">2022</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See Droplet-HiC <span class="citation" data-cites="chang2024droplet">Chang et al. (<a href="references.html#ref-chang2024droplet" role="doc-biblioref">2024</a>)</span> for an example of single-cell Hi-C.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>See Paired-tag <span class="citation" data-cites="zhu2021joint">C. Zhu et al. (<a href="references.html#ref-zhu2021joint" role="doc-biblioref">2021</a>)</span> for an example of single-cell histone modification.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>If you plan on using Pando yourself (which has pretty well documented code and tutorials in R), please refer to the code directly to see how the method works: <a href="https://github.com/quadbio/Pando/blob/main/R/grn.R" class="uri">https://github.com/quadbio/Pando/blob/main/R/grn.R</a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://en.wikipedia.org/wiki/Simpsons_paradox" class="uri">https://en.wikipedia.org/wiki/Simpsons_paradox</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>If you plan on using Pando yourself (which has pretty well documented code and tutorials in R), please refer to the code directly to see how the method works: <a href="https://github.com/quadbio/Pando/blob/main/R/grn.R" class="uri">https://github.com/quadbio/Pando/blob/main/R/grn.R</a>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><a href="https://en.wikipedia.org/wiki/Simpsons_paradox" class="uri">https://en.wikipedia.org/wiki/Simpsons_paradox</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter4_protein.html" class="pagination-link" aria-label="'Single-cell' proteomics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">‘Single-cell’ proteomics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter6_dna.html" class="pagination-link" aria-label="'Single-cell' DNA">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">‘Single-cell’ DNA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>