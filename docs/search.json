[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "scOmicNotes",
    "section": "",
    "text": "This is a Quarto book made from the content of BIOST 545 (Biostatistical Methods for Big Omics Data), taught by Dr. Kevin Lin at the University of Washington, Winter 2025. The lecture notes in BIOST 545 are meant to ease you into reading these notes, and the notes are meant to be a gateway to many references where the course’s goal is for you 1) to determine for yourself what areas you find interesting and are relevant to your research goals, and 2) use the references as a portal to find many ideas to bolster your own research. This Quarto book is assembled with the help of many student volunteers at the University of Washington: Wenyu Zeng, Nello Gu, and [TBD].",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface-nello version</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html",
    "href": "chapter1_intro.html",
    "title": "2  Introduction",
    "section": "",
    "text": "2.1 Why study cell biology in public health?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#why-study-cell-biology-in-public-health",
    "href": "chapter1_intro.html#why-study-cell-biology-in-public-health",
    "title": "2  Introduction",
    "section": "",
    "text": "2.1.1 What are “omics”?\nThe term “omics” refers to a broad field of biology aimed at the comprehensive characterisation and quantification of biological molecules that translate into the structure, function, and dynamics of an organism. At its core, “omics” encapsulates the idea of studying biological systems at a global scale rather than focusing on individual components. This includes genomics (DNA), transcriptomics (RNA), proteomics (proteins), epigenomics, metabolomics (metabolites), and more. Each of these fields leverages high-throughput technologies to generate massive datasets that capture complex interactions within cells, tissues, or organisms.\nThe rise of “omics” has revolutionised biology by enabling researchers to ask holistic questions such as how different genes, proteins, or metabolites interact in health and disease. It emphasises understanding systems as interconnected networks rather than isolated elements. This systems-level approach is particularly powerful in identifying biomarkers, understanding disease mechanisms, and tailoring precision-medicine strategies. In public health, “omics” provides tools to bridge molecular discoveries with population-level outcomes, offering new opportunities to tackle complex health challenges.\n\n\n2.1.2 Some examples of a “cell-biology” question\n\nHow the brain develops (i.e. the longitudinal sequence of events between birth and maturation), shown in Figure 2.1.\n\nHow microglia in the brain gain or lose certain functions during ageing, shown in Figure 2.2.\n\nWhy certain cells (i.e. cancer cells) divide uncontrollably, see Figure 2.3.\n\n\n\n\n\n\n\n\nFigure 2.1: What is the sequence of cell types that emerge (and where) during human brain development? (Zhou, Song, and Ming 2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.2: Microglia (immune cells of the brain) radically change shape during ageing.\nWhat are the functional consequences of this? (Von Bernhardi, Eugenı́n-von Bernhardi, and Eugenı́n 2015)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.3: Cancer is typically characterised by uncontrollable cell division. What drives this process, how can we detect it early, and how can we stop it? (Source: https://sites.duke.edu/seektobacco/2-the-role-of-tobacco-in-the-development-of-cancer/the-content/)\n\n\n\n\n\n\n2.1.3 How “omics” comes into the picture\nTo answer cell-biology questions we leverage different omics to learn clues about\n1. the cellular functions of a biological system, and\n2. how those functions change during disease, ageing, etc.\nAll these omics are related:\n\nThe central dogma of biology (DNA → RNA → protein) is illustrated in Figure 2.4 and Figure 2.5, linking the three most fundamental omics.\n\nThe epigenome, shown in Figure 2.6, comprises chemical modifications to DNA and histone proteins that regulate gene expression yet are not part of the DNA itself. The figure highlights three commonly studied features: DNA accessibility, DNA methylation, and histone modifications.\n\nThese layers are summarised in Figure 2.7.\n\n\n\n\n\n\n\nFigure 2.4: Central dogma. (Source: https://www.khanacademy.org/science/ap-biology/gene-expression-and-regulation/translation/a/intro-to-gene-expression-central-dogma)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.5: Central dogma. (Source: https://researchfeatures.com/adding-structure-biologys-central-dogma-cancer-treatments-thyroid-cancer/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.6: Epigenetics. (Source: https://en.wikipedia.org/wiki/Epigenetics)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.7: A non-exhaustive list of omics. (Wen et al. 2022)\n\n\n\n\n\nRemark (Personal opinion: Biology is constantly revising the details).\nStatistical knowledge is rarely revised – its instead mostly refined. We know properties that generalize to much broader settings (i.e., less statistical assumptions) and much more refined statistical rates for the settings studied two decades ago. (1) There’s little revisions, since once someone proves a statistical theorem, it is very unlikely for it to get disproven in the future. (2) Statistics generally focuses on what happens in an “average/typical” scenario.\nBiology, in comparison, has many revisions and refinements. There’s a couple reasons for this: (1) Biology research is driven by technology. Hence, as we can image/sequence/profile new aspects of a cell, design new model organisms, or collect more data, we might revise a lot of understanding of how cells work. (2) While there are broad biological mechanisms that generally hold true, many diseases occur when the general biological principle no longer holds true. For this reasons, a lot of cell biology research is about these exceptions, which cause us to question how universally true a biological mechanism is. (As a simple example – we’re taught humans have 46 chromosomes. However, many conditions such as Down Syndrome, originate from having an abnormal number of chromosomes.)\n\n\nRemark (All the omics we will study in this course are matrices).\nOne of major missions of this course is to answer the following question: Every omic is represented as a matrix (generally, where the rows are cells, and columns are certain features, depending on the omic). In that case, how come some statistical methods designed for one omic isn’t applicable for another omic?\nWhile there are certain statistical answers to this question, most of the answers are based on biology. Certain methods rely on a specific biological premise, and that premise becomes hard to justify as you switch from one omic to another.\nThis is not too dissimilar from a causal analysis. In a causal analysis, the reason certain features get labeled as a confounder, treatment, outcome, instrumental variable, mediator, etc. relies on the context.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#what-do-we-hope-to-learn-from-single-cell-data",
    "href": "chapter1_intro.html#what-do-we-hope-to-learn-from-single-cell-data",
    "title": "2  Introduction",
    "section": "2.2 What do we hope to learn from single-cell data?",
    "text": "2.2 What do we hope to learn from single-cell data?\n\n2.2.1 Basic biology\nSingle-cell data offer a transformative lens to study the fundamental processes of life at unparalleled resolution. Unlike bulk data, which averages signals across populations of cells, single-cell technologies allow researchers to examine the diversity and complexity of individual cells within a tissue or organism. This level of detail provides insights into key biological phenomena, such as cellular differentiation during development, the plasticity of cell states in response to environmental cues, and the organization of complex tissues. For instance, single-cell RNA-sequencing (scRNA-seq) has uncovered new cell types in the brain and immune system, challenging traditional classifications and offering a more nuanced understanding of cellular identities and functions. These insights are essential for constructing more accurate models of how life operates at a cellular level.\nMany of the examples shown in Figs. Figure 2.1–Figure 2.2 are basic biology questions. Two additional examples are shown in Figure 2.8 and Figure 2.9.\n\n\n\n\n\n\n\nFigure 2.8: How do cancer cells survive successive therapies? (Schaff et al. 2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.9: What deteriorates in a cell as it ages (Silva and Schumacher 2021)\n\n\n\n\n\n\n2.2.2 Benchside-to-bedside applications\nSingle-cell data have enormous potential to revolutionize clinical practice by bridging molecular biology and medicine. After learning basic biology, the next stage is to use our newfound understanding to advance treatments. (We typically call this translation research, to denote translating our basic biology knowledge to therapeutic improvements.) This is also called benchside (for the wet-bench, i.e. laboratory setting) to bedside (for the hospital setting).\nBy mapping cellular heterogeneity in diseased and healthy tissues, researchers can identify specific cell populations driving disease progression and therapeutic resistance. For example, in cancer, single-cell analyses have uncovered rare tumor subclones that evade treatment, providing critical targets for drug development. Similarly, in autoimmune diseases like rheumatoid arthritis, single-cell profiling of synovial tissues has identified inflammatory cell states that correlate with disease severity and treatment response. Beyond diagnostics, this technology enables precision medicine by tailoring treatments to the molecular profiles of individual patients. As single-cell approaches continue to evolve, they are poised to refine drug-discovery pipelines, improve vaccine design, and ultimately transform how diseases are diagnosed and treated.\nThere are a few ways this typically happens. Figure 2.10 shows one example, where single-cell research helps identify the specific cell types and specific edits needed to improve cellular function. Figure 2.11 shows another example, where understanding the cellular functions, we can improve how conventional methods can be used to measure more accurate biomarkers. Cancer research has been (by far) the biggest beneficiary of single-cell research, and Figure 2.12 illustrates how single-cell improves cancer therapies.\n\n\n\n\n\n\n\nFigure 2.10: There are current single-cell therapies that involve extracting blood from a donor, altering the cells outside the body, and then infusing the altered blood back into the donor. (Source: https://www.cancer.gov/news-events/cancer-currents-blog/2020/crispr-cancer-research-treatment)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.11: After learning the causal mechanisms for specific cell types for Alzheimer’s disease that can be detected from blood draws, we can refine existing biomarkers to monitor Alzheimer’s. (Hansson et al. 2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.12: Example of how insights from single-cell studies transform cancer therapies. (Gohil et al. 2021)\n\n\n\n\n\n\n\n2.2.3 What existed prior to single-cell data?\nWestern blots and flow cytometry.\nBefore the advent of single-cell technologies, biological research relied heavily on methods like western blots and flow cytometry to study cells and molecules. Western blotting (shown in Figure 2.13 and Figure 2.14), developed in the late 1970 s, enabled researchers to detect and quantify specific proteins in a sample, providing insights into cellular pathways and protein-expression levels. However, this technique required lysing entire tissues or cell populations, averaging the signals from thousands or millions of cells. Flow cytometry (shown in Figure 2.15 and Figure 2.16), emerging in the 1980s, represented a major step forward by allowing researchers to analyse individual cells’ physical and chemical characteristics in suspension. While flow cytometry offered single-cell resolution, it was limited to analysing predefined markers and could not capture the full complexity of cellular states or gene expression.\n\n\n\n\n\n\n\nFigure 2.13: Illustration of the Western-blot technique. (Source: https://www.bio-rad.com/en-us/applications-technologies/western-blotting-electrophoresis-techniques)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.14: Example Western-blot data. (Kepchia et al. 2020)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.15: Illustration of flow-cytometry technique. (Source: https://www.streck.com/blog/principles-of-flow-cytometry/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.16: Example flow-cytometry data. (Verschoor et al. 2015)\n\n\n\n\nMicroarray technology.\nThe 1990s marked the rise of microarray technology (shown in Figure 2.17 and Figure 2.18), which allowed scientists to measure the expression levels of thousands of genes simultaneously. Microarrays revolutionised transcriptomics by enabling high-throughput studies of gene activity in various conditions, tissues, and diseases. Despite its transformative impact, microarray analysis was fundamentally a bulk method, averaging signals across all cells in a sample. It is also based on light intensity, which can be tricky to extract consistently. These limitations obscured cellular heterogeneity, especially in complex tissues where distinct cell types or states contribute uniquely to biological processes or disease mechanisms.\n\n\n\n\n\n\n\nFigure 2.17: Illustration of microarray technique. (Source: https://www.onlinebiologynotes.com/dna-microarray-principle-types-and-steps-involved-in-cdna-microarrays/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.18: Example microarray image prior to quantification. (Source: https://online.stat.psu.edu/stat555/node/28/)\n\n\n\n\n\nRemark (Personal opinion: the close history between microarrays and high-dimensional statistics).\nHistorically, the rise of microarray data spurred advances in high-dimensional statistics — e.g. the Lasso (Tibshirani et al. 2005), gene-expression classification for leukaemia (Golub et al. 1999), and empirical-Bayes multiple testing (Efron and Tibshirani 2002).\n\nBulk sequencing technologies.\nIn the 2000s, bulk sequencing technologies for DNA and RNA emerged, further advancing the study of genomes and transcriptomes. RNA-sequencing (RNA-seq) became a powerful tool for capturing the entire transcriptome with greater accuracy and dynamic range than microarrays. Similarly, DNA sequencing enabled comprehensive studies of genetic variation, from point mutations to structural alterations. However, like microarrays, bulk sequencing aggregated signals across many cells, masking rare cell populations and the heterogeneity critical to understanding dynamic processes such as tumour evolution or immune responses. These bulk techniques laid the groundwork for single-cell methods by driving innovations in high-throughput sequencing and data analysis, which would later be adapted for single-cell resolution.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#when-did-single-cell-data-become-popular-and-how-has-the-technology-advanced",
    "href": "chapter1_intro.html#when-did-single-cell-data-become-popular-and-how-has-the-technology-advanced",
    "title": "2  Introduction",
    "section": "2.3 When did single-cell data become popular, and how has the technology advanced?",
    "text": "2.3 When did single-cell data become popular, and how has the technology advanced?\n\n2.3.1 The rise of single-cell data\nSingle-cell data began gaining prominence in the early 2010s, fuelled by advances in microfluidics and next-generation sequencing. Single-cell RNA-sequencing (scRNA-seq), pioneered around 2009 – 2011, was among the first methods to achieve widespread adoption. It enabled measurement of gene expression in individual cells, uncovering heterogeneity that bulk analyses masked. Early applications revealed new cell types and states, reshaped our understanding of development, and identified rare populations in cancers and neurodegenerative disorders. Popularity grew as throughput increased, costs fell, and workflows became standardised.\nFigure 2.19 and Figure 2.20 contrasts bulk and single-cell sequencing. Figure 2.21 shows how single-cell data tease apart different sources of heterogeneity.\n\n\n\n\n\n\n\nFigure 2.19: Illustrations of how single-cell sequencing improves resolution for studying cancer resistance. (Shalek and Benson 2017)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.20: Illustrations of how single-cell sequencing improves resolution for studying cancer resistance. (Shalek and Benson 2017)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.21: Single-cell insights disentangle underlying biological mechanisms. (Lei et al. 2021)\n\n\n\n\n\n\n2.3.2 Expansion into other omics and spatial technologies\nBuilding on single-cell transcriptomics, the field rapidly expanded into other omics. Single-cell proteomics allows detailed analysis of protein expression and signalling pathways. Single-cell ATAC-seq profiles chromatin accessibility; Hi-C and related methods reveal 3D genome architecture. Spatial transcriptomics connects gene expression with tissue context. CRISPR-based single-cell screens enable high-throughput perturbations, and lineage-tracing barcodes add a temporal dimension, charting cell ancestry in development and disease. Together, these advances transformed single-cell biology into a multi-dimensional, integrative discipline.\nMany of these technologies appear in Figure 2.22.\n\n\n\n\n\n\n\nFigure 2.22: Illustration (circa 2020) of technologies that pair various omics at single-cell resolution. (Teichmann and Efremova 2020)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#what-is-the-role-of-a-biostatistician-in-a-wet-lab-clinical-world",
    "href": "chapter1_intro.html#what-is-the-role-of-a-biostatistician-in-a-wet-lab-clinical-world",
    "title": "2  Introduction",
    "section": "2.4 What is the role of a biostatistician in a wet-lab / clinical world?",
    "text": "2.4 What is the role of a biostatistician in a wet-lab / clinical world?\nCell biology is vast – especially for students trained primarily in statistics or biostatistics. Many disciplines intersect with cell biology. For example:\n\nStatistics / Biostatistics – statistical models for complex biological processes; translation between maths and biology\nComputational biology – scalable computation, leveraging public data\nBioinformatics / Genetics – tools that draw on large‐consortium resources\nEpidemiology – population-level data and policy recommendations\nBioengineering – new laboratory technologies for cheaper/faster measurement or imaging\nBiology – mechanistic studies in model organisms\nBiochemistry / Molecular biology – structure, function, interactions of specific molecules\nWet-bench medicine – disease mechanisms via tissues, models, cell lines\nClinical-facing medicine – patient treatment and real-world sample collection\nPharmacology – integrating evidence to design new drugs and therapies\n\nGiven so many players, what does a biostatistician contribute?\n\n2.4.1 How a biostatistician perceives the world\nGive me a concrete (ideally cleaned) dataset: the larger the better—and I will analyse it from many angles.\nCausality: A mathematically stricter notion than correlation, usually via (1) counterfactual reasoning, or (2) a directed-acyclic-graph picture of how variables relate.\n\nRemark (Personal opinion: statistical causality for cell biology is extremely difficult). Obstacles: (i) tracking the same cell over time is impossible because sequencing lyses it; (ii) longitudinal human tissue samples are rare. Strong modelling assumptions can help but must withstand biological scrutiny. The bottleneck is often data, not maths—ambitious statisticians who learn enough biology still have a fighting chance.\n\n\nRemark (Single-cell methods are largely an “associative” world): Most single-cell analyses discover mechanisms that are statistically correlational; the causal proof comes from experiments and biology.\n\nThe research inquiry starts and ends with a method: (How to integrate modalities? learn a gene-regulatory network? perform valid post-clustering tests?) Start with a statistical model and a parameter of interest \\(\\theta^*\\), then typically:\n\nDevelop a novel estimator of \\(\\theta^*\\), explaining why current methods fail (e.g. lack robustness, accuracy, power, or are heuristic). Focus on statistical logic: A clear, simple mathematical intuition should show the gap and how the new method fills it.\nProve theorems showing the estimate \\(\\hat\\theta\\) converges to \\(\\theta^*\\) under stated assumptions. Focus on consistency & convergence: More data should provably yield more accurate results (often the highlight of a statistics paper).\nSimulations demonstrating that when the true \\(\\theta^*\\) is known, \\(\\hat\\theta\\) beats competing estimators across many settings. Illustration via benchmarking: Empirically recover the correct answer more often than existing methods.\nReal-data demonstration showing results align with known biology or provide biologically sensible new insights. Focus on practicality: The method must work in real scenarios mirroring its target audience.\n\nMindset: deliver a reliable tool that others can trust as-is. Human validations are often impractical; guard-rails and diagnostics are vital.\nWhy biostatisticians need wet-lab biologists / clinicians: We rarely generate data ourselves, so collaborators supply (i) exciting data with novel questions, (ii) biological context for sensible assumptions, and (iii) experimental validation of statistical findings.\n\n\n2.4.2 How a wet-lab biologist / clinician perceives the world\nExperiments, experiments, experiments: Carefully controlled—even if small—to make downstream analysis straightforward.\nCausality comes from a chain of experiments. Suppose we study a gene’s role in disease:\n\nTemporal evidence, such as change in gene expression preceding a change in cell phenotype. A causal mechanism should occur before the phenotype.\nBiological logic providing explanation of the underlying mechanism (binding factors, protein function, evolutionary rationale, etc.). For example, there must be a coherent pathway from gene → protein → phenotype.\nUniversality of how the described association persists across cell lines or organisms. A causal mechanism should be discoverable in other systems (extent depends on how general the logic is). This is offten the highlight of a biology paper.\nValidation, such as knocking out the gene alters the outcome, whereas similar genes do not. For example, perturbing the specific gene (not its close counterparts) changes the outcome.\n\nInquiry starts and ends with a biological hypothesis: Large intellectual effort goes into proposing explanations and designing experiments to rule them in or out.\nMindset: Assemble overwhelming evidence for a mechanism, combining careful experiments and biological logic.\nWhy wet-lab scientists need biostatisticians: Data are now complex and plentiful; exhaustive experiments for every hypothesis are infeasible. Statistical methods can (i) account for data & biological complexity and (ii) prioritise hypotheses worth experimental investment.\n\nSo how does a biostatistician develop computational / statistical methods for cell biology?\n\n\nBiological context – What is the biological system and the “north-star” question? Which premises are accepted, which ones are to be tested, and why is it important to understand this mechanism better?\nTechnology, experiment, data – How are data collected and why did you choose this particular {technology, experiment, data} trio? What technical artefacts arise?\nBoundaries of current tools – Simple analyses first: what “breaks” in existing workflows? Is there preliminary evidence a new computational method would do better?\nStatistical model – What is the insight that a different computational method could interrogate the biology better? (Here the statistics training begins.)\nDevelop a method & show robustness – Robustness can be defined numerically (i.e., noise tolerance) or biologically (i.e., applicable across contexts/environments). Often, the biological question you study lacks a ground truth, so validity arguments lean on biological logic.\nUncover new / refined biology – Does the method advance our biological understanding? How confident are we that findings generalise beyond the original {technology, experiment, data} trio? (This is usually the crown-jewel of your computational biology paper – it’s not necessary your specific analyses, but the potential that your tool can be used on other biological studies beyond what you’ve demonstrated your method on.)\n\n\n\n\n\n\nEfron, Bradley, and Robert Tibshirani. 2002. “Empirical Bayes Methods and False Discovery Rates for Microarrays.” Genetic Epidemiology 23 (1): 70–86.\n\n\nGohil, Satyen H, J Bryan Iorgulescu, David A Braun, Derin B Keskin, and Kenneth J Livak. 2021. “Applying High-Dimensional Single-Cell Technologies to the Analysis of Cancer Immunotherapy.” Nature Reviews Clinical Oncology 18 (4): 244–56.\n\n\nGolub, Todd R, Donna K Slonim, Pablo Tamayo, Christine Huard, Michelle Gaasenbeek, Jill P Mesirov, Hilary Coller, et al. 1999. “Molecular Classification of Cancer: Class Discovery and Class Prediction by Gene Expression Monitoring.” Science 286 (5439): 531–37.\n\n\nHansson, Oskar, Kaj Blennow, Henrik Zetterberg, and Jeffrey Dage. 2023. “Blood Biomarkers for Alzheimer’s Disease in Clinical Practice and Trials.” Nature Aging 3 (5): 506–19.\n\n\nKepchia, Devin, Ling Huang, Richard Dargusch, Robert A Rissman, Maxim N Shokhirev, Wolfgang Fischer, and David Schubert. 2020. “Diverse Proteins Aggregate in Mild Cognitive Impairment and Alzheimer’s Disease Brain.” Alzheimer’s Research & Therapy 12: 1–20.\n\n\nLei, Yalan, Rong Tang, Jin Xu, Wei Wang, Bo Zhang, Jiang Liu, Xianjun Yu, and Si Shi. 2021. “Applications of Single-Cell Sequencing in Cancer Research: Progress and Perspectives.” Journal of Hematology & Oncology 14 (1): 91.\n\n\nSchaff, Dylan L, Aria J Fasse, Phoebe E White, Robert J Vander Velde, and Sydney M Shaffer. 2024. “Clonal Differences Underlie Variable Responses to Sequential and Prolonged Treatment.” Cell Systems 15 (3): 213–26.\n\n\nShalek, Alex K, and Mikael Benson. 2017. “Single-Cell Analyses to Tailor Treatments.” Science Translational Medicine 9 (408): eaan4730.\n\n\nSilva, Paulo FL da, and Björn Schumacher. 2021. “Principles of the Molecular and Cellular Mechanisms of Aging.” Journal of Investigative Dermatology 141 (4): 951–60.\n\n\nTeichmann, Sarah, and Mirjana Efremova. 2020. “Method of the Year 2019: Single-Cell Multimodal Omics.” Nature Methods 17 (1): 2020.\n\n\nTibshirani, Robert, Michael Saunders, Saharon Rosset, Ji Zhu, and Keith Knight. 2005. “Sparsity and Smoothness via the Fused Lasso.” Journal of the Royal Statistical Society Series B: Statistical Methodology 67 (1): 91–108.\n\n\nVerschoor, Chris P, Alina Lelic, Jonathan L Bramson, and Dawn ME Bowdish. 2015. “An Introduction to Automated Flow Cytometry Gating Tools and Their Implementation.” Frontiers in Immunology 6: 380.\n\n\nVon Bernhardi, Rommy, Laura Eugenı́n-von Bernhardi, and Jaime Eugenı́n. 2015. “Microglial Cell Dysregulation in Brain Aging and Neurodegeneration.” Frontiers in Aging Neuroscience 7: 124.\n\n\nWen, Lu, Guoqiang Li, Tao Huang, Wei Geng, Hao Pei, Jialiang Yang, Miao Zhu, et al. 2022. “Single-Cell Technologies: From Research to Application.” The Innovation 3 (6).\n\n\nZhou, Yi, Hongjun Song, and Guo-li Ming. 2024. “Genetics of Human Brain Development.” Nature Reviews Genetics 25 (1): 26–45.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter2_sequencing.html",
    "href": "chapter2_sequencing.html",
    "title": "3  Single-cell sequencing",
    "section": "",
    "text": "3.1 The sparse count matrix and the negative binomial\nAt the heart of single-cell sequencing data lies the sparse count matrix, where rows represent genes, columns represent cells, and entries capture the number of sequencing reads (or molecules) detected for each gene in each cell. This matrix is typically sparse because most genes are not expressed in any given cell, leading to a prevalence of zeros. The data’s sparsity reflects both the biological reality of selective gene expression and technical limitations such as sequencing depth. To model the variability in these counts, the negative binomial distribution is often employed. This distribution accommodates overdispersion, where the observed variability in gene expression counts exceeds what would be expected under simpler models like the Poisson distribution. By accounting for both biological heterogeneity and technical noise, the negative binomial provides a robust framework for analyzing sparse single-cell data.\nLet \\(X \\in \\mathbb{R}^{n\\times p}\\) denote the single-cell data matrix with \\(n\\) cells (rows) and \\(p\\) features (columns). In a single-cell RNA-seq data matrix, the \\(p\\) features represent the \\(p\\) genes.\nHere are some basic statistics about these matrices (based mainly from my experience):\nBased on these observations, the negative binomial distribution is very commonly used.\nThe negative binomial (NB) distribution is a widely used model in single-cell RNA-seq analysis due to its ability to handle overdispersion, which is common in gene expression data. Overdispersion occurs when the variance of the data exceeds the mean, a phenomenon that cannot be captured by the Poisson distribution. The NB distribution introduces an additional parameter to model this extra variability, making it more flexible for single-cell data.\nLet us focus on the count for cell \\(i\\) and gene \\(j\\), i.e., the value \\(X_{ij}\\). The probability mass function (pmf) of the NB distribution for a random variable ( X_{ij} ) is given by:\n\\[\nP(X_{ij} = k) = \\binom{k + r_j - 1}{k} p_{ij}^r (1 - p_{ij})^k, \\quad k = 0, 1, 2, \\ldots\n\\tag{3.1}\\]\nwhere \\(r_j \\&gt; 0\\) is the dispersion (or “overdispersion”) parameter and \\(p\\_{ij} \\in (0, 1)\\) is the probability of success. This is the “standard” parameterization, mentioned in https://en.wikipedia.org/wiki/Negative_binomial_distribution. This specific parameterization is actually not very commonly used.\nAlternatively, the NB distribution is most commonly parameterized in terms of the mean \\(\\mu_{ij}\\) and the dispersion parameter \\(r_j\\), which is often preferred in single-cell analysis:\n\\[\n\\text{Mean: } \\mu_{ij}, \\quad \\text{Variance: } \\mu_{ij} + \\frac{\\mu_{ij}^2}{r_j} = \\mu_{ij}\\left(1 + \\frac{\\mu_{ij}}{r_j}\\right).\n\\tag{3.2}\\]\n(Compare these relations to the Poisson distribution, where both the mean and variance would be \\(\\mu_{ij}\\).)\nTo relate equation Equation 3.1 to Equation 3.2, observe that we can derive,\n\\[\n\\mu_{ij} = \\frac{r_j (1 - p_{ij})}{p_{ij}}.\n\\]\nWe typically use a different overdispersion parameter \\(r_j\\) for each gene \\(j \\in \\{1,\\ldots,p\\}\\). Here, \\(r_j\\) controls the degree of overdispersion. When \\(r_j \\to \\infty\\), the variance approaches the mean, and the NB distribution converges to the Poisson distribution. For single-cell RNA-seq data, the introduction of \\(r_j\\) allows the model to capture both the biological variability between cells and technical noise, making it robust to the sparse and overdispersed nature of gene expression data.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Single-cell sequencing</span>"
    ]
  },
  {
    "objectID": "chapter2_sequencing.html#the-sparse-count-matrix-and-the-negative-binomial",
    "href": "chapter2_sequencing.html#the-sparse-count-matrix-and-the-negative-binomial",
    "title": "3  Single-cell sequencing",
    "section": "",
    "text": "For \\(n\\), we usually have 10,000 to 500,000 cells. These cells originate from a specific set of samples/donors/organisms1. See ?fig-lupus and ?fig-zebrafish for larger examples of single-cell datasets.\n\nFor \\(p\\), we usually have about 30,000 genes (but as you’ll see, we usually limit the analysis to 2000 to 5000 genes chosen from this full set).2\n\nIn a typical scRNA-seq matrix, more than 70% of the elements are exactly 0. (And among the remaining 30%, typically half are exactly 1. The maximum count can be in the hundreds, i.e., the distribution is extremely right-skewed.) This is illustrated in Figure 3.1 and Figure 3.2. We’ll see later in ?sec-scrnaseq_tech where these “counts” come from.\n\n\n\n\n\n\n\n\n\nFigure 3.1: Illustration of data from https://satijalab.org/seurat/articles/pbmc3k_tutorial.html showing a snippet of the count matrix\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.2: Illustration of data from https://satijalab.org/seurat/articles/pbmc3k_tutorial.html showing the percentage of cells with non-zero counts for each gene\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhy would genes even have different overdispersions? We’re assuming in most statistical models that: 1) genes are modeled as a negative binomial random variable, and 2) genes have different overdispersion parameters \\(r_j\\). Why is this reasonable? Is there a biomolecular reason for this?\nWe draw upon (sarkar2021separating?), explaining how the NB distribution is justified (both theoretically and empirically) for scRNA-seq data. After reading this paper, you’ll see that the overdispersion originates from the “biological noise” (i.e., the Gamma distribution). This differs from gene to gene because gene expression is subject to many aspects: transcriptomic bursting, the proximity between the gene and the promoter, the mRNA stability and degradation, copy number variation, the cell cycle stage, etc.\n\n\n3.1.0.1 How do you estimate the overdispersion parameter in practice?\nThe easiest way is to use MASS::glm.nb in R. However, this is very noisy for single-cell data (see Remark 3.1). Since we are estimate one dispersion parameter per gene, many methods use an Empirical Bayes framework to “smooth” the overdispersion parameters (love2014moderated?). More sophisticated methods (such as SCTransform (hafemeister2019normalization?)) use the Bioconductor R package called glmGamPoi. Deep-learning methods simply incorporate estimating the dispersion parameter into the architecture and objective function, see scVI (lopez2018deep?).\nAlso, note that which we are assuming here that the overdispersion parameter \\(r_j\\) is shared across all the cells for gene \\(j\\), there are methods that also use different overdispersion parameters for different cell populations. See (chen2018umi?) or the dispersion parameter in scVI (see https://docs.scvi-tools.org/en/stable/api/reference/scvi.model.SCVI.html#scvi.model.SCVI). In general, using different overdispersion parameters for the same gene across different cell populations is not common, so my suggestion is to: 1) have a diagnostic in mind on how would you know if need to use different overdispersion parameters for the same gene, and then 2) try analyzing the genes where each gene only has one overdispersion parameter and see if you have enough concrete evidence that such a model was too simplistic.\n\nPersonal opinion: My preferred parameterization The formulation Equation 3.2 by far is the most common way people write the NB distribution. We typically call \\(r_j\\) the “overdispersion” parameter, since the inclusion of \\(r_j\\) in our modeling is typically to denote that there is more variance than a Poisson. I personally don’t like it because I find it confusing that a larger \\(r_j\\) denotes a distribution with smaller variance. Hence, I usually write the variance as \\(\\mu_{ij}(1+\\alpha_j \\mu_{ij})\\) (where \\(\\alpha_j = 1/r_j\\)). This way, \\(\\alpha_j = 0\\) is a Poisson distribution. However, even though this makes more sense to me, it’s not commonly used. (It’s because this parameterization makes it confusing to work with the exponential-family distributions mathematically.)\nThe main takeaway is to always pay close attention to each paper’s NB parameterization. You’re looking for the mean-variance relation written somewhere in the paper to ensure you understand the author’s notation.\n\n\nRemark 3.1. What makes the negative binomial tricky Let me use an analogy that is based on the more familiar coin toss. Suppose 30 people each are given a weighted coin where the probability of heads is \\(10^{-9}\\) (basically, it’s impossible to get a heads). Everyone coerce and agree to a secret number \\(N\\), and everyone independently flips their own coin \\(N\\) times and records the number of heads. I (the moderator) do not know \\(N\\), but I get to see how many heads each person got during this experiment. My goal is to estimate \\(N\\). What makes this problem very difficult?\nIf \\(N\\) were 10, or 100, or maybe even 10,000, almost everyone would get 0 heads. That is, we cannot reliably estimate \\(N\\) since the log-likelihood function is very flat. The issue is because count data has a finite resolution — 0 is always the smallest possible value, and 1 is always the second smallest value. Hence, unlike continuous values (which have “infinite resolution” in some sense), non-negative integers “lose” information the smaller the range is.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Single-cell sequencing</span>"
    ]
  },
  {
    "objectID": "chapter2_sequencing.html#footnotes",
    "href": "chapter2_sequencing.html#footnotes",
    "title": "3  Single-cell sequencing",
    "section": "",
    "text": "You can have a simple hierarchical model in your head – each human donor contributes one (or more) tissue sample. Each tissue sample contains many cells.↩︎\nHow many genes are there in the human body? This is not a well-defined questions. If you want to only ask about protein-coding genes, there’s probably about 24,000 of them (salzberg2018open?). However, most gene callers (such as CellRanger https://www.10xgenomics.com/support/software/cell-ranger/latest, which is what we usually use for 10x single-cell data) also label genes that don’t translate. We’ll talk about this in ?sec-beyond_scrna.↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Single-cell sequencing</span>"
    ]
  },
  {
    "objectID": "chapter3_rna.html",
    "href": "chapter3_rna.html",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "4.1 Some important nouns and verbs",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter3_rna.html#some-important-nouns-and-verbs",
    "href": "chapter3_rna.html#some-important-nouns-and-verbs",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "Sequencing (verb): The process of determining the order of nucleotides (A, T, C, G) in a DNA or RNA molecule, providing the primary structure of these biomolecules. Sequencing technologies have evolved to be high-throughput, enabling the analysis of entire genomes or transcriptomes.\nSequencing depth, read depth, library size (noun; all synonyms): These terms refer to the number of times a specific nucleotide or region of the genome is sequenced in an experiment. Greater depth provides more accurate detection of rare variants or lowly expressed genes but requires increased computational and financial resources.\nChromosome, DNA, RNA, protein (noun):\n\nChromosome: A large, organized structure of DNA and associated proteins that contains many genes and regulatory elements.\n\nDNA: The molecule that encodes genetic information in a double-helical structure.\n\nRNA: A single-stranded molecule transcribed from DNA that can act as a messenger (mRNA), a structural component (rRNA), or a regulator (e.g., miRNA). When we talk about scRNA-seq, we are usually referring to exclusively measuring mRNA.\n\nProtein: The functional biomolecule synthesized from RNA via translation, performing structural, enzymatic, and regulatory roles in cells.\n\nGenome vs. gene vs. intergenic region (noun):\n\nGenome: The complete set of DNA in an organism, encompassing all of its genetic material, including coding genes, non-coding regions, and regulatory elements. The genome is the blueprint that defines the biological potential of the organism.\n\nGene: A specific sequence within the genome that encodes a functional product, typically a protein or functional RNA. Genes include regions such as exons (coding sequences), introns (non-coding regions within a gene), and regulatory sequences (e.g., promoters and enhancers) that control gene expression. We will see more about the architecture of a gene in Section 7.1.\n\nIntergenic region: The stretches of DNA between genes that do not directly code for proteins or RNA. Intergenic regions were once considered “junk DNA,” but they often contain regulatory elements, such as enhancers and silencers, that influence the expression of nearby or distant genes. These regions also play roles in chromatin organization and genome stability.\n\nGenetics vs. genomics (noun): Genetics typically focuses on the role of the DNA among large populations (of people, of species, etc.), while genomics can encapsulate any omic, and does not necessarily imply studies across a large population1.\n“Next generation sequencing” (noun)2: A collection of high-throughput technologies that allow for the parallel sequencing of millions of DNA or RNA molecules. It has revolutionized biology by enabling large-scale studies of genomes, transcriptomes, and epigenomes.\nRead fragment (noun): A short sequence of DNA or RNA produced as an output from high-throughput sequencing. Fragments are typically between 50 bp and 300 bp long, depending on the sequencing technology, and they represent segments of the original molecule being sequenced.\nReference genome (noun): A curated, complete assembly of the genomic sequence for a species, used as a template to align and interpret sequencing reads. It serves as a baseline for identifying genetic variations, such as mutations or structural changes, and for annotating functional elements.\nCoding genes vs. non-coding genes (noun):\n\nCoding genes: Genes that contain instructions for producing proteins. They are transcribed into mRNA, which is then translated into functional proteins that perform structural, enzymatic, or regulatory roles in cells.\n\nNon-coding genes: Genes that do not produce proteins but instead generate functional RNA molecules, such as rRNA, tRNA, miRNA, or lncRNA, which regulate gene expression, maintain genomic stability, or perform other cellular functions. Non-coding genes highlight the complexity of gene regulation and cellular processes beyond protein synthesis.\n\nEpigenetics vs. epigenomics (noun): Epigenetics studies modifications to DNA and histones (e.g., methylation, acetylation) that regulate gene expression without altering the DNA sequence. Epigenomics examines these modifications across the entire genome.\nTranscriptome (noun): The complete set of RNA transcripts expressed in a cell or tissue at a given time, reflecting dynamic gene activity.\nProteome (noun): The full complement of proteins expressed in a cell, tissue, or organism, representing functional output.\nSingle-cell sequencing (noun): Sequencing technologies applied at the resolution of individual cells, allowing for the study of heterogeneity in gene expression, epigenetics, or genetic variation across cell populations.\nBulk sequencing (noun): Sequencing technologies that aggregate material (e.g., RNA, DNA) from many cells, providing an average profile of the population but masking individual cell variability.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter3_rna.html#footnotes",
    "href": "chapter3_rna.html#footnotes",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "Technically, genomics (as a field) is a broader categorization and encapsulates genetics. But usually when people say they work on “genomics,” they are colloquially implying they work on biology that is not genetics (otherwise, they usually say they’re a geneticist).↩︎\nThis term is not very often used anymore. It was an umbrella label popularized in the mid-2000s. We instead typically refer to a more specific category of technology. For example, most of the data in this scRNA-seq chapter are referred to as “short-read 3′ single-cell RNA-sequencing.” (You could throw in “droplet-based” and “UMI” to be even more precise, but that’s usually not needed in most casual contexts.)↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter4_protein.html",
    "href": "chapter4_protein.html",
    "title": "5  ‘Single-cell’ proteomics",
    "section": "",
    "text": "5.1 Review of the central dogma\nThe central dogma of molecular biology outlines the flow of genetic information within a cell: DNA is transcribed into RNA, and RNA is then translated into protein (see Figure 5.1). Specifically, coding genes in DNA are transcribed into messenger RNA (mRNA), which serves as a template for protein synthesis. During translation, mRNA sequences are read in sets of three nucleotides, known as codons, each corresponding to a specific amino acid. These amino acids are then linked together to form proteins, which carry out a vast array of functions within the cell. While this process provides a foundational framework, it is a dramatic over-simplification. As we’ll explore later in the course, the correlation between a gene and its corresponding protein levels is often surprisingly low, highlighting the complexity of gene expression regulation.\nUnderstanding proteins is crucial because they are the primary effectors of cellular function. Most cellular activities — whether structural, enzymatic, or signaling—are mediated by proteins. While RNA intermediates, such as mRNA, play important roles in carrying genetic information, the majority of RNA fragments never leave the cell, with a few exceptions like extracellular RNA in communication. Proteins, however, directly influence both intracellular processes and extracellular interactions. Given the weak correlation between genes and proteins and the central role proteins play in biological function, studying proteins arguably provides a more direct and meaningful insight into cellular and organismal behavior. This dual perspective on the central dogma will frame much of our exploration in this course.1",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>'Single-cell' proteomics</span>"
    ]
  },
  {
    "objectID": "chapter4_protein.html#review-of-the-central-dogma",
    "href": "chapter4_protein.html#review-of-the-central-dogma",
    "title": "5  ‘Single-cell’ proteomics",
    "section": "",
    "text": "Figure 5.1: What I call the ``AP Biology textbook’’ figure. Screenshot taken from https://www.slideshare.net/slideshow/lecture-on-dna-to-proteins-the-central-dogma-of-molecular-biology/38811421.\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.2: From (buccitelli2020mrnas?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.3: From (buccitelli2020mrnas?).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>'Single-cell' proteomics</span>"
    ]
  },
  {
    "objectID": "chapter4_protein.html#other-ways-to-study-proteins-that-were-not-going-to-discuss-here",
    "href": "chapter4_protein.html#other-ways-to-study-proteins-that-were-not-going-to-discuss-here",
    "title": "5  ‘Single-cell’ proteomics",
    "section": "5.2 Other ways to study proteins that we’re not going to discuss here",
    "text": "5.2 Other ways to study proteins that we’re not going to discuss here\n\n5.2.1 So You Heard About AlphaFold…\nAlphaFold (see Figure 5.4) represents a revolutionary advancement in computational biology, designed to predict the three-dimensional structure of proteins from their amino acid sequences2. Historically, determining protein shapes required experimental techniques like X-ray crystallography, cryo-electron microscopy (EM) (see Figure 5.5), or nuclear magnetic resonance (NMR), which are resource-intensive and time-consuming. AlphaFold uses deep learning and structural biology insights to achieve high accuracy.\nHowever, significant challenges remain. There are still many open questions on how specific genetic modifications impact protein folding, how proteins dynamically change their conformation, or how they interact with other molecules such as DNA or other proteins. Additionally, ongoing developments in using large language models are showing promise in predicting not only shape but also potential functions directly from amino acid sequences.\n\n\n\n\n\n\n\nFigure 5.4: From (jumper2021highly?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.5: From https://myscope.training/CRYO_Introducing_Single_Particle_Analysis, as an example of what cryo-EM data “looks like,” just to give you a brief glimpse on how people study protein structure.\n\n\n\n\n\n\n5.2.2 Other Methods: Flow Cytometry, Spatial Proteomics, and FISH\nWhile AlphaFold focuses on protein structure, methods like flow cytometry and spatial proteomics explore proteins in their functional and cellular contexts. Flow cytometry, sometimes considered the “original” single-cell data method, measures the expression of surface and intracellular proteins across thousands of cells, providing rich insights into cellular heterogeneity. Spatial proteomics and techniques like fluorescence in situ hybridization (FISH) take this further by localizing proteins and RNA within tissue contexts, enabling researchers to map molecular interactions in their native environments. These approaches highlight the versatility of protein studies, from understanding their structure to dissecting their function and distribution in complex systems. While not the focus of this course, these methods are invaluable in expanding our understanding of proteins and their roles in biology.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>'Single-cell' proteomics</span>"
    ]
  },
  {
    "objectID": "chapter4_protein.html#footnotes",
    "href": "chapter4_protein.html#footnotes",
    "title": "5  ‘Single-cell’ proteomics",
    "section": "",
    "text": "Proteins typically degrade much slower than mRNA fragments. See https://book.bionumbers.org/how-fast-do-rnas-and-proteins-degrade. For this reason, you might hypothesize that “cellular memory” is stored via proteins, not mRNA.↩︎\nSee https://www.youtube.com/watch?v=P_fHJIYENdI for a fun YouTube video for more about this.↩︎",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>'Single-cell' proteomics</span>"
    ]
  },
  {
    "objectID": "chapter5_epigenetics.html",
    "href": "chapter5_epigenetics.html",
    "title": "6  Single-cell epigenetics",
    "section": "",
    "text": "6.1 Primer on the genome, epigenetics, and enhancers\nThe genome is the complete set of DNA within an organism, encoding the instructions for life. While every cell in an organism typically contains the same genome, different cells exhibit distinct phenotypes and functions. This diversity arises not from changes in the underlying DNA sequence but from epigenetic regulation—heritable modifications that influence gene expression without altering the DNA itself. Epigenetics includes processes like DNA methylation, histone modification, and chromatin accessibility, all of which contribute to the dynamic regulation of gene activity in response to developmental cues and environmental signals.\nEnhancers play a critical role in this regulatory landscape. These are DNA sequences that, while not coding for proteins themselves, can dramatically increase the transcription of target genes. Enhancers act by binding specific transcription factors, proteins that recognize and attach to DNA sequences to regulate gene expression. Some transcription factors require assistance from chaperone proteins, which ensure their proper folding and functionality, or pioneer proteins, which can access and open tightly packed chromatin to allow other factors to bind. This interplay highlights the complexity of the regulatory machinery that governs cellular function. See Figure 6.1 and Figure 6.2 to appreciate how complex this machinery is.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Single-cell epigenetics</span>"
    ]
  },
  {
    "objectID": "chapter5_epigenetics.html#primer-on-the-genome-epigenetics-and-enhancers",
    "href": "chapter5_epigenetics.html#primer-on-the-genome-epigenetics-and-enhancers",
    "title": "6  Single-cell epigenetics",
    "section": "",
    "text": "Figure 6.1: From Ito et al. (2022).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.2: From Claringbould and Zaugg (2021).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Single-cell epigenetics</span>"
    ]
  },
  {
    "objectID": "chapter5_epigenetics.html#the-zoo-of-epigenetic-modalities",
    "href": "chapter5_epigenetics.html#the-zoo-of-epigenetic-modalities",
    "title": "6  Single-cell epigenetics",
    "section": "6.2 The zoo of epigenetic modalities",
    "text": "6.2 The zoo of epigenetic modalities\nEpigenetics encompasses a vast array of molecular mechanisms that regulate gene expression without altering the underlying DNA sequence. These mechanisms include modifications to DNA, RNA, chromatin, and the spatial organization of the genome, collectively forming a complex regulatory landscape. Below are some of the key modalities studied in epigenetics:\n\nDNA Accessibility: Techniques like ATAC-seq and DNase-seq measure how accessible DNA is to transcription factors and other regulatory proteins. Accessible regions often overlap with promoters and enhancers, providing critical insights into gene regulation. (This is what we’ll focus on this chapter.)\nDNA Methylation1: This modification, typically at cytosines in CpG dinucleotides, is a key epigenetic mark associated with gene silencing. Tools like bisulfite sequencing are used to map methylation patterns across the genome, revealing their roles in development and disease. See Figure 6.3.\n\n\n\n\n\n\n\n\nFigure 6.3: From (gauba2021immunomodulation?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.4: From (bruggeman2008using?).\n\n\n\n\n\nHi-C and Genome Organization2: Hi-C measures chromatin interactions to reveal the three-dimensional structure of the genome. It uncovers features like topologically associating domains (TADs) and enhancer-promoter loops, which are crucial for understanding how spatial organization influences gene regulation. See Figure 6.5.\n\n\n\n\n\n\n\n\nFigure 6.5: From (ea2015contribution?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.6: From (liu2021seeing?).\n\n\n\n\n\nHistone Modifications3: Post-translational modifications, such as acetylation, methylation, and phosphorylation, occur on histone proteins and regulate chromatin structure. Techniques like ChIP-seq and the newer Cut & Tag method are used to map these modifications and their role in gene expression at the bulk level. See Figure 6.7.\n\n\n\n\n\n\n\n\nFigure 6.7: From https://opened.cuny.edu/courseware/lesson/684/student/?section=2.\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.8: From (steinbach2017pten?). (Note: This is an example of the “canonical” functions of common histone modifications. This is by no means exhaustive and guaranteed to hold true for all biological systems.)\n\n\n\n\nSome of you might be interested: Personally, I think one of the fascinating concepts based on histone modifications is bivalent chromatin (essentially, chromatin that is wrapped in such a way that is simultaneously activated and silenced), see Figure 6.9. It’s a particularly curious phenomenon that entire labs dedicate themselves to studying. See (blanco2020bivalent?) for an overview why this mechanism might be “beneficial.”\n\n\n\n\n\n\n\nFigure 6.9: From (macrae2023regulation?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.10: From (glancy2024bivalent?).\n\n\n\n\n\nRNA Modifications (m6A and Pseudouridine): Modifications like N6-methyladenosine (m6A) and pseudouridine occur on RNA molecules and are involved in processes like splicing, translation, and mRNA decay. See Figure 6.11 for what pseudouridine is, i.e., “a rotation of the uridine molecule.” These modifications add an epitranscriptomic layer to gene regulation.\n\n\n\n\n\n\n\n\nFigure 6.11: From (hamma2006pseudouridine?) about pseudouridine.\n\n\n\n\n\nUntranslated Regions (UTRs): Before talking about UTRs, it’s probably good to review what an mRNA fragment “looks like” at the different stages of transcription and translation, see Figure 6.12. The 5′ and 3′ UTRs contain regulatory elements that influence mRNA stability, localization, and translation efficiency. The 3′ UTR, in particular, serves as a binding platform for RNA-binding proteins and microRNAs, providing an additional layer of post-transcriptional gene regulation.\n\n\n\n\n\n\n\n\nFigure 6.12: From (niazi2023rna?). Notice the splicing (i.e., “removal” of the introns – see Alternative Splicing below) and that the protein-coding region is not the only part of the mRNA transcript – there are also the UTRs and poly-A tail. NOTE: The transcription start site (TSS) is not the same place as the promoter. The promoter is usually an un-transcribed region upstream of the TSS, while the TSS is where transcription actually starts.\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.13: From (mignone2002untranslated?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.14: From https://www.cambio.co.uk/9/257/applications/methods/in-vitro-transcription/mrna-therapeutics/.\n\n\n\n\n\nAlternative Splicing: This post-transcriptional process generates multiple mRNA isoforms from the same gene, expanding the proteomic diversity, see Figure 6.15. This is a combinatorial explosion of isoforms. While not traditionally classified as epigenetic, splicing often intersects with chromatin modifications and RNA-binding proteins, blurring the lines between transcriptional and post-transcriptional regulation.\n\n\n\n\n\n\n\n\nFigure 6.15: From (chen2015alternative?).\n\n\n\n\n\nAlternative Polyadenylation (APA): APA generates transcript isoforms with different 3′ ends, affecting mRNA stability, localization, and translation, see Figure 6.16. By selecting distinct cleavage sites, APA alters the 3′ UTR length without affecting the poly-A tail itself, thereby modulating interactions with regulatory factors such as microRNAs and RNA-binding proteins.\n\n\n\n\n\n\n\n\nFigure 6.16: From Li et al. (2022).\n\n\n\n\nEfforts like the ENCODE project (https://pmc.ncbi.nlm.nih.gov/articles/PMC7061942/) have systematically mapped these modalities across cell types and tissues, creating a comprehensive resource for understanding genome function. ENCODE has provided invaluable datasets on DNA accessibility, histone modifications, and RNA-binding proteins, enabling researchers to uncover how epigenetic and transcriptomic layers work together to drive cellular processes.\nFinally, tools like MPRA (Massively Parallel Reporter Assays) are revolutionizing how we study enhancers and regulatory sequences. MPRA allows researchers to test thousands of DNA fragments for their regulatory activity, providing functional validation for epigenetic marks. This growing zoo of modalities continues to expand our understanding of how the genome is dynamically regulated in health and disease.\nSee Figure 6.17 for some courageous figures that try to display multiple types of epigenetic modifications all at once. See (lim2024advances?) for a broad overview about the different types of technologies to sequence different omics and layers of epigenetics, and how they are getting computationally put together.\n\n\n\n\n\n\n\nFigure 6.17: From https://www.sc-best-practices.org/chromatin_accessibility/introduction.html.\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.18: From https://www.whatisepigenetics.com/type-2-diabetes-mellitus-and-epigenetics.\n\n\n\n\n\n\n\n\nClaringbould, Annique, and Judith B Zaugg. 2021. “Enhancers in Disease: Molecular Basis and Emerging Treatment Strategies.” Trends in Molecular Medicine 27 (11): 1060–73.\n\n\nIto, Shinsuke, Nando Dulal Das, Takashi Umehara, and Haruhiko Koseki. 2022. “Factors and Mechanisms That Influence Chromatin-Mediated Enhancer–Promoter Interactions and Transcriptional Regulation.” Cancers 14 (21): 5404.\n\n\nLi, Lei, Yumei Li, Xudong Zou, Fuduan Peng, Ya Cui, Eric J Wagner, and Wei Li. 2022. “Population-Scale Genetic Control of Alternative Polyadenylation and Its Association with Human Diseases.” Quantitative Biology 10 (1): 44–54.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Single-cell epigenetics</span>"
    ]
  },
  {
    "objectID": "chapter5_epigenetics.html#footnotes",
    "href": "chapter5_epigenetics.html#footnotes",
    "title": "6  Single-cell epigenetics",
    "section": "",
    "text": "The technology to measure this at single-cell resolution is still being developed (see snmC-seq2 (liu2021dna?)), and is particularly interesting due to methylation’s relation to cellular memory (kim2017dna?) and molecular clocks (hernando2019ageing?); (trapp2021profiling?); (gabbutt2022fluctuating?).↩︎\nSee Droplet-HiC (chang2024droplet?) for an example of single-cell Hi-C.↩︎\nSee Paired-tag (zhu2021joint?) for an example of single-cell histone modification.↩︎",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Single-cell epigenetics</span>"
    ]
  },
  {
    "objectID": "chapter6_dna.html",
    "href": "chapter6_dna.html",
    "title": "7  ‘Single-cell’ DNA",
    "section": "",
    "text": "7.1 Genetics 101\nUnderstanding the fundamental concepts of genetics is essential for studying genomic variation, including copy-number variations (CNVs) and single nucleotide polymorphisms (SNPs). This section provides an overview of genetic architecture, SNPs and their detection, commonly sequenced tissues, and genome annotation resources such as the UCSC Genome Browser.\nSingle Nucleotide Polymorphisms (SNPs) and Their Detection.\nA single nucleotide polymorphism (SNP) is a variation at a single base pair position in the genome that is present in a significant fraction of the population. SNPs are the most common type of genetic variation and can have functional consequences depending on their location. When an SNP occurs within a coding region, it may alter the resulting protein sequence if it leads to an amino acid substitution (nonsynonymous SNP) or have no effect if the change is synonymous. SNPs in noncoding regions can impact gene regulation by affecting transcription factor binding sites, splicing efficiency, or untranslated regions (UTRs). Since you have “two copies” of each of your 23 chromosomes, this means SNP data is a data matrix of \\(n\\) people by \\(p\\) SNP regions (think of a couple million – more on this technicality later), where each value is \\(\\{0,1,2\\}\\), see Figure 7.1. Typically, the major allele is defined as “0”, and a “1” or “2” means if how many copies of the minor allele do you have.\nSNPs are detected using high-throughput sequencing technologies, primarily whole-genome sequencing (WGS) and whole-exome sequencing (WES). In these approaches, DNA is extracted from a biological sample, fragmented, and sequenced to generate short or long reads. The raw sequencing reads are then aligned to a reference genome, and variant calling algorithms such as those implemented in GATK (mckenna2010genome?), bcftools, and FreeBayes (garrison2012haplotype?) identify SNPs by comparing observed nucleotide differences to the reference sequence. (See (zverinova2022variant?) for a overview). The sequencing depth, or coverage, at a given genomic position determines the confidence in an SNP call, with higher coverage reducing the likelihood of sequencing errors.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>'Single-cell' DNA</span>"
    ]
  },
  {
    "objectID": "chapter6_dna.html#sec-genetics_basics",
    "href": "chapter6_dna.html#sec-genetics_basics",
    "title": "7  ‘Single-cell’ DNA",
    "section": "",
    "text": "Figure 7.1: From https://www.genome.gov/about-genomics/educational-resources/fact-sheets/human-genomic-variation.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>'Single-cell' DNA</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html",
    "href": "chapter7_crispr.html",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "8.1 Basics of how CRISPR works\nThe CRISPR-Cas system1 is a powerful genome-editing technology that allows for precise modifications of DNA in a wide range of biological systems. Originally derived from the bacterial adaptive immune system, CRISPR-Cas9 has been repurposed for genetic engineering by using a guide RNA (gRNA) to direct the Cas9 nuclease to a specific genomic locus for targeted DNA cleavage. This section discusses how CRISPR is performed in the wet lab, different functional applications of CRISPR, and how CRISPR-based perturbations are analyzed in single-cell gene expression studies.\nIn a typical CRISPR screen experiment (mainly a CRISPR knockout), a library of lentivirus-packaged guide RNAs is introduced into cells under conditions designed to infect each cell with only one or a few sgRNAs (single guide RNA), see Figure 8.1 and Figure 8.2. After selection to ensure stable integration, the cells are subjected to a particular stimulus such as drug treatment or other environmental challenge. Researchers then track the abundance of each sgRNA at the start and after the stimulus (for example, at day 0 and day 28) through next-generation sequencing. By comparing which sgRNAs become enriched or depleted, it is possible to discover genes essential for viability, pathways governing drug resistance, or other critical biological functions relevant to the phenotype under study, see Figure 8.3.\nTypical components of a CRISPR mechanism.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#sec-chapter_7_basics",
    "href": "chapter7_crispr.html#sec-chapter_7_basics",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "Figure 8.1: Original from Wei et al. (2019), but this is directly from https://www.youtube.com/watch?v=JdCCl1uxCME.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.2: From https://www.idtdna.com/pages/education/decoded/article/overview-what-is-crispr-screening.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.3: From Esposito et al. (2019).\n\n\n\n\n\n\nCas9 protein: A DNA endonuclease that recognizes and cuts target DNA specified by the guide RNA; variations include nuclease-deactivated (dCas9) or nickase Cas9 for alternative applications. Other CRISPR-associated proteins like Cas12a (Cpf1), Cas13, or dCas9 (dead Cas9) can expand the range of target sequences, have different PAM requirements, or allow for gene regulation without cutting DNA.\nCas9 may bind sites with partial sequence complementarity, resulting in unintended cuts — this is called “off-target effects.” Various strategies (e.g., high-fidelity Cas9 variants, improved gRNA design) help minimize these effects.\nGuide RNA (gRNA): A customizable RNA sequence that directs Cas9 to the desired genomic locus; variations include single-guide RNA (sgRNA) and dual-RNA formats depending on the experimental design.\nTo streamline CRISPR-Cas9 applications in genetic engineering, scientists have designed a synthetic fusion of crRNA and tracrRNA into a single-guide RNA (sgRNA). This chimeric RNA retains both the target-specific recognition (crRNA component) and Cas9-binding function (tracrRNA component) but simplifies the system by reducing the number of necessary molecules. sgRNAs are commonly used in research and therapeutic applications due to their ease of design and efficiency in genome editing.\n\ncrRNA (CRISPR RNA): A short RNA sequence that is complementary to the target DNA and provides sequence specificity for Cas9 binding. This is typically 20 nucleotides long.\n\ntracrRNA (Trans-activating CRISPR RNA): A structural RNA that base-pairs with the crRNA and interacts with Cas9 to activate its nuclease function.\n\nIn this system, the crRNA and tracrRNA must form a duplex to guide Cas9 to the target sequence, which then leads to DNA cleavage.\nMultiple guide RNAs can be delivered simultaneously to target different loci at once, enabling complex genome-scale screens or combinatorial gene perturbations. Computational tools help optimize sgRNA sequences to maximize on-target efficiency while minimizing off-target effects. Chemically modified guide RNAs can improve stability and efficiency in vivo.\nPAM (Protospacer Adjacent Motif): A short DNA sequence adjacent to the target region that is essential for Cas9 to recognize and bind to DNA. The PAM sequence is typically “NGG” (where “N” represents any nucleotide, and “GG” is required). Without the correct PAM sequence, Cas9 cannot efficiently bind or cut the DNA, ensuring some level of specificity in genome editing. Different Cas9 variants have evolved or been engineered to recognize alternative PAM sequences, which offer broader targeting possibilities with reduced off-target effects. The cut typically happens 3 base-pairs upstream of the PAM on the target strand (i.e., in the 5′ direction).\nLentivirus: Lentiviruses are widely used as viral vectors for delivering CRISPR components into cells (variations include different promoters, packaging systems, and envelope proteins to optimize transduction efficiency), particularly for experiments requiring stable and long-term expression of Cas9 and guide RNAs. Since many cell types are difficult to transfect2 using conventional methods, lentiviral transduction provides an efficient way to introduce CRISPR machinery into a broad range of cell types, including non-dividing and primary cells.\nWhat is delivered to cells? (See Figure 8.4 for the construction and architecture of the lentiviral vector.)\n\nCas9 expression construct: A lentiviral vector encoding the Cas9 nuclease under a suitable promoter. In some systems, inducible promoters (e.g., doxycycline-inducible) are used to control Cas9 activity.\n\nGuide RNA (gRNA) expression construct: A separate lentiviral vector encoding the guide RNA sequence under a promoter to ensure efficient transcription.\n\nSelection markers: Often, antibiotic resistance genes or fluorescent markers are included to facilitate selection of successfully transduced cells.\n\nLentiviral delivery is essential for CRISPR applications due to its ability to stably integrate into the host genome, ensuring long-term expression of Cas9 and guide RNAs. This stability is particularly advantageous for genome-wide CRISPR knockout screens and lineage-tracing experiments. Additionally, many cell types, such as primary cells, stem cells, and immune cells, are notoriously difficult to transfect3; lentiviral transduction provides a more efficient and reliable alternative. See Figure 8.7 for how the gRNA can be injected into the cell, or if it’s integrated into the DNA, how it “borrows” the cell’s transcriptional machinery.\n\n\n\n\n\n\n\n\nFigure 8.4: (Top) From Khan et al. (2022).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.5: (Bottom left) https://bpsbioscience.com/pd-1-crispr-cas9-lentivirus-integrating-78052.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.6: (Bottom right) From Mao, Botella, and Zhu (2017).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.7: (Left) https://www.benchling.com/blog/how-to-synthesize-your-grnas-for-crispr.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.8: (Right) https://bpsbioscience.com/lentiviruses?product_type_filter=5567.\n\n\n\n\n\n8.1.0.1 A bit about the mechanism of double-stranded DNA cleavage by Cas9 in a CRISPR knockout.\nCas9-mediated DNA cleavage occurs in several distinct steps. The Cas9 scans the genome for a matching PAM sequence. Once a PAM is identified, the guide RNA (gRNA) pairs with the complementary DNA strand. The actual cleavage of DNA is catalyzed by two distinct nuclease domains within Cas9: the RuvC domain, which cuts the non-complementary (non-target) DNA strand, and the HNH domain, which cuts the complementary (target) strand. These coordinated cleavages result in a double-strand break (DSB), typically occurring 3-4 nucleotides upstream of the PAM sequence. This precise cleavage mechanism allows for highly specific genome modifications.\nOnce the double-strand break is generated, the cell must repair the damage. The two primary DNA repair mechanisms are Non-Homologous End Joining (NHEJ) and Homology-Directed Repair (HDR). NHEJ is the default repair pathway in most cells and often introduces small insertions or deletions (indels) at the cut site, leading to gene disruptions. HDR, on the other hand, allows for precise DNA modifications when a donor DNA template is provided, making it a key mechanism for precise genome editing. Understanding the role of PAM sequences and the cleavage process is critical for designing effective CRISPR-based genetic modifications.\nSee Figure 8.9 for variations of a CRISPR screen. What we’re discussing more in this chapter is a pooled CRISPR screen.\n\n\n\n\n\n\n\nFigure 8.9: From Bock et al. (2022). Note: Not all CRISPR screens are necessarily at the single-cell level, and it’s possible that no “gene expression” is measured. In the simplest CRISPR analyses, you are simply counting which gRNAs are most enriched (across the entire petri dish) after applying a stress to the cells.\n\n\n\n\n\n\n8.1.1 CRISPR in the wet lab: Design and delivery\nCRISPR experiments begin with the design of a single-guide RNA (sgRNA) that matches the target DNA sequence adjacent to a protospacer-adjacent motif (PAM), which is required for Cas9 recognition and cleavage. The choice of target site is crucial, as off-target effects can lead to unintended mutations. Computational tools such as CRISPOR (Concordet and Haeussler 2018) help predict sgRNA efficiency and minimize off-target binding.\nOnce the sgRNA is designed, it must be delivered into cells alongside the Cas9 enzyme. This can be achieved, such as using viral vectors such as lentivirus. Viral delivery is particularly useful for stable genome integration in cell populations, while other transient delivery methods allow for temporary gene editing effects. The choice of delivery method depends on the cell type, efficiency, and experimental goals. In single-cell studies, lentiviral vectors are often used to introduce a pooled library of sgRNAs, enabling large-scale CRISPR screens across thousands of individual cells.\n\n8.1.1.1 Commonly used cells.\nK562 cells, a human myelogenous leukemia cell line, are widely used in CRISPR screens due to their ease of culture, high transfection efficiency, and well-characterized genome. These cells exhibit an undifferentiated hematopoietic phenotype, making them a valuable model for studying gene regulation, hematopoiesis, and drug resistance. Their high proliferative capacity and ability to grow in suspension allow for efficient perturbation experiments at scale. Additionally, K562 cells have been used extensively in studies involving transcriptional regulation due to their rich chromatin accessibility data from ENCODE, which facilitates the identification of enhancer-gene interactions.\nAnother one I’ve seen quite often is Jurkat cells. This is a human T-cell leukemia cell line that serves as a model for immunology and T-cell signaling studies, often used in CRISPR screens focused on immune response and checkpoint regulation.\nWhile CRISPR screens are widely applied in established cell lines, extending them to other cell types requires careful experimental planning. Primary cells and non-transformed cell types often have lower transfection or transduction efficiencies, necessitating optimization of delivery methods such as electroporation or viral transduction. Additionally, cell-type-specific chromatin accessibility and DNA repair mechanisms can influence CRISPR efficiency and editing outcomes, requiring tailored guide RNA design and validation. Growth rate and population doubling time must also be considered, as slow-dividing or non-dividing cells may require prolonged selection periods or alternative screening strategies, such as inducible CRISPR systems. Finally, proper negative controls and lineage-specific reference datasets are critical to ensure accurate interpretation of perturbation effects in novel cellular contexts. While most CRISPR screens are done in vitro, there are also technical challenges (which can be controlled for) for in vivo systems, see Figure 8.10.\n\n\n\n\n\n\n\nFigure 8.10: From Kuhn, Santinha, and Platt (2021).\n\n\n\n\n\n\n\n8.1.2 The jungle of CRISPR: CRISPR-KO, CRISPRi, and CRISPRa\nCRISPR can be adapted for different functional purposes beyond simple gene knockout (KO). CRISPR-knockout (CRISPR-KO) involves the use of Cas9 to introduce double-stranded breaks at the target locus, leading to insertions or deletions (indels) that disrupt gene function, which is mainly what we’ve discussed above. This method is widely used for loss-of-function studies to investigate gene essentiality and pathway regulation.\nIn contrast, CRISPR activation (CRISPRa) and CRISPR interference (CRISPRi) enable gene expression modulation without altering the DNA sequence. CRISPRa employs a catalytically inactive Cas9 (dCas9) fused to transcriptional activators to enhance gene expression. Conversely, CRISPRi uses dCas9 fused to repressive domains such as KRAB to inhibit transcription. These methods allow for fine-tuned control over gene expression levels, making them particularly useful for studying gene regulatory networks at the single-cell level.\nSee Figure 8.11 and Figure 8.12 for examples of variations of CRISPR screens.\n\n\n\n\n\n\n\nFigure 8.11: From Esposito et al. (2019).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.12: From Bock et al. (2022).\n\n\n\n\n\n\n8.1.3 CRISPR screens and single-cell gene expression analysis\nCRISPR screening is a high-throughput approach that uses pooled single-guide RNA (sgRNA) libraries to systematically perturb thousands of genes in a single experiment. There are two main types of CRISPR screens: positive selection screens, which identify sgRNAs that promote cell survival or proliferation, and negative selection screens, which identify essential genes by tracking sgRNAs that are depleted over time. When combined with single-cell RNA sequencing (scRNA-seq), CRISPR screens can reveal gene regulatory interactions at the resolution of individual cells, enabling functional genomics studies at an unprecedented scale. See Figure 8.13 for the bulk-level analysis that does not include RNA-sequencing – this is to give you a sense of the simplistic CRISPR analysis.\n\n\n\n\n\n\n\nFigure 8.13: From Bock et al. (2022). This is an example of a bulk-level analysis that does not include RNA-sequencing.\n\n\n\n\nTo analyze CRISPR perturbations in a single-cell context, cells are first transduced with a pooled sgRNA library, followed by scRNA-seq to capture transcriptomic changes. The identity of the sgRNA in each cell must also be determined in order to link gene perturbations to expression changes. This is typically done through targeted sequencing of the sgRNA cassette embedded in the transcriptome. However, sequencing the guide RNAs presents a challenge because they lack poly-A tails, which are typically required for capture in common scRNA-seq protocols. To overcome this, specialized methods such as Perturb-seq (Dixit et al. 2016) and CROP-seq (Datlinger et al. 2017) incorporate modifications to ensure efficient capture of sgRNA sequences. For example, Perturb-seq integrates the sgRNA into a polyadenylated transcript, allowing it to be captured along with mRNA molecules during reverse transcription.\nComputational tools, which we will discuss in Section 8.2, are commonly used to analyze CRISPR screen data by linking sgRNA-induced perturbations to gene expression changes. These tools help identify differentially expressed genes in response to specific genetic perturbations, revealing functional interactions within cellular networks. By combining CRISPR-based gene perturbation with single-cell transcriptomics, researchers can systematically dissect gene function, uncover regulatory networks, and study cellular heterogeneity in response to genetic modifications.\n\n\n8.1.4 Interpreting CRISPR data and experimental considerations\nCRISPR datasets in single-cell studies typically consist of expression matrices where each row corresponds to a gene and each column represents a cell, with additional metadata indicating the sgRNA assigned to each cell. One key challenge in analyzing these datasets is ensuring that each cell receives a single sgRNA, as multiple perturbations can introduce confounding effects. Additionally, technical noise in single-cell RNA sequencing, such as dropout events and variability in sequencing depth, must be accounted for in downstream analyses.\nWhile CRISPR has revolutionized functional genomics, several caveats remain. Off-target effects can complicate result interpretation, requiring careful validation with orthogonal approaches such as RNA interference (RNAi) or small molecule inhibitors. Moreover, certain genes may be difficult to perturb due to low sgRNA efficiency or compensation from redundant pathways.\n\n8.1.4.1 More considerations and readings about CRISPR.\nSee Bock et al. (2022) for an important checklist (Box 1) to give you a sense the complexities when setting up a CRISPR experiment. Also, keep in mind that many CRISPR experiments are not measuring single-cell gene expressions. However, also (as mentioned above), there are also many CRISPR protocols to measure various omics at single-cell resolution alongside the gRNAs, see Figure 8.14.\n\n\n\n\n\n\n\nFigure 8.14: From Cheng et al. (2023).\n\n\n\n\nFor more reading: - https://www.idtdna.com/pages/education/decoded/article/overview-what-is-crispr-screening is probably one of the most helpful webpages I came across.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#sec-chapter_7_link",
    "href": "chapter7_crispr.html#sec-chapter_7_link",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.2 Linking gRNA (i.e., perturbations) to its downstream genes",
    "text": "8.2 Linking gRNA (i.e., perturbations) to its downstream genes\nUnderstanding the causal relationships between genetic perturbations and gene expression changes is a fundamental problem in genomics. Single-cell CRISPR screening technologies enable high-throughput profiling of transcriptomic changes induced by targeted genetic modifications at a single-cell resolution. The goal of the statistical analysis here is to identify genes whose expression levels are significantly altered by specific perturbations, providing insights into gene regulatory networks and functional genomics. However, accurately estimating these effects requires sophisticated statistical methodologies that can properly account for measurement noise, technical confounders, and the stochastic nature of gene expression.\nA prototypical statistical model for this analysis is based on a generalized linear model (GLM) or a negative binomial regression framework, where gene expression levels are modeled as a function of perturbation status, along with potential confounders such as sequencing depth, batch effects, and cellular state, see Figure 8.15. Here are some statistical challenges a typical statistical method might account for: - Inferring which cells got which perturbation: Given that perturbations are not directly observed but inferred through guide RNA (gRNA) expression, a crucial modeling step involves using a measurement error framework or latent variable model to impute perturbation identities. The presence of background noise in gRNA detection complicates direct classification of perturbed versus unperturbed cells. See Figure 8.16. - Account for unmeasured confounders: Variations in sequencing efficiency or cell cycle effects (i.e., unmeasured biological processes that affect both the guide RNA and gene expression) can introduce spurious associations between perturbations and gene expression if not properly adjusted\nFortunately, one experimental consideration we can use to advantage are negative control perturbations – perturbations that target non-functional genomic regions. These provide a null distribution against which true perturbation effects can be compared. Certain methods can use the negative controls to calibrate the p-values, while others use the negative controls to validate their control of false discovery rates.\n\n\n\n\n\n\n\nFigure 8.15: From J. L. Zhou et al. (2024).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.16: From Barry, Roeder, and Katsevich (2024).\n\n\n\n\nThe goal of this analysis is produce a p-value for every sgRNA (targeting an enhancer) and gene pair. This is often visualized a QQ-plot, shown in Figure 8.17.\n\n\n\n\n\n\n\nFigure 8.17: From Barry et al. (2021). All the points here are negative controls, meaning we do not expect biologically that the sgRNA should affect the gene. (Again, each point is a pair of sgRNA and gene.) Hence, a “good” result is one where all the p-values fall on the diagonal line (i.e., the expected quantiles of the null p-values match the observed quantiles).\n\n\n\n\n\n8.2.0.1 A typical choice: SCEPTRE.\nSCEPTRE (Barry et al. 2021) (Analysis of single-cell perturbation screens via conditional resampling) is a statistical method designed to analyze gene-gRNA associations in single-cell CRISPR screens. It distinguishes true regulatory relationships from spurious ones by properly accounting for confounding technical factors and by circumventing strict parametric assumptions.\n\nInput/Output. The input to SCEPTRE is a 1) single-cell gene expression count matrix \\(Y\\in \\mathbb{Z}_+^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, and 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(X \\in \\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations. The output is a pairing between certain \\(k\\) perturbations and \\(p\\) genes (not necessarily one-to-one) with associated p-values. We can screen these p-values for significant ones after multiple-testing correction to determine which perturbations are associated (but not necessarily statistically causal in this method) with which genes.\n\n\nAre the guide RNAs measured as binary or counts?\nSCEPTRE “thresholds” the gRNA count matrix to be a binary matrix (i.e., which cells received which perturbation). However, in reality, this information is itself sequenced and can be noisy. The authors then wrote a follow-up paper called GLM-EIV (Barry, Roeder, and Katsevich 2024) to further account for this.\n\nWe describe the main components of SCEPTRE below. See Figure 8.18 for an illustration of this method.\n\nInput Data. Let \\(n\\) be the number of cells, \\(p\\) the number of genes, and \\(k\\) the number of gRNAs. The gene expression data can be represented by an \\(n \\times p\\) matrix, where each entry \\(Y_{ij}\\) is the observed count (for instance, UMI count) of gene \\(j\\) in cell \\(i\\). The gRNA detection data can be represented by an \\(n \\times d\\) binary matrix, where each entry \\(X_{ik}\\) indicates whether gRNA \\(k\\) was observed in cell \\(i\\) (commonly treated as a binary indicator). In addition, each cell \\(i\\) has a vector of technical covariates \\(Z_i \\in \\mathbb{R}^r\\) (for instance, capturing batch, sequencing depth, or other factors). These covariates are crucial, as they can affect both the probability of detecting a given gRNA and the observed gene expression counts.\nNegative Binomial Expression Model. To test the association between a particular gene \\(j\\) and gRNA \\(k\\) (typically within 1 Mb apart), consider one-dimensional slices \\(Y_i\\) and \\(X_i\\), denoting that cell \\(i\\) has count \\(Y_i\\) for gene \\(j\\) and \\(X_i \\in \\{0,1\\}\\) for gRNA \\(k\\). A typical regression model is\n\n\\[\nY_i \\sim \\mathrm{NegBin}(\\mu_i, \\alpha),\n\\quad\n\\log(\\mu_i) = \\beta_0 + \\beta \\, X_i + \\gamma^\\top Z_i,\n\\]\nwhere \\(\\alpha\\) is a dispersion parameter, \\(\\beta\\) measures how the presence of the gRNA (\\(X_i\\)) shifts the mean expression \\(\\mu_i\\), and \\(\\gamma\\) captures the effect of the technical covariates. Fitting this negative binomial regression provides a test statistic, for example a \\(z\\)-score \\(T = \\beta / \\text{SE}(\\beta)\\), that quantifies the strength of the association between \\(X_i\\) and \\(Y_i\\).\n\nLogistic Model for gRNA Detection. A key insight in SCEPTRE is that \\(X_i\\) itself is subject to measurement variability and is influenced by the same covariates \\(Z_i\\). This can be modeled via\n\n\\[\n\\pi_i = P(X_i = 1 \\mid Z_i),\n\\quad\n\\log\\!\\Bigl(\\frac{\\pi_i}{1 - \\pi_i}\\Bigr)\n= \\tau_0 + \\tau^\\top Z_i.\n\\]\nFitting this logistic model to the observed gRNA indicators provides estimated probabilities \\(\\hat{\\pi}_i\\) for each cell.\n\nConditional Resampling. SCEPTRE constructs an empirical null distribution by repeatedly resampling “fake” gRNA indicators \\(\\tilde{X}_i\\) in each cell, drawn independently from \\(\\mathrm{Bernoulli}(\\hat{\\pi}_i)\\). In each resampled dataset, one holds \\(Y_i\\) and \\(Z_i\\) fixed but replaces the original \\(X_i\\) with \\(\\tilde{X}_i\\). For each resample, one refits the negative binomial regression (using an efficient shortcut) to compute a new test statistic \\(\\tilde{T}\\). The empirical distribution of these \\(\\tilde{T}\\) values represents how the test statistic would behave under the null hypothesis (no real regulatory effect) but with confounders preserved. The SCEPTRE \\(p\\)-value compares the actual test statistic \\(T\\) against this resampling-based distribution, thus ensuring valid inference even if the negative binomial model for \\(Y_i\\) is not perfectly specified.\n\nThis is a common statistical trick. Essentially, the idea is: we constructing “fake” gRNA data that accounts for the technical factors but we are guaranteed to not relate to gene expression (thanks to how we sampled this fake data). Then, we can use this “fake” data to see what the typical estimated relation between the gRNA and gene is. We deem a gRNA and gene as a significant pair if the estimated relation is stronger than this “fake” distribution.\n\n\n\n\n\n\n\nFigure 8.18: From Barry et al. (2021).",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#estimating-gene-pathways-impacted-by-a-group-of-perturbations",
    "href": "chapter7_crispr.html#estimating-gene-pathways-impacted-by-a-group-of-perturbations",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.3 Estimating gene pathways impacted by a group of perturbations",
    "text": "8.3 Estimating gene pathways impacted by a group of perturbations\nUnderstanding the impact of CRISPR-based genetic perturbations on gene expression requires methods that can accurately capture coordinated transcriptional responses. Rather than affecting single genes in isolation, many perturbations influence entire regulatory networks or gene modules. Grouping genes and guide RNAs (gRNAs) into functional modules provides a structured framework to infer how perturbations propagate through cellular pathways, enhancing the ability to detect meaningful biological signals. See Dixit et al. (2016) and Schnitzler et al. (2024) for analyses that performed this type of analysis.\nBiologically, grouping genes into modules is motivated by the observation that genetic perturbations often target key regulatory elements such as transcription factors, chromatin remodelers, or signaling pathway components. These elements control multiple downstream genes, making it crucial to infer their collective effects rather than analyzing genes independently. Single-cell CRISPR screens allow for the systematic interrogation of gene regulatory networks, but sparsity in the data and limited per-perturbation cell numbers necessitate statistical techniques that integrate information across functionally related genes. Here are some statistical challenges (very similar to the ones introduced in Section 8.2).\n\nSparse and noisy guides: Perturbation effects are often sparse, meaning that each perturbation affects only a subset of genes, necessitating regularized models that can extract meaningful structure from noisy data. Also, single-cell CRISPR screens require inference of perturbation identities, as not all cells successfully receive a gRNA, and sequencing-based methods introduce detection noise.\nUnmeasured confounders: Batch effects, cell cycle states, and sequencing depth variations, can obscure true biological signals, making it essential to employ factor models that account for these sources of variability.\nHigher MOI for cheaper sequencing costs: A complexity arises when analyzing interactions between perturbations. Many CRISPR screens employ pooled designs where multiple perturbations may be present within the same cell. This can introduce nonlinear effects or epistatic interactions, where the combined influence of two perturbations deviates from the sum of their individual effects. See Yao et al. (2024) and Lin et al. (2022) for some examples of this.\n\n\n8.3.0.1 A current choice: GSFA.\nGuided Sparse Factor Analysis (GSFA) (Y. Zhou et al. 2023) is a Bayesian approach to analyze single-cell CRISPR screens, where multiple genetic perturbations (gRNAs) and whole-transcriptome gene expression are measured across individual cells. Below is a concise description of its components, using more detailed notation. (There is no commonly agreed upon method for this analysis at this time. You should think of GSFA as a promising start of a sequence of research. Future methods might account for guide RNA efficiency, non-additive effects, bioinformatics between guide RNA and target genes, etc.)\n\nInput/Output. The input to GSFA is a 1) single-cell gene expression count matrix \\(Y\\in \\mathbb{R}^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, and 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(G \\in \\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations. Here, \\(Y_{ij}\\) is the normalized expression of gene \\(j\\) in cell \\(i\\). The output of GSFA are: 1) a matrix \\(W \\in \\mathbb{R}^{p \\times k}\\) that denotes which genes is in which module (i.e., latent factor), and 2) a matrix \\(\\beta \\in \\mathbb{R}^{d \\times k}\\) that denotes which perturbation is in which module.\n\nWe describe the main components of GSFA below. See Figure 8.19 for an illustration of this method.\n\n\n\n\n\n\n\nFigure 8.19: From Y. Zhou et al. (2023).\n\n\n\n\n\nNested matrix factorization model: GSFA decomposes the expression matrix into latent factors \\(Z\\) and gene loadings \\(W\\), while modeling how these factors depend on \\(G\\):\n\n\\[\n\\underbrace{Y_{ij}}_{\\text{Expression}}\n=\n\\sum_{\\ell=1}^k Z_{i\\ell}\\,W_{j\\ell}\n+\nE_{ij},\n\\qquad\n\\underbrace{Z_{i\\ell}}_{\\text{Factors}}\n=\n\\sum_{m=1}^d G_{im}\\,\\beta_{m\\ell}\n+\n\\phi_{i,k}.\n\\]\nHere, \\(k\\) is the number of latent factors, \\(E_{ij}\\) is residual noise (often assumed Gaussian), and \\(\\phi_{i\\ell}\\) is a Gaussian random term that captures variation in factor \\(\\ell\\) not explained by perturbations. The factors \\(Z_{i\\ell}\\) can be interpreted as “gene modules” or “principal axes” of variation in the single-cell data.\n\nSparse priors and Bayesian inference: Each perturbation \\(m\\) is assumed to affect only a few latent factors, reflected in a sparse prior on the effect sizes \\(\\beta_{m\\ell}\\). Similarly, each factor \\(\\ell\\) is assumed to influence only a small subset of genes, reflected in a sparse prior on \\(W_{j\\ell}\\). These priors impose the idea that genetic perturbations typically alter only a limited set of biological pathways. GSFA uses Gibbs sampling to draw from the posterior distributions of \\(\\beta_{m\\ell}\\), \\(W_{j\\ell}\\), and \\(Z_{i\\ell}\\) given the observed data \\((Y, G)\\).\nFactor association: Once \\(Z\\) and \\(\\beta\\) are estimated, GSFA identifies which gRNAs significantly shift which factors. The parameter \\(\\beta_{m\\ell}\\) measures how strongly perturbation \\(m\\) activates or represses factor \\(\\ell\\). Posterior inclusion probabilities (PIPs) are computed to assess confidence in each \\(\\beta_{m\\ell}\\) being nonzero.\nGene-level effects: GSFA also summarizes the overall impact of perturbation \\(m\\) on gene \\(j\\). Since perturbation \\(m\\) can affect multiple factors, and each factor influences the expression of gene \\(j\\), the total effect is\n\n\\[\n\\theta_{mj}\n=\n\\sum_{\\ell=1}^k \\beta_{m\\ell}\\,W_{j\\ell}.\n\\]\nThe distribution of \\(\\theta_{m,j}\\) is sampled under the model’s posterior, yielding an LFSR (local false sign rate) that quantifies significance and sign confidence of the perturbation’s effect on that gene.\n In practice, GSFA is applied to single-cell CRISPR screen data as follows. First, one often transforms count data (for example, via deviance residuals) and centers/scales covariates. Next, one fits GSFA via Gibbs sampling, obtaining posterior samples of the factors, gene loadings, and perturbation-factor effects. The factor discovery step can reveal broad biological modules (cell-cycle, immune response, neuronal development, etc.), while the gene-level effect summaries \\(\\theta_{mj}\\) yield a differential expression–style list of significantly perturbed genes for each gRNA. By borrowing information across genes that move together, GSFA can be more sensitive than a naive single-gene test, and can better separate real signals from confounding or measurement noise.\n\n\n8.3.0.2 A brief note about other work.\nSchnitzler et al. (2024) demonstrates using CRISPR to link SNPs in a GWAS to the regulated genes. (This paper also mentions a consensus NMF, which illustrates a different variation of clustering genes by regulatory pathways.) Yao et al. (2024) demonstrates a method to “unravel” the effect of each perturbation on genes in high MOI experiments, where there are multiple perturbations purposely placed in cell, or multiple cells purposely placed in each droplet.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#prediction-perturbation-effects-for-crispr-screens-but-other-types-of-perturbations-as-well",
    "href": "chapter7_crispr.html#prediction-perturbation-effects-for-crispr-screens-but-other-types-of-perturbations-as-well",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.4 Prediction perturbation effects (for CRISPR screens, but other types of perturbations as well)",
    "text": "8.4 Prediction perturbation effects (for CRISPR screens, but other types of perturbations as well)\nA fundamental computational challenge in single-cell perturbation studies is predicting how a perturbation, such as a drug treatment or CRISPR-based genetic modification, affects cellular behavior. This challenge arises in two primary contexts: (1) given a perturbation applied to one cell type, where both control and perturbed states are observed, inferring how another cell type would respond to the same perturbation based on its unperturbed expression; or (2) disentangling the latent space of perturbations from the latent space of cell embeddings, allowing for generalizable predictions of perturbation effects even in the absence of direct observations. The latter approach leverages biological priors on perturbation relationships, enabling the extrapolation of perturbation effects across unseen conditions. Accurate prediction methods are crucial for understanding drug responses, genetic knockouts, and CRISPR-based enhancer perturbations, ultimately providing insights into gene regulatory networks and therapeutic interventions.\n\n8.4.0.1 Hold on… Why do we need this again?\nRemember: If we use a low MOI (ex: MOI of 0.3) experiment, we need many cells to receive each guide, and we even more cells because most cells won’t receive a guide. To quote Bock et al. (2022), ::: block “For both genome-scale and focused CRISPR knockout (CRISPRko) screens, it is advisable to include at least four different gRNAs for each target gene, although carefully designed and validated gRNA libraries with fewer gRNAs per gene can provide reliable results. All gRNA libraries should include gRNAs for application-specific positive and negative control genes, which are important to validate the screen. In addition, they should include control gRNAs that target known safe harbour loci or other genomic regions where no specific effects of gene editing are expected, in order to account for the DNA damage response and for non-specific reduction in cell proliferation caused by CRISPRko. …\nAs a guideline, we recommend a coverage of 100-200 cells per target gene for positive selection screens and 500-1,000 cells per target gene for negative selection screens.” :::\n(The reason negative selection screens need more cells is because these cells will die from the stressor after the CRISPRko integration. So you need to be confident these cells really “died” (instead of you happening by bad luck to miss these cells during sequencing).)\nFor this reasons, some CRISPR experiments purposely use a high MOI (think of 10 to 50). This reduces the number of cells they need, since most cells will receive multiple guides. As one concrete example, see Gasperini et al. (2019), which performed a CRISPRi screen. They targeted 1,119 candidate enhancer elements (which was near 5,611 genes) in K562 cells, and used a high MOI (roughly 15) across 47,650 cells. This means, if they used a conservative MOI=1 (i.e., each cell receives only one guide), they would needed about \\(47,650 \\times 15 \\approx 715,000\\) cells. (That would make that experiment a massive (and extremely expensive) single-cell experiments.)\nHowever, the drawback of high MOI is that sometimes you cannot reasonably rule that different sgRNA doesn’t interact with one another. For this reason, we might wonder: Can we: 1) use a low MOI experiment, 2) leverage some biological insights about these sgRNA, and 3) develop a fancy computational tool to synthetically predict what the effects of the sgRNA we didn’t actually use are?\n\n\n8.4.0.2 Brief aside: What on earth is a “normalizing flow neural networks”?\nNormalizing flow neural networks provide a framework to construct a rich, complex probability distribution by applying a series of invertible transformations to a simple base distribution (often a Gaussian), see Figure 8.20 and Figure 8.21. Each transformation is designed to be bijective and differentiable, which ensures that the overall mapping from the latent space to the data space remains invertible. This property allows for exact likelihood evaluation, because the change of variables formula can be applied directly to the transformed distribution. In practice, one computes the log-likelihood of an observed sample by summing the log of the Jacobian determinant of each invertible mapping and the log-likelihood of the base distribution.\n\n\n\n\n\n\n\nFigure 8.20: From https://lilianweng.github.io/posts/2018-10-13-flow-models/.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.21: From https://lilianweng.github.io/posts/2018-10-13-flow-models/.\n\n\n\n\nInvertibility is a key difference between normalizing flows and Variational Autoencoders (VAEs). In a VAE, an encoder approximates a posterior distribution over the latent variables, but it is generally not invertible. Consequently, VAEs compute a lower bound of the log-likelihood rather than the exact likelihood. In contrast, the invertible nature of normalizing flows enables direct calculation of the log-likelihood, thereby avoiding the need for variational approximations. This leads to more precise density estimation and can offer a clearer interpretation of how each layer transforms data.\nHere is one concrete example of what a normalizing flow network is, which is called RealNVP (where NVP stands for “non-volume preserving”). RealNVP (Dinh, Sohl-Dickstein, and Bengio 2016) is a type of invertible (or “normalizing flow”) model where each transformation can be inverted cheaply by design. The primary idea is to split the input vector \\(\\mathbf{x}\\) into two parts, keep one part unchanged (\\(\\mathbf{x}_1\\)), and transform the other part (\\(\\mathbf{x}_2\\)) in a way that is guaranteed to be invertible.\n\nCoupling Layer: Partition \\(\\mathbf{x}\\) into \\(\\mathbf{x}_1\\) and \\(\\mathbf{x}_2\\). Then, define the output \\(\\mathbf{y} = (\\mathbf{y}_1, \\mathbf{y}_2)\\) where \\(\\mathbf{y}_1 = \\mathbf{x}_1\\) and\n\n\\[\n\\mathbf{y}_2 = \\mathbf{x}_2 \\,\\odot\\, \\exp\\bigl(\\mathbf{s}(\\mathbf{x}_1)\\bigr) + \\mathbf{t}(\\mathbf{x}_1).\n\\]\nThe functions \\(\\mathbf{s}(\\cdot)\\) and \\(\\mathbf{t}(\\cdot)\\) can be any neural networks that output real-valued vectors. The exponential ensures a nonzero scale factor, while addition by \\(\\mathbf{t}\\) is trivially invertible. See Figure 8.22.\n\n\n\n\n\n\n\nFigure 8.22: From Dinh, Sohl-Dickstein, and Bengio (2016).\n\n\n\n\n\nEnsuring this transformation is invertible: The inverse of the above transformation is\n\n\\[\n\\mathbf{x}_1 = \\mathbf{y}_1, \\quad\n\\mathbf{x}_2 = \\bigl(\\mathbf{y}_2 - \\mathbf{t}(\\mathbf{y}_1)\\bigr) \\,\\odot\\, \\exp\\bigl(-\\mathbf{s}(\\mathbf{y}_1)\\bigr).\n\\]\nBecause \\(\\mathbf{x}_1\\) remains the same, it is straightforward to reconstruct \\(\\mathbf{x}_2\\). No matter how \\(\\mathbf{s}\\) and \\(\\mathbf{t}\\) are learned, the coupling layer is invertible by construction.\nSplitting the input and only transforming part of it guarantees efficient forward and inverse computations. By composing multiple coupling layers, we can create flexible density estimators while preserving tractable log-likelihood calculation.\nSee https://lilianweng.github.io/posts/2018-10-13-flow-models/, https://paperswithcode.com/method/affine-coupling, https://bjlkeng.io/posts/normalizing-flows-with-real-nvp/, and Kobyzev, Prince, and Brubaker (2020) for useful overviews about normalizing flows, with some details about the way to construct normalizing flows using affine transformations.\n(Sidenote: This context is mainly only needed to understand PerturbNet (Yu and Welch 2022). There are plenty of methods to predict perturbation effects not build using normalizing flow networks. See scGen (Lotfollahi, Wolf, and Theis 2019) for example, which is built on your more typical VAE architecture.)\n\n\n8.4.0.3 State-of-the-art research: PerturbNet.\nPerturbNet (Yu and Welch 2022) is a deep generative framework that predicts single-cell gene expression responses under both observed and unseen chemical or genetic perturbations. That is, we want to predict the effect of perturbation even if none of cells ever received this perturbation.\n\nInput/Output. The input to PerturbNet (when trying to perturb the impact of CRISPRi perturbations) is a 1) single-cell gene expression count matrix \\(\\mathbb{Z}_+^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(\\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations, and 3) a database that groups the perturbations (many of which might not the \\(d\\) perturbations you actually measured) into pathways. The output is three things: 1) a VAE to embed each of the \\(n\\) cells into low-dimensional space, 2) a VAE to embed each of the perturbations (including the \\(d\\) in your dataset) into a low-dimensional space, and 3) a learned function that takes in a cell’s latent representation and perturbation’s latent representation and outputs the (predicted) cell’s latent representation after receiving that perturbation.\n\nIt is designed around three principal building blocks: (i) perturbation representation networks, (ii) cell-state representation networks, and (iii) a conditional invertible neural network (cINN) that translates perturbation embeddings into full distributions of cellular states.\n\nPerturbation Representation Networks (GenotypeVAE or ESM): To capture key features of chemical or genetic perturbations in a low-dimensional, learnable space, PerturbNet uses different encoder architectures. We’ll just focus on the CRISPR-related perturbations in our discussion here. For CRISPR knockdown or CRISPRi/a perturbations, a GenotypeVAE is used, which starts from a high-dimensional GO-term annotation vector for each target gene (or union of genes), then encodes this vector into a condensed gene-function latent space via fully-connected layers. In the case of coding-sequence edits (such as CRISPR knockouts which introduce changes to the genetics), perturbations are encoded by a pretrained transformer (e.g. ESM, which stands for “evolutionary scale modeling”4), which outputs a deterministic embedding of amino-acid sequences.\n\nThe point is: we use biological insights about these perturbations (which use established databases) to learn the “space of perturbations.” See Figure 8.23 and Figure 8.24.\n\n\n\n\n\n\n\nFigure 8.23: From Yu and Welch (2022). GenotypeVAE to learn a low-dimensional representation for each gene based on which pathways it is known to be involved in.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.24: From Yu and Welch (2022). ESM to learn a low-dimensional representation of the protein sequence (which is a “sequence of words” (language model).\n\n\n\n\n\nCell-state representation network: Separately, PerturbNet learns a latent space for the single-cell gene expression profiles. This is similar to your typical VAE for scRNA-seq using a negative binomial-likelihood. Each cell is thus mapped into a latent space \\(Z\\) capturing core variation in gene expression. The VAE decoder reconstructs the input (e.g. counts) from the sampled \\(Z\\) latent, enabling distributional modeling of single-cell data.\nConditional invertible neural network (cINN): [[This is where the magic happens!]] The crux of PerturbNet is a conditional invertible neural network, denoted \\(Z=f(V \\mid Y)\\). (This is where the normalizing flow comes into play.) Here, \\(Y\\) is the perturbation’s latent embedding (from GenotypeVAE or ESM), and \\(Z\\) is the cell-state latent (from the cell VAE). The cINN incorporates a “residual” variable \\(V \\sim N(0,I)\\), capturing per-cell variability unexplained by the perturbation. In plain English, you want learn the function \\(f\\) that takes in as input \\(V\\) (the “baseline” representation of the cell), and then condition to a perturbation (represented by \\(Y\\)) to give you the observed gene expression (which here, is a low-dimensional embedding represented by \\(Z\\)).\n\nConcretely, \\(f\\) is built from affine coupling blocks (see Figure 8.22):\n\\[\n(W_1, W_2) = \\mathrm{Block}((U_1,U_2) \\mid Y),\n\\]\nwhere \\(U_1,U_2\\) split the input, and each block’s parameters are learned via fully-connected sub-networks that shift and scale one part of the data conditioned on the other part and on \\(Y\\). Because each block is invertible (with a tractable Jacobian determinant), one can train \\(f\\) from the objective5\n\\[\n\\mathcal{L} = \\mathbb{E} \\bigl[-\\log p\\{f^{-1}(Z \\mid Y)\\}\\bigr] + \\text{(constant terms)},\n\\]\ndriving \\(f^{-1}\\) to map \\((Z,Y)\\) back to a Gaussian \\(V\\). (I’m aware this probably doesn’t make a lot of sense since I’m not providing enough context about how a cINN works. See the references above about normalizing flows.)\nThis cINN architecture thus learns to sample realistic cell embeddings for each perturbation. In practice, a stack of multiple affine coupling blocks plus normalization layers is used, ensuring expressivity and stable training.\n\nTraining procedure and use: After the perturbation and cell VAEs are pre-trained (often on large unpaired datasets), one collects paired perturbation–cell data (e.g. a high-throughput Perturb-seq or chemical screen). By feeding the latent \\(Y\\) from the perturbation network and the latent \\(Z\\) from the cell-state VAE into the cINN, PerturbNet learns the probabilistic mapping between \\(Y\\) and \\(Z\\). Once trained, it can (1) sample predicted single-cell states for a new perturbation \\(Y_{\\mathrm{new}}\\), and (2) be inverted to find which perturbation embeddings shift cells toward a desired \\(Z_{\\mathrm{target}}\\) distribution.\n\nPutting this all together, see Figure 8.25 and Figure 8.26.\n\n\n\n\n\n\n\nFigure 8.25: From Yu and Welch (2022). High-level idea.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.26: From Yu and Welch (2022). More details about how this works.\n\n\n\n\n\n\n\n\nBarry, Timothy, Kathryn Roeder, and Eugene Katsevich. 2024. “Exponential Family Measurement Error Models for Single-Cell CRISPR Screens.” Biostatistics 25 (4): 1254–72.\n\n\nBarry, Timothy, Xuran Wang, John A Morris, Kathryn Roeder, and Eugene Katsevich. 2021. “SCEPTRE Improves Calibration and Sensitivity in Single-Cell CRISPR Screen Analysis.” Genome Biology 22 (1): 1–19.\n\n\nBock, Christoph, Paul Datlinger, Florence Chardon, Matthew A Coelho, Matthew B Dong, Keith A Lawson, Tian Lu, et al. 2022. “High-Content CRISPR Screening.” Nature Reviews Methods Primers 2 (1): 1–23.\n\n\nCheng, Junyun, Gaole Lin, Tianhao Wang, Yunzhu Wang, Wenbo Guo, Jie Liao, Penghui Yang, et al. 2023. “Massively Parallel CRISPR-Based Genetic Perturbation Screening at Single-Cell Resolution.” Advanced Science 10 (4): 2204484.\n\n\nConcordet, Jean-Paul, and Maximilian Haeussler. 2018. “CRISPOR: Intuitive Guide Selection for CRISPR/Cas9 Genome Editing Experiments and Screens.” Nucleic Acids Research 46 (W1): W242–45.\n\n\nDatlinger, Paul, André F Rendeiro, Christian Schmidl, Thomas Krausgruber, Peter Traxler, Johanna Klughammer, Linda C Schuster, Amelie Kuchler, Donat Alpar, and Christoph Bock. 2017. “Pooled CRISPR Screening with Single-Cell Transcriptome Readout.” Nature Methods 14 (3): 297–301.\n\n\nDinh, Laurent, Jascha Sohl-Dickstein, and Samy Bengio. 2016. “Density Estimation Using Real Nvp.” arXiv Preprint arXiv:1605.08803.\n\n\nDixit, Atray, Oren Parnas, Biyu Li, Jenny Chen, Charles P Fulco, Livnat Jerby-Arnon, Nemanja D Marjanovic, et al. 2016. “Perturb-Seq: Dissecting Molecular Circuits with Scalable Single-Cell RNA Profiling of Pooled Genetic Screens.” Cell 167 (7): 1853–66.\n\n\nEsposito, Roberta, Núria Bosch, Andrés Lanzós, Taisia Polidori, Carlos Pulido-Quetglas, and Rory Johnson. 2019. “Hacking the Cancer Genome: Profiling Therapeutically Actionable Long Non-Coding RNAs Using CRISPR-Cas9 Screening.” Cancer Cell 35 (4): 545–57.\n\n\nGasperini, Molly, Andrew J Hill, José L McFaline-Figueroa, Beth Martin, Seungsoo Kim, Melissa D Zhang, Dana Jackson, et al. 2019. “A Genome-Wide Framework for Mapping Gene Regulation via Cellular Genetic Screens.” Cell 176 (1): 377–90.\n\n\nKhan, Faiza Shafique, Farhan Goher, Dapeng Zhang, Peng Shi, Zhiying Li, Yin Min Htwe, and Yong Wang. 2022. “Is CRISPR/Cas9 a Way Forward to Fast-Track Genetic Improvement in Commercial Palms? Prospects and Limits.” Frontiers in Plant Science 13: 1042828.\n\n\nKobyzev, Ivan, Simon JD Prince, and Marcus A Brubaker. 2020. “Normalizing Flows: An Introduction and Review of Current Methods.” IEEE Transactions on Pattern Analysis and Machine Intelligence 43 (11): 3964–79.\n\n\nKuhn, Maria, António J Santinha, and Randall J Platt. 2021. “Moving from in Vitro to in Vivo CRISPR Screens.” Gene and Genome Editing 2: 100008.\n\n\nLin, Xueqiu, Yanxia Liu, Shuai Liu, Xiang Zhu, Lingling Wu, Yanyu Zhu, Dehua Zhao, et al. 2022. “Nested Epistasis Enhancer Networks for Robust Genome Regulation.” Science 377 (6610): 1077–85.\n\n\nLotfollahi, Mohammad, F Alexander Wolf, and Fabian J Theis. 2019. “scGen Predicts Single-Cell Perturbation Responses.” Nature Methods 16 (8): 715–21.\n\n\nMao, Yanfei, Jose Ramon Botella, and Jian-Kang Zhu. 2017. “Heritability of Targeted Gene Modifications Induced by Plant-Optimized CRISPR Systems.” Cellular and Molecular Life Sciences 74 (6): 1075–93.\n\n\nSchnitzler, Gavin R, Helen Kang, Shi Fang, Ramcharan S Angom, Vivian S Lee-Kim, X Rosa Ma, Ronghao Zhou, et al. 2024. “Convergence of Coronary Artery Disease Genes onto Endothelial Cell Programs.” Nature 626 (8000): 799–807.\n\n\nWei, Lai, Derek Lee, Cheuk-Ting Law, Misty Shuo Zhang, Jialing Shen, Don Wai-Ching Chin, Allen Zhang, et al. 2019. “Genome-Wide CRISPR/Cas9 Library Screening Identified PHGDH as a Critical Driver for Sorafenib Resistance in HCC.” Nature Communications 10 (1): 4681.\n\n\nYao, Douglas, Loic Binan, Jon Bezney, Brooke Simonton, Jahanara Freedman, Chris J Frangieh, Kushal Dey, et al. 2024. “Scalable Genetic Screening for Regulatory Circuits Using Compressed Perturb-Seq.” Nature Biotechnology 42 (8): 1282–95.\n\n\nYu, Hengshi, and Joshua D Welch. 2022. “Perturbnet Predicts Single-Cell Responses to Unseen Chemical and Genetic Perturbations.” BioRxiv, 2022–07.\n\n\nZhou, Jessica L, Karthik Guruvayurappan, Shushan Toneyan, Hsiuyi V Chen, Aaron R Chen, Peter Koo, and Graham McVicker. 2024. “Analysis of Single-Cell CRISPR Perturbations Indicates That Enhancers Predominantly Act Multiplicatively.” Cell Genomics 4 (11).\n\n\nZhou, Yifan, Kaixuan Luo, Lifan Liang, Mengjie Chen, and Xin He. 2023. “A New Bayesian Factor Analysis Method Improves Detection of Genes and Biological Processes Affected by Perturbations in Single-Cell CRISPR Screening.” Nature Methods 20 (11): 1693–703.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#footnotes",
    "href": "chapter7_crispr.html#footnotes",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "CRISPR stands for “clustered regularly interspaced short palindromic repeats,” but it’s not too important to know why exactly it’s called this for the purposes of this chapter.↩︎\nThis itself is fascinating. See https://github.com/facebookresearch/esm.↩︎\nThis itself is fascinating. See https://github.com/facebookresearch/esm.↩︎\nThis itself is fascinating. See https://github.com/facebookresearch/esm.↩︎\nHere, the probability \\(p\\) is determining the likelihood \\(f^{-1}(Z \\mid Y)\\) originated from \\(V \\sim N(0,I)\\). We’re going to approximate the expectation by taking an average of all the cells we’ve sequenced based on their latent embedding \\(Z\\) and the latent embedding of the treatment \\(Y\\) that was applied to that cell.↩︎",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html",
    "href": "chapter8_lineage.html",
    "title": "9  Single-cell lineage tracing",
    "section": "",
    "text": "9.1 Why are we interested in learning temporal dynamics?\nStudying how cells change over time provides critical insight into the sequence of events driving biological processes. By observing changes in cell populations across multiple time points, researchers can pinpoint when specific transitions or bifurcations occur. Such temporal information reveals which factors influence a cell’s fate and how quickly new traits emerge.\nMoreover, understanding temporal dynamics can help us develop better interventions. If we can identify the earliest signs of disease or undesirable changes in cells, then targeted therapies can be designed to prevent or slow progression. Such strategies are especially powerful for complex, multi-stage diseases where later intervention might be less effective.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#why-are-we-interested-in-learning-temporal-dynamics",
    "href": "chapter8_lineage.html#why-are-we-interested-in-learning-temporal-dynamics",
    "title": "9  Single-cell lineage tracing",
    "section": "",
    "text": "Cancer subclone evolution: Tumors consist of various subclones that compete and evolve. Observing which subclones become dominant over time helps illuminate how certain cells acquire and propagate new mutations, sometimes conferring resistance to treatments. See Figure 9.1 and Figure 9.2.\n\n\n\n\n\n\n\n\nFigure 9.1: (Top) From (ashouri2023decoding?).\n\n\n\n\n\n\n\n\n\n\n\nFigure 9.2: (Bottom) From (marine2020non?).\n\n\n\n\n\nCancer metastasis: Cells that detach from the primary tumor site and successfully colonize new tissues undergo significant genetic and phenotypic changes. Understanding these changes in temporal sequence highlights the adaptations needed for invasion and survival in distant environments. See Figure 9.3.\n\n\n\n\n\n\n\n\nFigure 9.3: From (fu2023emerging?).\n\n\n\n\n\nDisease progression: Many diseases advance in stages, even beyond cancer, with cells accumulating subtle changes that eventually manifest as severe pathologies. Timing the acquisition of these changes reveals how early molecular events cascade into full-blown disease. See Figure 9.4 for an example of this investigated in COVID.\n\n\n\n\n\n\n\n\nFigure 9.4: From (stephenson2021single?). You can see that at different stages of COVID, there is a slightly different proportion of cell types that constitute the immune system.\n\n\n\n\n\nEmbryonic/organ development and cell fate: During embryonic development, cells undergo a series of tightly regulated fate decisions that determine their final identity. These decisions are influenced by both intrinsic genetic programs and extrinsic signaling cues from the surrounding environment. Understanding the temporal dynamics of these transitions allows researchers to uncover the molecular mechanisms guiding differentiation and tissue formation. By tracking how cells commit to specific lineages, we gain insight into how organs form or how “cells make decisions”. See Figure 9.5.\n\n\n\n\n\n\n\n\nFigure 9.5: From (weinreb2020lineage?). This dataset is recorded longitudinally (i.e., cells were sequenced at Day 2, 4, and 6.) What’s shown here are cells known to be in different lineages, but certain lineages don’t differentiate by Day 6, differentiate into multiple cell types, or differentiate only into one cell type.\n\n\n\n\n\nStem cell research: Stem cells differentiate into specialized cell types following a tightly regulated timeline. Tracking these progressions uncovers the signals that guide each step and may inform regenerative medicine strategies for repairing damaged tissues. See Figure 9.6.\n\n\n\n\n\n\n\n\nFigure 9.6: From https://stemcellthailand.org/induced-pluripotent-stem-cells-ips-ipscs-hipscs/.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html",
    "href": "chapter9_spatial.html",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "10.1 The broad categorization of spatial transcriptomic technologies\nSingle-cell spatial transcriptomics is an emerging technology that enables the measurement of gene expression while preserving the spatial organization of cells within a tissue. See Figure 10.1 for a useful schematic I like. Unlike traditional single-cell RNA sequencing, which dissociates cells and loses spatial context, spatial transcriptomics allows researchers to analyze gene expression in relation to cellular neighborhoods, tissue architecture, and microenvironments, see Figure 10.2.\nThe spatial arrangement of cells is fundamental to understanding cell biology, as cellular functions are often influenced by their local microenvironment:\nAs one concrete example of how spatial transcriptomics advances cell biology beyond what other sequencing technologies offers: spatial transcriptomics is particularly valuable for studying cell-cell communication, as it enables the identification of ligand-receptor interactions that mediate signaling between neighboring cells. By integrating spatial data with single-cell transcriptomics, researchers can infer functional relationships between different cell types, uncovering regulatory networks that drive biological processes.\nNote: Spatial information in cell biology has been studied for decades, long before single-cell sequencing became commercially feasible. Techniques like fluorescence in situ hybridization (FISH) have been used to visualize the spatial localization of specific RNA molecules within cells, providing crucial insights into gene expression patterns. Microscopy-based methods, including confocal and super-resolution imaging, have also been instrumental in understanding cellular structures and interactions. The key novelty of modern spatial transcriptomics is its ability to scale these analyses – rather than measuring just a few genes at a time, we can now capture the spatial expression patterns of hundreds to thousands of genes simultaneously, enabling a much more comprehensive view of cellular organization and function.\nSpatial transcriptomic technologies can be broadly categorized into two main approaches: spot-based methods and imaging-based methods, see Figure 10.4 and Figure 10.5.\nSee Figure 10.6, Figure 10.7, and Figure 10.9 for examples of what these datasets look like, and how spot- and imaging-based spatial transcriptomics could yield quite dramatically different datasets.\nSee Figure 10.10 for a table of many possible technologies to perform spatial transcriptomics.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#the-broad-categorization-of-spatial-transcriptomic-technologies",
    "href": "chapter9_spatial.html#the-broad-categorization-of-spatial-transcriptomic-technologies",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "Figure 10.4: Left: From https://hutchdatascience.org/Choosing_Genomics_Tools/spatial-transcriptomics-1.html\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.5: Right: From https://geneviatechnologies.com/bioinformatics-analyses/spatial-transcriptomic-data-analysis/\n\n\n\n\n\nSpot-based technologies utilize sequencing-based approaches to capture gene expression across a tissue section. These methods typically involve placing spatially barcoded capture spots on a slide, allowing RNA molecules from the tissue to be sequenced while retaining their spatial information. Spot-based techniques offer broad coverage across the entire transcriptome, making them well-suited for large tissue sections and unbiased gene discovery. However, they have relatively low spatial resolution due to the size of the capture spots and may lack sufficient depth for detecting lowly expressed but biologically significant genes.\nImaging-based technologies rely on multiplexed imaging methods to visualize gene expression directly within tissues. These approaches build upon fluorescence in situ hybridization (FISH) and other imaging techniques, enabling subcellular resolution of RNA molecules. By using sequential hybridization cycles with fluorescent probes, imaging-based methods can measure the expression of dozens to hundreds of preselected genes. While this high-resolution approach provides detailed spatial maps at the single-molecule level, it requires prior selection of target genes and computationally intensive methods to delineate cell boundaries from dense tissue images.\n\n\n\n\n\n\n\n\n\nFigure 10.6: Top: From https://www.trillium.de/en/journals/trillium-pathology/archive/2024/tp-1/2024/ai-in-pathology/integration-of-spatially-resolved-transcriptomics-into-pathological-research-opportunities-and-challenges.html\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.7: Bottom: From Figiel et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.8: From Longo et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.9: From Rademacher et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.10: From https://rubd.github.io/Giotto_site/. (This figure is rapidly becoming out-dated. I would argue and say this figure is already nearly unrepresentative of the field.)\n\n\n\n\n\nRemark 10.1. These are all 2D tissue slices!\nOur body is three-dimensional (unsurprisingly). However, all the spatial information we are collecting is typically 2D. (Some really rich consortiums have sequenced many cross-sectional 2D slices to reconstruct the 3D organ, for example M. Zhang et al. (2023). However, most single-PI labs do not have the budget to do this. Therefore, it’s important you ask yourself: “Is it possible I am misleading myself by analyzing a 2D tissue slice when my question is about the 3D organ?”\nIt’s entirely possible that the cellular organization/dynamics on a 2D tissue slice is representative of the overall tissue. It’s also entirely possible that it’s not. Knowing how the 2D tissue was selected (i.e., how did someone even choose this specific cross-section in the first place?) is an important question to answer before you can even start thinking mathematically on how your 2D findings relate back to the 3D shape.\n\n\n10.1.1 Sequencing-based: Visium (10x)\nVisium by 10x Genomics is a widely used spot-based spatial transcriptomics technology. See Figure 10.11 for a cartoon on how it works. Visium captures transcriptomic information within predefined spatial spots on a tissue section, allowing for spatially resolved gene expression profiling. However, each spot is relatively large (usually around 55 µm in diameter), often encompassing multiple cells. To infer cellular composition within each spot, computational deconvolution methods are typically applied. In addition to transcriptomic data, Visium also provides an H&E (hematoxylin and eosin) stained image of the tissue, which is valuable for histological context, aiding in the interpretation of spatial gene expression patterns and tissue architecture. ?fig-spatial-analyses provides examples of this spot-based spatial transcriptomics.\n\n\n\n\n\n\n\nFigure 10.11: From Duan, Cheng, and Cheng (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.12: Left: From Kim, Choi, and Lee (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.13: Right: From https://satijalab.org/seurat/articles/spatial_vignette\n\n\n\n\n\n\n10.1.2 Sequencing-based: Visium HD (10x)\nVisium HD is an advanced version of Visium that significantly improves spatial resolution, see Figure 10.14 and Figure 10.15. Unlike standard Visium, which has relatively large spots, Visium HD features smaller spots, allowing for higher spatial resolution and better separation of individual cells. This enhancement enables more precise mapping of transcriptomic data to tissue morphology. However, the increased resolution comes at a higher cost, as sequencing expenses rise due to the need for greater sequencing depth to capture the finer spatial granularity.\n\n\n\n\n\n\n\nFigure 10.14: Left: From https://imaging.as.uky.edu/visium-hd-spatial-transcriptomics. See more at https://www.10xgenomics.com/spatial-transcriptomics#what-is-spatial-transcriptomics.\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.15: Right: From https://x.com/AlbertVilella/status/1367028429300916225\n\n\n\n\n\n\n10.1.3 Imaging-based: MERFISH/MERSCOPE (Vizgen)\nMultiplexed Error-Robust Fluorescence In Situ Hybridization (MERFISH) is an imaging-based spatial transcriptomics method that enables the detection of hundreds to thousands of preselected RNA transcripts in a tissue section. It operates by hybridizing barcoded probes to RNA molecules, followed by multiple rounds of imaging to decode the transcript identities, see Figure 10.16. Since MERFISH provides subcellular resolution, it allows precise localization of transcripts within individual cells, but it requires computational cell segmentation to assign transcripts to specific cells. MERSCOPE is a commercial platform for MERFISH, providing an integrated solution for sample preparation, imaging, and data analysis.\nSee Figure 10.17 and Figure 10.18 for examples of the data.\n\n\n\n\n\n\n\nFigure 10.16: From Chen et al. (2015)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.17: Top: From M. Zhang et al. (2023). Here, each “dot” is a cell colored by its cell type (after a cell segmentation was run to determine which RNA transcripts belonged to which cell).\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.18: Bottom: From Chen et al. (2015). Here, each “dot” is an RNA transcript colored by the different genes that the RNA transcript came from. (This figure is more representative of what the “raw data” looks like.)\n\n\n\n\n\n\n10.1.4 Imaging-based: Xenium (10x)\nXenium by 10x Genomics is another imaging-based spatial transcriptomics platform, designed to profile a targeted set of transcripts with subcellular resolution. Unlike sequencing-based approaches, Xenium relies on fluorescence imaging to detect preselected RNA targets within tissue sections. See Figure 10.19 for a comparison. It enables high-throughput spatial mapping of gene expression while preserving tissue morphology. As with other imaging-based methods, accurate cell segmentation is essential to delineate individual cells and associate detected transcripts with them. (There are many papers that try comparing Xenium and MERSCOPE. See Figure 10.20 for one paper.)\n\n\n\n\n\n\n\nFigure 10.19: From Lee et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.20: From Hartman and Satija (2024)\n\n\n\n\nSee more at https://www.10xgenomics.com/blog/optimizing-your-spatial-transcriptomics-research-with-visium-hd-and-xenium-in-situ.\n\n\n10.1.5 So, what should I use?\nIf you are about to collect spatial transcriptomics data yourself, it’s important to first consider what you’re trying to biologically investigate (since this data will be quite expensive to collect). Are you trying to explore the complexity of a tissue, or are you trying to definitively prove the existence (or lack thereof) of something? The nature of your biological question might make it apparent which technology best suits your needs. See Figure 10.21.\n\n\n\n\n\n\n\nFigure 10.21: From Williams et al. (2022). (I think “CosMx” is incorrectly labeled in this figure? It is more of an imaging-based method.)\n\n\n\n\nSee a massive review of the benefits and drawbacks of different spatial transcriptomics technologies in Lee et al. (2024), Liao et al. (2021), Duan, Cheng, and Cheng (2023).",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#a-whirlwind-of-other-tasks",
    "href": "chapter9_spatial.html#a-whirlwind-of-other-tasks",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.2 A whirlwind of other tasks",
    "text": "10.2 A whirlwind of other tasks\nBeyond generating spatial transcriptomic data, a variety of computational tasks are necessary to ensure accurate interpretation and integration with other biological information. These tasks broadly fall into two categories: preprocessing and statistical analysis.\n\n10.2.1 Preprocessing\nRaw spatial transcriptomic data often require substantial preprocessing to correct for technical artifacts and enhance interpretability. One key step is integration, where spatial data are aligned with other tissue slides or combined with histological information, such as the H&E stain, to provide morphological context. Contamination removal is another crucial step, as transcripts may originate from neighboring cells or ambient RNA, especially in spot-based approaches. Additionally, imputation techniques can be applied to recover missing gene expression values, particularly in spot-based methods where some spots may have low or undetectable expression due to sequencing depth limitations.\n\n\n10.2.2 Statistical analyses\nOnce preprocessed, spatial transcriptomic data can be analyzed using various statistical approaches to uncover biological insights. Identifying spatially variable genes helps determine which genes exhibit spatially structured expression patterns, highlighting key regulators of tissue organization. Another common analysis involves defining spatial domains, where clustering techniques identify tissue regions with distinct gene expression profiles while accounting for spatial proximity. For spot-based methods, cell-type deconvolution is used to estimate the composition of different cell types within each spot, given that multiple cells may contribute to a single measurement. In imaging-based methods, cell segmentation is a critical computational step, where individual cells are delineated based on transcript localization and morphological features to achieve single-cell resolution.\nSee Figure 10.22, Figure 10.23, Figure 10.24, and Figure 10.25 (and the papers these figures come from) for a broad overview of all the different types of analyses you can do with spatial transcriptomics.\n\n\n\n\n\n\n\nFigure 10.22: Left: From https://geneviatechnologies.com/bioinformatics-analyses/spatial-transcriptomic-data-analysis/\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.23: Right: From Kiessling and Kuppe (2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.24: Top: From Park et al. (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.25: Bottom: From (zhou2023spatial?)\n\n\n\n\n\nRemark 10.2. Remember, after we collect the tissue from a donor, we don’t really care about the donor anymore. We care about the biology\nOne of the trickiest (statistical) philosophical roadblocks you’ll encounter when you work on spatial transcriptomics is: “What on earth is the ‘population’ I’m studying?” You’ll need to think really hard about variation that might occur within an individual or between different individuals. (Spatial transcriptomics by itself is currently financially unrealistic to be a reliable tool for biomarker detection, unlike other biomedical technologies such as MRI, PET scans, CT scans, staining of tissue slices, etc.)\nIt’s not uncommon to only have one or two spatial transcriptomic tissue slices for an entire study. (This is really a reflection about how expensive and laborious getting this data is.) In that case, are you really just learning biology about this one specific person? How do you know that the donor’s biology is representative of overall human biology?\nBroadly speaking, there are two philosophical approaches to handle this:\n\nYou don’t: Some papers simply show “existence.” That is, they have a statement that is of the flavor, “Our paper demonstrates that this phenomenon can occur in tissue, because we have found evidence of it existing in our tissue.” The benefit of this strategy is that you can always claim this, and there is still room for scientific novelty. However, you cannot make any statement that generalizes beyond your specific tissue. Hence, it’s really important you pick really “interesting” tissue slices for this approach.\nRelate everything back to the omics: It’s difficult to “integrate” tissue slices from two completely different people together. (You can think about how impossibly hard this is, especially if you have familiarity with MRI data. How would you “align” my lung tissue slice with your lung tissue slice? What if my lungs are slightly bigger/smaller in certain regions than yours?) Unlike single-cell data (where we can just combine the cells across many donors), in spatial transcriptomics, you are usually instead relating all your findings on\n\n\nFor examples of what type of analyses you can do with spatial transcriptomics data (beyond what we’ll discuss in these notes), see: https://hutchdatascience.org/Choosing_Genomics_Tools/spatial-transcriptomics-1.html, https://squidpy.readthedocs.io/en/stable/, and https://giottosuite.readthedocs.io/en/master/.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#cell-cell-communication",
    "href": "chapter9_spatial.html#cell-cell-communication",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.3 Cell-cell communication",
    "text": "10.3 Cell-cell communication\nCell-cell communication is a fundamental process in biology that enables cells to coordinate their behavior, maintain homeostasis, and respond to environmental stimuli. Through various signaling mechanisms, cells transmit biochemical signals that regulate development, immune responses, tissue repair, and disease progression. The ability to understand and map these communication networks is crucial for uncovering mechanisms underlying diseases such as cancer, neurodegenerative disorders, and immune dysfunctions. With advances in spatial transcriptomics and single-cell technologies, researchers can now investigate cell-cell communication at unprecedented resolution, allowing for insights into how cells interact in complex tissue environments.\n\n10.3.1 How do cells communicate with one another?\nCells communicate using multiple signaling modalities, each suited for different biological contexts:\n\nAutocrine signaling: A cell releases signaling molecules that bind to its own receptors, allowing it to regulate its own behavior. This is common in immune responses and cancer progression.\n\nGap junction signaling: Cells directly exchange ions and small molecules through specialized intercellular channels called gap junctions. This form of communication is rapid and crucial in electrically excitable tissues like the heart and nervous system.\n\nParacrine signaling: Cells secrete signaling molecules that diffuse over short distances to affect neighboring cells. This is commonly seen in tissue development and inflammation.\n\nEndocrine signaling: Hormones are released into the bloodstream and travel long distances to regulate distant target cells. This is a key mechanism in systemic physiological regulation, such as insulin signaling in metabolism.\n\nSee these illustrated in Figure 10.26.\n\n\n\n\n\n\n\nFigure 10.26: From https://frontlinegenomics.com/methods-to-study-cell-cell-communication/\n\n\n\n\nWhat do we do with these results? There are many types of results we could publish. Visually, these are summarized in Figure 10.27.\n\n\n\n\n\n\n\nFigure 10.27: From Armingol et al. (2021)\n\n\n\n\n\n\n10.3.2 Brief aside: Ligand-receptor pairs\nCell-cell communication often relies on ligand-receptor interactions. A ligand is a signaling molecule (such as a protein, peptide, or small molecule) that binds to a receptor, a transmembrane or intracellular protein that mediates a cellular response, see Figure 10.28, Figure 10.29, and Figure 10.30. Ligand-receptor interactions trigger cascades of intracellular signaling events, leading to diverse functional outcomes.\n\n\n\n\n\n\n\nFigure 10.28: From https://commons.wikimedia.org/wiki/File:Ligand-receptor_interaction.png\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.29: Top: From https://www.khanacademy.org/science/biology/cell-signaling/mechanisms-of-cell-signaling/a/introduction-to-cell-signaling\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.30: Bottom: From https://biocircuits.github.io/chapters/13_promiscuous_binding.html. Notice: Ligand-receptor pairs are not one to one! A ligand can bind to many different types of receptors, and vice versa.\n\n\n\n\nTo systematically study these interactions, several databases compile known ligand-receptor pairs:\n\nCellChatDB Jin et al. (2021): A curated database that includes signaling pathways and interactions inferred from literature and experimental data.\n\nCellPhoneDB (efremova2020cellphonedb?): A database that maps ligand-receptor interactions based on transcriptomic data and protein complex structures, see Figure 10.31. See https://cellphonedb.readthedocs.io/.\n\nFANTOM5: A large-scale functional annotation project that includes information on secreted ligands and their corresponding receptors.\n\n\n\n\n\n\n\n\nFigure 10.31: From (efremova2020cellphonedb?). Here, the rows represent different ligand-receptor pairs, and the columns represent different cell types.\n\n\n\n\nGene expression data plays a critical role in understanding cell-cell communication. By measuring the expression levels of ligands and receptors across different cell types, researchers can infer potential signaling interactions. Advances in spatial transcriptomics further enhance this analysis by preserving spatial context, allowing for the reconstruction of communication networks within tissues. Computational tools, such as COMMOT, integrate gene expression data with spatial information to infer cell-cell signaling and its functional consequences.\n\n\n10.3.3 Using spatial transcriptomics to study cell-cell communication\n\n10.3.3.1 Pause: We’ve actually been studying cell-cell communication long before spatial transcriptomics became commercially viable. It just relied on some leaps of faith.\nBefore the advent of spatial transcriptomics, researchers inferred cell-cell communication primarily from single-cell RNA sequencing (scRNA-seq) data. By identifying which cells expressed specific ligands and which expressed corresponding receptors, computational methods could predict potential signaling interactions, see Figure 10.32 and Figure 10.33. However, this approach required a key assumption: that interacting cells were in close spatial proximity, even though spatial relationships were not directly measured. Furthermore, we assumed that there was a close relation between high gene expression and high abundance of the corresponding ligand (or receptor).\n\n\n\n\n\n\n\nFigure 10.32: Top: From Armingol et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.33: Bottom: From Armingol et al. (2021)\n\n\n\n\nAdditional information, such as histological staining or known tissue structures, sometimes provided indirect spatial context. For example, in well-characterized tissues like the intestine or brain, researchers could infer likely cell-cell interactions based on prior anatomical knowledge. However, these inferences were often imprecise and required validation through techniques like immunohistochemistry or in situ hybridization.\nWith spatial transcriptomics, these leaps of faith are no longer necessary. We can now directly observe which cells are adjacent or within signaling range, making it possible to study cell-cell communication with much higher confidence, see Figure 10.34 and Figure 10.35. This allows researchers to investigate how signaling networks vary across different tissue regions, uncover spatially organized signaling niches, and refine our understanding of how tissue structure influences intercellular communication.\n\n\n\n\n\n\n\nFigure 10.34: From Almet et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.35: From Longo et al. (2021)\n\n\n\n\nCOMMOT (COMMunication analysis by Optimal Transport) Cang et al. (2023) is a computational framework designed to infer cell-cell communication (CCC) from spatial transcriptomic data. Unlike traditional methods that examine ligand-receptor interactions independently, COMMOT considers multiple ligand-receptor pairs simultaneously while incorporating spatial constraints. See Figure 10.36.\n\nInput/Output.\nThe input to COMMOT is 1) a spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(X \\in \\mathbb{R}^{n \\times p}\\) for \\(n\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n\\) cells, and 2) a database of known ligand-receptor pairs for \\(n_l\\) ligands and \\(n_r\\) receptors (alongside which ligands are known to bind to which receptors), of which the \\(n_l+n_r\\) ligand and receptors should correspond to some of the \\(p\\) genes.\nThe output is: for each ligand \\(i\\) and receptor \\(j\\), a map among the 2D tissue slice of how much “mass” of each ligand is transported to each receptor.\n\n\n\n\n\n\n\n\nFigure 10.36: From Cang et al. (2023)\n\n\n\n\n\nOptimal transport for a single ligand-receptor pair:\nGiven a ligand \\(i\\) and receptor \\(j\\), COMMOT formulates the inference of CCC as an optimal transport problem. The goal is to determine the transport plan \\(P_{\\ell,r} \\in \\mathbb{R}^{n\\times n}_+\\) for \\(n\\) cells, where \\([P_{\\ell,r}]_{k,l}\\) quantifies the strength of signaling from sender cell \\(i\\) to receiver cell \\(j\\) through the ligand-receptor pair \\((\\ell,r)\\). This is achieved by minimizing the transport cost:\n\\[\n\\min_{P_{\\ell,r} \\in \\Gamma_{\\ell,r}} \\langle P_{\\ell,r}, C_{\\ell,r} \\rangle_F\n\\tag{10.1}\\]\nwhere \\(C_{\\ell,r} \\in \\mathbb{R}^{n \\times n}_+\\) is a spatially constrained cost matrix encoding the physical distances between cells (think: Euclidean distance between any two cells along this 2D plane), and \\(\\Gamma_{\\ell,r}\\) is the set of allowable transport plans:\n\\[\n\\Gamma_{\\ell,r} = \\Big\\{P_{\\ell,r} :  \\sum_{j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}, \\quad \\sum_{i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\\Big\\}\n\\tag{10.2}\\]\nwhere \\(X_{i,\\ell}\\) and \\(X_{j,r}\\) represent the expression levels of the ligand and receptor in the respective cells.1\nGeneralization to multiple ligand-receptor pairs:\nCOMMOT extends the optimal transport framework to simultaneously infer multiple ligand-receptor interactions, rather than treating them separately. This is formulated as a collective optimal transport problem, where multiple ligand and receptor species interact within spatial constraints while competing for signaling resources.\nGiven \\(n_l\\) ligand species and \\(n_r\\) receptor species, the method optimizes a transport plan \\(P \\in \\mathbb{R}^{n_l \\times n_r \\times n \\times n}_+\\), where \\([P_{\\ell,r}]_{k,l}\\) quantifies the signaling strength from sender cell \\(i\\) to receiver cell \\(j\\) through ligand \\(\\ell\\) and receptor \\(r\\). The optimization problem is formulated as:\n\\[\n\\min_{P} \\sum_{(\\ell,r) \\in I} \\langle P_{\\ell,r}, C_{\\ell,r} \\rangle_F + \\rho (\\|\\mu\\|_1 + \\|\\nu\\|_1),\n\\tag{10.3}\\]\nwhere:\n\n\\(C_{\\ell,r} \\in \\mathbb{R}^{n \\times n}_+\\) is a spatial cost matrix encoding distances between cells for ligand-receptor pair \\((\\ell,r)\\),\n\n\\(\\mu_{i,\\ell} = X_{i,\\ell} - \\sum_{r,j} [P_{\\ell,r}]_{i,j}\\) represents the untransported mass of ligand \\(\\ell\\) at sender cell \\(i\\),\n\n\\(\\nu_{j,r} = X_{j,r} - \\sum_{\\ell,i} [P_{\\ell,r}]_{i,j}\\) represents the untransported mass of receptor \\(r\\) at receiver cell \\(j\\).\n\nThe L1 penalty term \\(\\rho (\\|\\mu\\|_1 + \\|\\nu\\|_1)\\), for some tuning parameter \\(\\rho\\), discourages excessive untransported mass, ensuring that ligands and receptors are optimally assigned to communication pathways while allowing some flexibility when spatial constraints prevent full utilization.\nThe feasible transport plans must satisfy:\n\\[\n\\sum_{r,j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}, \\quad \\sum_{\\ell,i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\n\\tag{10.4}\\]\nensuring that transported mass does not exceed ligand and receptor expression levels.\nThis multi-species framework introduces competition between ligand-receptor interactions: when multiple ligands target the same receptor, or when a receptor has limited capacity, the transport plan balances the signaling mass across competing interactions.\n\nJust to give you some examples of what the result of a cell-cell communication analysis for spatial transcriptomics looks like, see Figure 10.37 and Figure 10.38.\n\n\n\n\n\n\n\nFigure 10.37: Left: From He et al. (2024), for the signaling cascade starting from a particular T cell type.\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.38: Right: From H. Li et al. (2024), for the signaling originating from the tumor (“invasive”) to the receiving immune cells that are responding to the tumor.\n\n\n\n\n\n\n\n10.3.4 A brief note on other approaches\nIn a way, cell-cell communication is a particular flavor of spatial co-expression of certain genes (i.e., genes for the ligands and receptors), if you really are going to believe that a high expression of a gene means high abundance of the corresponding ligand or receptor. In this sense, there are many methods that can do cell-cell communication. See SpatialDM Z. Li et al. (2023) as one example for this usage.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#integrationalignment-of-spatial-slices",
    "href": "chapter9_spatial.html#integrationalignment-of-spatial-slices",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.4 Integration/alignment of spatial slices",
    "text": "10.4 Integration/alignment of spatial slices\nIntegration in spatial transcriptomics is essential for ensuring accurate, comprehensive, and biologically meaningful analyses. One of the primary reasons for integration is to rigorously compare data across different donors, similar to batch correction in single-cell RNA sequencing. Variability introduced by differences in sample preparation, sequencing depth, and experimental conditions can obscure true biological signals. By aligning spatial transcriptomics data across donors, researchers can mitigate technical noise and ensure that observed patterns reflect genuine biological variation rather than artifacts of sample processing.\n\nRemark 10.3. We are still far from doing spatial transcriptomics analyses from large cohorts of donors!\nDespite recent advancements in spatial transcriptomics, we are still far from being able to perform large-scale analyses across cohorts of donors. One major limitation is the small size of tissue sections compared to whole-organ imaging modalities like PET, CT, or MRI. Unlike these imaging technologies, which allow for consistent anatomical registration across individuals, spatial transcriptomic data lacks a straightforward way to ensure alignment across different donors. Another fundamental challenge is the invasive nature of tissue collection, requiring surgical procedures that necessitate careful consideration of the timepoints at which samples are obtained. In diseases like neurodegeneration, where disease progression is highly dynamic, comparing spatial transcriptomic profiles across donors is going to make you go crazy. Even if multiple donors contribute tissue from the same anatomical region, variability in disease stage and molecular signaling could make direct comparisons unreliable. You want to say something along the lines of “the spatial signaling dynamics in Alzhemier’s disease is disrupted in this brain region,” but how are you so sure you’re finding similar spatial dynamics across all your donors?\nAdditionally, the cost of generating spatial transcriptomic data remains prohibitively high, limiting large-scale studies.\n\nFortunately, there are two other big reasons to do integrations:\n\nAnother critical application of integration is combining data from different spatial transcriptomics technologies, such as MERFISH and Visium. Each platform has its own strengths—MERFISH provides high-resolution, single-molecule imaging of a limited gene set, while Visium captures genome-wide expression but at lower spatial resolution. By integrating data across these platforms, researchers can leverage the strengths of both, enabling a more complete understanding of cellular organization, gene expression, and interactions within a tissue. This cross-modality alignment allows for deeper biological insights that would be difficult to achieve using a single technology alone.\nIntegration is crucial for constructing three-dimensional spatial transcriptomics datasets from multiple tissue slices. Aligning and stitching tissue slices is essential for constructing three-dimensional molecular profiles.\nSince spatial transcriptomics data is often collected as two-dimensional slices, aligning and stitching these slices together is necessary to reconstruct a holistic, 3D molecular map of a tissue. This process enables researchers to study tissue architecture in its native three-dimensional context, facilitating discoveries about developmental processes, tumor microenvironments, and disease progression. By integrating slices into a unified 3D model, researchers can more accurately analyze spatial relationships between cells, study molecular gradients, and gain a deeper understanding of how cellular interactions shape tissue function.\nSee ?fig-commot-3d and Figure 10.41 as examples.\n\n\n\n\n\n\n\n\nFigure 10.39: Left: From Cang et al. (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.40: Right: From Moffitt et al. (2018)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.41: From Schott et al. (2024)\n\n\n\n\n\n10.4.1 Brief aside: Image registration (in contexts for broader biomedical imaging)\nImage registration is the process of aligning multiple images into a common coordinate system, allowing for meaningful comparisons across different imaging modalities, timepoints, or subjects. In biomedical imaging, registration is widely used in modalities such as MRI, CT, PET, and histological imaging to ensure that anatomical structures from different scans are spatially aligned. This is particularly important when integrating data from different sources, such as aligning a patient’s pre- and post-treatment scans or fusing anatomical (MRI) and functional (PET) imaging for comprehensive analysis.\nRegistration is necessary because biological tissues can exhibit variations due to differences in patient positioning, tissue deformation, or even individual anatomical differences. In neuroimaging, for example, brain MRI scans from different individuals must be warped onto a standardized brain atlas to enable group-level statistical analysis. Similarly, in histopathology, adjacent tissue sections must be aligned to reconstruct a 3D representation of tissue morphology. Without accurate registration, direct comparisons across images would be unreliable, leading to misinterpretations in clinical diagnoses, disease progression studies, and biomarker discovery.\n\n\n\n\n\n\n\nFigure 10.42: From X. Zhang et al. (2019)\n\n\n\n\n\n\n10.4.2 A current choice for aligning slices in spatial transcriptomics: SANTO\nThe SANTO (coarse-to-fine alignment and stitching) H. Li et al. (2024) method aligns two spatial transcriptomics datasets in a two-step process: coarse alignment followed by fine alignment. (We’ll describe this for spot-level data, but this can be used for imaging data once you’ve done a cell segmentation.)\n\n\n\n\n\n\n\nFigure 10.43: From Schott et al. (2024)\n\n\n\n\n\nInput/Output.\nThe input to SANTO is 1) a spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(X \\in \\mathbb{R}^{n_X \\times p}\\) for \\(n_X\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n_X\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n_X\\) cells, and 2) a second spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(Y \\in \\mathbb{R}^{n_Y \\times p}\\) for \\(n_Y\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n_Y\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n_Y\\) cells.\nThe output is a rotated and translated spatial transcriptomics dataset \\(X'\\) where all the expression values among the \\(n_X\\) cells in \\(X\\) are the same, but now there’s a rotation and translation of all the spatial coordinates of these \\(n_X\\) spots to best align with slice \\(Y\\).\n\n\nCoarse alignment:\nSANTO first performs a coarse alignment by rapidly estimating the relative spatial positioning of two slices and identifying their overlapping regions. This is achieved by computing the Pearson Correlation Coefficient (PCC) of shared omics features:\n\\[\n\\text{PCC}(G_{X_i}, G_{Y_j}) = \\frac{\\sum (G_{X_i} - \\bar{G}_X)(G_{Y_j} - \\bar{G}_Y)}{\\sqrt{\\sum (G_{X_i} - \\bar{G}_X)^2 \\sum (G_{Y_j} - \\bar{G}_Y)^2}}\n\\tag{10.5}\\]\nwhere \\(G_{X_i}\\) and \\(G_{Y_j}\\) denote the gene expression vectors of spots \\(i\\) and \\(j\\) in slices \\(X\\) and \\(Y\\), respectively.\nPairs with high PCC scores are used to estimate the transformation matrix via Singular Value Decomposition (SVD):\n\\[\nH = \\sum (S_{X_i} - \\bar{S}_X)(S_{Y_j} - \\bar{S}_Y)^\\top\n\\tag{10.6}\\]\nwhere \\(S_X\\) and \\(S_Y\\) represent spatial coordinates. The optimal rotation matrix \\(R\\) and translation \\(T\\) are computed as \\(R = VU^\\top\\) and \\(T = \\bar{S}_Y - R\\bar{S}_X\\). The new spatial coordinates of \\(S_X\\) then get set to be \\(S_X \\leftarrow RS_X + T\\).\n(You can think of this as: 1) using gene expression in both slides to find pairs of “anchors” (one anchor on each slide), and then 2) using the spatial coordinates of the anchor pairs, finding a shift and a rotation for slide \\(X\\).)\nFine alignment:\nFor fine alignment, SANTO iteratively improves the alignment by a more nuanced approach that accounts for a “soft mapping” between spots in different slices. This is implemented with a Dynamic Graph Convolutional Neural Network (DGCNN).\nDuring training, all the spots are combined into one batch, so if there are \\(n_X\\) spots in slice \\(X\\) and \\(n_Y\\) spots in slice \\(Y\\), both slices are used in the network. The model learns spatial and expression embeddings, computes a probabilistic soft mapping\n\\[\nm(X, Y) = \\text{softmax}(F_Y F_X^\\top)\n\\tag{10.7}\\]\nand uses this to derive \\(X^{(Y)}\\), a “counterpart” slice of \\(X\\) generated via \\(Y\\). The network is trained with a loss function that balances omics similarity and spatial coordinate similarity:\n\\[\n\\mathcal{L} = \\frac{1}{n_X n_Y} \\sum_{\\text{spots } i \\in X} \\underset{j \\in Y}{\\text{softmin}} \\left[ \\alpha (1 - \\text{PCC}(G_{X_i}, G_{Y_j})) + (1-\\alpha) d(S_{X_i}, S_{Y_j}) \\right]\n\\tag{10.8}\\]\nwhere \\(d(S_{X_i}, S_{Y_j})\\) is the Euclidean distance between aligned spots, and \\(\\alpha\\) balances spatial and omics contributions.\n\n\n\n10.4.3 A brief note about other approaches\nYou’ll notice that SANTO did not ever “distort” the spatial coordinates. All it’s really doing is learning a global rotation and translation. If you want to see a procedure that can “shrink” and “stretch” spatial coordinates to better match slices, see STAlign Clifton et al. (2023), which relies on large deformation diffeomorphic metric mapping (LDDMM) (https://en.wikipedia.org/wiki/Large_deformation_diffeomorphic_metric_mapping).\n\n\n\n\nAlmet, Axel A, Zixuan Cang, Suoqin Jin, and Qing Nie. 2021. “The Landscape of Cell–Cell Communication Through Single-Cell Transcriptomics.” Current Opinion in Systems Biology 26: 12–23.\n\n\nArmingol, Erick, Adam Officer, Olivier Harismendy, and Nathan E Lewis. 2021. “Deciphering Cell–Cell Interactions and Communication from Gene Expression.” Nature Reviews Genetics 22 (2): 71–88.\n\n\nCang, Zixuan, Yanxiang Zhao, Axel A Almet, Adam Stabell, Raul Ramos, Maksim V Plikus, Scott X Atwood, and Qing Nie. 2023. “Screening Cell-Cell Communication in Spatial Transcriptomics via Collective Optimal Transport.” Nature Methods, 1–11.\n\n\nChen, Kok Hao, Alistair N Boettiger, Jeffrey R Moffitt, Siyuan Wang, and Xiaowei Zhuang. 2015. “Spatially Resolved, Highly Multiplexed RNA Profiling in Single Cells.” Science 348 (6233): aaa6090.\n\n\nClifton, Kalen, Manjari Anant, Gohta Aihara, Lyla Atta, Osagie K Aimiuwu, Justus M Kebschull, Michael I Miller, Daniel Tward, and Jean Fan. 2023. “STalign: Alignment of Spatial Transcriptomics Data Using Diffeomorphic Metric Mapping.” Nature Communications 14 (1): 8123.\n\n\nDuan, Honglin, Tao Cheng, and Hui Cheng. 2023. “Spatially Resolved Transcriptomics: Advances and Applications.” Blood Science 5 (1): 1–14.\n\n\nFigiel, Sandy, Anthony Bates, David A Braun, Renu Eapen, Markus Eckstein, Brandon J Manley, Matthew I Milowsky, et al. 2024. “Clinical Implications of Basic Research: Exploring the Transformative Potential of Spatial’omics in Uro-Oncology.” European Urology.\n\n\nHartman, Austin, and Rahul Satija. 2024. “Comparative Analysis of Multiplexed in Situ Gene Expression Profiling Technologies.” bioRxiv, 2024–01.\n\n\nHe, Siyu, Yinuo Jin, Achille Nazaret, Lingting Shi, Xueer Chen, Sham Rampersaud, Bahawar S Dhillon, et al. 2024. “Starfysh Integrates Spatial Transcriptomic and Histologic Data to Reveal Heterogeneous Tumor–Immune Hubs.” Nature Biotechnology, 1–13.\n\n\nJin, Suoqin, Christian F Guerrero-Juarez, Lihua Zhang, Ivan Chang, Raul Ramos, Chen-Hsiang Kuan, Peggy Myung, Maksim V Plikus, and Qing Nie. 2021. “Inference and Analysis of Cell-Cell Communication Using CellChat.” Nature Communications 12 (1): 1088.\n\n\nKiessling, Paul, and Christoph Kuppe. 2024. “Spatial Multi-Omics: Novel Tools to Study the Complexity of Cardiovascular Diseases.” Genome Medicine 16 (1): 14.\n\n\nKim, Yoon-Seob, Jinyong Choi, and Sug Hyung Lee. 2023. “Single-Cell and Spatial Sequencing Application in Pathology.” Journal of Pathology and Translational Medicine 57 (1): 43–51.\n\n\nLee, Colin YC, James McCaffrey, Dominic McGovern, and Menna R Clatworthy. 2024. “Profiling Immune Cell Tissue Niches in the Spatial-Omics Era.” Journal of Allergy and Clinical Immunology.\n\n\nLi, Haoyang, Yingxin Lin, Wenjia He, Wenkai Han, Xiaopeng Xu, Chencheng Xu, Elva Gao, Hongyu Zhao, and Xin Gao. 2024. “SANTO: A Coarse-to-Fine Alignment and Stitching Method for Spatial Omics.” Nature Communications 15 (1): 6048.\n\n\nLi, Zhuoxuan, Tianjie Wang, Pentao Liu, and Yuanhua Huang. 2023. “SpatialDM for Rapid Identification of Spatially Co-Expressed Ligand–Receptor and Revealing Cell–Cell Communication Patterns.” Nature Communications 14 (1): 3995.\n\n\nLiao, Jie, Xiaoyan Lu, Xin Shao, Ling Zhu, and Xiaohui Fan. 2021. “Uncovering an Organ’s Molecular Architecture at Single-Cell Resolution by Spatially Resolved Transcriptomics.” Trends in Biotechnology 39 (1): 43–58.\n\n\nLongo, Sophia K, Margaret G Guo, Andrew L Ji, and Paul A Khavari. 2021. “Integrating Single-Cell and Spatial Transcriptomics to Elucidate Intercellular Tissue Dynamics.” Nature Reviews Genetics 22 (10): 627–44.\n\n\nMoffitt, Jeffrey R, Dhananjay Bambah-Mukku, Stephen W Eichhorn, Eric Vaughn, Karthik Shekhar, Julio D Perez, Nimrod D Rubinstein, et al. 2018. “Molecular, Spatial, and Functional Single-Cell Profiling of the Hypothalamic Preoptic Region.” Science 362 (6416): eaau5324.\n\n\nPark, Han-Eol, Song Hyun Jo, Rosalind H Lee, Christian P Macks, Taeyun Ku, Jihwan Park, Chung Whan Lee, Junho K Hur, and Chang Ho Sohn. 2023. “Spatial Transcriptomics: Technical Aspects of Recent Developments and Their Applications in Neuroscience and Cancer Research.” Advanced Science 10 (16): 2206939.\n\n\nRademacher, Anne, Alik Huseynov, Michele Bortolomeazzi, Sina Jasmin Wille, Sabrina Schumacher, Pooja Sant, Denise Keitel, et al. 2024. “Comparison of Spatial Transcriptomics Technologies Using Tumor Cryosections.” bioRxiv, 2024–04.\n\n\nSchott, Marie, Daniel León-Periñán, Elena Splendiani, Leon Strenger, Jan Robin Licha, Tancredi Massimo Pentimalli, Simon Schallenberg, et al. 2024. “Open-ST: High-Resolution Spatial Transcriptomics in 3D.” Cell 187 (15): 3953–72.\n\n\nWilliams, Cameron G, Hyun Jae Lee, Takahiro Asatsuma, Roser Vento-Tormo, and Ashraful Haque. 2022. “An Introduction to Spatial Transcriptomics for Biomedical Research.” Genome Medicine 14 (1): 68.\n\n\nZhang, Meng, Xingjie Pan, Won Jung, Aaron Halpern, Stephen W Eichhorn, Zhiyun Lei, Limor Cohen, et al. 2023. “A Molecularly Defined and Spatially Resolved Cell Atlas of the Whole Mouse Brain.” bioRxiv, 2023–03.\n\n\nZhang, Xinyuan, Yanqiu Feng, Wufan Chen, Xin Li, Andreia V Faria, Qianjin Feng, and Susumu Mori. 2019. “Linear Registration of Brain Mri Using Knowledge-Based Multiple Intermediator Libraries.” Frontiers in Neuroscience 13: 909.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#footnotes",
    "href": "chapter9_spatial.html#footnotes",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "The first constraint \\(\\sum_{j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}\\) says, “Given that cell \\(i\\) has this much expression of ligand \\(\\ell\\), it should not be sending more than \\(X_{i,\\ell}\\) to all the other \\(n\\) cells.” The second constraint \\(\\sum_{i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\\) says, “Given that cell \\(j\\) has this much expression of receptor \\(r\\), it should not be receiving more than \\(X_{j,r}\\) from all the other \\(n\\) cells.”↩︎",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  }
]