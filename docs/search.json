[
  {
    "objectID": "chapter3_rna.html",
    "href": "chapter3_rna.html",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "4.1 Some important nouns and verbs",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter3_rna.html#some-important-nouns-and-verbs",
    "href": "chapter3_rna.html#some-important-nouns-and-verbs",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "Sequencing (verb): The process of determining the order of nucleotides (A, T, C, G) in a DNA or RNA molecule, providing the primary structure of these biomolecules. Sequencing technologies have evolved to be high-throughput, enabling the analysis of entire genomes or transcriptomes.\nSequencing depth, read depth, library size (noun; all synonyms): These terms refer to the number of times a specific nucleotide or region of the genome is sequenced in an experiment. Greater depth provides more accurate detection of rare variants or lowly expressed genes but requires increased computational and financial resources.\nChromosome, DNA, RNA, protein (noun):\n\nChromosome: A large, organized structure of DNA and associated proteins that contains many genes and regulatory elements.\n\nDNA: The molecule that encodes genetic information in a double-helical structure.\n\nRNA: A single-stranded molecule transcribed from DNA that can act as a messenger (mRNA), a structural component (rRNA), or a regulator (e.g., miRNA). When we talk about scRNA-seq, we are usually referring to exclusively measuring mRNA.\n\nProtein: The functional biomolecule synthesized from RNA via translation, performing structural, enzymatic, and regulatory roles in cells.\n\nGenome vs. gene vs. intergenic region (noun):\n\nGenome: The complete set of DNA in an organism, encompassing all of its genetic material, including coding genes, non-coding regions, and regulatory elements. The genome is the blueprint that defines the biological potential of the organism.\n\nGene: A specific sequence within the genome that encodes a functional product, typically a protein or functional RNA. Genes include regions such as exons (coding sequences), introns (non-coding regions within a gene), and regulatory sequences (e.g., promoters and enhancers) that control gene expression. We will see more about the architecture of a gene in Section 7.1.\n\nIntergenic region: The stretches of DNA between genes that do not directly code for proteins or RNA. Intergenic regions were once considered “junk DNA,” but they often contain regulatory elements, such as enhancers and silencers, that influence the expression of nearby or distant genes. These regions also play roles in chromatin organization and genome stability.\n\nGenetics vs. genomics (noun): Genetics typically focuses on the role of the DNA among large populations (of people, of species, etc.), while genomics can encapsulate any omic, and does not necessarily imply studies across a large population1.\n“Next generation sequencing” (noun)2: A collection of high-throughput technologies that allow for the parallel sequencing of millions of DNA or RNA molecules. It has revolutionized biology by enabling large-scale studies of genomes, transcriptomes, and epigenomes.\nRead fragment (noun): A short sequence of DNA or RNA produced as an output from high-throughput sequencing. Fragments are typically between 50 bp and 300 bp long, depending on the sequencing technology, and they represent segments of the original molecule being sequenced.\nReference genome (noun): A curated, complete assembly of the genomic sequence for a species, used as a template to align and interpret sequencing reads. It serves as a baseline for identifying genetic variations, such as mutations or structural changes, and for annotating functional elements.\nCoding genes vs. non-coding genes (noun):\n\nCoding genes: Genes that contain instructions for producing proteins. They are transcribed into mRNA, which is then translated into functional proteins that perform structural, enzymatic, or regulatory roles in cells.\n\nNon-coding genes: Genes that do not produce proteins but instead generate functional RNA molecules, such as rRNA, tRNA, miRNA, or lncRNA, which regulate gene expression, maintain genomic stability, or perform other cellular functions. Non-coding genes highlight the complexity of gene regulation and cellular processes beyond protein synthesis.\n\nEpigenetics vs. epigenomics (noun): Epigenetics studies modifications to DNA and histones (e.g., methylation, acetylation) that regulate gene expression without altering the DNA sequence. Epigenomics examines these modifications across the entire genome.\nTranscriptome (noun): The complete set of RNA transcripts expressed in a cell or tissue at a given time, reflecting dynamic gene activity.\nProteome (noun): The full complement of proteins expressed in a cell, tissue, or organism, representing functional output.\nSingle-cell sequencing (noun): Sequencing technologies applied at the resolution of individual cells, allowing for the study of heterogeneity in gene expression, epigenetics, or genetic variation across cell populations.\nBulk sequencing (noun): Sequencing technologies that aggregate material (e.g., RNA, DNA) from many cells, providing an average profile of the population but masking individual cell variability.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter3_rna.html#footnotes",
    "href": "chapter3_rna.html#footnotes",
    "title": "4  Single-cell RNA-sequencing",
    "section": "",
    "text": "Technically, genomics (as a field) is a broader categorization and encapsulates genetics. But usually when people say they work on “genomics,” they are colloquially implying they work on biology that is not genetics (otherwise, they usually say they’re a geneticist).↩︎\nThis term is not very often used anymore. It was an umbrella label popularized in the mid-2000s. We instead typically refer to a more specific category of technology. For example, most of the data in this scRNA-seq chapter are referred to as “short-read 3′ single-cell RNA-sequencing.” (You could throw in “droplet-based” and “UMI” to be even more precise, but that’s usually not needed in most casual contexts.)↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Single-cell RNA-sequencing</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html",
    "href": "chapter7_crispr.html",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "8.1 Basics of how CRISPR works\nThe CRISPR-Cas system1 is a powerful genome-editing technology that allows for precise modifications of DNA in a wide range of biological systems. Originally derived from the bacterial adaptive immune system, CRISPR-Cas9 has been repurposed for genetic engineering by using a guide RNA (gRNA) to direct the Cas9 nuclease to a specific genomic locus for targeted DNA cleavage. This section discusses how CRISPR is performed in the wet lab, different functional applications of CRISPR, and how CRISPR-based perturbations are analyzed in single-cell gene expression studies.\nIn a typical CRISPR screen experiment (mainly a CRISPR knockout), a library of lentivirus-packaged guide RNAs is introduced into cells under conditions designed to infect each cell with only one or a few sgRNAs (single guide RNA), see Figure 8.1 and Figure 8.2. After selection to ensure stable integration, the cells are subjected to a particular stimulus such as drug treatment or other environmental challenge. Researchers then track the abundance of each sgRNA at the start and after the stimulus (for example, at day 0 and day 28) through next-generation sequencing. By comparing which sgRNAs become enriched or depleted, it is possible to discover genes essential for viability, pathways governing drug resistance, or other critical biological functions relevant to the phenotype under study, see Figure 8.3.\nTypical components of a CRISPR mechanism.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#sec-chapter_7_basics",
    "href": "chapter7_crispr.html#sec-chapter_7_basics",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "Figure 8.1: Original from Wei et al. (2019), but this is directly from https://www.youtube.com/watch?v=JdCCl1uxCME.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.2: From https://www.idtdna.com/pages/education/decoded/article/overview-what-is-crispr-screening.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.3: From Esposito et al. (2019).\n\n\n\n\n\n\nCas9 protein: A DNA endonuclease that recognizes and cuts target DNA specified by the guide RNA; variations include nuclease-deactivated (dCas9) or nickase Cas9 for alternative applications. Other CRISPR-associated proteins like Cas12a (Cpf1), Cas13, or dCas9 (dead Cas9) can expand the range of target sequences, have different PAM requirements, or allow for gene regulation without cutting DNA.\nCas9 may bind sites with partial sequence complementarity, resulting in unintended cuts — this is called “off-target effects.” Various strategies (e.g., high-fidelity Cas9 variants, improved gRNA design) help minimize these effects.\nGuide RNA (gRNA): A customizable RNA sequence that directs Cas9 to the desired genomic locus; variations include single-guide RNA (sgRNA) and dual-RNA formats depending on the experimental design.\nTo streamline CRISPR-Cas9 applications in genetic engineering, scientists have designed a synthetic fusion of crRNA and tracrRNA into a single-guide RNA (sgRNA). This chimeric RNA retains both the target-specific recognition (crRNA component) and Cas9-binding function (tracrRNA component) but simplifies the system by reducing the number of necessary molecules. sgRNAs are commonly used in research and therapeutic applications due to their ease of design and efficiency in genome editing.\n\ncrRNA (CRISPR RNA): A short RNA sequence that is complementary to the target DNA and provides sequence specificity for Cas9 binding. This is typically 20 nucleotides long.\n\ntracrRNA (Trans-activating CRISPR RNA): A structural RNA that base-pairs with the crRNA and interacts with Cas9 to activate its nuclease function.\n\nIn this system, the crRNA and tracrRNA must form a duplex to guide Cas9 to the target sequence, which then leads to DNA cleavage.\nMultiple guide RNAs can be delivered simultaneously to target different loci at once, enabling complex genome-scale screens or combinatorial gene perturbations. Computational tools help optimize sgRNA sequences to maximize on-target efficiency while minimizing off-target effects. Chemically modified guide RNAs can improve stability and efficiency in vivo.\nPAM (Protospacer Adjacent Motif): A short DNA sequence adjacent to the target region that is essential for Cas9 to recognize and bind to DNA. The PAM sequence is typically “NGG” (where “N” represents any nucleotide, and “GG” is required). Without the correct PAM sequence, Cas9 cannot efficiently bind or cut the DNA, ensuring some level of specificity in genome editing. Different Cas9 variants have evolved or been engineered to recognize alternative PAM sequences, which offer broader targeting possibilities with reduced off-target effects. The cut typically happens 3 base-pairs upstream of the PAM on the target strand (i.e., in the 5′ direction).\nLentivirus: Lentiviruses are widely used as viral vectors for delivering CRISPR components into cells (variations include different promoters, packaging systems, and envelope proteins to optimize transduction efficiency), particularly for experiments requiring stable and long-term expression of Cas9 and guide RNAs. Since many cell types are difficult to transfect using conventional methods, lentiviral transduction provides an efficient way to introduce CRISPR machinery into a broad range of cell types, including non-dividing and primary cells.\nWhat is delivered to cells? (See Figure 8.4 for the construction and architecture of the lentiviral vector.)\n\nCas9 expression construct: A lentiviral vector encoding the Cas9 nuclease under a suitable promoter. In some systems, inducible promoters (e.g., doxycycline-inducible) are used to control Cas9 activity.\n\nGuide RNA (gRNA) expression construct: A separate lentiviral vector encoding the guide RNA sequence under a promoter to ensure efficient transcription.\n\nSelection markers: Often, antibiotic resistance genes or fluorescent markers are included to facilitate selection of successfully transduced cells.\n\nLentiviral delivery is essential for CRISPR applications due to its ability to stably integrate into the host genome, ensuring long-term expression of Cas9 and guide RNAs. This stability is particularly advantageous for genome-wide CRISPR knockout screens and lineage-tracing experiments. Additionally, many cell types, such as primary cells, stem cells, and immune cells, are notoriously difficult to transfect2; lentiviral transduction provides a more efficient and reliable alternative. See Figure 8.7 for how the gRNA can be injected into the cell, or if it’s integrated into the DNA, how it “borrows” the cell’s transcriptional machinery.\n\n\n\n\n\n\n\n\nFigure 8.4: (Top) From Khan et al. (2022).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.5: (Bottom left) https://bpsbioscience.com/pd-1-crispr-cas9-lentivirus-integrating-78052.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.6: (Bottom right) From Mao, Botella, and Zhu (2017).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.7: (Left) https://www.benchling.com/blog/how-to-synthesize-your-grnas-for-crispr.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.8: (Right) https://bpsbioscience.com/lentiviruses?product_type_filter=5567.\n\n\n\n\n\n8.1.0.1 A bit about the mechanism of double-stranded DNA cleavage by Cas9 in a CRISPR knockout.\nCas9-mediated DNA cleavage occurs in several distinct steps. The Cas9 scans the genome for a matching PAM sequence. Once a PAM is identified, the guide RNA (gRNA) pairs with the complementary DNA strand. The actual cleavage of DNA is catalyzed by two distinct nuclease domains within Cas9: the RuvC domain, which cuts the non-complementary (non-target) DNA strand, and the HNH domain, which cuts the complementary (target) strand. These coordinated cleavages result in a double-strand break (DSB), typically occurring 3-4 nucleotides upstream of the PAM sequence. This precise cleavage mechanism allows for highly specific genome modifications.\nOnce the double-strand break is generated, the cell must repair the damage. The two primary DNA repair mechanisms are Non-Homologous End Joining (NHEJ) and Homology-Directed Repair (HDR). NHEJ is the default repair pathway in most cells and often introduces small insertions or deletions (indels) at the cut site, leading to gene disruptions. HDR, on the other hand, allows for precise DNA modifications when a donor DNA template is provided, making it a key mechanism for precise genome editing. Understanding the role of PAM sequences and the cleavage process is critical for designing effective CRISPR-based genetic modifications.\nSee Figure 8.9 for variations of a CRISPR screen. What we’re discussing more in this chapter is a pooled CRISPR screen.\n\n\n\n\n\n\n\nFigure 8.9: From Bock et al. (2022). Note: Not all CRISPR screens are necessarily at the single-cell level, and it’s possible that no “gene expression” is measured. In the simplest CRISPR analyses, you are simply counting which gRNAs are most enriched (across the entire petri dish) after applying a stress to the cells.\n\n\n\n\n\n\n8.1.1 CRISPR in the wet lab: Design and delivery\nCRISPR experiments begin with the design of a single-guide RNA (sgRNA) that matches the target DNA sequence adjacent to a protospacer-adjacent motif (PAM), which is required for Cas9 recognition and cleavage. The choice of target site is crucial, as off-target effects can lead to unintended mutations. Computational tools such as CRISPOR (Concordet and Haeussler 2018) help predict sgRNA efficiency and minimize off-target binding.\nOnce the sgRNA is designed, it must be delivered into cells alongside the Cas9 enzyme. This can be achieved, such as using viral vectors such as lentivirus. Viral delivery is particularly useful for stable genome integration in cell populations, while other transient delivery methods allow for temporary gene editing effects. The choice of delivery method depends on the cell type, efficiency, and experimental goals. In single-cell studies, lentiviral vectors are often used to introduce a pooled library of sgRNAs, enabling large-scale CRISPR screens across thousands of individual cells.\n\n8.1.1.1 Commonly used cells.\nK562 cells, a human myelogenous leukemia cell line, are widely used in CRISPR screens due to their ease of culture, high transfection efficiency, and well-characterized genome. These cells exhibit an undifferentiated hematopoietic phenotype, making them a valuable model for studying gene regulation, hematopoiesis, and drug resistance. Their high proliferative capacity and ability to grow in suspension allow for efficient perturbation experiments at scale. Additionally, K562 cells have been used extensively in studies involving transcriptional regulation due to their rich chromatin accessibility data from ENCODE, which facilitates the identification of enhancer-gene interactions.\nAnother one I’ve seen quite often is Jurkat cells. This is a human T-cell leukemia cell line that serves as a model for immunology and T-cell signaling studies, often used in CRISPR screens focused on immune response and checkpoint regulation.\nWhile CRISPR screens are widely applied in established cell lines, extending them to other cell types requires careful experimental planning. Primary cells and non-transformed cell types often have lower transfection or transduction efficiencies, necessitating optimization of delivery methods such as electroporation or viral transduction. Additionally, cell-type-specific chromatin accessibility and DNA repair mechanisms can influence CRISPR efficiency and editing outcomes, requiring tailored guide RNA design and validation. Growth rate and population doubling time must also be considered, as slow-dividing or non-dividing cells may require prolonged selection periods or alternative screening strategies, such as inducible CRISPR systems. Finally, proper negative controls and lineage-specific reference datasets are critical to ensure accurate interpretation of perturbation effects in novel cellular contexts. While most CRISPR screens are done in vitro, there are also technical challenges (which can be controlled for) for in vivo systems, see Figure 8.10.\n\n\n\n\n\n\n\nFigure 8.10: From Kuhn, Santinha, and Platt (2021).\n\n\n\n\n\n\n\n8.1.2 The jungle of CRISPR: CRISPR-KO, CRISPRi, and CRISPRa\nCRISPR can be adapted for different functional purposes beyond simple gene knockout (KO). CRISPR-knockout (CRISPR-KO) involves the use of Cas9 to introduce double-stranded breaks at the target locus, leading to insertions or deletions (indels) that disrupt gene function, which is mainly what we’ve discussed above. This method is widely used for loss-of-function studies to investigate gene essentiality and pathway regulation.\nIn contrast, CRISPR activation (CRISPRa) and CRISPR interference (CRISPRi) enable gene expression modulation without altering the DNA sequence. CRISPRa employs a catalytically inactive Cas9 (dCas9) fused to transcriptional activators to enhance gene expression. Conversely, CRISPRi uses dCas9 fused to repressive domains such as KRAB to inhibit transcription. These methods allow for fine-tuned control over gene expression levels, making them particularly useful for studying gene regulatory networks at the single-cell level.\nSee Figure 8.11 and Figure 8.12 for examples of variations of CRISPR screens.\n\n\n\n\n\n\n\nFigure 8.11: From Esposito et al. (2019).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.12: From Bock et al. (2022).\n\n\n\n\n\n\n8.1.3 CRISPR screens and single-cell gene expression analysis\nCRISPR screening is a high-throughput approach that uses pooled single-guide RNA (sgRNA) libraries to systematically perturb thousands of genes in a single experiment. There are two main types of CRISPR screens: positive selection screens, which identify sgRNAs that promote cell survival or proliferation, and negative selection screens, which identify essential genes by tracking sgRNAs that are depleted over time. When combined with single-cell RNA sequencing (scRNA-seq), CRISPR screens can reveal gene regulatory interactions at the resolution of individual cells, enabling functional genomics studies at an unprecedented scale. See Figure 8.13 for the bulk-level analysis that does not include RNA-sequencing – this is to give you a sense of the simplistic CRISPR analysis.\n\n\n\n\n\n\n\nFigure 8.13: From Bock et al. (2022). This is an example of a bulk-level analysis that does not include RNA-sequencing.\n\n\n\n\nTo analyze CRISPR perturbations in a single-cell context, cells are first transduced with a pooled sgRNA library, followed by scRNA-seq to capture transcriptomic changes. The identity of the sgRNA in each cell must also be determined in order to link gene perturbations to expression changes. This is typically done through targeted sequencing of the sgRNA cassette embedded in the transcriptome. However, sequencing the guide RNAs presents a challenge because they lack poly-A tails, which are typically required for capture in common scRNA-seq protocols. To overcome this, specialized methods such as Perturb-seq (Dixit et al. 2016) and CROP-seq (Datlinger et al. 2017) incorporate modifications to ensure efficient capture of sgRNA sequences. For example, Perturb-seq integrates the sgRNA into a polyadenylated transcript, allowing it to be captured along with mRNA molecules during reverse transcription.\nComputational tools, which we will discuss in Section 8.2, are commonly used to analyze CRISPR screen data by linking sgRNA-induced perturbations to gene expression changes. These tools help identify differentially expressed genes in response to specific genetic perturbations, revealing functional interactions within cellular networks. By combining CRISPR-based gene perturbation with single-cell transcriptomics, researchers can systematically dissect gene function, uncover regulatory networks, and study cellular heterogeneity in response to genetic modifications.\n\n\n8.1.4 Interpreting CRISPR data and experimental considerations\nCRISPR datasets in single-cell studies typically consist of expression matrices where each row corresponds to a gene and each column represents a cell, with additional metadata indicating the sgRNA assigned to each cell. One key challenge in analyzing these datasets is ensuring that each cell receives a single sgRNA, as multiple perturbations can introduce confounding effects. Additionally, technical noise in single-cell RNA sequencing, such as dropout events and variability in sequencing depth, must be accounted for in downstream analyses.\nWhile CRISPR has revolutionized functional genomics, several caveats remain. Off-target effects can complicate result interpretation, requiring careful validation with orthogonal approaches such as RNA interference (RNAi) or small molecule inhibitors. Moreover, certain genes may be difficult to perturb due to low sgRNA efficiency or compensation from redundant pathways.\n\n8.1.4.1 More considerations and readings about CRISPR.\nSee Bock et al. (2022) for an important checklist (Box 1) to give you a sense the complexities when setting up a CRISPR experiment. Also, keep in mind that many CRISPR experiments are not measuring single-cell gene expressions. However, also (as mentioned above), there are also many CRISPR protocols to measure various omics at single-cell resolution alongside the gRNAs, see Figure 8.14.\n\n\n\n\n\n\n\nFigure 8.14: From Cheng et al. (2023).\n\n\n\n\nFor more reading: - https://www.idtdna.com/pages/education/decoded/article/overview-what-is-crispr-screening is probably one of the most helpful webpages I came across.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#sec-chapter_7_link",
    "href": "chapter7_crispr.html#sec-chapter_7_link",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.2 Linking gRNA (i.e., perturbations) to its downstream genes",
    "text": "8.2 Linking gRNA (i.e., perturbations) to its downstream genes\nUnderstanding the causal relationships between genetic perturbations and gene expression changes is a fundamental problem in genomics. Single-cell CRISPR screening technologies enable high-throughput profiling of transcriptomic changes induced by targeted genetic modifications at a single-cell resolution. The goal of the statistical analysis here is to identify genes whose expression levels are significantly altered by specific perturbations, providing insights into gene regulatory networks and functional genomics. However, accurately estimating these effects requires sophisticated statistical methodologies that can properly account for measurement noise, technical confounders, and the stochastic nature of gene expression.\nA prototypical statistical model for this analysis is based on a generalized linear model (GLM) or a negative binomial regression framework, where gene expression levels are modeled as a function of perturbation status, along with potential confounders such as sequencing depth, batch effects, and cellular state, see Figure 8.15. Here are some statistical challenges a typical statistical method might account for:\n\nInferring which cells got which perturbation: Given that perturbations are not directly observed but inferred through guide RNA (gRNA) expression, a crucial modeling step involves using a measurement error framework or latent variable model to impute perturbation identities. The presence of background noise in gRNA detection complicates direct classification of perturbed versus unperturbed cells. See Figure 8.16.\nAccount for unmeasured confounders: Variations in sequencing efficiency or cell cycle effects (i.e., unmeasured biological processes that affect both the guide RNA and gene expression) can introduce spurious associations between perturbations and gene expression if not properly adjusted\n\nFortunately, one experimental consideration we can use to advantage are negative control perturbations – perturbations that target non-functional genomic regions. These provide a null distribution against which true perturbation effects can be compared. Certain methods can use the negative controls to calibrate the p-values, while others use the negative controls to validate their control of false discovery rates.\n\n\n\n\n\n\n\nFigure 8.15: From J. L. Zhou et al. (2024).\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.16: From Barry, Roeder, and Katsevich (2024).\n\n\n\n\nThe goal of this analysis is produce a p-value for every sgRNA (targeting an enhancer) and gene pair. This is often visualized a QQ-plot, shown in Figure 8.17.\n\n\n\n\n\n\n\nFigure 8.17: From Barry et al. (2021). All the points here are negative controls, meaning we do not expect biologically that the sgRNA should affect the gene. (Again, each point is a pair of sgRNA and gene.) Hence, a “good” result is one where all the p-values fall on the diagonal line (i.e., the expected quantiles of the null p-values match the observed quantiles).\n\n\n\n\n\n8.2.0.1 A typical choice: SCEPTRE.\nSCEPTRE (Barry et al. 2021) (Analysis of single-cell perturbation screens via conditional resampling) is a statistical method designed to analyze gene-gRNA associations in single-cell CRISPR screens. It distinguishes true regulatory relationships from spurious ones by properly accounting for confounding technical factors and by circumventing strict parametric assumptions.\n\nInput/Output. The input to SCEPTRE is a 1) single-cell gene expression count matrix \\(Y\\in \\mathbb{Z}_+^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, and 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(X \\in \\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations. The output is a pairing between certain \\(k\\) perturbations and \\(p\\) genes (not necessarily one-to-one) with associated p-values. We can screen these p-values for significant ones after multiple-testing correction to determine which perturbations are associated (but not necessarily statistically causal in this method) with which genes.\n\n\nAre the guide RNAs measured as binary or counts?\nSCEPTRE “thresholds” the gRNA count matrix to be a binary matrix (i.e., which cells received which perturbation). However, in reality, this information is itself sequenced and can be noisy. The authors then wrote a follow-up paper called GLM-EIV (Barry, Roeder, and Katsevich 2024) to further account for this.\n\nWe describe the main components of SCEPTRE below. See Figure 8.18 for an illustration of this method.\n\nInput Data. Let \\(n\\) be the number of cells, \\(p\\) the number of genes, and \\(k\\) the number of gRNAs. The gene expression data can be represented by an \\(n \\times p\\) matrix, where each entry \\(Y_{ij}\\) is the observed count (for instance, UMI count) of gene \\(j\\) in cell \\(i\\). The gRNA detection data can be represented by an \\(n \\times d\\) binary matrix, where each entry \\(X_{ik}\\) indicates whether gRNA \\(k\\) was observed in cell \\(i\\) (commonly treated as a binary indicator). In addition, each cell \\(i\\) has a vector of technical covariates \\(Z_i \\in \\mathbb{R}^r\\) (for instance, capturing batch, sequencing depth, or other factors). These covariates are crucial, as they can affect both the probability of detecting a given gRNA and the observed gene expression counts.\nNegative Binomial Expression Model. To test the association between a particular gene \\(j\\) and gRNA \\(k\\) (typically within 1 Mb apart), consider one-dimensional slices \\(Y_i\\) and \\(X_i\\), denoting that cell \\(i\\) has count \\(Y_i\\) for gene \\(j\\) and \\(X_i \\in \\{0,1\\}\\) for gRNA \\(k\\). A typical regression model is\n\n\\[\nY_i \\sim \\mathrm{NegBin}(\\mu_i, \\alpha),\n\\quad\n\\log(\\mu_i) = \\beta_0 + \\beta \\, X_i + \\gamma^\\top Z_i,\n\\]\nwhere \\(\\alpha\\) is a dispersion parameter, \\(\\beta\\) measures how the presence of the gRNA (\\(X_i\\)) shifts the mean expression \\(\\mu_i\\), and \\(\\gamma\\) captures the effect of the technical covariates. Fitting this negative binomial regression provides a test statistic, for example a \\(z\\)-score \\(T = \\beta / \\text{SE}(\\beta)\\), that quantifies the strength of the association between \\(X_i\\) and \\(Y_i\\).\n\nLogistic Model for gRNA Detection. A key insight in SCEPTRE is that \\(X_i\\) itself is subject to measurement variability and is influenced by the same covariates \\(Z_i\\). This can be modeled via\n\n\\[\n\\pi_i = P(X_i = 1 \\mid Z_i),\n\\quad\n\\log\\!\\Bigl(\\frac{\\pi_i}{1 - \\pi_i}\\Bigr)\n= \\tau_0 + \\tau^\\top Z_i.\n\\]\nFitting this logistic model to the observed gRNA indicators provides estimated probabilities \\(\\hat{\\pi}_i\\) for each cell.\n\nConditional Resampling. SCEPTRE constructs an empirical null distribution by repeatedly resampling “fake” gRNA indicators \\(\\tilde{X}_i\\) in each cell, drawn independently from \\(\\mathrm{Bernoulli}(\\hat{\\pi}_i)\\). In each resampled dataset, one holds \\(Y_i\\) and \\(Z_i\\) fixed but replaces the original \\(X_i\\) with \\(\\tilde{X}_i\\). For each resample, one refits the negative binomial regression (using an efficient shortcut) to compute a new test statistic \\(\\tilde{T}\\). The empirical distribution of these \\(\\tilde{T}\\) values represents how the test statistic would behave under the null hypothesis (no real regulatory effect) but with confounders preserved. The SCEPTRE \\(p\\)-value compares the actual test statistic \\(T\\) against this resampling-based distribution, thus ensuring valid inference even if the negative binomial model for \\(Y_i\\) is not perfectly specified.\n\nThis is a common statistical trick. Essentially, the idea is: we constructing “fake” gRNA data that accounts for the technical factors but we are guaranteed to not relate to gene expression (thanks to how we sampled this fake data). Then, we can use this “fake” data to see what the typical estimated relation between the gRNA and gene is. We deem a gRNA and gene as a significant pair if the estimated relation is stronger than this “fake” distribution.\n\n\n\n\n\n\n\nFigure 8.18: From Barry et al. (2021).",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#estimating-gene-pathways-impacted-by-a-group-of-perturbations",
    "href": "chapter7_crispr.html#estimating-gene-pathways-impacted-by-a-group-of-perturbations",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.3 Estimating gene pathways impacted by a group of perturbations",
    "text": "8.3 Estimating gene pathways impacted by a group of perturbations\nUnderstanding the impact of CRISPR-based genetic perturbations on gene expression requires methods that can accurately capture coordinated transcriptional responses. Rather than affecting single genes in isolation, many perturbations influence entire regulatory networks or gene modules. Grouping genes and guide RNAs (gRNAs) into functional modules provides a structured framework to infer how perturbations propagate through cellular pathways, enhancing the ability to detect meaningful biological signals. See Dixit et al. (2016) and Schnitzler et al. (2024) for analyses that performed this type of analysis.\nBiologically, grouping genes into modules is motivated by the observation that genetic perturbations often target key regulatory elements such as transcription factors, chromatin remodelers, or signaling pathway components. These elements control multiple downstream genes, making it crucial to infer their collective effects rather than analyzing genes independently. Single-cell CRISPR screens allow for the systematic interrogation of gene regulatory networks, but sparsity in the data and limited per-perturbation cell numbers necessitate statistical techniques that integrate information across functionally related genes. Here are some statistical challenges (very similar to the ones introduced in Section 8.2).\n\nSparse and noisy guides: Perturbation effects are often sparse, meaning that each perturbation affects only a subset of genes, necessitating regularized models that can extract meaningful structure from noisy data. Also, single-cell CRISPR screens require inference of perturbation identities, as not all cells successfully receive a gRNA, and sequencing-based methods introduce detection noise.\nUnmeasured confounders: Batch effects, cell cycle states, and sequencing depth variations, can obscure true biological signals, making it essential to employ factor models that account for these sources of variability.\nHigher MOI for cheaper sequencing costs: A complexity arises when analyzing interactions between perturbations. Many CRISPR screens employ pooled designs where multiple perturbations may be present within the same cell. This can introduce nonlinear effects or epistatic interactions, where the combined influence of two perturbations deviates from the sum of their individual effects. See Yao et al. (2024) and Lin et al. (2022) for some examples of this.\n\n\n8.3.0.1 A current choice: GSFA.\nGuided Sparse Factor Analysis (GSFA) (Y. Zhou et al. 2023) is a Bayesian approach to analyze single-cell CRISPR screens, where multiple genetic perturbations (gRNAs) and whole-transcriptome gene expression are measured across individual cells. Below is a concise description of its components, using more detailed notation. (There is no commonly agreed upon method for this analysis at this time. You should think of GSFA as a promising start of a sequence of research. Future methods might account for guide RNA efficiency, non-additive effects, bioinformatics between guide RNA and target genes, etc.)\n\nInput/Output. The input to GSFA is a 1) single-cell gene expression count matrix \\(Y\\in \\mathbb{R}^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, and 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(G \\in \\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations. Here, \\(Y_{ij}\\) is the normalized expression of gene \\(j\\) in cell \\(i\\). The output of GSFA are: 1) a matrix \\(W \\in \\mathbb{R}^{p \\times k}\\) that denotes which genes is in which module (i.e., latent factor), and 2) a matrix \\(\\beta \\in \\mathbb{R}^{d \\times k}\\) that denotes which perturbation is in which module.\n\nWe describe the main components of GSFA below. See Figure 8.19 for an illustration of this method.\n\n\n\n\n\n\n\nFigure 8.19: From Y. Zhou et al. (2023).\n\n\n\n\n\nNested matrix factorization model: GSFA decomposes the expression matrix into latent factors \\(Z\\) and gene loadings \\(W\\), while modeling how these factors depend on \\(G\\):\n\n\\[\n\\underbrace{Y_{ij}}_{\\text{Expression}}\n=\n\\sum_{\\ell=1}^k Z_{i\\ell}\\,W_{j\\ell}\n+\nE_{ij},\n\\qquad\n\\underbrace{Z_{i\\ell}}_{\\text{Factors}}\n=\n\\sum_{m=1}^d G_{im}\\,\\beta_{m\\ell}\n+\n\\phi_{i,k}.\n\\]\nHere, \\(k\\) is the number of latent factors, \\(E_{ij}\\) is residual noise (often assumed Gaussian), and \\(\\phi_{i\\ell}\\) is a Gaussian random term that captures variation in factor \\(\\ell\\) not explained by perturbations. The factors \\(Z_{i\\ell}\\) can be interpreted as “gene modules” or “principal axes” of variation in the single-cell data.\n\nSparse priors and Bayesian inference: Each perturbation \\(m\\) is assumed to affect only a few latent factors, reflected in a sparse prior on the effect sizes \\(\\beta_{m\\ell}\\). Similarly, each factor \\(\\ell\\) is assumed to influence only a small subset of genes, reflected in a sparse prior on \\(W_{j\\ell}\\). These priors impose the idea that genetic perturbations typically alter only a limited set of biological pathways. GSFA uses Gibbs sampling to draw from the posterior distributions of \\(\\beta_{m\\ell}\\), \\(W_{j\\ell}\\), and \\(Z_{i\\ell}\\) given the observed data \\((Y, G)\\).\nFactor association: Once \\(Z\\) and \\(\\beta\\) are estimated, GSFA identifies which gRNAs significantly shift which factors. The parameter \\(\\beta_{m\\ell}\\) measures how strongly perturbation \\(m\\) activates or represses factor \\(\\ell\\). Posterior inclusion probabilities (PIPs) are computed to assess confidence in each \\(\\beta_{m\\ell}\\) being nonzero.\nGene-level effects: GSFA also summarizes the overall impact of perturbation \\(m\\) on gene \\(j\\). Since perturbation \\(m\\) can affect multiple factors, and each factor influences the expression of gene \\(j\\), the total effect is\n\n\\[\n\\theta_{mj}\n=\n\\sum_{\\ell=1}^k \\beta_{m\\ell}\\,W_{j\\ell}.\n\\]\nThe distribution of \\(\\theta_{m,j}\\) is sampled under the model’s posterior, yielding an LFSR (local false sign rate) that quantifies significance and sign confidence of the perturbation’s effect on that gene.\nIn practice, GSFA is applied to single-cell CRISPR screen data as follows. First, one often transforms count data (for example, via deviance residuals) and centers/scales covariates. Next, one fits GSFA via Gibbs sampling, obtaining posterior samples of the factors, gene loadings, and perturbation-factor effects. The factor discovery step can reveal broad biological modules (cell-cycle, immune response, neuronal development, etc.), while the gene-level effect summaries \\(\\theta_{mj}\\) yield a differential expression–style list of significantly perturbed genes for each gRNA. By borrowing information across genes that move together, GSFA can be more sensitive than a naive single-gene test, and can better separate real signals from confounding or measurement noise.\n\n\n8.3.0.2 A brief note about other work.\nSchnitzler et al. (2024) demonstrates using CRISPR to link SNPs in a GWAS to the regulated genes. (This paper also mentions a consensus NMF, which illustrates a different variation of clustering genes by regulatory pathways.) Yao et al. (2024) demonstrates a method to “unravel” the effect of each perturbation on genes in high MOI experiments, where there are multiple perturbations purposely placed in cell, or multiple cells purposely placed in each droplet.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#prediction-perturbation-effects-for-crispr-screens-but-other-types-of-perturbations-as-well",
    "href": "chapter7_crispr.html#prediction-perturbation-effects-for-crispr-screens-but-other-types-of-perturbations-as-well",
    "title": "8  Single-cell CRISPR editting",
    "section": "8.4 Prediction perturbation effects (for CRISPR screens, but other types of perturbations as well)",
    "text": "8.4 Prediction perturbation effects (for CRISPR screens, but other types of perturbations as well)\nA fundamental computational challenge in single-cell perturbation studies is predicting how a perturbation, such as a drug treatment or CRISPR-based genetic modification, affects cellular behavior. This challenge arises in two primary contexts: (1) given a perturbation applied to one cell type, where both control and perturbed states are observed, inferring how another cell type would respond to the same perturbation based on its unperturbed expression; or (2) disentangling the latent space of perturbations from the latent space of cell embeddings, allowing for generalizable predictions of perturbation effects even in the absence of direct observations. The latter approach leverages biological priors on perturbation relationships, enabling the extrapolation of perturbation effects across unseen conditions. Accurate prediction methods are crucial for understanding drug responses, genetic knockouts, and CRISPR-based enhancer perturbations, ultimately providing insights into gene regulatory networks and therapeutic interventions.\n\n8.4.0.1 Hold on… Why do we need this again?\nRemember: If we use a low MOI (ex: MOI of 0.3) experiment, we need many cells to receive each guide, and we even more cells because most cells won’t receive a guide. To quote Bock et al. (2022), ::: block “For both genome-scale and focused CRISPR knockout (CRISPRko) screens, it is advisable to include at least four different gRNAs for each target gene, although carefully designed and validated gRNA libraries with fewer gRNAs per gene can provide reliable results. All gRNA libraries should include gRNAs for application-specific positive and negative control genes, which are important to validate the screen. In addition, they should include control gRNAs that target known safe harbour loci or other genomic regions where no specific effects of gene editing are expected, in order to account for the DNA damage response and for non-specific reduction in cell proliferation caused by CRISPRko. …\nAs a guideline, we recommend a coverage of 100-200 cells per target gene for positive selection screens and 500-1,000 cells per target gene for negative selection screens.” :::\n(The reason negative selection screens need more cells is because these cells will die from the stressor after the CRISPRko integration. So you need to be confident these cells really “died” (instead of you happening by bad luck to miss these cells during sequencing).)\nFor this reasons, some CRISPR experiments purposely use a high MOI (think of 10 to 50). This reduces the number of cells they need, since most cells will receive multiple guides. As one concrete example, see Gasperini et al. (2019), which performed a CRISPRi screen. They targeted 1,119 candidate enhancer elements (which was near 5,611 genes) in K562 cells, and used a high MOI (roughly 15) across 47,650 cells. This means, if they used a conservative MOI=1 (i.e., each cell receives only one guide), they would needed about \\(47,650 \\times 15 \\approx 715,000\\) cells. (That would make that experiment a massive (and extremely expensive) single-cell experiments.)\nHowever, the drawback of high MOI is that sometimes you cannot reasonably rule that different sgRNA doesn’t interact with one another. For this reason, we might wonder: Can we: 1) use a low MOI experiment, 2) leverage some biological insights about these sgRNA, and 3) develop a fancy computational tool to synthetically predict what the effects of the sgRNA we didn’t actually use are?\n\n\n8.4.0.2 Brief aside: What on earth is a “normalizing flow neural networks”?\nNormalizing flow neural networks provide a framework to construct a rich, complex probability distribution by applying a series of invertible transformations to a simple base distribution (often a Gaussian), see Figure 8.20 and Figure 8.21. Each transformation is designed to be bijective and differentiable, which ensures that the overall mapping from the latent space to the data space remains invertible. This property allows for exact likelihood evaluation, because the change of variables formula can be applied directly to the transformed distribution. In practice, one computes the log-likelihood of an observed sample by summing the log of the Jacobian determinant of each invertible mapping and the log-likelihood of the base distribution.\n\n\n\n\n\n\n\nFigure 8.20: From https://lilianweng.github.io/posts/2018-10-13-flow-models/.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.21: From https://lilianweng.github.io/posts/2018-10-13-flow-models/.\n\n\n\n\nInvertibility is a key difference between normalizing flows and Variational Autoencoders (VAEs). In a VAE, an encoder approximates a posterior distribution over the latent variables, but it is generally not invertible. Consequently, VAEs compute a lower bound of the log-likelihood rather than the exact likelihood. In contrast, the invertible nature of normalizing flows enables direct calculation of the log-likelihood, thereby avoiding the need for variational approximations. This leads to more precise density estimation and can offer a clearer interpretation of how each layer transforms data.\nHere is one concrete example of what a normalizing flow network is, which is called RealNVP (where NVP stands for “non-volume preserving”). RealNVP (Dinh, Sohl-Dickstein, and Bengio 2016) is a type of invertible (or “normalizing flow”) model where each transformation can be inverted cheaply by design. The primary idea is to split the input vector \\(\\mathbf{x}\\) into two parts, keep one part unchanged (\\(\\mathbf{x}_1\\)), and transform the other part (\\(\\mathbf{x}_2\\)) in a way that is guaranteed to be invertible.\n\nCoupling Layer: Partition \\(\\mathbf{x}\\) into \\(\\mathbf{x}_1\\) and \\(\\mathbf{x}_2\\). Then, define the output \\(\\mathbf{y} = (\\mathbf{y}_1, \\mathbf{y}_2)\\) where \\(\\mathbf{y}_1 = \\mathbf{x}_1\\) and\n\n\\[\n\\mathbf{y}_2 = \\mathbf{x}_2 \\,\\odot\\, \\exp\\bigl(\\mathbf{s}(\\mathbf{x}_1)\\bigr) + \\mathbf{t}(\\mathbf{x}_1).\n\\]\nThe functions \\(\\mathbf{s}(\\cdot)\\) and \\(\\mathbf{t}(\\cdot)\\) can be any neural networks that output real-valued vectors. The exponential ensures a nonzero scale factor, while addition by \\(\\mathbf{t}\\) is trivially invertible. See Figure 8.22.\n\n\n\n\n\n\n\nFigure 8.22: From Dinh, Sohl-Dickstein, and Bengio (2016).\n\n\n\n\n\nEnsuring this transformation is invertible: The inverse of the above transformation is\n\n\\[\n\\mathbf{x}_1 = \\mathbf{y}_1, \\quad\n\\mathbf{x}_2 = \\bigl(\\mathbf{y}_2 - \\mathbf{t}(\\mathbf{y}_1)\\bigr) \\,\\odot\\, \\exp\\bigl(-\\mathbf{s}(\\mathbf{y}_1)\\bigr).\n\\]\nBecause \\(\\mathbf{x}_1\\) remains the same, it is straightforward to reconstruct \\(\\mathbf{x}_2\\). No matter how \\(\\mathbf{s}\\) and \\(\\mathbf{t}\\) are learned, the coupling layer is invertible by construction.\nSplitting the input and only transforming part of it guarantees efficient forward and inverse computations. By composing multiple coupling layers, we can create flexible density estimators while preserving tractable log-likelihood calculation.\nSee https://lilianweng.github.io/posts/2018-10-13-flow-models/, https://paperswithcode.com/method/affine-coupling, https://bjlkeng.io/posts/normalizing-flows-with-real-nvp/, and Kobyzev, Prince, and Brubaker (2020) for useful overviews about normalizing flows, with some details about the way to construct normalizing flows using affine transformations.\n(Sidenote: This context is mainly only needed to understand PerturbNet (Yu and Welch 2022). There are plenty of methods to predict perturbation effects not build using normalizing flow networks. See scGen (Lotfollahi, Wolf, and Theis 2019) for example, which is built on your more typical VAE architecture.)\n\n\n8.4.0.3 State-of-the-art research: PerturbNet.\nPerturbNet (Yu and Welch 2022) is a deep generative framework that predicts single-cell gene expression responses under both observed and unseen chemical or genetic perturbations. That is, we want to predict the effect of perturbation even if none of cells ever received this perturbation.\n\nInput/Output. The input to PerturbNet (when trying to perturb the impact of CRISPRi perturbations) is a 1) single-cell gene expression count matrix \\(\\mathbb{Z}_+^{n\\times p}\\) for \\(n\\) cells and \\(p\\) genes, 2) a single-cell guide RNA count matrix of the same \\(n\\) cells, \\(\\{0,1\\}^{n\\times d}\\) for \\(d\\) perturbations, and 3) a database that groups the perturbations (many of which might not the \\(d\\) perturbations you actually measured) into pathways. The output is three things: 1) a VAE to embed each of the \\(n\\) cells into low-dimensional space, 2) a VAE to embed each of the perturbations (including the \\(d\\) in your dataset) into a low-dimensional space, and 3) a learned function that takes in a cell’s latent representation and perturbation’s latent representation and outputs the (predicted) cell’s latent representation after receiving that perturbation.\n\nIt is designed around three principal building blocks: (i) perturbation representation networks, (ii) cell-state representation networks, and (iii) a conditional invertible neural network (cINN) that translates perturbation embeddings into full distributions of cellular states.\n\nPerturbation Representation Networks (GenotypeVAE or ESM): To capture key features of chemical or genetic perturbations in a low-dimensional, learnable space, PerturbNet uses different encoder architectures. We’ll just focus on the CRISPR-related perturbations in our discussion here. For CRISPR knockdown or CRISPRi/a perturbations, a GenotypeVAE is used, which starts from a high-dimensional GO-term annotation vector for each target gene (or union of genes), then encodes this vector into a condensed gene-function latent space via fully-connected layers. In the case of coding-sequence edits (such as CRISPR knockouts which introduce changes to the genetics), perturbations are encoded by a pretrained transformer (e.g. ESM, which stands for “evolutionary scale modeling”3), which outputs a deterministic embedding of amino-acid sequences.\n\nThe point is: we use biological insights about these perturbations (which use established databases) to learn the “space of perturbations.” See Figure 8.23 and Figure 8.24.\n\n\n\n\n\n\n\nFigure 8.23: From Yu and Welch (2022). GenotypeVAE to learn a low-dimensional representation for each gene based on which pathways it is known to be involved in.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.24: From Yu and Welch (2022). ESM to learn a low-dimensional representation of the protein sequence (which is a “sequence of words” (language model).\n\n\n\n\n\nCell-state representation network: Separately, PerturbNet learns a latent space for the single-cell gene expression profiles. This is similar to your typical VAE for scRNA-seq using a negative binomial-likelihood. Each cell is thus mapped into a latent space \\(Z\\) capturing core variation in gene expression. The VAE decoder reconstructs the input (e.g. counts) from the sampled \\(Z\\) latent, enabling distributional modeling of single-cell data.\nConditional invertible neural network (cINN): [[This is where the magic happens!]] The crux of PerturbNet is a conditional invertible neural network, denoted \\(Z=f(V \\mid Y)\\). (This is where the normalizing flow comes into play.) Here, \\(Y\\) is the perturbation’s latent embedding (from GenotypeVAE or ESM), and \\(Z\\) is the cell-state latent (from the cell VAE). The cINN incorporates a “residual” variable \\(V \\sim N(0,I)\\), capturing per-cell variability unexplained by the perturbation. In plain English, you want learn the function \\(f\\) that takes in as input \\(V\\) (the “baseline” representation of the cell), and then condition to a perturbation (represented by \\(Y\\)) to give you the observed gene expression (which here, is a low-dimensional embedding represented by \\(Z\\)).\n\nConcretely, \\(f\\) is built from affine coupling blocks (see Figure 8.22):\n\\[\n(W_1, W_2) = \\mathrm{Block}((U_1,U_2) \\mid Y),\n\\]\nwhere \\(U_1,U_2\\) split the input, and each block’s parameters are learned via fully-connected sub-networks that shift and scale one part of the data conditioned on the other part and on \\(Y\\). Because each block is invertible (with a tractable Jacobian determinant), one can train \\(f\\) from the objective4\n\\[\n\\mathcal{L} = \\mathbb{E} \\bigl[-\\log p\\{f^{-1}(Z \\mid Y)\\}\\bigr] + \\text{(constant terms)},\n\\]\ndriving \\(f^{-1}\\) to map \\((Z,Y)\\) back to a Gaussian \\(V\\). (I’m aware this probably doesn’t make a lot of sense since I’m not providing enough context about how a cINN works. See the references above about normalizing flows.)\nThis cINN architecture thus learns to sample realistic cell embeddings for each perturbation. In practice, a stack of multiple affine coupling blocks plus normalization layers is used, ensuring expressivity and stable training.\n\nTraining procedure and use: After the perturbation and cell VAEs are pre-trained (often on large unpaired datasets), one collects paired perturbation–cell data (e.g. a high-throughput Perturb-seq or chemical screen). By feeding the latent \\(Y\\) from the perturbation network and the latent \\(Z\\) from the cell-state VAE into the cINN, PerturbNet learns the probabilistic mapping between \\(Y\\) and \\(Z\\). Once trained, it can (1) sample predicted single-cell states for a new perturbation \\(Y_{\\mathrm{new}}\\), and (2) be inverted to find which perturbation embeddings shift cells toward a desired \\(Z_{\\mathrm{target}}\\) distribution.\n\nPutting this all together, see Figure 8.25 and Figure 8.26.\n\n\n\n\n\n\n\nFigure 8.25: From Yu and Welch (2022). High-level idea.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.26: From Yu and Welch (2022). More details about how this works.\n\n\n\n\n\n\n\n\nBarry, Timothy, Kathryn Roeder, and Eugene Katsevich. 2024. “Exponential Family Measurement Error Models for Single-Cell CRISPR Screens.” Biostatistics 25 (4): 1254–72.\n\n\nBarry, Timothy, Xuran Wang, John A Morris, Kathryn Roeder, and Eugene Katsevich. 2021. “SCEPTRE Improves Calibration and Sensitivity in Single-Cell CRISPR Screen Analysis.” Genome Biology 22 (1): 1–19.\n\n\nBock, Christoph, Paul Datlinger, Florence Chardon, Matthew A Coelho, Matthew B Dong, Keith A Lawson, Tian Lu, et al. 2022. “High-Content CRISPR Screening.” Nature Reviews Methods Primers 2 (1): 1–23.\n\n\nCheng, Junyun, Gaole Lin, Tianhao Wang, Yunzhu Wang, Wenbo Guo, Jie Liao, Penghui Yang, et al. 2023. “Massively Parallel CRISPR-Based Genetic Perturbation Screening at Single-Cell Resolution.” Advanced Science 10 (4): 2204484.\n\n\nConcordet, Jean-Paul, and Maximilian Haeussler. 2018. “CRISPOR: Intuitive Guide Selection for CRISPR/Cas9 Genome Editing Experiments and Screens.” Nucleic Acids Research 46 (W1): W242–45.\n\n\nDatlinger, Paul, André F Rendeiro, Christian Schmidl, Thomas Krausgruber, Peter Traxler, Johanna Klughammer, Linda C Schuster, Amelie Kuchler, Donat Alpar, and Christoph Bock. 2017. “Pooled CRISPR Screening with Single-Cell Transcriptome Readout.” Nature Methods 14 (3): 297–301.\n\n\nDinh, Laurent, Jascha Sohl-Dickstein, and Samy Bengio. 2016. “Density Estimation Using Real Nvp.” arXiv Preprint arXiv:1605.08803.\n\n\nDixit, Atray, Oren Parnas, Biyu Li, Jenny Chen, Charles P Fulco, Livnat Jerby-Arnon, Nemanja D Marjanovic, et al. 2016. “Perturb-Seq: Dissecting Molecular Circuits with Scalable Single-Cell RNA Profiling of Pooled Genetic Screens.” Cell 167 (7): 1853–66.\n\n\nEsposito, Roberta, Núria Bosch, Andrés Lanzós, Taisia Polidori, Carlos Pulido-Quetglas, and Rory Johnson. 2019. “Hacking the Cancer Genome: Profiling Therapeutically Actionable Long Non-Coding RNAs Using CRISPR-Cas9 Screening.” Cancer Cell 35 (4): 545–57.\n\n\nGasperini, Molly, Andrew J Hill, José L McFaline-Figueroa, Beth Martin, Seungsoo Kim, Melissa D Zhang, Dana Jackson, et al. 2019. “A Genome-Wide Framework for Mapping Gene Regulation via Cellular Genetic Screens.” Cell 176 (1): 377–90.\n\n\nKhan, Faiza Shafique, Farhan Goher, Dapeng Zhang, Peng Shi, Zhiying Li, Yin Min Htwe, and Yong Wang. 2022. “Is CRISPR/Cas9 a Way Forward to Fast-Track Genetic Improvement in Commercial Palms? Prospects and Limits.” Frontiers in Plant Science 13: 1042828.\n\n\nKobyzev, Ivan, Simon JD Prince, and Marcus A Brubaker. 2020. “Normalizing Flows: An Introduction and Review of Current Methods.” IEEE Transactions on Pattern Analysis and Machine Intelligence 43 (11): 3964–79.\n\n\nKuhn, Maria, António J Santinha, and Randall J Platt. 2021. “Moving from in Vitro to in Vivo CRISPR Screens.” Gene and Genome Editing 2: 100008.\n\n\nLin, Xueqiu, Yanxia Liu, Shuai Liu, Xiang Zhu, Lingling Wu, Yanyu Zhu, Dehua Zhao, et al. 2022. “Nested Epistasis Enhancer Networks for Robust Genome Regulation.” Science 377 (6610): 1077–85.\n\n\nLotfollahi, Mohammad, F Alexander Wolf, and Fabian J Theis. 2019. “scGen Predicts Single-Cell Perturbation Responses.” Nature Methods 16 (8): 715–21.\n\n\nMao, Yanfei, Jose Ramon Botella, and Jian-Kang Zhu. 2017. “Heritability of Targeted Gene Modifications Induced by Plant-Optimized CRISPR Systems.” Cellular and Molecular Life Sciences 74 (6): 1075–93.\n\n\nSchnitzler, Gavin R, Helen Kang, Shi Fang, Ramcharan S Angom, Vivian S Lee-Kim, X Rosa Ma, Ronghao Zhou, et al. 2024. “Convergence of Coronary Artery Disease Genes onto Endothelial Cell Programs.” Nature 626 (8000): 799–807.\n\n\nWei, Lai, Derek Lee, Cheuk-Ting Law, Misty Shuo Zhang, Jialing Shen, Don Wai-Ching Chin, Allen Zhang, et al. 2019. “Genome-Wide CRISPR/Cas9 Library Screening Identified PHGDH as a Critical Driver for Sorafenib Resistance in HCC.” Nature Communications 10 (1): 4681.\n\n\nYao, Douglas, Loic Binan, Jon Bezney, Brooke Simonton, Jahanara Freedman, Chris J Frangieh, Kushal Dey, et al. 2024. “Scalable Genetic Screening for Regulatory Circuits Using Compressed Perturb-Seq.” Nature Biotechnology 42 (8): 1282–95.\n\n\nYu, Hengshi, and Joshua D Welch. 2022. “Perturbnet Predicts Single-Cell Responses to Unseen Chemical and Genetic Perturbations.” BioRxiv, 2022–07.\n\n\nZhou, Jessica L, Karthik Guruvayurappan, Shushan Toneyan, Hsiuyi V Chen, Aaron R Chen, Peter Koo, and Graham McVicker. 2024. “Analysis of Single-Cell CRISPR Perturbations Indicates That Enhancers Predominantly Act Multiplicatively.” Cell Genomics 4 (11).\n\n\nZhou, Yifan, Kaixuan Luo, Lifan Liang, Mengjie Chen, and Xin He. 2023. “A New Bayesian Factor Analysis Method Improves Detection of Genes and Biological Processes Affected by Perturbations in Single-Cell CRISPR Screening.” Nature Methods 20 (11): 1693–703.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter7_crispr.html#footnotes",
    "href": "chapter7_crispr.html#footnotes",
    "title": "8  Single-cell CRISPR editting",
    "section": "",
    "text": "CRISPR stands for “clustered regularly interspaced short palindromic repeats,” but it’s not too important to know why exactly it’s called this for the purposes of this chapter.↩︎\nTransfection is the process of introducing foreign nucleic acids (such as DNA or RNA) into eukaryotic cells to manipulate gene expression or enable genetic modifications. It is commonly used in plasmid-based CRISPR applications. In opposition, transduction refers to the introduction of genetic material using viral vectors..↩︎\nThis itself is fascinating. See https://github.com/facebookresearch/esm.↩︎\nHere, the probability \\(p\\) is determining the likelihood \\(f^{-1}(Z \\mid Y)\\) originated from \\(V \\sim N(0,I)\\). We’re going to approximate the expectation by taking an average of all the cells we’ve sequenced based on their latent embedding \\(Z\\) and the latent embedding of the treatment \\(Y\\) that was applied to that cell.↩︎",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Single-cell CRISPR editting</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html",
    "href": "chapter1_intro.html",
    "title": "2  Introduction",
    "section": "",
    "text": "2.1 Why study cell biology in public health?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#why-study-cell-biology-in-public-health",
    "href": "chapter1_intro.html#why-study-cell-biology-in-public-health",
    "title": "2  Introduction",
    "section": "",
    "text": "2.1.1 What are “omics”?\nThe term “omics” refers to a broad field of biology aimed at the comprehensive characterisation and quantification of biological molecules that translate into the structure, function, and dynamics of an organism. At its core, “omics” encapsulates the idea of studying biological systems at a global scale rather than focusing on individual components. This includes genomics (DNA), transcriptomics (RNA), proteomics (proteins), epigenomics, metabolomics (metabolites), and more. Each of these fields leverages high-throughput technologies to generate massive datasets that capture complex interactions within cells, tissues, or organisms.\nThe rise of “omics” has revolutionised biology by enabling researchers to ask holistic questions such as how different genes, proteins, or metabolites interact in health and disease. It emphasises understanding systems as interconnected networks rather than isolated elements. This systems-level approach is particularly powerful in identifying biomarkers, understanding disease mechanisms, and tailoring precision-medicine strategies. In public health, “omics” provides tools to bridge molecular discoveries with population-level outcomes, offering new opportunities to tackle complex health challenges.\n\n\n2.1.2 Some examples of a “cell-biology” question\n\nHow the brain develops (i.e. the longitudinal sequence of events between birth and maturation), shown in Figure 2.1.\n\nHow microglia in the brain gain or lose certain functions during ageing, shown in Figure 2.2.\n\nWhy certain cells (i.e. cancer cells) divide uncontrollably, see Figure 2.3.\n\n\n\n\n\n\n\n\nFigure 2.1: What is the sequence of cell types that emerge (and where) during human brain development? (Zhou, Song, and Ming 2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.2: Microglia (immune cells of the brain) radically change shape during ageing.\nWhat are the functional consequences of this? (Von Bernhardi, Eugenı́n-von Bernhardi, and Eugenı́n 2015)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.3: Cancer is typically characterised by uncontrollable cell division. What drives this process, how can we detect it early, and how can we stop it? (Source: https://sites.duke.edu/seektobacco/2-the-role-of-tobacco-in-the-development-of-cancer/the-content/)\n\n\n\n\n\n\n2.1.3 How “omics” comes into the picture\nTo answer cell-biology questions we leverage different omics to learn clues about\n1. the cellular functions of a biological system, and\n2. how those functions change during disease, ageing, etc.\nAll these omics are related:\n\nThe central dogma of biology (DNA → RNA → protein) is illustrated in Figure 2.4 and Figure 2.5, linking the three most fundamental omics.\n\nThe epigenome, shown in Figure 2.6, comprises chemical modifications to DNA and histone proteins that regulate gene expression yet are not part of the DNA itself. The figure highlights three commonly studied features: DNA accessibility, DNA methylation, and histone modifications.\n\nThese layers are summarised in Figure 2.7.\n\n\n\n\n\n\n\nFigure 2.4: Central dogma. (Source: https://www.khanacademy.org/science/ap-biology/gene-expression-and-regulation/translation/a/intro-to-gene-expression-central-dogma)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.5: Central dogma. (Source: https://researchfeatures.com/adding-structure-biologys-central-dogma-cancer-treatments-thyroid-cancer/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.6: Epigenetics. (Source: https://en.wikipedia.org/wiki/Epigenetics)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.7: A non-exhaustive list of omics. (Wen et al. 2022)\n\n\n\n\n\nRemark (Personal opinion: Biology is constantly revising the details).\nStatistical knowledge is rarely revised – its instead mostly refined. We know properties that generalize to much broader settings (i.e., less statistical assumptions) and much more refined statistical rates for the settings studied two decades ago. (1) There’s little revisions, since once someone proves a statistical theorem, it is very unlikely for it to get disproven in the future. (2) Statistics generally focuses on what happens in an “average/typical” scenario.\nBiology, in comparison, has many revisions and refinements. There’s a couple reasons for this: (1) Biology research is driven by technology. Hence, as we can image/sequence/profile new aspects of a cell, design new model organisms, or collect more data, we might revise a lot of understanding of how cells work. (2) While there are broad biological mechanisms that generally hold true, many diseases occur when the general biological principle no longer holds true. For this reasons, a lot of cell biology research is about these exceptions, which cause us to question how universally true a biological mechanism is. (As a simple example – we’re taught humans have 46 chromosomes. However, many conditions such as Down Syndrome, originate from having an abnormal number of chromosomes.)\n\n\nRemark (All the omics we will study in this course are matrices).\nOne of major missions of this course is to answer the following question: Every omic is represented as a matrix (generally, where the rows are cells, and columns are certain features, depending on the omic). In that case, how come some statistical methods designed for one omic isn’t applicable for another omic?\nWhile there are certain statistical answers to this question, most of the answers are based on biology. Certain methods rely on a specific biological premise, and that premise becomes hard to justify as you switch from one omic to another.\nThis is not too dissimilar from a causal analysis. In a causal analysis, the reason certain features get labeled as a confounder, treatment, outcome, instrumental variable, mediator, etc. relies on the context.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#what-do-we-hope-to-learn-from-single-cell-data",
    "href": "chapter1_intro.html#what-do-we-hope-to-learn-from-single-cell-data",
    "title": "2  Introduction",
    "section": "2.2 What do we hope to learn from single-cell data?",
    "text": "2.2 What do we hope to learn from single-cell data?\n\n2.2.1 Basic biology\nSingle-cell data offer a transformative lens to study the fundamental processes of life at unparalleled resolution. Unlike bulk data, which averages signals across populations of cells, single-cell technologies allow researchers to examine the diversity and complexity of individual cells within a tissue or organism. This level of detail provides insights into key biological phenomena, such as cellular differentiation during development, the plasticity of cell states in response to environmental cues, and the organization of complex tissues. For instance, single-cell RNA-sequencing (scRNA-seq) has uncovered new cell types in the brain and immune system, challenging traditional classifications and offering a more nuanced understanding of cellular identities and functions. These insights are essential for constructing more accurate models of how life operates at a cellular level.\nMany of the examples shown in Figs. Figure 2.1–Figure 2.2 are basic biology questions. Two additional examples are shown in Figure 2.8 and Figure 2.9.\n\n\n\n\n\n\n\nFigure 2.8: How do cancer cells survive successive therapies? (Schaff et al. 2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.9: What deteriorates in a cell as it ages (Silva and Schumacher 2021)\n\n\n\n\n\n\n2.2.2 Benchside-to-bedside applications\nSingle-cell data have enormous potential to revolutionize clinical practice by bridging molecular biology and medicine. After learning basic biology, the next stage is to use our newfound understanding to advance treatments. (We typically call this translation research, to denote translating our basic biology knowledge to therapeutic improvements.) This is also called benchside (for the wet-bench, i.e. laboratory setting) to bedside (for the hospital setting).\nBy mapping cellular heterogeneity in diseased and healthy tissues, researchers can identify specific cell populations driving disease progression and therapeutic resistance. For example, in cancer, single-cell analyses have uncovered rare tumor subclones that evade treatment, providing critical targets for drug development. Similarly, in autoimmune diseases like rheumatoid arthritis, single-cell profiling of synovial tissues has identified inflammatory cell states that correlate with disease severity and treatment response. Beyond diagnostics, this technology enables precision medicine by tailoring treatments to the molecular profiles of individual patients. As single-cell approaches continue to evolve, they are poised to refine drug-discovery pipelines, improve vaccine design, and ultimately transform how diseases are diagnosed and treated.\nThere are a few ways this typically happens. Figure 2.10 shows one example, where single-cell research helps identify the specific cell types and specific edits needed to improve cellular function. Figure 2.11 shows another example, where understanding the cellular functions, we can improve how conventional methods can be used to measure more accurate biomarkers. Cancer research has been (by far) the biggest beneficiary of single-cell research, and Figure 2.12 illustrates how single-cell improves cancer therapies.\n\n\n\n\n\n\n\nFigure 2.10: There are current single-cell therapies that involve extracting blood from a donor, altering the cells outside the body, and then infusing the altered blood back into the donor. (Source: https://www.cancer.gov/news-events/cancer-currents-blog/2020/crispr-cancer-research-treatment)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.11: After learning the causal mechanisms for specific cell types for Alzheimer’s disease that can be detected from blood draws, we can refine existing biomarkers to monitor Alzheimer’s. (Hansson et al. 2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.12: Example of how insights from single-cell studies transform cancer therapies. (Gohil et al. 2021)\n\n\n\n\n\n\n\n2.2.3 What existed prior to single-cell data?\nWestern blots and flow cytometry.\nBefore the advent of single-cell technologies, biological research relied heavily on methods like western blots and flow cytometry to study cells and molecules. Western blotting (shown in Figure 2.13 and Figure 2.14), developed in the late 1970 s, enabled researchers to detect and quantify specific proteins in a sample, providing insights into cellular pathways and protein-expression levels. However, this technique required lysing entire tissues or cell populations, averaging the signals from thousands or millions of cells. Flow cytometry (shown in Figure 2.15 and Figure 2.16), emerging in the 1980s, represented a major step forward by allowing researchers to analyse individual cells’ physical and chemical characteristics in suspension. While flow cytometry offered single-cell resolution, it was limited to analysing predefined markers and could not capture the full complexity of cellular states or gene expression.\n\n\n\n\n\n\n\nFigure 2.13: Illustration of the Western-blot technique. (Source: https://www.bio-rad.com/en-us/applications-technologies/western-blotting-electrophoresis-techniques)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.14: Example Western-blot data. (Kepchia et al. 2020)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.15: Illustration of flow-cytometry technique. (Source: https://www.streck.com/blog/principles-of-flow-cytometry/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.16: Example flow-cytometry data. (Verschoor et al. 2015)\n\n\n\n\nMicroarray technology.\nThe 1990s marked the rise of microarray technology (shown in Figure 2.17 and Figure 2.18), which allowed scientists to measure the expression levels of thousands of genes simultaneously. Microarrays revolutionised transcriptomics by enabling high-throughput studies of gene activity in various conditions, tissues, and diseases. Despite its transformative impact, microarray analysis was fundamentally a bulk method, averaging signals across all cells in a sample. It is also based on light intensity, which can be tricky to extract consistently. These limitations obscured cellular heterogeneity, especially in complex tissues where distinct cell types or states contribute uniquely to biological processes or disease mechanisms.\n\n\n\n\n\n\n\nFigure 2.17: Illustration of microarray technique. (Source: https://www.onlinebiologynotes.com/dna-microarray-principle-types-and-steps-involved-in-cdna-microarrays/)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.18: Example microarray image prior to quantification. (Source: https://online.stat.psu.edu/stat555/node/28/)\n\n\n\n\n\nRemark (Personal opinion: the close history between microarrays and high-dimensional statistics).\nHistorically, the rise of microarray data spurred advances in high-dimensional statistics — e.g. the Lasso (Tibshirani et al. 2005), gene-expression classification for leukaemia (Golub et al. 1999), and empirical-Bayes multiple testing (Efron and Tibshirani 2002).\n\nBulk sequencing technologies.\nIn the 2000s, bulk sequencing technologies for DNA and RNA emerged, further advancing the study of genomes and transcriptomes. RNA-sequencing (RNA-seq) became a powerful tool for capturing the entire transcriptome with greater accuracy and dynamic range than microarrays. Similarly, DNA sequencing enabled comprehensive studies of genetic variation, from point mutations to structural alterations. However, like microarrays, bulk sequencing aggregated signals across many cells, masking rare cell populations and the heterogeneity critical to understanding dynamic processes such as tumour evolution or immune responses. These bulk techniques laid the groundwork for single-cell methods by driving innovations in high-throughput sequencing and data analysis, which would later be adapted for single-cell resolution.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#when-did-single-cell-data-become-popular-and-how-has-the-technology-advanced",
    "href": "chapter1_intro.html#when-did-single-cell-data-become-popular-and-how-has-the-technology-advanced",
    "title": "2  Introduction",
    "section": "2.3 When did single-cell data become popular, and how has the technology advanced?",
    "text": "2.3 When did single-cell data become popular, and how has the technology advanced?\n\n2.3.1 The rise of single-cell data\nSingle-cell data began gaining prominence in the early 2010s, fuelled by advances in microfluidics and next-generation sequencing. Single-cell RNA-sequencing (scRNA-seq), pioneered around 2009 – 2011, was among the first methods to achieve widespread adoption. It enabled measurement of gene expression in individual cells, uncovering heterogeneity that bulk analyses masked. Early applications revealed new cell types and states, reshaped our understanding of development, and identified rare populations in cancers and neurodegenerative disorders. Popularity grew as throughput increased, costs fell, and workflows became standardised.\nFigure 2.19 and Figure 2.20 contrasts bulk and single-cell sequencing. Figure 2.21 shows how single-cell data tease apart different sources of heterogeneity.\n\n\n\n\n\n\n\nFigure 2.19: Illustrations of how single-cell sequencing improves resolution for studying cancer resistance. (Shalek and Benson 2017)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.20: Illustrations of how single-cell sequencing improves resolution for studying cancer resistance. (Shalek and Benson 2017)\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.21: Single-cell insights disentangle underlying biological mechanisms. (Lei et al. 2021)\n\n\n\n\n\n\n2.3.2 Expansion into other omics and spatial technologies\nBuilding on single-cell transcriptomics, the field rapidly expanded into other omics. Single-cell proteomics allows detailed analysis of protein expression and signalling pathways. Single-cell ATAC-seq profiles chromatin accessibility; Hi-C and related methods reveal 3D genome architecture. Spatial transcriptomics connects gene expression with tissue context. CRISPR-based single-cell screens enable high-throughput perturbations, and lineage-tracing barcodes add a temporal dimension, charting cell ancestry in development and disease. Together, these advances transformed single-cell biology into a multi-dimensional, integrative discipline.\nMany of these technologies appear in Figure 2.22.\n\n\n\n\n\n\n\nFigure 2.22: Illustration (circa 2020) of technologies that pair various omics at single-cell resolution. (Teichmann and Efremova 2020)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter1_intro.html#what-is-the-role-of-a-biostatistician-in-a-wet-lab-clinical-world",
    "href": "chapter1_intro.html#what-is-the-role-of-a-biostatistician-in-a-wet-lab-clinical-world",
    "title": "2  Introduction",
    "section": "2.4 What is the role of a biostatistician in a wet-lab / clinical world?",
    "text": "2.4 What is the role of a biostatistician in a wet-lab / clinical world?\nCell biology is vast – especially for students trained primarily in statistics or biostatistics. Many disciplines intersect with cell biology. For example:\n\nStatistics / Biostatistics – statistical models for complex biological processes; translation between maths and biology\nComputational biology – scalable computation, leveraging public data\nBioinformatics / Genetics – tools that draw on large‐consortium resources\nEpidemiology – population-level data and policy recommendations\nBioengineering – new laboratory technologies for cheaper/faster measurement or imaging\nBiology – mechanistic studies in model organisms\nBiochemistry / Molecular biology – structure, function, interactions of specific molecules\nWet-bench medicine – disease mechanisms via tissues, models, cell lines\nClinical-facing medicine – patient treatment and real-world sample collection\nPharmacology – integrating evidence to design new drugs and therapies\n\nGiven so many players, what does a biostatistician contribute?\n\n2.4.1 How a biostatistician perceives the world\nGive me a concrete (ideally cleaned) dataset: the larger the better—and I will analyse it from many angles.\nCausality: A mathematically stricter notion than correlation, usually via (1) counterfactual reasoning, or (2) a directed-acyclic-graph picture of how variables relate.\n\nRemark (Personal opinion: statistical causality for cell biology is extremely difficult). Obstacles: (i) tracking the same cell over time is impossible because sequencing lyses it; (ii) longitudinal human tissue samples are rare. Strong modelling assumptions can help but must withstand biological scrutiny. The bottleneck is often data, not maths—ambitious statisticians who learn enough biology still have a fighting chance.\n\n\nRemark (Single-cell methods are largely an “associative” world): Most single-cell analyses discover mechanisms that are statistically correlational; the causal proof comes from experiments and biology.\n\nThe research inquiry starts and ends with a method: (How to integrate modalities? learn a gene-regulatory network? perform valid post-clustering tests?) Start with a statistical model and a parameter of interest \\(\\theta^*\\), then typically:\n\nDevelop a novel estimator of \\(\\theta^*\\), explaining why current methods fail (e.g. lack robustness, accuracy, power, or are heuristic). Focus on statistical logic: A clear, simple mathematical intuition should show the gap and how the new method fills it.\nProve theorems showing the estimate \\(\\hat\\theta\\) converges to \\(\\theta^*\\) under stated assumptions. Focus on consistency & convergence: More data should provably yield more accurate results (often the highlight of a statistics paper).\nSimulations demonstrating that when the true \\(\\theta^*\\) is known, \\(\\hat\\theta\\) beats competing estimators across many settings. Illustration via benchmarking: Empirically recover the correct answer more often than existing methods.\nReal-data demonstration showing results align with known biology or provide biologically sensible new insights. Focus on practicality: The method must work in real scenarios mirroring its target audience.\n\nMindset: deliver a reliable tool that others can trust as-is. Human validations are often impractical; guard-rails and diagnostics are vital.\nWhy biostatisticians need wet-lab biologists / clinicians: We rarely generate data ourselves, so collaborators supply (i) exciting data with novel questions, (ii) biological context for sensible assumptions, and (iii) experimental validation of statistical findings.\n\n\n2.4.2 How a wet-lab biologist / clinician perceives the world\nExperiments, experiments, experiments: Carefully controlled—even if small—to make downstream analysis straightforward.\nCausality comes from a chain of experiments. Suppose we study a gene’s role in disease:\n\nTemporal evidence, such as change in gene expression preceding a change in cell phenotype. A causal mechanism should occur before the phenotype.\nBiological logic providing explanation of the underlying mechanism (binding factors, protein function, evolutionary rationale, etc.). For example, there must be a coherent pathway from gene → protein → phenotype.\nUniversality of how the described association persists across cell lines or organisms. A causal mechanism should be discoverable in other systems (extent depends on how general the logic is). This is offten the highlight of a biology paper.\nValidation, such as knocking out the gene alters the outcome, whereas similar genes do not. For example, perturbing the specific gene (not its close counterparts) changes the outcome.\n\nInquiry starts and ends with a biological hypothesis: Large intellectual effort goes into proposing explanations and designing experiments to rule them in or out.\nMindset: Assemble overwhelming evidence for a mechanism, combining careful experiments and biological logic.\nWhy wet-lab scientists need biostatisticians: Data are now complex and plentiful; exhaustive experiments for every hypothesis are infeasible. Statistical methods can (i) account for data & biological complexity and (ii) prioritise hypotheses worth experimental investment.\n\nSo how does a biostatistician develop computational / statistical methods for cell biology?\n\n\nBiological context – What is the biological system and the “north-star” question? Which premises are accepted, which ones are to be tested, and why is it important to understand this mechanism better?\nTechnology, experiment, data – How are data collected and why did you choose this particular {technology, experiment, data} trio? What technical artefacts arise?\nBoundaries of current tools – Simple analyses first: what “breaks” in existing workflows? Is there preliminary evidence a new computational method would do better?\nStatistical model – What is the insight that a different computational method could interrogate the biology better? (Here the statistics training begins.)\nDevelop a method & show robustness – Robustness can be defined numerically (i.e., noise tolerance) or biologically (i.e., applicable across contexts/environments). Often, the biological question you study lacks a ground truth, so validity arguments lean on biological logic.\nUncover new / refined biology – Does the method advance our biological understanding? How confident are we that findings generalise beyond the original {technology, experiment, data} trio? (This is usually the crown-jewel of your computational biology paper – it’s not necessary your specific analyses, but the potential that your tool can be used on other biological studies beyond what you’ve demonstrated your method on.)\n\n\n\n\n\n\nEfron, Bradley, and Robert Tibshirani. 2002. “Empirical Bayes Methods and False Discovery Rates for Microarrays.” Genetic Epidemiology 23 (1): 70–86.\n\n\nGohil, Satyen H, J Bryan Iorgulescu, David A Braun, Derin B Keskin, and Kenneth J Livak. 2021. “Applying High-Dimensional Single-Cell Technologies to the Analysis of Cancer Immunotherapy.” Nature Reviews Clinical Oncology 18 (4): 244–56.\n\n\nGolub, Todd R, Donna K Slonim, Pablo Tamayo, Christine Huard, Michelle Gaasenbeek, Jill P Mesirov, Hilary Coller, et al. 1999. “Molecular Classification of Cancer: Class Discovery and Class Prediction by Gene Expression Monitoring.” Science 286 (5439): 531–37.\n\n\nHansson, Oskar, Kaj Blennow, Henrik Zetterberg, and Jeffrey Dage. 2023. “Blood Biomarkers for Alzheimer’s Disease in Clinical Practice and Trials.” Nature Aging 3 (5): 506–19.\n\n\nKepchia, Devin, Ling Huang, Richard Dargusch, Robert A Rissman, Maxim N Shokhirev, Wolfgang Fischer, and David Schubert. 2020. “Diverse Proteins Aggregate in Mild Cognitive Impairment and Alzheimer’s Disease Brain.” Alzheimer’s Research & Therapy 12: 1–20.\n\n\nLei, Yalan, Rong Tang, Jin Xu, Wei Wang, Bo Zhang, Jiang Liu, Xianjun Yu, and Si Shi. 2021. “Applications of Single-Cell Sequencing in Cancer Research: Progress and Perspectives.” Journal of Hematology & Oncology 14 (1): 91.\n\n\nSchaff, Dylan L, Aria J Fasse, Phoebe E White, Robert J Vander Velde, and Sydney M Shaffer. 2024. “Clonal Differences Underlie Variable Responses to Sequential and Prolonged Treatment.” Cell Systems 15 (3): 213–26.\n\n\nShalek, Alex K, and Mikael Benson. 2017. “Single-Cell Analyses to Tailor Treatments.” Science Translational Medicine 9 (408): eaan4730.\n\n\nSilva, Paulo FL da, and Björn Schumacher. 2021. “Principles of the Molecular and Cellular Mechanisms of Aging.” Journal of Investigative Dermatology 141 (4): 951–60.\n\n\nTeichmann, Sarah, and Mirjana Efremova. 2020. “Method of the Year 2019: Single-Cell Multimodal Omics.” Nature Methods 17 (1): 2020.\n\n\nTibshirani, Robert, Michael Saunders, Saharon Rosset, Ji Zhu, and Keith Knight. 2005. “Sparsity and Smoothness via the Fused Lasso.” Journal of the Royal Statistical Society Series B: Statistical Methodology 67 (1): 91–108.\n\n\nVerschoor, Chris P, Alina Lelic, Jonathan L Bramson, and Dawn ME Bowdish. 2015. “An Introduction to Automated Flow Cytometry Gating Tools and Their Implementation.” Frontiers in Immunology 6: 380.\n\n\nVon Bernhardi, Rommy, Laura Eugenı́n-von Bernhardi, and Jaime Eugenı́n. 2015. “Microglial Cell Dysregulation in Brain Aging and Neurodegeneration.” Frontiers in Aging Neuroscience 7: 124.\n\n\nWen, Lu, Guoqiang Li, Tao Huang, Wei Geng, Hao Pei, Jialiang Yang, Miao Zhu, et al. 2022. “Single-Cell Technologies: From Research to Application.” The Innovation 3 (6).\n\n\nZhou, Yi, Hongjun Song, and Guo-li Ming. 2024. “Genetics of Human Brain Development.” Nature Reviews Genetics 25 (1): 26–45.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html",
    "href": "chapter8_lineage.html",
    "title": "9  Single-cell lineage tracing",
    "section": "",
    "text": "9.1 Why are we interested in learning temporal dynamics?\nStudying how cells change over time provides critical insight into the sequence of events driving biological processes. By observing changes in cell populations across multiple time points, researchers can pinpoint when specific transitions or bifurcations occur. Such temporal information reveals which factors influence a cell’s fate and how quickly new traits emerge.\nMoreover, understanding temporal dynamics can help us develop better interventions. If we can identify the earliest signs of disease or undesirable changes in cells, then targeted therapies can be designed to prevent or slow progression. Such strategies are especially powerful for complex, multi-stage diseases where later intervention might be less effective.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#why-are-we-interested-in-learning-temporal-dynamics",
    "href": "chapter8_lineage.html#why-are-we-interested-in-learning-temporal-dynamics",
    "title": "9  Single-cell lineage tracing",
    "section": "",
    "text": "Cancer subclone evolution: Tumors consist of various subclones that compete and evolve. Observing which subclones become dominant over time helps illuminate how certain cells acquire and propagate new mutations, sometimes conferring resistance to treatments. See Figure 9.1 and Figure 9.2.\n\n\n\n\n\n\n\n\nFigure 9.1: (Top) From Ashouri, Zhang, and Gaiti (2023).\n\n\n\n\n\n\n\n\n\n\n\nFigure 9.2: (Bottom) From Marine, Dawson, and Dawson (2020).\n\n\n\n\n\nCancer metastasis: Cells that detach from the primary tumor site and successfully colonize new tissues undergo significant genetic and phenotypic changes. Understanding these changes in temporal sequence highlights the adaptations needed for invasion and survival in distant environments. See Figure 9.3.\n\n\n\n\n\n\n\n\nFigure 9.3: From (fu2023emerging?).\n\n\n\n\n\nDisease progression: Many diseases advance in stages, even beyond cancer, with cells accumulating subtle changes that eventually manifest as severe pathologies. Timing the acquisition of these changes reveals how early molecular events cascade into full-blown disease. See Figure 9.4 for an example of this is investigated in COVID.\n\n\n\n\n\n\n\n\nFigure 9.4: From Stephenson et al. (2021). You can see that at different stages of COVID, there is a slightly different proportion of cell types that constitute the immune system.\n\n\n\n\n\nEmbryonic/organ development and cell fate: During embryonic development, cells undergo a series of tightly regulated fate decisions that determine their final identity. These decisions are influenced by both intrinsic genetic programs and extrinsic signaling cues from the surrounding environment. Understanding the temporal dynamics of these transitions allows researchers to uncover the molecular mechanisms guiding differentiation and tissue formation. By tracking how cells commit to specific lineages, we gain insight into how organs form or how “cells make decisions”. See Figure 9.5.\n\n\n\n\n\n\n\n\nFigure 9.5: From Weinreb et al. (2020). This dataset is recorded longitudinally (i.e., cells were sequenced at Day 2, 4, and 6.) What’s shown here are cells known to be in different lineages, but certain lineages don’t differentiate by Day 6, differentiate into multiple cell types, or differentiate only into one cell type.\n\n\n\n\n\nStem cell research: Stem cells differentiate into specialized cell types following a tightly regulated timeline. Tracking these progressions uncovers the signals that guide each step and may inform regenerative medicine strategies for repairing damaged tissues. See Figure 9.6.\n\n\n\n\n\n\n\n\nFigure 9.6: From https://stemcellthailand.org/induced-pluripotent-stem-cells-ips-ipscs-hipscs/.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#sec-natural_lineage",
    "href": "chapter8_lineage.html#sec-natural_lineage",
    "title": "9  Single-cell lineage tracing",
    "section": "9.2 Basis on how to infer history from cells naturally",
    "text": "9.2 Basis on how to infer history from cells naturally\nCertain features in a cell’s genetic material serve as natural markers for tracing lineage. These features arise spontaneously or accumulate over time, and researchers can compare them across related cells to reconstruct branching histories.\n\nMitochondrial DNA (somatic mutations):\nMitochondrial genomes can pick up small mutations as cells divide. (Note! There are a lot of types of other DNA in your cells beyond the typical DNA we think of in the 23 pairs of chromosomes. Your mitochondria has its own DNA.) By measuring these mutations, one can infer which cells share a common ancestor and roughly estimate how many divisions have occurred. However, because the mutation rate is not always high, it can be difficult to achieve fine-grained resolution.\nDNA copy number:\nGains or losses in chromosome segments, known as copy number variations, can also serve as lineage markers. Though useful for distinguishing large-scale genomic shifts, such variations do not necessarily arise in a predictable manner. This makes it challenging to reproducibly track precise cell-to-cell histories.\nFor examples of bulk-DNA phylogenetic tree, see . This is a massive field, so one citation is not doing this field justice. We’ll see this more in Section 8.3.\nDNA methylation:\nDNA methylation serves as another naturally occurring cellular barcode. Over time, cells acquire unique methylation patterns that reflect their lineage history. These epigenetic marks regulate gene expression and can be stably inherited through cell divisions. Because different tissues and cell types exhibit distinct methylation landscapes, analyzing these patterns can provide a historical record of a cell’s developmental path. However, while DNA methylation is useful for lineage tracing, its resolution is limited by the variability in methylation turnover rates and the difficulty of distinguishing cell-to-cell differences in a reproducible manner.\n\nThese naturally occurring barcodes, while informative, can be limiting in resolution. They may not mutate or appear frequently enough to trace detailed branching events. Additionally, reproducing the exact timing of such genetic changes in the wet lab can be difficult, making it hard to pinpoint when and how they impacted lineage formation.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#brief-aside-relation-to-snapshot-trajectory-inference",
    "href": "chapter8_lineage.html#brief-aside-relation-to-snapshot-trajectory-inference",
    "title": "9  Single-cell lineage tracing",
    "section": "9.3 Brief aside: Relation to “snapshot” trajectory inference",
    "text": "9.3 Brief aside: Relation to “snapshot” trajectory inference\nSnapshot-based methods, such as Monocle or Slingshot, rely on measuring gene expression states at a single time point (or a limited set of time points). They use computational models to infer the probable order and branching of cell fates based on these static profiles. While powerful, these methods rely on assumptions about the smoothness of transitions and may not capture rare events or subtle branching.\nLineage tracing complements snapshot-based methods by providing a direct record of which cells arose from the same ancestor. By confirming or refining the trajectories suggested by computational approaches, lineage tracing can validate inferred timelines, reveal overlooked branches, and identify rare subpopulations that might be missed in snapshot data alone. This integration leads to a more complete picture of cell fate decisions and improves our ability to predict and potentially manipulate cellular transitions.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#reconstruction-phylogenetic-tree-from-sclt",
    "href": "chapter8_lineage.html#reconstruction-phylogenetic-tree-from-sclt",
    "title": "9  Single-cell lineage tracing",
    "section": "9.4 Reconstruction phylogenetic tree from scLT",
    "text": "9.4 Reconstruction phylogenetic tree from scLT\nThe goal in this section is to provide a high-level overview of how we can reconstruct phylogenetic trees from single-cell lineage tracing (scLT) dataset, if we are using mutating barcodes. Remember, in single-cell sequencing experiments, we never get to see anything “directly” aside from sequences (of RNA, DNA, etc.) So we need to “estimate” the phylogenetic tree itself using the barcode edits. See Figure 9.7 for a conceptual illustration of this problem.\n\n\n\n\n\n\n\nFigure 9.7: From\n\n\n\n\nConceptually, this is our goal in a cartoon setting. (Technically, most lineage-tracing methods based on lentiviral barcodes return a claudogram (i.e., the edge lengths do not carry “time-information.” This is in contrast with a phylogram, where edge denote “amount of elapsed time since the branching event”). See ?fig-tree1 and ?fig-tree2.\n\n \n\n\n9.4.1 Brief review: Number of rooted trees\nGiven \\(n\\) nodes, how many possible phylogenetic trees are possible? Couldn’t we just enumerate all possible trees with \\(n\\) leaves, and determine which one is the “best one”? Think of this as a “caveman” optimization approach. All I need is a function that evaluates the “data agreement” score of a tree. Then, given single-cell data (either of scLT or copy numbers) of \\(n\\) cells, I can write down all possible trees (agnostic of data), and then pick the tree with the score that best agrees with data. What’s wrong with this approach?\nThe issue is that there is an explosion of possible trees. Let’s establish some ground rules. We will only talk about fully connected, binary, rooted trees where the \\(n\\) nodes are the leaves.\n\n\\(n\\) leaves: The \\(n\\) cells we observed are set to be leaves (sometimes called terminal nodes). (After all, we sequence all the cells at once, so we don’t actually observe the “parent” cell that divided to yield the two daughter cells we sequenced. Remember, over time, cells undergo mitosis to split into 2 cells.)\nFully connected and directed: All \\(n\\) leaves are connected by one graph. These \\(n\\) nodes are connected by \\(n-1\\) intermediate (unobserved) nodes.\nBinary and rooted: Every one of the \\(n-1\\) intermediate nodes has 2 children nodes. These children nodes could be one of the \\(n\\) leaves or one of the other intermediate nodes. Furthermore, every node has a parent except one special node called the “root node.” You can think of the root node as the common (unobserved) ancestor that spawned all the \\(n\\) cells.\n\n\n\n\n\n\n\n\nFigure 9.8: From https://microbenotes.com/phylogenetic-tree/\n\n\n\n\nWith these ground rules in place, we can prove the following result.\n\nGiven \\(n\\) named leaves, there are \\((2n - 3)!!\\) (where the \\(!!\\) denotes a double factorial1) possible rooted binary trees.\n\nHere is an informal sketch of the proof.\n\nWe prove that the number of fully resolved (binary) rooted phylogenetic trees on \\(n\\) labeled taxa (leaves) is given by\n\\[\nT_n = (2n - 3)!! = 1 \\times 3 \\times 5 \\times \\cdots \\times (2n - 3),\n\\tag{9.1}\\]\nvia induction.\nBase Case (\\(n=2\\)):\nFor \\(n=2\\), there is exactly one fully resolved rooted tree, consisting of a root node with two children (the two labeled leaves). Hence,\n\\[\nT_2 = 1.\n\\]\nInductive Step:\nAssume that for \\(n-1\\) leaves, the number of fully resolved rooted trees is given by \\(T_{n-1}\\). We show that the number of such trees for \\(n\\) leaves satisfies the recurrence relation\n\\[\nT_n = (2n - 3) \\times T_{n-1}.\n\\]\nTo form an \\(n\\)-leaf tree from a \\((n-1)\\)-leaf tree, we consider a particular \\((n-1)\\)-leaf tree and “split” one node. (By splitting, think of a “cherry” — a node with 2 children. We will take a node, set that to be a new internal node where one of its children is the original sub-tree of the node we picked, and the other child is the new leaf node for the \\(n\\)-leaf tree.)\nHence, we need to count how many possible nodes are available to split. In a fully resolved tree with \\(n-1\\) leaves, we have \\(n-2\\) internal nodes (i.e., “unobserved cells”), one of which is the root, and therefore, we have a total of \\((n-1)+(n-2) = 2n - 3\\) nodes.\nTherefore, there are \\((2n - 3)\\) such choices how to “split” a \\((n-1)\\)-leaf tree.\nSince there are \\(T_{n-1}\\) possible \\((n-1)\\)-leaf trees, (of which we have \\((2n - 3)\\) choices on how to form a \\(n\\)-leaf tree2), we have the relation,\n\\[\nT_n = (2n - 3) \\times T_{n-1}.\n\\]\n\nFor example, this means\n\\[\n\\begin{aligned}\nT_3 &= (2 \\times 3 - 3) \\times \\underbrace{T_2}_{=1} = 3, \\\\\nT_4 &= (2 \\times 4 - 3) \\times \\underbrace{T_3}_{=3} = (2 \\times 4 - 3) \\times (2 \\times 3 - 3) \\times 1 = 15.\n\\end{aligned}\n\\]\nSee Figure 9.9 for the trees enumerated.\nUsing the base case \\(T_2 = 1\\), repeated application of this recurrence gives\n\\[\nT_n = (2n - 3)!!.\n\\]\n:::\n\n\n\n\n\n\n\nFigure 9.9: From https://www.megasoftware.net/mega1_manual/Phylogeny.html\n\n\n\n\nSee (and related papers) for more context.\nSo… why is this result important? Observe that \\(n!!\\) is super exponential (i.e., it grows faster than an exponential3). So if you have \\(n=1000\\) cells, the number of possible trees you’ll try to enumerate is on the order of \\(1000^{1000} = 10^{3000}\\), which is way too many. See Figure 9.10.\nTherefore, when constructing phylogenetic trees, we need to be mathematically clever (probably with the help of some heuristic). Can we use some heuristic to drastically reduce the number of trees we’re going to even consider, and we can use our sequencing data of these \\(n\\) cells to help us in this endeavor?\n\n\n\n\n\n\n\nFigure 9.10: From https://calla.rnet.missouri.edu/cheng_courses/slides9.pdf\n\n\n\n\n\n\n9.4.2 Camin-Sokal maximum parsimony method\nThe Camin-Sokal maximum parsimony method is a phylogenetic reconstruction technique that aims to infer evolutionary relationships by minimizing the number of changes required to explain observed character states. (You’ll see this come up a lot when reading papers that reconstruct the phylogenetic tree from scLT data with mutating barcodes. You can think of this as the “baseline method” that every sc-phylogenetic method compares itself to.)\nThis method assumes that character states can only evolve in one direction, meaning once a trait is gained, it cannot be lost. Given a set of taxa and their character states, the algorithm constructs a tree that explains these states with the fewest evolutionary steps. While this method is computationally efficient for small datasets, it may oversimplify biological reality by enforcing irreversible character changes, limiting its applicability in cases where traits can reappear or revert.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#lentiviral-lineage-tracing",
    "href": "chapter8_lineage.html#lentiviral-lineage-tracing",
    "title": "9  Single-cell lineage tracing",
    "section": "9.5 Lentiviral lineage tracing",
    "text": "9.5 Lentiviral lineage tracing\n\n9.5.1 About the technology and application\nLentiviral approaches offer a more controlled way to label and track cell lineages. By inserting a known genetic barcode into cells, scientists can reliably follow how these labeled cells expand and diversify over time. See ?fig-barcode1, ?fig-barcode2, and ?fig-barcode3.\n\nIn static lineage barcoding, a lentivirus delivers a stable transgene (for example, GFP or RFP) containing a unique sequence in its untranslated region (UTR) to be integrated into the cell’s DNA. All progeny of an infected cell inherit this same sequence, making it straightforward to group related cells.\n(This won’t be the focus of the following sections. In static lineage barcoding, there is no phylogenetic tree. All the cell lineage information is relative to when the lentivirus was introduced to your cells.)\nIn mutating barcoding (or also called evolving barcode), a guide RNA (via CRISPR-Cas9) can introduce variations sometimes into a transgene reporter (a gene artificially integrated into the cell’s DNA) at various target sites.\nThis creates barcodes as “genetic scars” in descendant cells. This dynamic approach can provide a richer record of how cells diverge and acquire distinct identities.\n(There’s a lot more complexity to this. Here are some concerns that are a bit easier to explain:\n\nYou need make sure the Cas9 protein is continually being expressed over the course of the experiment.\n\nYou need to make sure you have enough diversity in the genetic scars that it’s unlikely two unrelated cells happened to acquire the same set of scars.\n\nThese CRISPR double-stranded breaks can lead to sometimes large deletion events. If there’s not a lot of different locations the transgene was integrated into the genome, or if the target sites are too close, then the multiple target sites might be deleted at once4.)\n\n\n\n  \n\nSee for fantastic overviews on both types of technologies.\nWhat can we do with this? As shown in Figure 9.11, in the cancer setting, we can use lineage barcoding to directly observe many qualities of cancer cells. See Figure 9.12 for a broader overview of different technologies and what biological insights they can reveal (based on what kind of information we can reconstruct from the barcode).\n\n\n\n\n\n\n\nFigure 9.11: From\n\n\n\n\n\n\n\n\n\n\n\nFigure 9.12: From\n\n\n\n\n\n\n9.5.2 For more reading on this technology\nSee , all of which are reviews that document the various ways labs have designed systems to record cellular history.\n\n\n9.5.3 Cassiopeia, for scLT barcodes: Illustrating a non-probabilistic modeling approach\nIn many CRISPR-lineage systems, each target site transitions exactly once from unedited to some specific indel state, and cannot revert (i.e., irreversible). This constraint helps reduce the multi-state problem to something akin to a binary “perfect phylogeny” assumption. However, real data can deviate from a true perfect phylogeny due to parallel evolution of the same indel or missing data.\n\nInput/Output. The input to Cassiopeia is the \\(\\{\\texttt{NA}, 0, 1, 2, \\ldots\\} \\in \\mathbb{R}^{n \\times m}\\) matrix of \\(n\\) cells and \\(m\\) possible target sites (i.e., Cas9-induced heritable insertions or deletions happened, also called indels). This is sometimes called the “character matrix”. Here, NA refers to “missing” (sometimes encoded as \\(-1\\) instead). 0 refers to the baseline sequence (i.e., unedited). Any positive integer (\\(1, 2, \\ldots\\)) denotes a categorical variable, that is, the type of indel mutation that happened at this site.\nThe output is a phylogenetic tree that is rooted binary where each of the \\(n\\) sequenced cells is a leaf, but this tree does not contain any temporal information about how “far in the past” the cell divisions happened (i.e., it’s a cladogram, not a phylogram).\nNotice that no scRNA-seq (gene expression) matrix is needed. All the sequencing that’s needed was to determine the genetic modifications at the target sites for these \\(n\\) cells.\n\nCassiopeia offers a couple different ways to construct its trees. We highlight two of these options below.\n\nCassiopeia-ILP (Steiner Tree Formulation):\nFirst, Cassiopeia-ILP constructs a directed acyclic “potential graph” whose vertices represent all plausible ancestral states (including the \\(n\\) observed leaves), and edges represent possible single-step mutations. The algorithm repeatedly merges pairs of nodes with a shared ancestor if they differ by a valid mutation, generating internal vertices. A user-defined parameter controls how large this potential graph may grow (to avoid excessive computational cost).\nOnce the potential graph \\(G\\) is built, the algorithm solves the Steiner tree problem on \\(G\\) with a flow-based integer linear programming (ILP). The ILP ensures each observed cell is reached from the root (the unmutated state) by a minimal set of edges, minimizing the total number of mutation events. This method is exact but can be computationally slow for large \\(n\\).\n\nThe Steiner tree problem is a combinatorial optimization problem that seeks the shortest possible network connecting a given set of points (terminals) while allowing additional intermediate points (Steiner nodes) to reduce the total length. In the context of evolutionary biology and phylogenetics, the Steiner tree approach can be used to infer ancestral relationships by identifying the most parsimonious connections between observed species. The problem is NP-hard, meaning exact solutions are computationally infeasible for large datasets. However, various heuristic and approximation algorithms have been developed to efficiently construct near-optimal Steiner trees in practical applications.\nThis is different from computing the minimal spanning tree because we don’t need the Steiner tree to include every node in \\(G\\). We just need it to contain the \\(n\\) leaves (i.e., the cells we actually observed). There might be hypothetical intermediate nodes (i.e., ancestral cells) in \\(G\\) that are not deemed necessary to be included in the output Steiner tree. See ?fig-cassiopeia1 and ?fig-cassiopeia2.\n\n(In short, you can imagine the first step of forming the potential graph \\(G\\) is to limit the space of possible phylogenetic trees — the returned tree must be a tree formed by the edges in \\(G\\). Then, in the second step, we formulate an ILP reminiscent of the Steiner tree problem to find the most “appropriate” tree.)\nCassiopeia-Greedy:\nThis algorithm builds the tree top-down, repeatedly choosing the most “frequent” or highest-priority mutation (unmutated \\(\\to\\) indel) to partition the cells into two subsets: those that carry that mutation vs. those that do not (i.e., it’s “greedy”).\nBecause CRISPR edits are irreversible, each multi-state site behaves effectively like a one-time event from an uncut state. Thus, one can treat each new indel as a potential splitting event. Cells with missing values at the chosen splitting site are assigned to whichever subset their non-missing edits best match. This step recurses until subsets become single cells or until all characters are used.\nGreedy is fast and scales to tens of thousands of cells, but may produce suboptimal solutions if extensive parallel evolution exists.\n\n\n \n\n\n\n9.5.4 Some implementation notes\n\nPriors on Indel Frequencies. Optionally, Cassiopeia can leverage empirical estimates of each indel’s probability to prioritize rare-but-frequent states (mitigating parallel evolution).\nMissing Data. Both ILP and greedy approaches accommodate missing data by enumerating or heuristically assigning cells to the most compatible subset.\n\n\n\n9.5.5 I’m very confused. Can you give me some more details?\nThere’s a lot of moving components since the lineage barcode data for mutating barcodes is quite unlike anything else we’ve seen in this course so far. Let me go through an example from https://cassiopeia-lineage.readthedocs.io/en/latest/notebooks/reconstruct.html (the Cassiopeia tutorial itself) to tell you what the “input data” for Cassiopeia is. (Once you understand the input data and how it was preprocessed, it’ll become clear what the output is.)\nIn a typical mutating lineage barcoding experiment, you get a bunch of gDNA or gRNA reads about the sequences of the barcodes that integrated into each cell. Then, you run bioinformatics code to align these sequences to a known reference genome to determine what happened at each target site of a cell’s barcode (i.e., did a mutation happen, if so, what was the insertion or deletion event, etc.). This is described in https://cassiopeia-lineage.readthedocs.io/en/latest/notebooks/preprocess.html. The output of this is an allele table that might look like Figure 9.13.\n\n\n\n\n\n\n\nFigure 9.13: From https://cassiopeia-lineage.readthedocs.io/en/latest/notebooks/reconstruct.html. We are showing 10 different integrated barcodes intBC (each with three target sites, r1 to r3) for the cell with RW.TTTGCGCCAAGAAAGG.\nSo you should expect every unique cell (i.e., unique cellBC) to have one or more integrated barcodes (for example, 10, as shown here). Furthermore, you hope that many different cells have the same integrated barcode, such as CTAGGGCATCTACG. (This is because you’re going to compare what happened at different target sites for cells that have the same integrated barcode to determine how these cells are related.)\nFor instance, in integrated barcode CTAGGGCATCTACG, we see at the first target site, CCGAA[None]AAATG, the None means there was no insertion or deletion event found at this site (relative to all the other sequences at the r1 region of this integrated barcode in the other cells).\nIn contrast, at the third target site r3, we see ATTCG[221:1D]GGAGG. This means at relative position 221 in this target site, there was a deletion that resulted in 1 base pair being deleted. (You can see in this screenshot that some of the deletion events can go up to 80+ base pairs, such as TGGCG[86:81D]CTCTG.) This large deletion event is okay (as long as it didn’t result in the deletion of a different target site) if the sequence alignment step could still determine that the flanking sequences to the deletion (in this case, TGGCG to the left and CTCTG to the right) still aligned to the reasonable positions to the target site for this barcode. Remember, you know what the full sequences of all these integrated barcodes are because these are all sequences you designed to be integrated into the cell’s DNA. See PCT48.ref.fasta in https://cassiopeia-lineage.readthedocs.io/en/latest/notebooks/preprocess.html.\n\n\n\n\nThis character matrix is the input to Cassiopeia — it now knows the type of mutation at each of the target sites for every cell, and then it’s going to try to estimate a phylogenetic tree from this.\n\n\n9.5.6 A brief note on other approaches\nCassiopeia doesn’t directly tell you some crucial pieces of information that you might want to know:\n1) how far in the past was the division (i.e., the “branch length”), and\n2) how fast are mutations happening (i.e., the “mutation rate”)?\nFor these, you could invoke more involved methods such as GAPML or ICE-FASE . On a different line of thinking, methods like LinTIMaT rely on using the lineage barcoding data alongside the scRNA-seq data (which tells you how similar two cells are based on either their annotated cell-types or expressed pathways) to construct phylogenetic trees.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#natural-lineage-barcodes-via-copy-number-alterations-cna",
    "href": "chapter8_lineage.html#natural-lineage-barcodes-via-copy-number-alterations-cna",
    "title": "9  Single-cell lineage tracing",
    "section": "9.6 Natural lineage barcodes via copy number alterations (CNA)",
    "text": "9.6 Natural lineage barcodes via copy number alterations (CNA)\n\n9.6.1 About the technology and application\nOne of the goals of why studying copy number variation in Section 8.3 was to understand cellular dynamics. So… how is this done?\nCopy number alterations (CNAs) are a hallmark of many cancers and arise due to genomic instability within tumor cells (refer back to ?fig-copy-number-cancer). Because cancer is often driven by such genomic instabilities, CNAs serve as a natural “barcode” of lineage. By tracking which genes or regions of chromosomes have been duplicated or lost over time, researchers can infer how subclones evolve and expand. These aberrations not only reveal how aggressive a tumor might be, but can also hint at its capacity for metastasis. Indeed, it is quite common to see particular copy number events that are associated with advanced disease states or resistance to therapy.\nAnother key advantage of using CNAs in cancer research is the ability to reconstruct phylogenetic trees of tumor evolution at single-cell resolution. Traditional bulk sequencing can obscure the heterogeneity of a tumor by averaging out signals across thousands or millions of cells, making it difficult to identify rare but important subpopulations. By examining individual cells, we can trace how specific lineages emerged, which mutations or copy number changes appeared first, and how these have proliferated. This level of detail helps us pinpoint the subclones that might be the most aggressive or metastatic, and may reveal new therapeutic targets based on the genetic changes that drove each lineage.\nFurthermore, once a phylogenetic tree is built from copy number data, the specific chromosomal regions that underwent duplication or deletion can yield insight into the biology of the tumor. Some genomic loci harbor oncogenes or tumor suppressors, so gains or losses in these regions can be especially detrimental—or beneficial, from the tumor’s perspective. Such events might correlate with faster growth, immune evasion, or other clinically significant traits. By focusing on these recurrently altered regions, researchers and clinicians can identify potential biomarkers for prognosis or drug targets for personalized therapy. See Figure 9.14 as an example of what this workflow looks like.\n\n\n\n\n\n\n\nFigure 9.14: From . Imagine we have longitudinal samples of a person. Those tissue samples get single-cell sequenced. Then a variant calling happens, and then we want to learn a clone tree, which is the focus for the type of tree we’re discussing in these notes.\n\n\n\n\nThese output phylogenetic trees might look like the ones in ?fig-dice1 and ?fig-dice2.\n(As a sidenote: be sure to understand what the branch lengths mean in a phylogenetic tree. Here, these branch lengths denote the “distance” between two cells’ CNA profiles. (The longer the branch, the more it’s different.) Other methods use the branch length to denote time, i.e., the longer the branch, the more time has elapsed since the branching event. Most methods (in my experience) do not give you branch lengths relative to time, since this would require you (the data analyst) to provide the method with more biological information. For example, how fast do certain CNA events happen? You would need to provide this additional information to your phylogenetic method for it to know how to estimate branch lengths that denote time.)\n\n \n\n\n\n9.6.2 COMPASS, for scDNA copy number: Illustrating a probabilistic approach\nCOMPASS (Joint Copy Number and Mutation Phylogeny from Amplicon Single-Cell DNA Sequencing) is a probabilistic model designed to reconstruct a branching evolutionary tree of SNVs (single-nucleotide variants) and CNAs (copy number alterations) from single-cell DNA sequencing data. It accommodates both allele-specific copy number changes (loss, gain, copy-neutral loss of heterozygosity) and single-nucleotide events, all integrated into a single phylogenetic structure.\n(In COMPASS, there are meaningful branch lengths. The output is simply a cladogram.)\n\n\n\n\n\n\n\nFigure 9.15: From .\nSome basic terminology: 1) SNV (Single Nucleotide Variant): A change in a single nucleotide of the DNA sequence.\n2) Loss: (Not shown in this figure) A deletion of one copy of a chromosomal region. For instance, in the usual 23 pairs of human chromosomes, one region could be deleted from one copy of Chromosome 1, while remaining intact on the other copy.\n3) CNLOH (Copy-Neutral Loss of Heterozygosity): A copy number alteration that preserves the total number of chromosome copies but still removes heterozygosity. In other words, the cell ends up with the same number of copies overall, yet the two copies become identical (losing heterozygosity).\n4) Gain: The opposite of a “loss.” This could involve duplicating a specific chromosomal region (thus elongating that chromosome) or duplicating the entire chromosome (leading to three copies of Chromosome 1, instead of the usual two).\n\n\n\n\n\nInput/Output. The input to COMPASS is\n1) \\(D \\in \\mathbb{Z}_+^{n \\times d}\\) denoting the total read count per DNA region (among \\(d\\) regions) for each of the \\(n\\) cells, and\ntwo matrices \\(X, Y \\in \\mathbb{Z}_+^{n \\times d}\\) denoting the number of DNA reads containing each SNV (among \\(d\\) SNVs) among the \\(n\\) cells.\nFor example, let \\(X_{ij}\\) denote the number of DNA reads from cell \\(i\\) that contained the major allele (i.e., “reference”) for SNV \\(j\\), and \\(Y_{ij}\\) denote likewise but for the minor allele (i.e., “alternative”) for SNV \\(j\\).\nThe output is a cladogram among the \\(n\\) cells. More specifically, COMPASS outputs a tree where the “internal nodes” denote what type of mutation happened, and cells are “attached” to these internal nodes (denoting that this cell followed this specific sequence of mutations, starting from the root of the tree).\n\nHere are the overall ideas of COMPASS. Both total coverage (for copy number inference) and allele-specific coverage (for LOH and SNV calling) are going to be part of the likelihood to help model the likelihood of a particular tree (which will be used to determine the tree that best fits the data).\n\nModel constraints:\nCOMPASS models four classes of mutations:\n\nSNVs, each occurring exactly once in the tree,\n\nLoss, which removes one copy of an allele in a region,\n\nGain, which increases the copy number of a region, and\n\nCNLOH (copy-neutral LOH), which replaces one allele with another while keeping total copy number constant.\n\nEach region can undergo CNAs at most once per lineage. When subclones exhibit multiple consecutive CNAs in a region, COMPASS in practice uses a single-event approximation to avoid ambiguous high copy numbers. (This is a parsimonious principle, in some sense. We’re dramatically limiting the number of trees that are going to be considered with these constraints.)\nCoverage and allelic likelihoods:\nThere are two components to model the likelihood, one for the SNVs, one for the CNAs.\n\nFor the CNAs, we have a coverage model. COMPASS uses a negative binomial distribution for each region’s total reads to capture overdispersion. Each region \\(j \\in \\{1,\\ldots,d\\}\\) is assigned a baseline coverage weight \\(\\rho_k\\) (reflecting primer efficiency, etc.), so if a cell’s node in the phylogeny has copy number \\(\\text{cn}_k\\), the expected read depth is scaled accordingly.\nFor the SNVs, we have an allelic model. For each locus \\(j \\in \\{1,\\ldots,p\\}\\), COMPASS directly uses read counts \\((\\text{REF}_i, \\text{ALT}_i)\\) under a Beta-Binomial model, allowing for overdispersion in allele fraction. Each variant has a dropout rate \\(\\mu_i\\), reflecting the probability that a given allele is lost (PCR failure), and the method marginalizes over all possible dropout configurations (\\(k\\) reference copies vs. \\(l\\) alternate copies).\n\nCell-to-node assignments:\n(Here, “node” refers to a mutation event, which are internal nodes in our tree.) COMPASS marginalizes over cell attachments to genotype nodes. Let \\(\\pi_k\\) be a prior probability that any cell is attached to node \\(k\\). The algorithm thus sums\n\\[\n\\sum_{k} \\pi_k \\, \\prod_{i=1}^{p} P(\\text{region reads}|\\dots) \\,\\prod_{i=1}^{d} P(\\text{allelic reads}|\\dots)\n\\]\nfor each cell.\nSimulated annealing:\nSimulated annealing is a useful statistical technique for reconstructing a phylogenetic tree from single-cell DNA data because we want to search through a vast space of possible evolutionary histories5. Each candidate tree is defined by how individual copy number events and mutations are arranged and passed down through successive subclones.\nA naive or purely greedy search might easily get stuck in suboptimal solutions, given the noisy nature of single-cell data and the combinatorial explosion of possible trees. By gradually “cooling” the exploration of this space — starting from more random moves and then narrowing down to finer adjustments — simulated annealing helps ensure that the final solution is not merely a local optimum. In other words, this strategy balances the need for broad exploration early on with the requirement of a precise, fine-grained search later, thereby increasing the likelihood of discovering a high-probability lineage structure.\n\nCOMPASS employs a simulated annealing approach over the discrete space of trees:\n\nStart with a random initial tree (random parent pointers, random SNV allocation, no CNAs).\nPropose local “moves” (adding or removing a node, reassigning mutations, introducing or removing a CNA, etc.).\nAccept or reject based on the ratio of posterior probabilities at a current “temperature” to allow exploration; gradually decrease the temperature to refine solutions.\n\nTo simulate potential trees, we need a prior distribution over trees. COMPASS will pick a prior to discourage trees with excessive branching or excessive CNA events. Specifically, it penalizes the total number of nodes and the number of CNA events. Longer CNAs across consecutive amplicons are treated as a single event. CNLOH events may be penalized more due to their strong effect on the allelic fraction.\nParameter Updates. Node weights \\(\\{\\pi_k\\}\\) (i.e., the probability any cell is attached to an internal node) and other parameters are estimated by an Expectation-Maximization (EM) step:\n\nE-step: Compute the posterior probabilities that cell \\(i\\) belongs to node \\(k\\), given the current tree and parameters.\nM-step: Update \\(\\pi_k\\) as the average posterior membership across cells.\n\nThis EM routine is invoked each time we propose or accept a new tree in the simulated annealing.\n(The EM algorithm is another useful statistical technique whenever you’re dealing with a model with unobserved variables. Here, our unobserved variable is whether or not a cell \\(i\\) is attached to node \\(k\\).)\nSee Figure 9.16 for an illustration of what the results could look like.\n\n\n\n\n\n\n\nFigure 9.16: From .\n\n\n\n\n\n\n9.6.3 A brief note on other approaches\nSo… what exactly are these trees good for?\nAs we’ve mentioned, you can see in Figure 9.16 that COMPASS is trying to learn the mutation event that happened at each node. (This gives us a clue on how deleterious the mutation event is. As a simple example, if there was a loss in copy number in a region that contains a cancer suppressive gene, we might expect rapid proliferation of this cancer cell.)\nOn the other hand, what we will talk more about in Chapter 9 is combining these phylogenetic trees with spatial information about these cells. See Figure 9.17.\n\n\n\n\n\n\n\nFigure 9.17: From . Panel a is the copy number events for each cell (here, this is actually based on spatial transcriptomics), and panel b is the estimated phylogenetic tree. From the tree, they can look at the spatial position of each clone and literally see on the 2D tissue slice how cancer clones (potentially aggressively) expanded in this tissue slice. The phylogenetic information gave us clues on which cancer subclone originated from which.\n\n\n\n\n\n\n\n\nAshouri, Arghavan, Chufan Zhang, and Federico Gaiti. 2023. “Decoding Cancer Evolution: Integrating Genetic and Non-Genetic Insights.” Genes 14 (10): 1856.\n\n\nMarine, Jean-Christophe, Sarah-Jane Dawson, and Mark A Dawson. 2020. “Non-Genetic Mechanisms of Therapeutic Resistance in Cancer.” Nature Reviews Cancer 20 (12): 743–56.\n\n\nStephenson, Emily, Gary Reynolds, Rachel A Botting, Fernando J Calero-Nieto, Michael D Morgan, Zewen Kelvin Tuong, Karsten Bach, et al. 2021. “Single-Cell Multi-Omics Analysis of the Immune Response in COVID-19.” Nature Medicine 27 (5): 904–16.\n\n\nWeinreb, Caleb, Alejo Rodriguez-Fraticelli, Fernando D Camargo, and Allon M Klein. 2020. “Lineage Tracing on Transcriptional Landscapes Links State to Fate During Differentiation.” Science 367 (6479).",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter8_lineage.html#footnotes",
    "href": "chapter8_lineage.html#footnotes",
    "title": "9  Single-cell lineage tracing",
    "section": "",
    "text": "See https://en.wikipedia.org/wiki/Simulated_annealing↩︎\nFormally, you would also need to prove that all the unique \\(n\\)-leaf trees formed this way from one particular \\((n-1)\\)-leaf tree is distinct from any possible \\(n\\)-leaf tree formed from a different \\((n-1)\\)-leaf tree.↩︎\nYou can approximate \\(n!\\) by \\(n^n\\). See https://en.wikipedia.org/wiki/Stirlings_approximation.↩︎\nSee https://en.wikipedia.org/wiki/Simulated_annealing↩︎\nSee https://en.wikipedia.org/wiki/Simulated_annealing↩︎",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Single-cell lineage tracing</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html",
    "href": "chapter9_spatial.html",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "10.1 The broad categorization of spatial transcriptomic technologies\nSingle-cell spatial transcriptomics is an emerging technology that enables the measurement of gene expression while preserving the spatial organization of cells within a tissue. See Figure 10.1 for a useful schematic I like. Unlike traditional single-cell RNA sequencing, which dissociates cells and loses spatial context, spatial transcriptomics allows researchers to analyze gene expression in relation to cellular neighborhoods, tissue architecture, and microenvironments, see Figure 10.2.\nThe spatial arrangement of cells is fundamental to understanding cell biology, as cellular functions are often influenced by their local microenvironment:\nAs one concrete example of how spatial transcriptomics advances cell biology beyond what other sequencing technologies offers: spatial transcriptomics is particularly valuable for studying cell-cell communication, as it enables the identification of ligand-receptor interactions that mediate signaling between neighboring cells. By integrating spatial data with single-cell transcriptomics, researchers can infer functional relationships between different cell types, uncovering regulatory networks that drive biological processes.\nNote: Spatial information in cell biology has been studied for decades, long before single-cell sequencing became commercially feasible. Techniques like fluorescence in situ hybridization (FISH) have been used to visualize the spatial localization of specific RNA molecules within cells, providing crucial insights into gene expression patterns. Microscopy-based methods, including confocal and super-resolution imaging, have also been instrumental in understanding cellular structures and interactions. The key novelty of modern spatial transcriptomics is its ability to scale these analyses – rather than measuring just a few genes at a time, we can now capture the spatial expression patterns of hundreds to thousands of genes simultaneously, enabling a much more comprehensive view of cellular organization and function.\nSpatial transcriptomic technologies can be broadly categorized into two main approaches: spot-based methods and imaging-based methods, see Figure 10.4 and Figure 10.5.\nSee Figure 10.6, Figure 10.7, and Figure 10.9 for examples of what these datasets look like, and how spot- and imaging-based spatial transcriptomics could yield quite dramatically different datasets.\nSee Figure 10.10 for a table of many possible technologies to perform spatial transcriptomics.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#the-broad-categorization-of-spatial-transcriptomic-technologies",
    "href": "chapter9_spatial.html#the-broad-categorization-of-spatial-transcriptomic-technologies",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "Figure 10.4: Left: From https://hutchdatascience.org/Choosing_Genomics_Tools/spatial-transcriptomics-1.html\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.5: Right: From https://geneviatechnologies.com/bioinformatics-analyses/spatial-transcriptomic-data-analysis/\n\n\n\n\n\nSpot-based technologies utilize sequencing-based approaches to capture gene expression across a tissue section. These methods typically involve placing spatially barcoded capture spots on a slide, allowing RNA molecules from the tissue to be sequenced while retaining their spatial information. Spot-based techniques offer broad coverage across the entire transcriptome, making them well-suited for large tissue sections and unbiased gene discovery. However, they have relatively low spatial resolution due to the size of the capture spots and may lack sufficient depth for detecting lowly expressed but biologically significant genes.\nImaging-based technologies rely on multiplexed imaging methods to visualize gene expression directly within tissues. These approaches build upon fluorescence in situ hybridization (FISH) and other imaging techniques, enabling subcellular resolution of RNA molecules. By using sequential hybridization cycles with fluorescent probes, imaging-based methods can measure the expression of dozens to hundreds of preselected genes. While this high-resolution approach provides detailed spatial maps at the single-molecule level, it requires prior selection of target genes and computationally intensive methods to delineate cell boundaries from dense tissue images.\n\n\n\n\n\n\n\n\n\nFigure 10.6: Top: From https://www.trillium.de/en/journals/trillium-pathology/archive/2024/tp-1/2024/ai-in-pathology/integration-of-spatially-resolved-transcriptomics-into-pathological-research-opportunities-and-challenges.html\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.7: Bottom: From Figiel et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.8: From Longo et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.9: From Rademacher et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.10: From https://rubd.github.io/Giotto_site/. (This figure is rapidly becoming out-dated. I would argue and say this figure is already nearly unrepresentative of the field.)\n\n\n\n\n\nRemark 10.1. These are all 2D tissue slices! Our body is three-dimensional (unsurprisingly). However, all the spatial information we are collecting is typically 2D. (Some really rich consortiums have sequenced many cross-sectional 2D slices to reconstruct the 3D organ, for example M. Zhang et al. (2023). However, most single-PI labs do not have the budget to do this. Therefore, it’s important you ask yourself: “Is it possible I am misleading myself by analyzing a 2D tissue slice when my question is about the 3D organ?”\nIt’s entirely possible that the cellular organization/dynamics on a 2D tissue slice is representative of the overall tissue. It’s also entirely possible that it’s not. Knowing how the 2D tissue was selected (i.e., how did someone even choose this specific cross-section in the first place?) is an important question to answer before you can even start thinking mathematically on how your 2D findings relate back to the 3D shape.\n\n\n10.1.1 Sequencing-based: Visium (10x)\nVisium by 10x Genomics is a widely used spot-based spatial transcriptomics technology. See Figure 10.11 for a cartoon on how it works. Visium captures transcriptomic information within predefined spatial spots on a tissue section, allowing for spatially resolved gene expression profiling. However, each spot is relatively large (usually around 55 µm in diameter), often encompassing multiple cells. To infer cellular composition within each spot, computational deconvolution methods are typically applied. In addition to transcriptomic data, Visium also provides an H&E (hematoxylin and eosin) stained image of the tissue, which is valuable for histological context, aiding in the interpretation of spatial gene expression patterns and tissue architecture. ?fig-spatial-analyses provides examples of this spot-based spatial transcriptomics.\n\n\n\n\n\n\n\nFigure 10.11: From Duan, Cheng, and Cheng (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.12: Left: From Kim, Choi, and Lee (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.13: Right: From https://satijalab.org/seurat/articles/spatial_vignette\n\n\n\n\n\n\n10.1.2 Sequencing-based: Visium HD (10x)\nVisium HD is an advanced version of Visium that significantly improves spatial resolution, see Figure 10.14 and Figure 10.15. Unlike standard Visium, which has relatively large spots, Visium HD features smaller spots, allowing for higher spatial resolution and better separation of individual cells. This enhancement enables more precise mapping of transcriptomic data to tissue morphology. However, the increased resolution comes at a higher cost, as sequencing expenses rise due to the need for greater sequencing depth to capture the finer spatial granularity.\n\n\n\n\n\n\n\nFigure 10.14: Left: From https://imaging.as.uky.edu/visium-hd-spatial-transcriptomics. See more at https://www.10xgenomics.com/spatial-transcriptomics#what-is-spatial-transcriptomics.\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.15: Right: From https://x.com/AlbertVilella/status/1367028429300916225\n\n\n\n\n\n\n10.1.3 Imaging-based: MERFISH/MERSCOPE (Vizgen)\nMultiplexed Error-Robust Fluorescence In Situ Hybridization (MERFISH) is an imaging-based spatial transcriptomics method that enables the detection of hundreds to thousands of preselected RNA transcripts in a tissue section. It operates by hybridizing barcoded probes to RNA molecules, followed by multiple rounds of imaging to decode the transcript identities, see Figure 10.16. Since MERFISH provides subcellular resolution, it allows precise localization of transcripts within individual cells, but it requires computational cell segmentation to assign transcripts to specific cells. MERSCOPE is a commercial platform for MERFISH, providing an integrated solution for sample preparation, imaging, and data analysis. See Figure 10.17 and Figure 10.18 for examples of the data.\n\n\n\n\n\n\n\nFigure 10.16: From Chen et al. (2015)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.17: Top: From M. Zhang et al. (2023). Here, each “dot” is a cell colored by its cell type (after a cell segmentation was run to determine which RNA transcripts belonged to which cell).\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.18: Bottom: From Chen et al. (2015). Here, each “dot” is an RNA transcript colored by the different genes that the RNA transcript came from. (This figure is more representative of what the “raw data” looks like.)\n\n\n\n\n\n\n10.1.4 Imaging-based: Xenium (10x)\nXenium by 10x Genomics is another imaging-based spatial transcriptomics platform, designed to profile a targeted set of transcripts with subcellular resolution. Unlike sequencing-based approaches, Xenium relies on fluorescence imaging to detect preselected RNA targets within tissue sections. See Figure 10.19 for a comparison. It enables high-throughput spatial mapping of gene expression while preserving tissue morphology. As with other imaging-based methods, accurate cell segmentation is essential to delineate individual cells and associate detected transcripts with them. (There are many papers that try comparing Xenium and MERSCOPE. See Figure 10.20 for one paper.)\n\n\n\n\n\n\n\nFigure 10.19: From Lee et al. (2024)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.20: From Hartman and Satija (2024)\n\n\n\n\nSee more at https://www.10xgenomics.com/blog/optimizing-your-spatial-transcriptomics-research-with-visium-hd-and-xenium-in-situ.\n\n\n10.1.5 So, what should I use?\nIf you are about to collect spatial transcriptomics data yourself, it’s important to first consider what you’re trying to biologically investigate (since this data will be quite expensive to collect). Are you trying to explore the complexity of a tissue, or are you trying to definitively prove the existence (or lack thereof) of something? The nature of your biological question might make it apparent which technology best suits your needs. See Figure 10.21.\n\n\n\n\n\n\n\nFigure 10.21: From Williams et al. (2022). (I think “CosMx” is incorrectly labeled in this figure? It is more of an imaging-based method.)\n\n\n\n\nSee a massive review of the benefits and drawbacks of different spatial transcriptomics technologies in Lee et al. (2024), Liao et al. (2021), Duan, Cheng, and Cheng (2023).",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#a-whirlwind-of-other-tasks",
    "href": "chapter9_spatial.html#a-whirlwind-of-other-tasks",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.2 A whirlwind of other tasks",
    "text": "10.2 A whirlwind of other tasks\nBeyond generating spatial transcriptomic data, a variety of computational tasks are necessary to ensure accurate interpretation and integration with other biological information. These tasks broadly fall into two categories: preprocessing and statistical analysis.\n\n10.2.1 Preprocessing\nRaw spatial transcriptomic data often require substantial preprocessing to correct for technical artifacts and enhance interpretability. One key step is integration, where spatial data are aligned with other tissue slides or combined with histological information, such as the H&E stain, to provide morphological context. Contamination removal is another crucial step, as transcripts may originate from neighboring cells or ambient RNA, especially in spot-based approaches. Additionally, imputation techniques can be applied to recover missing gene expression values, particularly in spot-based methods where some spots may have low or undetectable expression due to sequencing depth limitations.\n\n\n10.2.2 Statistical analyses\nOnce preprocessed, spatial transcriptomic data can be analyzed using various statistical approaches to uncover biological insights. Identifying spatially variable genes helps determine which genes exhibit spatially structured expression patterns, highlighting key regulators of tissue organization. Another common analysis involves defining spatial domains, where clustering techniques identify tissue regions with distinct gene expression profiles while accounting for spatial proximity. For spot-based methods, cell-type deconvolution is used to estimate the composition of different cell types within each spot, given that multiple cells may contribute to a single measurement. In imaging-based methods, cell segmentation is a critical computational step, where individual cells are delineated based on transcript localization and morphological features to achieve single-cell resolution.\nSee Figure 10.12, Figure 10.13, Figure 10.22, and Figure 10.23 (and the papers these figures come from) for a broad overview of all the different types of analyses you can do with spatial transcriptomics.\n\n\n\n\nLeft: From https://geneviatechnologies.com/bioinformatics-analyses/spatial-transcriptomic-data-analysis/\n\n\n\n\n\n\n\nRight: From Kiessling and Kuppe (2024)\n\n\n\n\n\n\n\n\n\n\nFigure 10.22: Top: From Park et al. (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.23: Bottom: From (zhou2023spatial?)\n\n\n\n\n\nRemark 10.2. Remember, after we collect the tissue from a donor, we don’t really care about the donor anymore. We care about the biology One of the trickiest (statistical) philosophical roadblocks you’ll encounter when you work on spatial transcriptomics is: “What on earth is the ‘population’ I’m studying?” You’ll need to think really hard about variation that might occur within an individual or between different individuals. (Spatial transcriptomics by itself is currently financially unrealistic to be a reliable tool for biomarker detection, unlike other biomedical technologies such as MRI, PET scans, CT scans, staining of tissue slices, etc.)\nIt’s not uncommon to only have one or two spatial transcriptomic tissue slices for an entire study. (This is really a reflection about how expensive and laborious getting this data is.) In that case, are you really just learning biology about this one specific person? How do you know that the donor’s biology is representative of overall human biology?\nBroadly speaking, there are two philosophical approaches to handle this:\n\nYou don’t: Some papers simply show “existence.” That is, they have a statement that is of the flavor, “Our paper demonstrates that this phenomenon can occur in tissue, because we have found evidence of it existing in our tissue.” The benefit of this strategy is that you can always claim this, and there is still room for scientific novelty. However, you cannot make any statement that generalizes beyond your specific tissue. Hence, it’s really important you pick really “interesting” tissue slices for this approach.\nRelate everything back to the omics: It’s difficult to “integrate” tissue slices from two completely different people together. (You can think about how impossibly hard this is, especially if you have familiarity with MRI data. How would you “align” my lung tissue slice with your lung tissue slice? What if my lungs are slightly bigger/smaller in certain regions than yours?) Unlike single-cell data (where we can just combine the cells across many donors), in spatial transcriptomics, you are usually instead relating all your findings on\n\n\nFor examples of what type of analyses you can do with spatial transcriptomics data (beyond what we’ll discuss in these notes), see: https://hutchdatascience.org/Choosing_Genomics_Tools/spatial-transcriptomics-1.html, https://squidpy.readthedocs.io/en/stable/, and https://giottosuite.readthedocs.io/en/master/.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#cell-cell-communication",
    "href": "chapter9_spatial.html#cell-cell-communication",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.3 Cell-cell communication",
    "text": "10.3 Cell-cell communication\nCell-cell communication is a fundamental process in biology that enables cells to coordinate their behavior, maintain homeostasis, and respond to environmental stimuli. Through various signaling mechanisms, cells transmit biochemical signals that regulate development, immune responses, tissue repair, and disease progression. The ability to understand and map these communication networks is crucial for uncovering mechanisms underlying diseases such as cancer, neurodegenerative disorders, and immune dysfunctions. With advances in spatial transcriptomics and single-cell technologies, researchers can now investigate cell-cell communication at unprecedented resolution, allowing for insights into how cells interact in complex tissue environments.\n\n10.3.1 How do cells communicate with one another?\nCells communicate using multiple signaling modalities, each suited for different biological contexts:\n\nAutocrine signaling: A cell releases signaling molecules that bind to its own receptors, allowing it to regulate its own behavior. This is common in immune responses and cancer progression.\nGap junction signaling: Cells directly exchange ions and small molecules through specialized intercellular channels called gap junctions. This form of communication is rapid and crucial in electrically excitable tissues like the heart and nervous system.\nParacrine signaling: Cells secrete signaling molecules that diffuse over short distances to affect neighboring cells. This is commonly seen in tissue development and inflammation.\nEndocrine signaling: Hormones are released into the bloodstream and travel long distances to regulate distant target cells. This is a key mechanism in systemic physiological regulation, such as insulin signaling in metabolism.\n\nSee these illustrated in Figure 10.24.\n\n\n\n\n\n\n\nFigure 10.24: From https://frontlinegenomics.com/methods-to-study-cell-cell-communication/\n\n\n\n\nWhat do we do with these results? There are many types of results we could publish. Visually, these are summarized in Figure 10.25.\n\n\n\n\n\n\n\nFigure 10.25: From Armingol et al. (2021)\n\n\n\n\n\n\n10.3.2 Brief aside: Ligand-receptor pairs\nCell-cell communication often relies on ligand-receptor interactions. A ligand is a signaling molecule (such as a protein, peptide, or small molecule) that binds to a receptor, a transmembrane or intracellular protein that mediates a cellular response, see Figure 10.26, Figure 10.27, and Figure 10.28. Ligand-receptor interactions trigger cascades of intracellular signaling events, leading to diverse functional outcomes.\n\n\n\n\n\n\n\nFigure 10.26: From https://commons.wikimedia.org/wiki/File:Ligand-receptor_interaction.png\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.27: Top: From https://www.khanacademy.org/science/biology/cell-signaling/mechanisms-of-cell-signaling/a/introduction-to-cell-signaling\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.28: Bottom: From https://biocircuits.github.io/chapters/13_promiscuous_binding.html. Notice: Ligand-receptor pairs are not one to one! A ligand can bind to many different types of receptors, and vice versa.\n\n\n\n\nTo systematically study these interactions, several databases compile known ligand-receptor pairs:\n\nCellChatDB Jin et al. (2021): A curated database that includes signaling pathways and interactions inferred from literature and experimental data.\nCellPhoneDB (efremova2020cellphonedb?): A database that maps ligand-receptor interactions based on transcriptomic data and protein complex structures, see Figure 10.29. See https://cellphonedb.readthedocs.io/.\nFANTOM5: A large-scale functional annotation project that includes information on secreted ligands and their corresponding receptors.\n\n\n\n\n\n\n\n\nFigure 10.29: From (efremova2020cellphonedb?). Here, the rows represent different ligand-receptor pairs, and the columns represent different cell types.\n\n\n\n\nGene expression data plays a critical role in understanding cell-cell communication. By measuring the expression levels of ligands and receptors across different cell types, researchers can infer potential signaling interactions. Advances in spatial transcriptomics further enhance this analysis by preserving spatial context, allowing for the reconstruction of communication networks within tissues. Computational tools, such as COMMOT, integrate gene expression data with spatial information to infer cell-cell signaling and its functional consequences.\n\n\n10.3.3 Using spatial transcriptomics to study cell-cell communication\n\n10.3.3.1 Pause: We’ve actually been studying cell-cell communication long before spatial transcriptomics became commercially viable. It just relied on some leaps of faith.\nBefore the advent of spatial transcriptomics, researchers inferred cell-cell communication primarily from single-cell RNA sequencing (scRNA-seq) data. By identifying which cells expressed specific ligands and which expressed corresponding receptors, computational methods could predict potential signaling interactions, see Figure 10.30 and Figure 10.31. However, this approach required a key assumption: that interacting cells were in close spatial proximity, even though spatial relationships were not directly measured. Furthermore, we assumed that there was a close relation between high gene expression and high abundance of the corresponding ligand (or receptor).\n\n\n\n\n\n\n\nFigure 10.30: Top: From Armingol et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.31: Bottom: From Armingol et al. (2021)\n\n\n\n\nAdditional information, such as histological staining or known tissue structures, sometimes provided indirect spatial context. For example, in well-characterized tissues like the intestine or brain, researchers could infer likely cell-cell interactions based on prior anatomical knowledge. However, these inferences were often imprecise and required validation through techniques like immunohistochemistry or in situ hybridization.\nWith spatial transcriptomics, these leaps of faith are no longer necessary. We can now directly observe which cells are adjacent or within signaling range, making it possible to study cell-cell communication with much higher confidence, see Figure 10.32 and Figure 10.33. This allows researchers to investigate how signaling networks vary across different tissue regions, uncover spatially organized signaling niches, and refine our understanding of how tissue structure influences intercellular communication.\n\n\n\n\n\n\n\nFigure 10.32: From Almet et al. (2021)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.33: From Longo et al. (2021)\n\n\n\n\nCOMMOT (COMMunication analysis by Optimal Transport) Cang et al. (2023) is a computational framework designed to infer cell-cell communication (CCC) from spatial transcriptomic data. Unlike traditional methods that examine ligand-receptor interactions independently, COMMOT considers multiple ligand-receptor pairs simultaneously while incorporating spatial constraints. See Figure 10.34.\n\nInput/Output. The input to COMMOT is 1) a spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(X \\in \\mathbb{R}^{n \\times p}\\) for \\(n\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n\\) cells, and 2) a database of known ligand-receptor pairs for \\(n_l\\) ligands and \\(n_r\\) receptors (alongside which ligands are known to bind to which receptors), of which the \\(n_l+n_r\\) ligand and receptors should correspond to some of the \\(p\\) genes. The output is: for each ligand \\(i\\) and receptor \\(j\\), a map among the 2D tissue slice of how much “mass” of each ligand is transported to each receptor.\n\n\n\n\n\n\n\n\nFigure 10.34: From Cang et al. (2023)\n\n\n\n\n\nOptimal transport for a single ligand-receptor pair: Given a ligand \\(i\\) and receptor \\(j\\), COMMOT formulates the inference of CCC as an optimal transport problem. The goal is to determine the transport plan \\(P_{\\ell,r} \\in \\mathbb{R}^{n\\times n}_+\\) for \\(n\\) cells, where \\([P_{\\ell,r}]_{k,l}\\) quantifies the strength of signaling from sender cell \\(i\\) to receiver cell \\(j\\) through the ligand-receptor pair \\((\\ell,r)\\). This is achieved by minimizing the transport cost:\n\\[\n\\min_{P_{\\ell,r} \\in \\Gamma_{\\ell,r}} \\langle P_{\\ell,r}, C_{\\ell,r} \\rangle_F\n\\tag{10.1}\\]\nwhere \\(C_{\\ell,r} \\in \\mathbb{R}^{n \\times n}_+\\) is a spatially constrained cost matrix encoding the physical distances between cells (think: Euclidean distance between any two cells along this 2D plane), and \\(\\Gamma_{\\ell,r}\\) is the set of allowable transport plans:\n\\[\n\\Gamma_{\\ell,r} = \\Big\\{P_{\\ell,r} :  \\sum_{j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}, \\quad \\sum_{i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\\Big\\}\n\\tag{10.2}\\]\nwhere \\(X_{i,\\ell}\\) and \\(X_{j,r}\\) represent the expression levels of the ligand and receptor in the respective cells.1\nGeneralization to multiple ligand-receptor pairs: COMMOT extends the optimal transport framework to simultaneously infer multiple ligand-receptor interactions, rather than treating them separately. This is formulated as a collective optimal transport problem, where multiple ligand and receptor species interact within spatial constraints while competing for signaling resources.\nGiven \\(n_l\\) ligand species and \\(n_r\\) receptor species, the method optimizes a transport plan \\(P \\in \\mathbb{R}^{n_l \\times n_r \\times n \\times n}_+\\), where \\([P_{\\ell,r}]_{k,l}\\) quantifies the signaling strength from sender cell \\(i\\) to receiver cell \\(j\\) through ligand \\(\\ell\\) and receptor \\(r\\). The optimization problem is formulated as:\n\\[\n\\min_{P} \\sum_{(\\ell,r) \\in I} \\langle P_{\\ell,r}, C_{\\ell,r} \\rangle_F + \\rho (\\|\\mu\\|_1 + \\|\\nu\\|_1),\n\\tag{10.3}\\]\nwhere:\n\n\\(C_{\\ell,r} \\in \\mathbb{R}^{n \\times n}_+\\) is a spatial cost matrix encoding distances between cells for ligand-receptor pair \\((\\ell,r)\\),\n\\(\\mu_{i,\\ell} = X_{i,\\ell} - \\sum_{r,j} [P_{\\ell,r}]_{i,j}\\) represents the untransported mass of ligand \\(\\ell\\) at sender cell \\(i\\),\n\\(\\nu_{j,r} = X_{j,r} - \\sum_{\\ell,i} [P_{\\ell,r}]_{i,j}\\) represents the untransported mass of receptor \\(r\\) at receiver cell \\(j\\).\n\nThe L1 penalty term \\(\\rho (\\|\\mu\\|_1 + \\|\\nu\\|_1)\\), for some tuning parameter \\(\\rho\\), discourages excessive untransported mass, ensuring that ligands and receptors are optimally assigned to communication pathways while allowing some flexibility when spatial constraints prevent full utilization.\nThe feasible transport plans must satisfy:\n\\[\n\\sum_{r,j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}, \\quad \\sum_{\\ell,i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\n\\tag{10.4}\\]\nensuring that transported mass does not exceed ligand and receptor expression levels.\nThis multi-species framework introduces competition between ligand-receptor interactions: when multiple ligands target the same receptor, or when a receptor has limited capacity, the transport plan balances the signaling mass across competing interactions.\n\nJust to give you some examples of what the result of a cell-cell communication analysis for spatial transcriptomics looks like, see Figure 10.35 and Figure 10.36.\n\n\n\n\n\n\n\nFigure 10.35: Left: From He et al. (2024), for the signaling cascade starting from a particular T cell type.\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.36: Right: From H. Li et al. (2024), for the signaling originating from the tumor (“invasive”) to the receiving immune cells that are responding to the tumor.\n\n\n\n\n\n\n\n10.3.4 A brief note on other approaches\nIn a way, cell-cell communication is a particular flavor of spatial co-expression of certain genes (i.e., genes for the ligands and receptors), if you really are going to believe that a high expression of a gene means high abundance of the corresponding ligand or receptor. In this sense, there are many methods that can do cell-cell communication. See SpatialDM Z. Li et al. (2023) as one example for this usage.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#integrationalignment-of-spatial-slices",
    "href": "chapter9_spatial.html#integrationalignment-of-spatial-slices",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "10.4 Integration/alignment of spatial slices",
    "text": "10.4 Integration/alignment of spatial slices\nIntegration in spatial transcriptomics is essential for ensuring accurate, comprehensive, and biologically meaningful analyses. One of the primary reasons for integration is to rigorously compare data across different donors, similar to batch correction in single-cell RNA sequencing. Variability introduced by differences in sample preparation, sequencing depth, and experimental conditions can obscure true biological signals. By aligning spatial transcriptomics data across donors, researchers can mitigate technical noise and ensure that observed patterns reflect genuine biological variation rather than artifacts of sample processing.\n\nRemark 10.3. We are still far from doing spatial transcriptomics analyses from large cohorts of donors!\nDespite recent advancements in spatial transcriptomics, we are still far from being able to perform large-scale analyses across cohorts of donors. One major limitation is the small size of tissue sections compared to whole-organ imaging modalities like PET, CT, or MRI. Unlike these imaging technologies, which allow for consistent anatomical registration across individuals, spatial transcriptomic data lacks a straightforward way to ensure alignment across different donors. Another fundamental challenge is the invasive nature of tissue collection, requiring surgical procedures that necessitate careful consideration of the timepoints at which samples are obtained. In diseases like neurodegeneration, where disease progression is highly dynamic, comparing spatial transcriptomic profiles across donors is going to make you go crazy. Even if multiple donors contribute tissue from the same anatomical region, variability in disease stage and molecular signaling could make direct comparisons unreliable. You want to say something along the lines of “the spatial signaling dynamics in Alzhemier’s disease is disrupted in this brain region,” but how are you so sure you’re finding similar spatial dynamics across all your donors?\nAdditionally, the cost of generating spatial transcriptomic data remains prohibitively high, limiting large-scale studies.\n\nFortunately, there are two other big reasons to do integrations:\n\nAnother critical application of integration is combining data from different spatial transcriptomics technologies, such as MERFISH and Visium. Each platform has its own strengths—MERFISH provides high-resolution, single-molecule imaging of a limited gene set, while Visium captures genome-wide expression but at lower spatial resolution. By integrating data across these platforms, researchers can leverage the strengths of both, enabling a more complete understanding of cellular organization, gene expression, and interactions within a tissue. This cross-modality alignment allows for deeper biological insights that would be difficult to achieve using a single technology alone.\nIntegration is crucial for constructing three-dimensional spatial transcriptomics datasets from multiple tissue slices. Aligning and stitching tissue slices is essential for constructing three-dimensional molecular profiles. Since spatial transcriptomics data is often collected as two-dimensional slices, aligning and stitching these slices together is necessary to reconstruct a holistic, 3D molecular map of a tissue. This process enables researchers to study tissue architecture in its native three-dimensional context, facilitating discoveries about developmental processes, tumor microenvironments, and disease progression. By integrating slices into a unified 3D model, researchers can more accurately analyze spatial relationships between cells, study molecular gradients, and gain a deeper understanding of how cellular interactions shape tissue function. See ?fig-commot-3d and Figure 10.39 as examples.\n\n\n\n\n\n\n\n\nFigure 10.37: Left: From Cang et al. (2023)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.38: Right: From Moffitt et al. (2018)\n\n\n\n\n\n\n\n\n\n\n\nFigure 10.39: From Schott et al. (2024)\n\n\n\n\n\n10.4.1 Brief aside: Image registration (in contexts for broader biomedical imaging)\nImage registration is the process of aligning multiple images into a common coordinate system, allowing for meaningful comparisons across different imaging modalities, timepoints, or subjects. In biomedical imaging, registration is widely used in modalities such as MRI, CT, PET, and histological imaging to ensure that anatomical structures from different scans are spatially aligned. This is particularly important when integrating data from different sources, such as aligning a patient’s pre- and post-treatment scans or fusing anatomical (MRI) and functional (PET) imaging for comprehensive analysis.\nRegistration is necessary because biological tissues can exhibit variations due to differences in patient positioning, tissue deformation, or even individual anatomical differences. In neuroimaging, for example, brain MRI scans from different individuals must be warped onto a standardized brain atlas to enable group-level statistical analysis. Similarly, in histopathology, adjacent tissue sections must be aligned to reconstruct a 3D representation of tissue morphology. Without accurate registration, direct comparisons across images would be unreliable, leading to misinterpretations in clinical diagnoses, disease progression studies, and biomarker discovery.\n\n\n\n\n\n\n\nFigure 10.40: From X. Zhang et al. (2019)\n\n\n\n\n\n\n10.4.2 A current choice for aligning slices in spatial transcriptomics: SANTO\nThe SANTO (coarse-to-fine alignment and stitching) H. Li et al. (2024) method aligns two spatial transcriptomics datasets in a two-step process: coarse alignment followed by fine alignment. (We’ll describe this for spot-level data, but this can be used for imaging data once you’ve done a cell segmentation.)\n\n\n\n\n\n\n\nFigure 10.41: From Schott et al. (2024)\n\n\n\n\n\nInput/Output. The input to SANTO is 1) a spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(X \\in \\mathbb{R}^{n_X \\times p}\\) for \\(n_X\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n_X\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n_X\\) cells, and 2) a second spatial transcriptomics dataset (can be spot-level or cell-segmented image data) \\(Y \\in \\mathbb{R}^{n_Y \\times p}\\) for \\(n_Y\\) cells (or spots) and \\(p\\) genes alongside \\(Z \\in \\mathbb{R}^{n_Y\\times 2}\\) denoting the \\((x,y)\\) spatial coordinates of each of the \\(n_Y\\) cells. The output is a rotated and translated spatial transcriptomics dataset \\(X'\\) where all the expression values among the \\(n_X\\) cells in \\(X\\) are the same, but now there’s a rotation and translation of all the spatial coordinates of these \\(n_X\\) spots to best align with slice \\(Y\\).\n\n\nCoarse alignment: SANTO first performs a coarse alignment by rapidly estimating the relative spatial positioning of two slices and identifying their overlapping regions. This is achieved by computing the Pearson Correlation Coefficient (PCC) of shared omics features:\n\\[\n\\text{PCC}(G_{X_i}, G_{Y_j}) = \\frac{\\sum (G_{X_i} - \\bar{G}_X)(G_{Y_j} - \\bar{G}_Y)}{\\sqrt{\\sum (G_{X_i} - \\bar{G}_X)^2 \\sum (G_{Y_j} - \\bar{G}_Y)^2}}\n\\tag{10.5}\\]\nwhere \\(G_{X_i}\\) and \\(G_{Y_j}\\) denote the gene expression vectors of spots \\(i\\) and \\(j\\) in slices \\(X\\) and \\(Y\\), respectively. Pairs with high PCC scores are used to estimate the transformation matrix via Singular Value Decomposition (SVD):\n\\[\nH = \\sum (S_{X_i} - \\bar{S}_X)(S_{Y_j} - \\bar{S}_Y)^\\top\n\\tag{10.6}\\]\nwhere \\(S_X\\) and \\(S_Y\\) represent spatial coordinates. The optimal rotation matrix \\(R\\) and translation \\(T\\) are computed as \\(R = VU^\\top\\) and \\(T = \\bar{S}_Y - R\\bar{S}_X\\). The new spatial coordinates of \\(S_X\\) then get set to be \\(S_X \\leftarrow RS_X + T\\).\n(You can think of this as: 1) using gene expression in both slides to find pairs of “anchors” (one anchor on each slide), and then 2) using the spatial coordinates of the anchor pairs, finding a shift and a rotation for slide \\(X\\).)\nFine alignment: For fine alignment, SANTO iteratively improves the alignment by a more nuanced approach that accounts for a “soft mapping” between spots in different slices. This is implemented with a Dynamic Graph Convolutional Neural Network (DGCNN).\nDuring training, all the spots are combined into one batch, so if there are \\(n_X\\) spots in slice \\(X\\) and \\(n_Y\\) spots in slice \\(Y\\), both slices are used in the network. The model learns spatial and expression embeddings, computes a probabilistic soft mapping\n\\[\nm(X, Y) = \\text{softmax}(F_Y F_X^\\top)\n\\tag{10.7}\\]\nand uses this to derive \\(X^{(Y)}\\), a “counterpart” slice of \\(X\\) generated via \\(Y\\). The network is trained with a loss function that balances omics similarity and spatial coordinate similarity:\n\\[\n\\mathcal{L} = \\frac{1}{n_X n_Y} \\sum_{\\text{spots } i \\in X} \\underset{j \\in Y}{\\text{softmin}} \\left[ \\alpha (1 - \\text{PCC}(G_{X_i}, G_{Y_j})) + (1-\\alpha) d(S_{X_i}, S_{Y_j}) \\right]\n\\tag{10.8}\\]\nwhere \\(d(S_{X_i}, S_{Y_j})\\) is the Euclidean distance between aligned spots, and \\(\\alpha\\) balances spatial and omics contributions.\n\n\n\n10.4.3 A brief note about other approaches\nYou’ll notice that SANTO did not ever “distort” the spatial coordinates. All it’s really doing is learning a global rotation and translation. If you want to see a procedure that can “shrink” and “stretch” spatial coordinates to better match slices, see STAlign Clifton et al. (2023), which relies on large deformation diffeomorphic metric mapping (LDDMM) (https://en.wikipedia.org/wiki/Large_deformation_diffeomorphic_metric_mapping).\n\n\n\n\nAlmet, Axel A, Zixuan Cang, Suoqin Jin, and Qing Nie. 2021. “The Landscape of Cell–Cell Communication Through Single-Cell Transcriptomics.” Current Opinion in Systems Biology 26: 12–23.\n\n\nArmingol, Erick, Adam Officer, Olivier Harismendy, and Nathan E Lewis. 2021. “Deciphering Cell–Cell Interactions and Communication from Gene Expression.” Nature Reviews Genetics 22 (2): 71–88.\n\n\nCang, Zixuan, Yanxiang Zhao, Axel A Almet, Adam Stabell, Raul Ramos, Maksim V Plikus, Scott X Atwood, and Qing Nie. 2023. “Screening Cell-Cell Communication in Spatial Transcriptomics via Collective Optimal Transport.” Nature Methods, 1–11.\n\n\nChen, Kok Hao, Alistair N Boettiger, Jeffrey R Moffitt, Siyuan Wang, and Xiaowei Zhuang. 2015. “Spatially Resolved, Highly Multiplexed RNA Profiling in Single Cells.” Science 348 (6233): aaa6090.\n\n\nClifton, Kalen, Manjari Anant, Gohta Aihara, Lyla Atta, Osagie K Aimiuwu, Justus M Kebschull, Michael I Miller, Daniel Tward, and Jean Fan. 2023. “STalign: Alignment of Spatial Transcriptomics Data Using Diffeomorphic Metric Mapping.” Nature Communications 14 (1): 8123.\n\n\nDuan, Honglin, Tao Cheng, and Hui Cheng. 2023. “Spatially Resolved Transcriptomics: Advances and Applications.” Blood Science 5 (1): 1–14.\n\n\nFigiel, Sandy, Anthony Bates, David A Braun, Renu Eapen, Markus Eckstein, Brandon J Manley, Matthew I Milowsky, et al. 2024. “Clinical Implications of Basic Research: Exploring the Transformative Potential of Spatial’omics in Uro-Oncology.” European Urology.\n\n\nHartman, Austin, and Rahul Satija. 2024. “Comparative Analysis of Multiplexed in Situ Gene Expression Profiling Technologies.” bioRxiv, 2024–01.\n\n\nHe, Siyu, Yinuo Jin, Achille Nazaret, Lingting Shi, Xueer Chen, Sham Rampersaud, Bahawar S Dhillon, et al. 2024. “Starfysh Integrates Spatial Transcriptomic and Histologic Data to Reveal Heterogeneous Tumor–Immune Hubs.” Nature Biotechnology, 1–13.\n\n\nJin, Suoqin, Christian F Guerrero-Juarez, Lihua Zhang, Ivan Chang, Raul Ramos, Chen-Hsiang Kuan, Peggy Myung, Maksim V Plikus, and Qing Nie. 2021. “Inference and Analysis of Cell-Cell Communication Using CellChat.” Nature Communications 12 (1): 1088.\n\n\nKiessling, Paul, and Christoph Kuppe. 2024. “Spatial Multi-Omics: Novel Tools to Study the Complexity of Cardiovascular Diseases.” Genome Medicine 16 (1): 14.\n\n\nKim, Yoon-Seob, Jinyong Choi, and Sug Hyung Lee. 2023. “Single-Cell and Spatial Sequencing Application in Pathology.” Journal of Pathology and Translational Medicine 57 (1): 43–51.\n\n\nLee, Colin YC, James McCaffrey, Dominic McGovern, and Menna R Clatworthy. 2024. “Profiling Immune Cell Tissue Niches in the Spatial-Omics Era.” Journal of Allergy and Clinical Immunology.\n\n\nLi, Haoyang, Yingxin Lin, Wenjia He, Wenkai Han, Xiaopeng Xu, Chencheng Xu, Elva Gao, Hongyu Zhao, and Xin Gao. 2024. “SANTO: A Coarse-to-Fine Alignment and Stitching Method for Spatial Omics.” Nature Communications 15 (1): 6048.\n\n\nLi, Zhuoxuan, Tianjie Wang, Pentao Liu, and Yuanhua Huang. 2023. “SpatialDM for Rapid Identification of Spatially Co-Expressed Ligand–Receptor and Revealing Cell–Cell Communication Patterns.” Nature Communications 14 (1): 3995.\n\n\nLiao, Jie, Xiaoyan Lu, Xin Shao, Ling Zhu, and Xiaohui Fan. 2021. “Uncovering an Organ’s Molecular Architecture at Single-Cell Resolution by Spatially Resolved Transcriptomics.” Trends in Biotechnology 39 (1): 43–58.\n\n\nLongo, Sophia K, Margaret G Guo, Andrew L Ji, and Paul A Khavari. 2021. “Integrating Single-Cell and Spatial Transcriptomics to Elucidate Intercellular Tissue Dynamics.” Nature Reviews Genetics 22 (10): 627–44.\n\n\nMoffitt, Jeffrey R, Dhananjay Bambah-Mukku, Stephen W Eichhorn, Eric Vaughn, Karthik Shekhar, Julio D Perez, Nimrod D Rubinstein, et al. 2018. “Molecular, Spatial, and Functional Single-Cell Profiling of the Hypothalamic Preoptic Region.” Science 362 (6416): eaau5324.\n\n\nPark, Han-Eol, Song Hyun Jo, Rosalind H Lee, Christian P Macks, Taeyun Ku, Jihwan Park, Chung Whan Lee, Junho K Hur, and Chang Ho Sohn. 2023. “Spatial Transcriptomics: Technical Aspects of Recent Developments and Their Applications in Neuroscience and Cancer Research.” Advanced Science 10 (16): 2206939.\n\n\nRademacher, Anne, Alik Huseynov, Michele Bortolomeazzi, Sina Jasmin Wille, Sabrina Schumacher, Pooja Sant, Denise Keitel, et al. 2024. “Comparison of Spatial Transcriptomics Technologies Using Tumor Cryosections.” bioRxiv, 2024–04.\n\n\nSchott, Marie, Daniel León-Periñán, Elena Splendiani, Leon Strenger, Jan Robin Licha, Tancredi Massimo Pentimalli, Simon Schallenberg, et al. 2024. “Open-ST: High-Resolution Spatial Transcriptomics in 3D.” Cell 187 (15): 3953–72.\n\n\nWilliams, Cameron G, Hyun Jae Lee, Takahiro Asatsuma, Roser Vento-Tormo, and Ashraful Haque. 2022. “An Introduction to Spatial Transcriptomics for Biomedical Research.” Genome Medicine 14 (1): 68.\n\n\nZhang, Meng, Xingjie Pan, Won Jung, Aaron Halpern, Stephen W Eichhorn, Zhiyun Lei, Limor Cohen, et al. 2023. “A Molecularly Defined and Spatially Resolved Cell Atlas of the Whole Mouse Brain.” bioRxiv, 2023–03.\n\n\nZhang, Xinyuan, Yanqiu Feng, Wufan Chen, Xin Li, Andreia V Faria, Qianjin Feng, and Susumu Mori. 2019. “Linear Registration of Brain Mri Using Knowledge-Based Multiple Intermediator Libraries.” Frontiers in Neuroscience 13: 909.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "chapter9_spatial.html#footnotes",
    "href": "chapter9_spatial.html#footnotes",
    "title": "10  ‘Single-cell’ spatial transcriptomics",
    "section": "",
    "text": "The first constraint \\(\\sum_{j} [P_{\\ell,r}]_{i,j} \\leq X_{i,\\ell}\\) says, “Given that cell \\(i\\) has this much expression of ligand \\(\\ell\\), it should not be sending more than \\(X_{i,\\ell}\\) to all the other \\(n\\) cells.” The second constraint \\(\\sum_{i} [P_{\\ell,r}]_{i,j} \\leq X_{j,r}\\) says, “Given that cell \\(j\\) has this much expression of receptor \\(r\\), it should not be receiving more than \\(X_{j,r}\\) from all the other \\(n\\) cells.”↩︎",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>'Single-cell' spatial transcriptomics</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Almet, Axel A, Zixuan Cang, Suoqin Jin, and Qing Nie. 2021. “The\nLandscape of Cell–Cell Communication Through Single-Cell\nTranscriptomics.” Current Opinion in Systems Biology 26:\n12–23.\n\n\nArmingol, Erick, Adam Officer, Olivier Harismendy, and Nathan E Lewis.\n2021. “Deciphering Cell–Cell Interactions and Communication from\nGene Expression.” Nature Reviews Genetics 22 (2): 71–88.\n\n\nAshouri, Arghavan, Chufan Zhang, and Federico Gaiti. 2023.\n“Decoding Cancer Evolution: Integrating Genetic and Non-Genetic\nInsights.” Genes 14 (10): 1856.\n\n\nBarry, Timothy, Kathryn Roeder, and Eugene Katsevich. 2024.\n“Exponential Family Measurement Error Models for Single-Cell\nCRISPR Screens.” Biostatistics 25 (4): 1254–72.\n\n\nBarry, Timothy, Xuran Wang, John A Morris, Kathryn Roeder, and Eugene\nKatsevich. 2021. “SCEPTRE Improves Calibration and\nSensitivity in Single-Cell CRISPR Screen Analysis.”\nGenome Biology 22 (1): 1–19.\n\n\nBock, Christoph, Paul Datlinger, Florence Chardon, Matthew A Coelho,\nMatthew B Dong, Keith A Lawson, Tian Lu, et al. 2022.\n“High-Content CRISPR Screening.” Nature Reviews Methods\nPrimers 2 (1): 1–23.\n\n\nCang, Zixuan, Yanxiang Zhao, Axel A Almet, Adam Stabell, Raul Ramos,\nMaksim V Plikus, Scott X Atwood, and Qing Nie. 2023. “Screening\nCell-Cell Communication in Spatial Transcriptomics via Collective\nOptimal Transport.” Nature Methods, 1–11.\n\n\nChen, Kok Hao, Alistair N Boettiger, Jeffrey R Moffitt, Siyuan Wang, and\nXiaowei Zhuang. 2015. “Spatially Resolved, Highly Multiplexed RNA\nProfiling in Single Cells.” Science 348 (6233): aaa6090.\n\n\nCheng, Junyun, Gaole Lin, Tianhao Wang, Yunzhu Wang, Wenbo Guo, Jie\nLiao, Penghui Yang, et al. 2023. “Massively Parallel CRISPR-Based\nGenetic Perturbation Screening at Single-Cell Resolution.”\nAdvanced Science 10 (4): 2204484.\n\n\nClaringbould, Annique, and Judith B Zaugg. 2021. “Enhancers in\nDisease: Molecular Basis and Emerging Treatment Strategies.”\nTrends in Molecular Medicine 27 (11): 1060–73.\n\n\nClifton, Kalen, Manjari Anant, Gohta Aihara, Lyla Atta, Osagie K\nAimiuwu, Justus M Kebschull, Michael I Miller, Daniel Tward, and Jean\nFan. 2023. “STalign: Alignment of Spatial Transcriptomics Data\nUsing Diffeomorphic Metric Mapping.” Nature\nCommunications 14 (1): 8123.\n\n\nConcordet, Jean-Paul, and Maximilian Haeussler. 2018. “CRISPOR:\nIntuitive Guide Selection for CRISPR/Cas9 Genome Editing Experiments and\nScreens.” Nucleic Acids Research 46 (W1): W242–45.\n\n\nDatlinger, Paul, André F Rendeiro, Christian Schmidl, Thomas\nKrausgruber, Peter Traxler, Johanna Klughammer, Linda C Schuster, Amelie\nKuchler, Donat Alpar, and Christoph Bock. 2017. “Pooled CRISPR\nScreening with Single-Cell Transcriptome Readout.” Nature\nMethods 14 (3): 297–301.\n\n\nDinh, Laurent, Jascha Sohl-Dickstein, and Samy Bengio. 2016.\n“Density Estimation Using Real Nvp.” arXiv Preprint\narXiv:1605.08803.\n\n\nDixit, Atray, Oren Parnas, Biyu Li, Jenny Chen, Charles P Fulco, Livnat\nJerby-Arnon, Nemanja D Marjanovic, et al. 2016. “Perturb-Seq:\nDissecting Molecular Circuits with Scalable Single-Cell RNA Profiling of\nPooled Genetic Screens.” Cell 167 (7): 1853–66.\n\n\nDuan, Honglin, Tao Cheng, and Hui Cheng. 2023. “Spatially Resolved\nTranscriptomics: Advances and Applications.” Blood\nScience 5 (1): 1–14.\n\n\nEfron, Bradley, and Robert Tibshirani. 2002. “Empirical Bayes\nMethods and False Discovery Rates for Microarrays.” Genetic\nEpidemiology 23 (1): 70–86.\n\n\nEsposito, Roberta, Núria Bosch, Andrés Lanzós, Taisia Polidori, Carlos\nPulido-Quetglas, and Rory Johnson. 2019. “Hacking the Cancer\nGenome: Profiling Therapeutically Actionable Long Non-Coding RNAs Using\nCRISPR-Cas9 Screening.” Cancer Cell 35 (4): 545–57.\n\n\nFigiel, Sandy, Anthony Bates, David A Braun, Renu Eapen, Markus\nEckstein, Brandon J Manley, Matthew I Milowsky, et al. 2024.\n“Clinical Implications of Basic Research: Exploring the\nTransformative Potential of Spatial’omics in Uro-Oncology.”\nEuropean Urology.\n\n\nGasperini, Molly, Andrew J Hill, José L McFaline-Figueroa, Beth Martin,\nSeungsoo Kim, Melissa D Zhang, Dana Jackson, et al. 2019. “A\nGenome-Wide Framework for Mapping Gene Regulation via Cellular Genetic\nScreens.” Cell 176 (1): 377–90.\n\n\nGohil, Satyen H, J Bryan Iorgulescu, David A Braun, Derin B Keskin, and\nKenneth J Livak. 2021. “Applying High-Dimensional Single-Cell\nTechnologies to the Analysis of Cancer Immunotherapy.” Nature\nReviews Clinical Oncology 18 (4): 244–56.\n\n\nGolub, Todd R, Donna K Slonim, Pablo Tamayo, Christine Huard, Michelle\nGaasenbeek, Jill P Mesirov, Hilary Coller, et al. 1999. “Molecular\nClassification of Cancer: Class Discovery and Class Prediction by Gene\nExpression Monitoring.” Science 286 (5439): 531–37.\n\n\nHansson, Oskar, Kaj Blennow, Henrik Zetterberg, and Jeffrey Dage. 2023.\n“Blood Biomarkers for Alzheimer’s Disease in Clinical Practice and\nTrials.” Nature Aging 3 (5): 506–19.\n\n\nHartman, Austin, and Rahul Satija. 2024. “Comparative Analysis of\nMultiplexed in Situ Gene Expression Profiling Technologies.”\nbioRxiv, 2024–01.\n\n\nHe, Siyu, Yinuo Jin, Achille Nazaret, Lingting Shi, Xueer Chen, Sham\nRampersaud, Bahawar S Dhillon, et al. 2024. “Starfysh Integrates\nSpatial Transcriptomic and Histologic Data to Reveal Heterogeneous\nTumor–Immune Hubs.” Nature Biotechnology, 1–13.\n\n\nIto, Shinsuke, Nando Dulal Das, Takashi Umehara, and Haruhiko Koseki.\n2022. “Factors and Mechanisms That Influence Chromatin-Mediated\nEnhancer–Promoter Interactions and Transcriptional Regulation.”\nCancers 14 (21): 5404.\n\n\nJin, Suoqin, Christian F Guerrero-Juarez, Lihua Zhang, Ivan Chang, Raul\nRamos, Chen-Hsiang Kuan, Peggy Myung, Maksim V Plikus, and Qing Nie.\n2021. “Inference and Analysis of Cell-Cell Communication Using\nCellChat.” Nature Communications 12 (1): 1088.\n\n\nKepchia, Devin, Ling Huang, Richard Dargusch, Robert A Rissman, Maxim N\nShokhirev, Wolfgang Fischer, and David Schubert. 2020. “Diverse\nProteins Aggregate in Mild Cognitive Impairment and Alzheimer’s Disease\nBrain.” Alzheimer’s Research & Therapy 12: 1–20.\n\n\nKhan, Faiza Shafique, Farhan Goher, Dapeng Zhang, Peng Shi, Zhiying Li,\nYin Min Htwe, and Yong Wang. 2022. “Is CRISPR/Cas9 a Way Forward\nto Fast-Track Genetic Improvement in Commercial Palms? Prospects and\nLimits.” Frontiers in Plant Science 13: 1042828.\n\n\nKiessling, Paul, and Christoph Kuppe. 2024. “Spatial Multi-Omics:\nNovel Tools to Study the Complexity of Cardiovascular Diseases.”\nGenome Medicine 16 (1): 14.\n\n\nKim, Yoon-Seob, Jinyong Choi, and Sug Hyung Lee. 2023.\n“Single-Cell and Spatial Sequencing Application in\nPathology.” Journal of Pathology and Translational\nMedicine 57 (1): 43–51.\n\n\nKobyzev, Ivan, Simon JD Prince, and Marcus A Brubaker. 2020.\n“Normalizing Flows: An Introduction and Review of Current\nMethods.” IEEE Transactions on Pattern Analysis and Machine\nIntelligence 43 (11): 3964–79.\n\n\nKuhn, Maria, António J Santinha, and Randall J Platt. 2021.\n“Moving from in Vitro to in Vivo CRISPR Screens.” Gene\nand Genome Editing 2: 100008.\n\n\nLee, Colin YC, James McCaffrey, Dominic McGovern, and Menna R\nClatworthy. 2024. “Profiling Immune Cell Tissue Niches in the\nSpatial-Omics Era.” Journal of Allergy and Clinical\nImmunology.\n\n\nLei, Yalan, Rong Tang, Jin Xu, Wei Wang, Bo Zhang, Jiang Liu, Xianjun\nYu, and Si Shi. 2021. “Applications of Single-Cell Sequencing in\nCancer Research: Progress and Perspectives.” Journal of\nHematology & Oncology 14 (1): 91.\n\n\nLi, Haoyang, Yingxin Lin, Wenjia He, Wenkai Han, Xiaopeng Xu, Chencheng\nXu, Elva Gao, Hongyu Zhao, and Xin Gao. 2024. “SANTO: A\nCoarse-to-Fine Alignment and Stitching Method for Spatial Omics.”\nNature Communications 15 (1): 6048.\n\n\nLi, Lei, Yumei Li, Xudong Zou, Fuduan Peng, Ya Cui, Eric J Wagner, and\nWei Li. 2022. “Population-Scale Genetic Control of Alternative\nPolyadenylation and Its Association with Human Diseases.”\nQuantitative Biology 10 (1): 44–54.\n\n\nLi, Zhuoxuan, Tianjie Wang, Pentao Liu, and Yuanhua Huang. 2023.\n“SpatialDM for Rapid Identification of Spatially Co-Expressed\nLigand–Receptor and Revealing Cell–Cell Communication Patterns.”\nNature Communications 14 (1): 3995.\n\n\nLiao, Jie, Xiaoyan Lu, Xin Shao, Ling Zhu, and Xiaohui Fan. 2021.\n“Uncovering an Organ’s Molecular Architecture at Single-Cell\nResolution by Spatially Resolved Transcriptomics.” Trends in\nBiotechnology 39 (1): 43–58.\n\n\nLin, Xueqiu, Yanxia Liu, Shuai Liu, Xiang Zhu, Lingling Wu, Yanyu Zhu,\nDehua Zhao, et al. 2022. “Nested Epistasis Enhancer Networks for\nRobust Genome Regulation.” Science 377 (6610): 1077–85.\n\n\nLongo, Sophia K, Margaret G Guo, Andrew L Ji, and Paul A Khavari. 2021.\n“Integrating Single-Cell and Spatial Transcriptomics to Elucidate\nIntercellular Tissue Dynamics.” Nature Reviews Genetics\n22 (10): 627–44.\n\n\nLotfollahi, Mohammad, F Alexander Wolf, and Fabian J Theis. 2019.\n“scGen Predicts Single-Cell Perturbation Responses.”\nNature Methods 16 (8): 715–21.\n\n\nMao, Yanfei, Jose Ramon Botella, and Jian-Kang Zhu. 2017.\n“Heritability of Targeted Gene Modifications Induced by\nPlant-Optimized CRISPR Systems.” Cellular and Molecular Life\nSciences 74 (6): 1075–93.\n\n\nMarine, Jean-Christophe, Sarah-Jane Dawson, and Mark A Dawson. 2020.\n“Non-Genetic Mechanisms of Therapeutic Resistance in\nCancer.” Nature Reviews Cancer 20 (12): 743–56.\n\n\nMoffitt, Jeffrey R, Dhananjay Bambah-Mukku, Stephen W Eichhorn, Eric\nVaughn, Karthik Shekhar, Julio D Perez, Nimrod D Rubinstein, et al.\n2018. “Molecular, Spatial, and Functional Single-Cell Profiling of\nthe Hypothalamic Preoptic Region.” Science 362 (6416):\neaau5324.\n\n\nPark, Han-Eol, Song Hyun Jo, Rosalind H Lee, Christian P Macks, Taeyun\nKu, Jihwan Park, Chung Whan Lee, Junho K Hur, and Chang Ho Sohn. 2023.\n“Spatial Transcriptomics: Technical Aspects of Recent Developments\nand Their Applications in Neuroscience and Cancer Research.”\nAdvanced Science 10 (16): 2206939.\n\n\nRademacher, Anne, Alik Huseynov, Michele Bortolomeazzi, Sina Jasmin\nWille, Sabrina Schumacher, Pooja Sant, Denise Keitel, et al. 2024.\n“Comparison of Spatial Transcriptomics Technologies Using Tumor\nCryosections.” bioRxiv, 2024–04.\n\n\nSchaff, Dylan L, Aria J Fasse, Phoebe E White, Robert J Vander Velde,\nand Sydney M Shaffer. 2024. “Clonal Differences Underlie Variable\nResponses to Sequential and Prolonged Treatment.” Cell\nSystems 15 (3): 213–26.\n\n\nSchnitzler, Gavin R, Helen Kang, Shi Fang, Ramcharan S Angom, Vivian S\nLee-Kim, X Rosa Ma, Ronghao Zhou, et al. 2024. “Convergence of\nCoronary Artery Disease Genes onto Endothelial Cell Programs.”\nNature 626 (8000): 799–807.\n\n\nSchott, Marie, Daniel León-Periñán, Elena Splendiani, Leon Strenger, Jan\nRobin Licha, Tancredi Massimo Pentimalli, Simon Schallenberg, et al.\n2024. “Open-ST: High-Resolution Spatial Transcriptomics in\n3D.” Cell 187 (15): 3953–72.\n\n\nShalek, Alex K, and Mikael Benson. 2017. “Single-Cell Analyses to\nTailor Treatments.” Science Translational Medicine 9\n(408): eaan4730.\n\n\nSilva, Paulo FL da, and Björn Schumacher. 2021. “Principles of the\nMolecular and Cellular Mechanisms of Aging.” Journal of\nInvestigative Dermatology 141 (4): 951–60.\n\n\nStephenson, Emily, Gary Reynolds, Rachel A Botting, Fernando J\nCalero-Nieto, Michael D Morgan, Zewen Kelvin Tuong, Karsten Bach, et al.\n2021. “Single-Cell Multi-Omics Analysis of the Immune Response in\nCOVID-19.” Nature Medicine 27 (5): 904–16.\n\n\nTeichmann, Sarah, and Mirjana Efremova. 2020. “Method of the Year\n2019: Single-Cell Multimodal Omics.” Nature Methods 17\n(1): 2020.\n\n\nTibshirani, Robert, Michael Saunders, Saharon Rosset, Ji Zhu, and Keith\nKnight. 2005. “Sparsity and Smoothness via the Fused\nLasso.” Journal of the Royal Statistical Society Series B:\nStatistical Methodology 67 (1): 91–108.\n\n\nVerschoor, Chris P, Alina Lelic, Jonathan L Bramson, and Dawn ME\nBowdish. 2015. “An Introduction to Automated Flow Cytometry Gating\nTools and Their Implementation.” Frontiers in Immunology\n6: 380.\n\n\nVon Bernhardi, Rommy, Laura Eugenı́n-von Bernhardi, and Jaime Eugenı́n.\n2015. “Microglial Cell Dysregulation in Brain Aging and\nNeurodegeneration.” Frontiers in Aging Neuroscience 7:\n124.\n\n\nWei, Lai, Derek Lee, Cheuk-Ting Law, Misty Shuo Zhang, Jialing Shen, Don\nWai-Ching Chin, Allen Zhang, et al. 2019. “Genome-Wide CRISPR/Cas9\nLibrary Screening Identified PHGDH as a Critical Driver for Sorafenib\nResistance in HCC.” Nature Communications 10 (1): 4681.\n\n\nWeinreb, Caleb, Alejo Rodriguez-Fraticelli, Fernando D Camargo, and\nAllon M Klein. 2020. “Lineage Tracing on Transcriptional\nLandscapes Links State to Fate During Differentiation.”\nScience 367 (6479).\n\n\nWen, Lu, Guoqiang Li, Tao Huang, Wei Geng, Hao Pei, Jialiang Yang, Miao\nZhu, et al. 2022. “Single-Cell Technologies: From Research to\nApplication.” The Innovation 3 (6).\n\n\nWilliams, Cameron G, Hyun Jae Lee, Takahiro Asatsuma, Roser Vento-Tormo,\nand Ashraful Haque. 2022. “An Introduction to Spatial\nTranscriptomics for Biomedical Research.” Genome\nMedicine 14 (1): 68.\n\n\nYao, Douglas, Loic Binan, Jon Bezney, Brooke Simonton, Jahanara\nFreedman, Chris J Frangieh, Kushal Dey, et al. 2024. “Scalable\nGenetic Screening for Regulatory Circuits Using Compressed\nPerturb-Seq.” Nature Biotechnology 42 (8): 1282–95.\n\n\nYu, Hengshi, and Joshua D Welch. 2022. “Perturbnet Predicts\nSingle-Cell Responses to Unseen Chemical and Genetic\nPerturbations.” BioRxiv, 2022–07.\n\n\nZhang, Meng, Xingjie Pan, Won Jung, Aaron Halpern, Stephen W Eichhorn,\nZhiyun Lei, Limor Cohen, et al. 2023. “A Molecularly Defined and\nSpatially Resolved Cell Atlas of the Whole Mouse Brain.”\nbioRxiv, 2023–03.\n\n\nZhang, Xinyuan, Yanqiu Feng, Wufan Chen, Xin Li, Andreia V Faria,\nQianjin Feng, and Susumu Mori. 2019. “Linear Registration of Brain\nMri Using Knowledge-Based Multiple Intermediator Libraries.”\nFrontiers in Neuroscience 13: 909.\n\n\nZhou, Jessica L, Karthik Guruvayurappan, Shushan Toneyan, Hsiuyi V Chen,\nAaron R Chen, Peter Koo, and Graham McVicker. 2024. “Analysis of\nSingle-Cell CRISPR Perturbations Indicates That Enhancers Predominantly\nAct Multiplicatively.” Cell Genomics 4 (11).\n\n\nZhou, Yifan, Kaixuan Luo, Lifan Liang, Mengjie Chen, and Xin He. 2023.\n“A New Bayesian Factor Analysis Method Improves Detection of Genes\nand Biological Processes Affected by Perturbations in Single-Cell CRISPR\nScreening.” Nature Methods 20 (11): 1693–703.\n\n\nZhou, Yi, Hongjun Song, and Guo-li Ming. 2024. “Genetics of Human\nBrain Development.” Nature Reviews Genetics 25 (1):\n26–45.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "scOmicNotes",
    "section": "",
    "text": "This is a Quarto book made from the content of BIOST 545 (Biostatistical Methods for Big Omics Data), taught by Dr. Kevin Lin at the University of Washington, Winter 2025. The lecture notes in BIOST 545 are meant to ease you into reading these notes, and the notes are meant to be a gateway to many references where the course’s goal is for you 1) to determine for yourself what areas you find interesting and are relevant to your research goals, and 2) use the references as a portal to find many ideas to bolster your own research. This Quarto book is assembled with the help of many student volunteers at the University of Washington: [TBD].",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface-nello version</span>"
    ]
  },
  {
    "objectID": "chapter6_dna.html",
    "href": "chapter6_dna.html",
    "title": "7  ‘Single-cell’ DNA",
    "section": "",
    "text": "7.1 Genetics 101\nUnderstanding the fundamental concepts of genetics is essential for studying genomic variation, including copy-number variations (CNVs) and single nucleotide polymorphisms (SNPs). This section provides an overview of genetic architecture, SNPs and their detection, commonly sequenced tissues, and genome annotation resources such as the UCSC Genome Browser.\nSingle Nucleotide Polymorphisms (SNPs) and Their Detection.\nA single nucleotide polymorphism (SNP) is a variation at a single base pair position in the genome that is present in a significant fraction of the population. SNPs are the most common type of genetic variation and can have functional consequences depending on their location. When an SNP occurs within a coding region, it may alter the resulting protein sequence if it leads to an amino acid substitution (nonsynonymous SNP) or have no effect if the change is synonymous. SNPs in noncoding regions can impact gene regulation by affecting transcription factor binding sites, splicing efficiency, or untranslated regions (UTRs). Since you have “two copies” of each of your 23 chromosomes, this means SNP data is a data matrix of \\(n\\) people by \\(p\\) SNP regions (think of a couple million – more on this technicality later), where each value is \\(\\{0,1,2\\}\\), see Figure 7.1. Typically, the major allele is defined as “0”, and a “1” or “2” means if how many copies of the minor allele do you have.\nSNPs are detected using high-throughput sequencing technologies, primarily whole-genome sequencing (WGS) and whole-exome sequencing (WES). In these approaches, DNA is extracted from a biological sample, fragmented, and sequenced to generate short or long reads. The raw sequencing reads are then aligned to a reference genome, and variant calling algorithms such as those implemented in GATK (mckenna2010genome?), bcftools, and FreeBayes (garrison2012haplotype?) identify SNPs by comparing observed nucleotide differences to the reference sequence. (See (zverinova2022variant?) for a overview). The sequencing depth, or coverage, at a given genomic position determines the confidence in an SNP call, with higher coverage reducing the likelihood of sequencing errors.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>'Single-cell' DNA</span>"
    ]
  },
  {
    "objectID": "chapter6_dna.html#sec-genetics_basics",
    "href": "chapter6_dna.html#sec-genetics_basics",
    "title": "7  ‘Single-cell’ DNA",
    "section": "",
    "text": "Figure 7.1: From https://www.genome.gov/about-genomics/educational-resources/fact-sheets/human-genomic-variation.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>'Single-cell' DNA</span>"
    ]
  }
]