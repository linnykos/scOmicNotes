<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Single-cell RNA-sequencing – scOmicNotes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter4_protein.html" rel="next">
<link href="./chapter2_sequencing.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter3_rna.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Single-cell RNA-sequencing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">scOmicNotes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2_sequencing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single-cell sequencing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3_rna.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Single-cell RNA-sequencing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4_protein.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">‘Single-cell’ proteomics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5_epigenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Single-cell epigenetics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6_dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">‘Single-cell’ DNA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7_crispr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Single-cell CRISPR editting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8_lineage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Single-cell lineage tracing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9_spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">‘Single-cell’ spatial transcriptomics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#some-important-nouns-and-verbs" id="toc-some-important-nouns-and-verbs" class="nav-link active" data-scroll-target="#some-important-nouns-and-verbs"><span class="header-section-number">4.1</span> Some important nouns and verbs</a></li>
  <li><a href="#sec-chapter_3_tech" id="toc-sec-chapter_3_tech" class="nav-link" data-scroll-target="#sec-chapter_3_tech"><span class="header-section-number">4.2</span> How scRNA-seq works as a technology</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering"><span class="header-section-number">4.3</span> Clustering</a>
  <ul>
  <li><a href="#what-is-a-cell-type-no-seriously.-what-is-it" id="toc-what-is-a-cell-type-no-seriously.-what-is-it" class="nav-link" data-scroll-target="#what-is-a-cell-type-no-seriously.-what-is-it"><span class="header-section-number">4.3.1</span> What is a “cell type”? No, seriously. What is it?</a></li>
  <li><a href="#clustering-cells-into-cell-types-or-cell-states" id="toc-clustering-cells-into-cell-types-or-cell-states" class="nav-link" data-scroll-target="#clustering-cells-into-cell-types-or-cell-states"><span class="header-section-number">4.3.2</span> Clustering cells into cell types or cell states</a></li>
  <li><a href="#the-standard-procedure-louvain-clustering" id="toc-the-standard-procedure-louvain-clustering" class="nav-link" data-scroll-target="#the-standard-procedure-louvain-clustering"><span class="header-section-number">4.3.3</span> The standard procedure: Louvain clustering</a></li>
  <li><a href="#how-to-do-this-in-practice" id="toc-how-to-do-this-in-practice" class="nav-link" data-scroll-target="#how-to-do-this-in-practice"><span class="header-section-number">4.3.4</span> How to do this in practice</a></li>
  <li><a href="#a-brief-note-on-other-approaches" id="toc-a-brief-note-on-other-approaches" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches"><span class="header-section-number">4.3.5</span> A brief note on other approaches</a></li>
  <li><a href="#clustering-cells-into-meta-cells" id="toc-clustering-cells-into-meta-cells" class="nav-link" data-scroll-target="#clustering-cells-into-meta-cells"><span class="header-section-number">4.3.6</span> Clustering cells into “meta-cells”</a></li>
  <li><a href="#how-to-do-this-in-practice-1" id="toc-how-to-do-this-in-practice-1" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-1"><span class="header-section-number">4.3.7</span> How to do this in practice</a></li>
  <li><a href="#a-brief-note-on-other-approaches-1" id="toc-a-brief-note-on-other-approaches-1" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-1"><span class="header-section-number">4.3.8</span> A brief note on other approaches</a></li>
  </ul></li>
  <li><a href="#differential-expression" id="toc-differential-expression" class="nav-link" data-scroll-target="#differential-expression"><span class="header-section-number">4.4</span> Differential expression</a>
  <ul>
  <li><a href="#hold-on-isnt-de-just-a-t-test" id="toc-hold-on-isnt-de-just-a-t-test" class="nav-link" data-scroll-target="#hold-on-isnt-de-just-a-t-test"><span class="header-section-number">4.4.1</span> Hold on… isn’t DE just a t-test?</a></li>
  <li><a href="#de-between-two-data-driven-grouping-of-cells" id="toc-de-between-two-data-driven-grouping-of-cells" class="nav-link" data-scroll-target="#de-between-two-data-driven-grouping-of-cells"><span class="header-section-number">4.4.2</span> DE between two data-driven grouping of cells</a></li>
  <li><a href="#wilcoxon-rank-sum-test-for-differential-expression-testing" id="toc-wilcoxon-rank-sum-test-for-differential-expression-testing" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-test-for-differential-expression-testing"><span class="header-section-number">4.4.3</span> Wilcoxon Rank-Sum Test for Differential Expression Testing</a></li>
  <li><a href="#how-to-do-this-in-practice-2" id="toc-how-to-do-this-in-practice-2" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-2"><span class="header-section-number">4.4.4</span> How to do this in practice</a></li>
  <li><a href="#what-if-you-want-valid-p-value" id="toc-what-if-you-want-valid-p-value" class="nav-link" data-scroll-target="#what-if-you-want-valid-p-value"><span class="header-section-number">4.4.5</span> What if you want “valid” p-value?</a></li>
  <li><a href="#a-brief-note-on-other-approaches-2" id="toc-a-brief-note-on-other-approaches-2" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-2"><span class="header-section-number">4.4.6</span> A brief note on other approaches</a></li>
  <li><a href="#a-brief-reminder-about-multiple-testing" id="toc-a-brief-reminder-about-multiple-testing" class="nav-link" data-scroll-target="#a-brief-reminder-about-multiple-testing"><span class="header-section-number">4.4.7</span> (A brief reminder about multiple testing)</a></li>
  <li><a href="#benjamini-hochberg-procedure" id="toc-benjamini-hochberg-procedure" class="nav-link" data-scroll-target="#benjamini-hochberg-procedure"><span class="header-section-number">4.4.8</span> Benjamini-Hochberg procedure</a></li>
  <li><a href="#how-to-do-this-in-practice-3" id="toc-how-to-do-this-in-practice-3" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-3"><span class="header-section-number">4.4.9</span> How to do this in practice</a></li>
  <li><a href="#a-brief-note-on-other-approaches-3" id="toc-a-brief-note-on-other-approaches-3" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-3"><span class="header-section-number">4.4.10</span> A brief note on other approaches</a></li>
  <li><a href="#the-volcano-plot" id="toc-the-volcano-plot" class="nav-link" data-scroll-target="#the-volcano-plot"><span class="header-section-number">4.4.11</span> The volcano plot</a></li>
  <li><a href="#sec-de_cohort" id="toc-sec-de_cohort" class="nav-link" data-scroll-target="#sec-de_cohort"><span class="header-section-number">4.4.12</span> DE in human cohorts</a></li>
  <li><a href="#the-standard-procedure-deseq2-pseudo-bulk-analysis" id="toc-the-standard-procedure-deseq2-pseudo-bulk-analysis" class="nav-link" data-scroll-target="#the-standard-procedure-deseq2-pseudo-bulk-analysis"><span class="header-section-number">4.4.13</span> The standard procedure: DESeq2 (Pseudo-bulk analysis)</a></li>
  <li><a href="#a-brief-note-on-other-approaches-4" id="toc-a-brief-note-on-other-approaches-4" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-4"><span class="header-section-number">4.4.14</span> A brief note on other approaches</a></li>
  <li><a href="#sec-de_normalization-vs-count" id="toc-sec-de_normalization-vs-count" class="nav-link" data-scroll-target="#sec-de_normalization-vs-count"><span class="header-section-number">4.4.15</span> Aside: DE testing on normalized vs.&nbsp;count data</a></li>
  <li><a href="#pooling-of-overdispersion-parameters-is-usually-the-most-de-methods-share-information-across-genes-if-at-all" id="toc-pooling-of-overdispersion-parameters-is-usually-the-most-de-methods-share-information-across-genes-if-at-all" class="nav-link" data-scroll-target="#pooling-of-overdispersion-parameters-is-usually-the-most-de-methods-share-information-across-genes-if-at-all"><span class="header-section-number">4.4.16</span> Pooling of overdispersion parameters is usually the most DE methods “share information across genes,” if at all</a></li>
  <li><a href="#de-for-a-continuous-covariate" id="toc-de-for-a-continuous-covariate" class="nav-link" data-scroll-target="#de-for-a-continuous-covariate"><span class="header-section-number">4.4.17</span> “DE” for a continuous covariate</a></li>
  </ul></li>
  <li><a href="#pathway-analysis" id="toc-pathway-analysis" class="nav-link" data-scroll-target="#pathway-analysis"><span class="header-section-number">4.5</span> Pathway analysis</a>
  <ul>
  <li><a href="#the-standard-procedure-gsea" id="toc-the-standard-procedure-gsea" class="nav-link" data-scroll-target="#the-standard-procedure-gsea"><span class="header-section-number">4.5.1</span> The standard procedure: GSEA</a></li>
  <li><a href="#a-brief-note-on-other-approaches-5" id="toc-a-brief-note-on-other-approaches-5" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-5"><span class="header-section-number">4.5.2</span> A brief note on other approaches</a></li>
  <li><a href="#how-to-do-this-in-practice-4" id="toc-how-to-do-this-in-practice-4" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-4"><span class="header-section-number">4.5.3</span> How to do this in practice</a></li>
  </ul></li>
  <li><a href="#sec-celltype_labeling" id="toc-sec-celltype_labeling" class="nav-link" data-scroll-target="#sec-celltype_labeling"><span class="header-section-number">4.6</span> Cell-type labeling, transfer learning</a>
  <ul>
  <li><a href="#sec-marker_gene_labeling" id="toc-sec-marker_gene_labeling" class="nav-link" data-scroll-target="#sec-marker_gene_labeling"><span class="header-section-number">4.6.1</span> Strategy 1: Good’ol marker genes</a></li>
  <li><a href="#in-relation-to-scoring-a-gene-set" id="toc-in-relation-to-scoring-a-gene-set" class="nav-link" data-scroll-target="#in-relation-to-scoring-a-gene-set"><span class="header-section-number">4.6.2</span> In relation to scoring a gene-set</a></li>
  <li><a href="#strategy-2-deploying-a-classifiertransfer-learning" id="toc-strategy-2-deploying-a-classifiertransfer-learning" class="nav-link" data-scroll-target="#strategy-2-deploying-a-classifiertransfer-learning"><span class="header-section-number">4.6.3</span> Strategy 2: Deploying a classifier/Transfer learning</a></li>
  <li><a href="#strategy-3-data-integration" id="toc-strategy-3-data-integration" class="nav-link" data-scroll-target="#strategy-3-data-integration"><span class="header-section-number">4.6.4</span> Strategy 3: Data integration</a></li>
  <li><a href="#how-to-do-this-in-practice-5" id="toc-how-to-do-this-in-practice-5" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-5"><span class="header-section-number">4.6.5</span> How to do this in practice</a></li>
  <li><a href="#a-brief-note-on-other-approaches-6" id="toc-a-brief-note-on-other-approaches-6" class="nav-link" data-scroll-target="#a-brief-note-on-other-approaches-6"><span class="header-section-number">4.6.6</span> A brief note on other approaches</a></li>
  </ul></li>
  <li><a href="#sec-trajectory" id="toc-sec-trajectory" class="nav-link" data-scroll-target="#sec-trajectory"><span class="header-section-number">4.7</span> Trajectory analysis</a>
  <ul>
  <li><a href="#a-typical-choice-monocle" id="toc-a-typical-choice-monocle" class="nav-link" data-scroll-target="#a-typical-choice-monocle"><span class="header-section-number">4.7.1</span> A typical choice: Monocle</a></li>
  <li><a href="#how-to-do-this-in-practice-6" id="toc-how-to-do-this-in-practice-6" class="nav-link" data-scroll-target="#how-to-do-this-in-practice-6"><span class="header-section-number">4.7.2</span> How to do this in practice</a></li>
  <li><a href="#a-highly-active-area-of-research-how-much-biology-does-your-premise-assume-is-true" id="toc-a-highly-active-area-of-research-how-much-biology-does-your-premise-assume-is-true" class="nav-link" data-scroll-target="#a-highly-active-area-of-research-how-much-biology-does-your-premise-assume-is-true"><span class="header-section-number">4.7.3</span> A highly active area of research: How much biology does your premise assume is true?</a></li>
  <li><a href="#talk-to-me-about-statistics-what-makes-this-topic-criminally-difficult" id="toc-talk-to-me-about-statistics-what-makes-this-topic-criminally-difficult" class="nav-link" data-scroll-target="#talk-to-me-about-statistics-what-makes-this-topic-criminally-difficult"><span class="header-section-number">4.7.4</span> Talk to me about statistics: What makes this topic criminally difficult?</a></li>
  </ul></li>
  <li><a href="#sec-beyond_scrna" id="toc-sec-beyond_scrna" class="nav-link" data-scroll-target="#sec-beyond_scrna"><span class="header-section-number">4.8</span> Concluding thoughts about scRNA-seq: Why bother with anything else?</a>
  <ul>
  <li><a href="#limited-biological-insights-from-scrna-seq-matrices" id="toc-limited-biological-insights-from-scrna-seq-matrices" class="nav-link" data-scroll-target="#limited-biological-insights-from-scrna-seq-matrices"><span class="header-section-number">4.8.1</span> Limited biological insights from scRNA-seq matrices</a></li>
  <li><a href="#limited-biological-understanding-of-mrna-fragments" id="toc-limited-biological-understanding-of-mrna-fragments" class="nav-link" data-scroll-target="#limited-biological-understanding-of-mrna-fragments"><span class="header-section-number">4.8.2</span> Limited biological understanding of mRNA fragments</a></li>
  <li><a href="#translational-limitation-of-scrna-seq-and-bulk-deconvolution" id="toc-translational-limitation-of-scrna-seq-and-bulk-deconvolution" class="nav-link" data-scroll-target="#translational-limitation-of-scrna-seq-and-bulk-deconvolution"><span class="header-section-number">4.8.3</span> Translational limitation of scRNA-seq, and bulk deconvolution</a></li>
  <li><a href="#not-all-rna-is-mrna" id="toc-not-all-rna-is-mrna" class="nav-link" data-scroll-target="#not-all-rna-is-mrna"><span class="header-section-number">4.8.4</span> Not all RNA is mRNA</a></li>
  <li><a href="#importance-of-other-omics" id="toc-importance-of-other-omics" class="nav-link" data-scroll-target="#importance-of-other-omics"><span class="header-section-number">4.8.5</span> Importance of other omics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Single-cell RNA-sequencing</span></h1>
<p class="subtitle lead">Cluster, differential expression, cell-typing, and trajectory analysis</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="block2">
<p><strong>Personal opinion: Most methods for single-cell RNA-sequencing “generalize” to other modalities</strong></p>
<p>Most of the statistical logic discussed for scRNA-seq will work for any other sequencing technology, even if it’s for another omic. While the literal details might change (and might be repackaged as a different method), this high-level statistical logic has stood the test of time, at least over the 10+ years. This is why it is arguably more important to understand the reason <em>why</em> certain methods are used, compared to <em>how</em> the method works.</p>
</div>
<section id="some-important-nouns-and-verbs" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="some-important-nouns-and-verbs"><span class="header-section-number">4.1</span> Some important nouns and verbs</h2>
<ul>
<li><p><strong>Sequencing</strong> <em>(verb)</em>: The process of determining the order of nucleotides (A, T, C, G) in a DNA or RNA molecule, providing the primary structure of these biomolecules. Sequencing technologies have evolved to be high-throughput, enabling the analysis of entire genomes or transcriptomes.</p></li>
<li><p><strong>Sequencing depth, read depth, library size</strong> <em>(noun; all synonyms)</em>: These terms refer to the number of times a specific nucleotide or region of the genome is sequenced in an experiment. Greater depth provides more accurate detection of rare variants or lowly expressed genes but requires increased computational and financial resources.</p></li>
<li><p><strong>Chromosome, DNA, RNA, protein</strong> <em>(noun)</em>:</p>
<ul>
<li><strong>Chromosome</strong>: A large, organized structure of DNA and associated proteins that contains many genes and regulatory elements.<br>
</li>
<li><strong>DNA</strong>: The molecule that encodes genetic information in a double-helical structure.<br>
</li>
<li><strong>RNA</strong>: A single-stranded molecule transcribed from DNA that can act as a messenger (mRNA), a structural component (rRNA), or a regulator (e.g., miRNA). When we talk about scRNA-seq, we are usually referring to exclusively measuring mRNA.<br>
</li>
<li><strong>Protein</strong>: The functional biomolecule synthesized from RNA via translation, performing structural, enzymatic, and regulatory roles in cells.</li>
</ul></li>
<li><p><strong>Genome vs.&nbsp;gene vs.&nbsp;intergenic region</strong> <em>(noun)</em>:</p>
<ul>
<li><strong>Genome</strong>: The complete set of DNA in an organism, encompassing all of its genetic material, including coding genes, non-coding regions, and regulatory elements. The genome is the blueprint that defines the biological potential of the organism.<br>
</li>
<li><strong>Gene</strong>: A specific sequence within the genome that encodes a functional product, typically a protein or functional RNA. Genes include regions such as exons (coding sequences), introns (non-coding regions within a gene), and regulatory sequences (e.g., promoters and enhancers) that control gene expression. We will see more about the architecture of a gene in <a href="chapter6_dna.html#sec-genetics_basics" class="quarto-xref"><span>Section 7.1</span></a>.<br>
</li>
<li><strong>Intergenic region</strong>: The stretches of DNA between genes that do not directly code for proteins or RNA. Intergenic regions were once considered “junk DNA,” but they often contain regulatory elements, such as enhancers and silencers, that influence the expression of nearby or distant genes. These regions also play roles in chromatin organization and genome stability.</li>
</ul></li>
<li><p><strong>Genetics vs.&nbsp;genomics</strong> <em>(noun)</em>: Genetics typically focuses on the role of the DNA among large populations (of people, of species, etc.), while genomics can encapsulate any omic, and does not necessarily imply studies across a large population<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p></li>
<li><p><strong>“Next generation sequencing”</strong> <em>(noun)</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>: A collection of high-throughput technologies that allow for the parallel sequencing of millions of DNA or RNA molecules. It has revolutionized biology by enabling large-scale studies of genomes, transcriptomes, and epigenomes.</p></li>
<li><p><strong>Read fragment</strong> <em>(noun)</em>: A short sequence of DNA or RNA produced as an output from high-throughput sequencing. Fragments are typically between 50 bp and 300 bp long, depending on the sequencing technology, and they represent segments of the original molecule being sequenced.</p></li>
<li><p><strong>Reference genome</strong> <em>(noun)</em>: A curated, complete assembly of the genomic sequence for a species, used as a template to align and interpret sequencing reads. It serves as a baseline for identifying genetic variations, such as mutations or structural changes, and for annotating functional elements.</p></li>
<li><p><strong>Coding genes vs.&nbsp;non-coding genes</strong> <em>(noun)</em>:</p>
<ul>
<li><strong>Coding genes</strong>: Genes that contain instructions for producing proteins. They are transcribed into mRNA, which is then translated into functional proteins that perform structural, enzymatic, or regulatory roles in cells.<br>
</li>
<li><strong>Non-coding genes</strong>: Genes that do not produce proteins but instead generate functional RNA molecules, such as rRNA, tRNA, miRNA, or lncRNA, which regulate gene expression, maintain genomic stability, or perform other cellular functions. Non-coding genes highlight the complexity of gene regulation and cellular processes beyond protein synthesis.</li>
</ul></li>
<li><p><strong>Epigenetics vs.&nbsp;epigenomics</strong> <em>(noun)</em>: Epigenetics studies modifications to DNA and histones (e.g., methylation, acetylation) that regulate gene expression without altering the DNA sequence. Epigenomics examines these modifications across the entire genome.</p></li>
<li><p><strong>Transcriptome</strong> <em>(noun)</em>: The complete set of RNA transcripts expressed in a cell or tissue at a given time, reflecting dynamic gene activity.</p></li>
<li><p><strong>Proteome</strong> <em>(noun)</em>: The full complement of proteins expressed in a cell, tissue, or organism, representing functional output.</p></li>
<li><p><strong>Single-cell sequencing</strong> <em>(noun)</em>: Sequencing technologies applied at the resolution of individual cells, allowing for the study of heterogeneity in gene expression, epigenetics, or genetic variation across cell populations.</p></li>
<li><p><strong>Bulk sequencing</strong> <em>(noun)</em>: Sequencing technologies that aggregate material (e.g., RNA, DNA) from many cells, providing an average profile of the population but masking individual cell variability.</p></li>
</ul>
</section>
<section id="sec-chapter_3_tech" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-chapter_3_tech"><span class="header-section-number">4.2</span> How scRNA-seq works as a technology</h2>
<div class="block">
<p><strong>Remark (Single-cell vs.&nbsp;single-nuclei).</strong> While I use the word “cell,” sometimes in certain biological tissues, the more accurate word is “nuclei.” The computational methods for single-cell RNA-seq data (scRNA-seq) is essentially the same as single-nuclei RNA-seq data (snRNA-seq). What’s different is the biological context. For instance, some biological processes happen only in the nucleus, so when you collect snRNA-seq data, you might be overly enriched to discover those processes. See <span class="citation" data-cites="denisenko2020systematic ding2020systematic">(<a href="references.html#ref-denisenko2020systematic" role="doc-biblioref">Denisenko et al. 2020</a>; <a href="references.html#ref-ding2020systematic" role="doc-biblioref">Ding et al. 2020</a>)</span> for example.</p>
</div>
<p>See <a href="#fig-10x-protocol" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> for an illustration of how the 10x protocol works. We’ll explain this next (and more importantly, <em>why</em> it’s important for a statistician to know how single-cell sequencing works)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="block">
<div id="fig-10x-protocol" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-10x-protocol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/10x-protocol.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-10x-protocol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Illustration of the how scRNA-seq works (this is specific for 10x Chromium 3’, but most single-cell protocols follow this rough strategy). <span class="citation" data-cites="swaminath2024use">(<a href="references.html#ref-swaminath2024use" role="doc-biblioref">Swaminath and Russell 2024</a>)</span>
</figcaption>
</figure>
</div>
</div>
<ol type="1">
<li><strong>Tissue dissociation and cell isolation</strong>: The tissue of interest is dissociated into a suspension of individual cells using enzymatic or mechanical methods. Single cells are isolated, often using fluorescence-activated cell sorting (FACS) or microfluidic techniques. This step is why some biological systems require “single-nuclei” instead of “single-cell.”</li>
</ol>
<div class="block">
<p><strong>Remark (Tissue dissociation is typically invasive).</strong> The main non-invasive ways is through blood, skin, and urine/feces. Otherwise, unlike MRIs, this is not easy to access tissues in humans. Hence, human samples from most non-accessible biological systems (i.e., brain, lung, heart, etc.) are usually obtain with prior consent from donors after surgery, biopsy, transplant, etc.</p>
</div>
<ol start="2" type="1">
<li><p><strong>Droplet formation</strong>: Cells are encapsulated into tiny droplets along with barcoded beads. Each bead contains unique molecular identifiers (UMIs) and cell-specific barcodes to label RNA molecules from individual cells. This step is the how we can keep track and eventually figure out which data came from which cell.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p></li>
<li><p><strong>Cell lysis and RNA capture</strong>: Cells are lysed within the droplets, and the released RNA molecules hybridize to oligonucleotides on the barcoded beads. This step ensures that all RNA from a single cell is tagged with the same cell-specific barcode.</p></li>
</ol>
<div class="block">
<p><strong>Remark (Lysing prevents longitudinal profile).</strong> This step is why, by default, scRNA-seq cannot do longitudinal experiments on literally the same cells. You have to destroy the cell to sequence it.</p>
</div>
<ol start="4" type="1">
<li><strong>Reverse transcription, cDNA synthesis, and PCR amplification</strong>: The captured RNA is reverse-transcribed into complementary DNA (cDNA), incorporating the barcodes and UMIs to track the origin of each molecule. The cDNA is amplified via PCR to generate enough material for sequencing<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. UMIs help correct for amplification biases by identifying and collapsing duplicate reads from the same original RNA molecule. See <a href="#fig-umi1" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> for the benefit the UMI.</li>
</ol>
<div class="block">
<div id="fig-umi1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-umi1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/umi.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-umi1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Illustration of the importance of UMIs. From <a href="https://help.geneiousbiologics.com/hc/en-us/articles/4781289585300-Understanding-Single-Cell-technologies-Barcodes-and-UMIs" class="uri">https://help.geneiousbiologics.com/hc/en-us/articles/4781289585300-Understanding-Single-Cell-technologies-Barcodes-and-UMIs</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-umi2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-umi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/barcode.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-umi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: How the Poly(dT) on the 10x bead sequence binds to the Poly(A) tail at the 3’ end of an mRNA fragment. From <a href="https://www.10xgenomics.com/support/universal-three-prime-gene-expression/documentation/steps/library-prep/chromium-gem-x-single-cell-3-v4-gene-expression-user-guide" class="uri">https://www.10xgenomics.com/support/universal-three-prime-gene-expression/documentation/steps/library-prep/chromium-gem-x-single-cell-3-v4-gene-expression-user-guide</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<p><strong>Remark (The importance and impact of PCR).</strong> Some biological modalities cannot be PCR’d reliably. This is why (as we’ll see later in the course) certain omics are a <em>lot</em> harder to get data of at single-cell resolution. The PCR step is important because you can imagine it’s <em>very</em> hard to sequence every fragment in a cell. There might be many fragments, but you won’t be able to sequence many of them. By amplifying the content in a cell, we can more reliably sequence the contents in that cell. The UMIs become very important because we want to make sure our eventual gene expression counts are the fragments from the original cell, not counts due to PCR amplification.</p>
</div>
<ol start="5" type="1">
<li><strong>Library preparation and high-throughput sequencing</strong>: Amplified cDNA is fragmented (if necessary) and adapters are added to prepare the material for sequencing. These adapters are required for sequencing compatibility and indexing. The prepared library is sequenced on a next-generation sequencing platform<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>, generating short reads<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> that include both the transcript sequence and the associated barcodes and UMIs</li>
</ol>
<div class="block2">
<p><strong>Remark (The impact of “short reads”).</strong> Short reads, typically around 50-400 base pairs long<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, are the output of most high-throughput sequencing platforms (i.e., a limitation of using Illumina sequencing, for example). While they provide highly accurate and cost-effective data, their limited length can pose challenges in resolving complex regions of the genome, such as repetitive sequences, or distinguishing between transcript isoforms in RNA-seq data. These limitations can obscure biological insights, particularly in applications requiring full-length transcript information or precise structural variation analysis.</p>
</div>
<div class="block">
<p><strong>Remark (Limitation of budget).</strong> The sequencing step is a costly step (in terms of money) in a data generation process. The more money you spend, the more sequencing depth you can get. (Of course, this is also dictated by the number of cells in your experiment, the cell quality, the efficacy of the sequencing protocol, etc.) However, if you don’t sequence using a large financial budget, then your count matrix <span class="math inline">\(X\)</span> will have even more 0’s. This means you have less “resolution” to discover biological insights<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
</div>
<ol start="6" type="1">
<li><strong>Mapping and alignment</strong>: Sequencing reads are mapped to a reference genome or transcriptome to identify the originating genes. UMIs are used to remove PCR duplicates, ensuring accurate quantification of transcripts. This is a classic bioinformatics task – given a sequencing fragment (i.e., the literal basepair sequence) and a reference genome, figure out where in the reference genome this sequencing fragment should map to. If you are doing a typical 10x scRNA-seq experiment, the software to do this (made by 10x) is called CellRanger<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>.</li>
</ol>
<div id="rem-biology_thrown" class="block proof remark">
<p><span class="proof-title"><em>Remark 4.1</em>. </span><strong>Remark (A lot of fascinating biology is thrown out).</strong> During the mapping and alignment step, many sequencing reads are often discarded because they do not align to the reference genome or transcriptome used in the analysis. This includes reads from bacteria and viruses, which could reveal insights into host-microbe interactions or infections <span class="citation" data-cites="arabi2023brain sato2018cell">(<a href="references.html#ref-arabi2023brain" role="doc-biblioref">Arabi et al. 2023</a>; <a href="references.html#ref-sato2018cell" role="doc-biblioref">Sato et al. 2018</a>)</span>. Similarly, long non-coding RNAs (lncRNAs) <span class="citation" data-cites="mattick2023long">(<a href="references.html#ref-mattick2023long" role="doc-biblioref">Mattick et al. 2023</a>)</span>, genetic variation (including allele-specific expression) <span class="citation" data-cites="robles2021allele">(<a href="references.html#ref-robles2021allele" role="doc-biblioref">Robles-Espinoza et al. 2021</a>)</span>, alternative splicing <span class="citation" data-cites="chen2015alternative">(<a href="references.html#ref-chen2015alternative" role="doc-biblioref">J. Chen and Weiss 2015</a>)</span>, and untranslated regions (UTRs) of mRNAs are frequently overlooked in standard analyses despite their crucial roles in gene regulation, transcript stability, and translation <span class="citation" data-cites="arora2022role">(<a href="references.html#ref-arora2022role" role="doc-biblioref">Arora et al. 2022</a>)</span>. While these regions and features are often excluded for simplicity or due to lack of annotation, they represent a wealth of biological information that could lead to fascinating discoveries if properly explored.</p>
</div>
<div id="rem-zero-inflation" class="block2 proof remark">
<p><span class="proof-title"><em>Remark 4.2</em>. </span><strong>Remark (Why zero-inflation is not currently as popular for scRNA-seq analyses).</strong> As I mentioned in <a href="chapter2_sequencing.html#sec-imputation" class="quarto-xref"><span>Section 3.3.13</span></a>, modeling zero-inflation is not very common anymore. (This is also why we typically do not use an imputation step beyond the usual dimension reduction.) This was shown for droplet-based sequencing protocols <span class="citation" data-cites="svensson2020droplet">(<a href="references.html#ref-svensson2020droplet" role="doc-biblioref">Svensson 2020</a>)</span>, alongside its replies and responses <span class="citation" data-cites="cao2021umi svensson2021reply">(<a href="references.html#ref-cao2021umi" role="doc-biblioref">Cao et al. 2021</a>; <a href="references.html#ref-svensson2021reply" role="doc-biblioref">Svensson 2021</a>)</span>. You might also be interested as well to read more about where the 0’s in a count matrix could come from during the entire sequencing protocol <span class="citation" data-cites="jiang2022statistics">(<a href="references.html#ref-jiang2022statistics" role="doc-biblioref">Jiang et al. 2022</a>)</span>, and how UMIs have contributed to not needing to worry about zero-inflation as much anymore <span class="citation" data-cites="chen2018umi kim2020demystifying">(<a href="references.html#ref-chen2018umi" role="doc-biblioref">W. Chen et al. 2018</a>; <a href="references.html#ref-kim2020demystifying" role="doc-biblioref">Kim, Zhou, and Chen 2020</a>)</span>.</p>
</div>
</section>
<section id="clustering" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="clustering"><span class="header-section-number">4.3</span> Clustering</h2>
<div class="block3">
<p><strong>Input/Output.</strong><br>
The input to clustering is a normalized matrix <span class="math inline">\(X\in \mathbb{R}^{n\times p}\)</span> for <span class="math inline">\(n\)</span> cells and <span class="math inline">\(p\)</span> features (i.e., genes) and typically a clustering resolution, and the output is a partitioning of all the cells. That is, if there are estimated to be <span class="math inline">\(K\)</span> clusters, each cell is assigned to one of the <span class="math inline">\(K\)</span> clusters.</p>
</div>
<section id="what-is-a-cell-type-no-seriously.-what-is-it" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="what-is-a-cell-type-no-seriously.-what-is-it"><span class="header-section-number">4.3.1</span> What is a “cell type”? No, seriously. What is it?</h3>
<p>The concept of a “cell type” is foundational yet complex in biology. Historically, cell types have been defined by shared structural and functional characteristics, making them distinct from other cells in an organism. However, this simplicity belies a deeper challenge: what features truly define a cell type? Modern research has shown that cell types exhibit diverse properties across molecular (i.e., the mRNA fragments and proteins in the cell), morphological (i.e., the shape of the cell), spatial (i.e., where the cell is in the human body), ancestry (i.e., where the cell originated from), and functional (i.e., the purpose of this cell) dimensions, often making it difficult to draw clear boundaries. For example:</p>
<ul>
<li><strong>Example of obvious distinctions</strong>: Obvious differences in cells are often rooted in their structure and function. Heart muscle cells contract using striated fibers, while neurons transmit signals via dendrites and axons, making their structures and functions unmistakably distinct.</li>
<li><strong>Example of not-obvious distinctions</strong>: Neurons in the brain have been categorized based on their shape, connectivity, and gene expression patterns, but these dimensions do not always align, leading to ambiguities in classification.</li>
</ul>
<p>For example, in many “atlas” projects (i.e., big scientific collaborators that aim to exhaustively profile many cells to understand the full diversity of cells), there is a very fundamental question: “How many cell types are there?” This is illustrated in <a href="#fig-atlas" class="quarto-xref">Figure&nbsp;<span>4.4</span></a><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>, where after exhaustively profile 4 brains from multiple brain regions, the authors defined 31 “superclusters” (shown as different colors) that separate into 3313 “subclusters.”</p>
<div class="block">
<div id="fig-atlas" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-atlas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/atlas.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-atlas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: From <span class="citation" data-cites="siletti2023transcriptomic">(<a href="references.html#ref-siletti2023transcriptomic" role="doc-biblioref">Siletti et al. 2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>Advances in single-cell transcriptomics have revolutionized how we define cell types. By profiling thousands of genes simultaneously, researchers can cluster cells into groups based on gene expression patterns, creating detailed cell taxonomies. Yet, even this high-resolution approach raises questions about granularity—should closely related clusters represent distinct cell types or variations within the same type? Additionally, transcriptomic definitions often need validation through other modalities, such as spatial organization, connectivity, or functional roles. See <a href="#fig-celltype_ex1" class="quarto-xref">Figure&nbsp;<span>4.5</span></a> for illustrations of other biotechnology assays to define cell types. Despite these challenges, integrating these diverse perspectives is essential for understanding how cells contribute to the structure and function of tissues and organs in both health and disease.</p>
<div class="block">
<div id="fig-celltype_ex1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-celltype_ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/celltype_ex1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-celltype_ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Illustrating how to define cell types (in this case, specific to the brain). <span class="citation" data-cites="zeng2022cell">(<a href="references.html#ref-zeng2022cell" role="doc-biblioref">Zeng 2022</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div class="block2">
<p><strong>Remark (Personal opinion: Being stunlocked on how to define “cell type” in your paper is the rite of passage to becoming a cell biologist).</strong> The more you work closer to biology, the more you’ll realize that answering “What is a cell type?” transforms from a seemingly useless pedagogical question into insanely difficult question that requires you to dig deep into biology. For instance, aging research is currently at the forefront of a lot of biomedical research. However, consider <a href="#fig-celltype_ex2" class="quarto-xref">Figure&nbsp;<span>4.6</span></a>. Does a cell switch it’s “cell type” as we age? (Clearly, the answer must be “yes” to some degree, since all our cells originate from an embryo.) However, when we age from 70 to 80 years old, do our cells change their “cell type” as certain cells start losing their intended function?</p>
<p>The questions can get even crazier: Suppose I “discover a new cell type” in my high-profile scRNA-seq analysis. What does that mean? How do I convey to another researcher what defines this cell type? How am I confident that this “cell type” can be found in donors not in my dataset? (Our notation of cell type would be quite useless if it only existed in one donor or one dataset.)</p>
</div>
<div class="block">
<div id="fig-celltype_ex2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-celltype_ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/celltype_ex2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-celltype_ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: From <span class="citation" data-cites="zeng2022cell">(<a href="references.html#ref-zeng2022cell" role="doc-biblioref">Zeng 2022</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<p>We will focus on how to cluster cells in the remainder of this section, but we’ll discuss how to label the clusters as “cell types” in <a href="#sec-celltype_labeling" class="quarto-xref"><span>Section 4.6</span></a>, and how to infer temporal relations in <a href="#sec-trajectory" class="quarto-xref"><span>Section 4.7</span></a>.</p>
</section>
<section id="clustering-cells-into-cell-types-or-cell-states" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="clustering-cells-into-cell-types-or-cell-states"><span class="header-section-number">4.3.2</span> Clustering cells into cell types or cell states</h3>
<p>Clustering is a central step in single-cell RNA-sequencing analysis, allowing researchers to group cells with similar gene expression profiles into distinct clusters that represent cell types or states. Methods like Louvain or Leiden clustering are commonly used for this purpose, leveraging the low-dimensional representation from Principal Component Analysis (PCA) to identify patterns of cellular heterogeneity. These algorithms operate on a graph-based representation of the data, where cells are nodes and edges reflect similarities in their PCA embeddings. The goal is to partition cells into cohesive groups that capture biologically meaningful variation, such as distinct immune cell types or developmental stages. By clustering cells, researchers can uncover the diversity within a tissue or system and generate hypotheses about the roles of different cell populations in health and disease.</p>
</section>
<section id="the-standard-procedure-louvain-clustering" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="the-standard-procedure-louvain-clustering"><span class="header-section-number">4.3.3</span> The standard procedure: Louvain clustering</h3>
<p>Louvain clustering is a graph-based community detection algorithm widely used in single-cell RNA-seq (scRNA-seq) analysis to group cells into clusters representing cell types or states. The algorithm operates on a nearest-neighbor graph constructed from the low-dimensional representation of the data, such as the first few principal components obtained via Principal Component Analysis (PCA). This methods needs one tuning parameter <span class="math inline">\(\gamma\)</span>, which denotes the “resolution” of the method.</p>
<ul>
<li><strong>Initialization (Graph construction)</strong>: The first step in Louvain clustering is to construct a graph <span class="math inline">\(G = (V, E)\)</span>, where:</li>
<li><span class="math inline">\(V\)</span> represents the set of nodes (cells),</li>
<li><span class="math inline">\(E\)</span> represents the edges between nodes, with weights <span class="math inline">\(w_{ij}\)</span> quantifying the similarity between cells <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</li>
</ul>
<p>The edge weights <span class="math inline">\(w_{ij}\)</span> are typically computed using a similarity metric, such as Euclidean distance or cosine similarity, and thresholded to retain only the <span class="math inline">\(k\)</span>-nearest neighbors for each node.</p>
<ul>
<li><strong>The objective (Modularity optimization)</strong>: The goal of Louvain clustering is to maximize the modularity <span class="math inline">\(Q\)</span> of the graph, defined as: <span class="math display">\[
Q = \frac{1}{2m} \sum_{i,j} \left( w_{ij} - \gamma \frac{k_i k_j}{2m} \right) \delta(c_i, c_j),
\]</span> where:</li>
<li><span class="math inline">\(w_{ij}\)</span> is the weight of the edge between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\(\gamma\)</span> is the resolution of the desired clustering (a larger number means smaller cluster sizes),</li>
<li><span class="math inline">\(k_i = \sum_j w_{ij}\)</span> is the sum of edge weights for node <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(m = \frac{1}{2} \sum_{i,j} w_{ij}\)</span> is the total weight of all edges in the graph,</li>
<li><span class="math inline">\(c_i\)</span> is the community assignment for node <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\delta(c_i, c_j)\)</span> is an indicator function that equals 1 if nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> belong to the same community, and 0 otherwise.</li>
</ul>
<p>The modularity measures the quality of a partition by comparing the observed edge weights within communities to those expected under a random graph with the same degree distribution. (Conceptually, you can see that <span class="math inline">\(k_i k_j/(2m)\)</span> represents the expected edge weight under a random graph model – a sort of “background distribution” adjustment.)</p>
<ul>
<li><strong>The estimation procedure (Iterative refinement)</strong>: Louvain clustering proceeds iteratively:</li>
</ul>
<ol type="1">
<li>Each node is initially assigned to its own community.</li>
<li>Nodes are moved to neighboring communities if this increases the modularity <span class="math inline">\(Q\)</span>.</li>
<li>Communities are aggregated into “super-nodes,” and the process repeats on the coarsened graph.</li>
</ol>
<p>The algorithm terminates when no further modularity improvement is possible.</p>
<p>In the context of scRNA-seq, Louvain clustering is applied to the nearest-neighbor graph of cells constructed from their PCA embeddings. The resulting clusters correspond to groups of cells with similar gene expression profiles, often representing distinct cell types or states. This method is computationally efficient and well-suited for the large, sparse graphs typical of scRNA-seq data. Louvain clustering’s modularity-based approach provides a flexible framework for uncovering cellular heterogeneity, making it a cornerstone of single-cell analysis pipelines.</p>
<div class="block2">
<p><strong>Remark (Leiden as an improvement over Louvain).</strong> The Leiden algorithm <span class="citation" data-cites="traag2019louvain">(<a href="references.html#ref-traag2019louvain" role="doc-biblioref">Traag, Waltman, and Van Eck 2019</a>)</span> improves upon Louvain by addressing issues of cluster quality and stability. While Louvain can produce disconnected or poorly connected clusters, Leiden guarantees that clusters are well-connected and more robust. This makes Leiden particularly suitable for high-dimensional and noisy datasets, such as those in single-cell RNA-seq analyses.</p>
</div>
<div class="block2">
<p><strong>Remark (You specify a resolution, not the number of clusters).</strong> In many clustering algorithms, particularly graph-based methods like Louvain or Leiden, you specify a resolution parameter that influences the granularity of the clustering. A higher resolution typically results in more, smaller clusters, while a lower resolution produces fewer, larger clusters. The number of clusters is not fixed beforehand but emerges as a result of the resolution and the underlying structure of the data.</p>
</div>
</section>
<section id="how-to-do-this-in-practice" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="how-to-do-this-in-practice"><span class="header-section-number">4.3.4</span> How to do this in practice</h3>
<p>See the <code>Seurat::FindClusters</code> function, illustrated in <a href="#fig-cluster" class="quarto-xref">Figure&nbsp;<span>4.7</span></a>. The resulting visualization is shown in <a href="#fig-cluster-fig1" class="quarto-xref">Figure&nbsp;<span>4.8</span></a>.</p>
<div class="block">
<div id="fig-cluster" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/cluster.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: The Louvian clustering step. See the tutorial in <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" class="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-cluster-fig1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cluster-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/cluster-fig1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cluster-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.8: Using the <code>Seurat::DimPlot(pbmc, reduction = "pca", group.by = "RNA_snn_res.0.5")</code> (left) function to visualize the clusters.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-cluster-fig2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cluster-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/cluster-fig2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cluster-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.9: Using the <code>Seurat::DimPlot(pbmc, reduction = "umap", group.by = "RNA_snn_res.0.5")</code> (right) function to visualize the clusters. See the tutorial in <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" class="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a>.
</figcaption>
</figure>
</div>
</div>
<div id="rem-cluster_exploratory" class="block proof remark">
<p><span class="proof-title"><em>Remark 4.3</em>. </span><strong>Remark (Clustering is often an exploratory step, which then allows you focus on key populations of interest later on in your research project).</strong> As you can see here, the clustering role (together with the previous visualization steps and the cell-type labeling to be discussed in <a href="#sec-celltype_labeling" class="quarto-xref"><span>Section 4.6</span></a>) is to provide you a high-level overview of what your dataset contains. After all, when you get a scRNA-seq data fresh out of a wetlab experiment, you don’t actually know what kind of cells are in your dataset. (No dataset comes automatically labeled with cell types.)</p>
<p>Usually in your paper, after determining the clusters (and their cell types), you will spend a considerable portion of the paper going in-depth on just a few key cell types.</p>
</div>
<div class="block2">
<p><strong>Remark (Personal opinion: Make a bit too many clusters, and manually adjust/merge).</strong> Starting with a higher number of clusters can capture finer granularity and prevent important subpopulations from being overlooked. You can then manually combine clusters based on biological knowledge or other criteria, ensuring the final groupings are both meaningful and interpretable.</p>
<p>While this might seem sacrilegious to statistical hard-liners, the reality of scRNA-seq analyses is that: 1) you don’t want technical artifacts (from sequencing) or numerical quirks (based on the literal computational method being used) to dictate certain cell clusters (sometimes certain clusters are way too small to be meaningful), and 2) for the reality mentioned in <a href="#rem-cluster_exploratory" class="quarto-xref">Remark&nbsp;<span>4.3</span></a>, it might not be great use to time to worry about the “perfect clustering straight out of a method.” As long as you can justify your actions biologically, you’ll be in good hands.</p>
</div>
<div class="block">
<p><strong>Remark (Personal opinion: If you’re goal is to make an atlas, consider hierarchical clustering methods).</strong> Recall <a href="#fig-celltype_ex1" class="quarto-xref">Figure&nbsp;<span>4.5</span></a>. If the goal of your project is to delineate all the different types of biological variation in your dataset, you’re probably better off using a method that gives you a hierarchy of cell clusters (rather than one fixed clustering). Methods like PAGA <span class="citation" data-cites="wolf2019paga">(<a href="references.html#ref-wolf2019paga" role="doc-biblioref">Wolf et al. 2019</a>)</span> and MRTree <span class="citation" data-cites="peng2021cell">(<a href="references.html#ref-peng2021cell" role="doc-biblioref">Peng et al. 2021</a>)</span> are some (among many) that are useful for this exact task.</p>
</div>
</section>
<section id="a-brief-note-on-other-approaches" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="a-brief-note-on-other-approaches"><span class="header-section-number">4.3.5</span> A brief note on other approaches</h3>
<p>See <span class="citation" data-cites="zhang2020review yu2022benchmarking">(<a href="references.html#ref-zhang2020review" role="doc-biblioref">S. Zhang et al. 2020</a>; <a href="references.html#ref-yu2022benchmarking" role="doc-biblioref">Yu et al. 2022</a>)</span> on benchmarking of various ways to cluster cells.</p>
</section>
<section id="clustering-cells-into-meta-cells" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="clustering-cells-into-meta-cells"><span class="header-section-number">4.3.6</span> Clustering cells into “meta-cells”</h3>
<p>Clustering cells into “meta-cells” is a strategy primarily aimed at simplifying the analysis of single-cell data or increasing the robustness of downstream analyses. In this approach, individual cells are grouped into larger aggregates, or meta-cells, based on their similarity in gene expression profiles. Unlike clustering aimed at identifying biologically meaningful cell types or states, meta-cells are often created to reduce noise, handle sparsity, or improve computational efficiency by working with fewer, more aggregated units. By combining the counts of multiple cells into a single meta-cell, this technique can also mitigate technical variability, making patterns in the data easier to detect. While meta-cells may not represent distinct biological entities, they serve as a practical tool for gaining insights from large and noisy datasets.</p>
</section>
<section id="how-to-do-this-in-practice-1" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="how-to-do-this-in-practice-1"><span class="header-section-number">4.3.7</span> How to do this in practice</h3>
<p>The method I’ve seen most commonly used for this task is MetaCell <span class="citation" data-cites="baran2019metacell">(<a href="references.html#ref-baran2019metacell" role="doc-biblioref">Baran et al. 2019</a>)</span>. These metacells are constructed using a graph-based partitioning method that leverages k-nearest neighbor (K-nn) similarity graphs to identify groups of cells with highly similar gene expression profiles. By grouping cells into metacells, the method effectively reduces noise while preserving meaningful biological variance, allowing for robust and unbiased exploration of transcriptional states, gradients, and cell types. This is illustrated in <a href="#fig-metacell1" class="quarto-xref">Figure&nbsp;<span>4.10</span></a>.</p>
<div class="block">
<div id="fig-metacell1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-metacell1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/metacell1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-metacell1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.10: Schematic of Metacell. <span class="citation" data-cites="baran2019metacell">(<a href="references.html#ref-baran2019metacell" role="doc-biblioref">Baran et al. 2019</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-metacell2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-metacell2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/metacell2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-metacell2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.11: Visualization of the cells and their meta-cells. <span class="citation" data-cites="baran2019metacell">(<a href="references.html#ref-baran2019metacell" role="doc-biblioref">Baran et al. 2019</a>)</span>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="a-brief-note-on-other-approaches-1" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-1"><span class="header-section-number">4.3.8</span> A brief note on other approaches</h3>
<p>See a review in <span class="citation" data-cites="bilous2024building">(<a href="references.html#ref-bilous2024building" role="doc-biblioref">Bilous et al. 2024</a>)</span>.</p>
</section>
</section>
<section id="differential-expression" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="differential-expression"><span class="header-section-number">4.4</span> Differential expression</h2>
<p>Differential expression (DE) analysis, illustrated in <a href="#fig-de-illustration" class="quarto-xref">Figure&nbsp;<span>4.12</span></a>, aims to identify genes that are expressed at significantly different levels between two groups of cells. We will discuss two primary scenarios in the following section: 1) either where the groups are estimated from data, or 2) where the groups are determined by the experimental design. This comparison helps uncover genes that may play critical roles in the biological processes or phenotypic changes under investigation. In the context of single-cell RNA-seq, DE analysis must account for the unique challenges of sparsity and variability in the data. The primary goal is to highlight key molecular drivers of the experimental conditions, providing insights into underlying mechanisms or potential targets for therapeutic intervention. This analysis is foundational for linking cellular behavior to experimental manipulations or disease states.</p>
<div class="block">
<div id="fig-de-illustration" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-de-illustration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/de-illustration.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-de-illustration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.12: Illustration of how to think about DE. From <a href="https://www.sc-best-practices.org/conditions/differential_gene_expression.html" class="uri">https://www.sc-best-practices.org/conditions/differential_gene_expression.html</a>.
</figcaption>
</figure>
</div>
</div>
<p>See <a href="https://www.sc-best-practices.org/conditions/differential_gene_expression.html" class="uri">https://www.sc-best-practices.org/conditions/differential_gene_expression.html</a> for more background.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The input to differential expression is matrix <span class="math inline">\(X\in \mathbb{R}^{n\times p}\)</span> for <span class="math inline">\(n\)</span> cells and <span class="math inline">\(p\)</span> features (i.e., genes) split into two groups, and the output is two numbers per gene. One is the p-value for the gene (denoting how significant that gene deviates from the null distribution where there is no difference in the gene expression between the two groups. A smaller p-value denotes more evidence against the null), and the other is log fold change (denoting, roughly, how much larger the mean expression in one group is larger than the mean expression of the other group). The p-value is a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, and the log-fold change is any real value where both the sign and magnitude are important.</p>
</div>
<div class="block">
<p><strong>Remark (Intent of Differential Expression Analysis).</strong> The primary intent of differential expression (DE) analysis in single-cell RNA-seq is <em>not</em> usually to provide definitive evidence for interventions, such as proving a drug’s efficacy. Instead, DE in single-cell studies is often exploratory, aimed at uncovering basic biological insights. It addresses questions like, “We know there is a difference between these two conditions, but what is driving that difference at the cellular level?” The goal is to identify genes that exhibit meaningful changes in expression, contributing to our collective understanding of gene functions and their roles in cellular processes. These findings expand the compendium of knowledge that informs future experiments and hypotheses.</p>
</div>
<div class="block2">
<p><strong>Remark (Pleiotropy and the Need for Continued DE Analyses).</strong> There are a ton of existing databases that document what the function of each gene is. For instance, you can see collections of genes (<a href="https://www.genome.jp/kegg/kegg2.html" class="uri">https://www.genome.jp/kegg/kegg2.html</a> and <a href="https://www.gsea-msigdb.org/gsea/msigdb" class="uri">https://www.gsea-msigdb.org/gsea/msigdb</a>) or individual genes (<a href="https://www.ncbi.nlm.nih.gov/gene" class="uri">https://www.ncbi.nlm.nih.gov/gene</a> and <a href="https://www.genecards.org/" class="uri">https://www.genecards.org/</a>). You might wonder – given this wealth of knowledge, why bother do any more DE analyses on your own?</p>
<p>Pleiotropy, where a single gene influences multiple, seemingly unrelated biological processes, underscores the importance of continued differential expression (DE) analyses even in the presence of well-annotated pathways like KEGG. While these resources provide invaluable insights into known gene functions and pathways, they often fail to capture the full complexity of gene roles across diverse cellular contexts, conditions, or tissues. DE analysis allows us to uncover novel functions or unexpected roles for genes, especially in underexplored biological systems or conditions. Pleiotropic effects are context-dependent, and without systematically exploring gene expression across varied conditions, we risk oversimplifying or missing critical aspects of cellular and molecular biology.</p>
</div>
<section id="hold-on-isnt-de-just-a-t-test" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="hold-on-isnt-de-just-a-t-test"><span class="header-section-number">4.4.1</span> Hold on… isn’t DE just a t-test?</h3>
<p>So why is DE even an interesting problem? Couldn’t we just use a t-test (parametric, asymptotic), Wilcoxon rank-sum test (nonparametric, asymptotic), or permutation test (nonparametric, exact)? Yes, you can.</p>
<p>So why is there a huge field studying DE in genomics, and why are there so many methods? Ultimately, the focus is on achieving greater statistical power or applying the methods more broadly across diverse datasets and experimental conditions. It boils down to engineering the underlying statistical model to do the following two things effectively:</p>
<ul>
<li><strong>Extract the “meaningful” signal</strong>: While we could run any of the aforementioned tests on the observed single-cell data, the results might be misleading due to the presence of unwanted covariates. For example, significant genes might simply reflect technical artifacts, such as the correlation between gene expression and the number of cells with non-zero counts for that gene.</li>
</ul>
<p>As we’ve discussed, these are cases where <em>technical noise</em> (i.e., noise induced by the measurement or sequencing process, and theoretically removable with perfect technology) has not been properly accounted for. The challenge, then, is to design a statistical model that “removes” this noise, isolating the “meaningful” biological signal. Without this step, DE results may reflect experimental artifacts rather than true biological differences.</p>
<ul>
<li><strong>Sharing information across genes to increase power, while controlling Type-1 error</strong>: Single-cell data is often much sparser than bulk sequencing data, leading to fewer detectable signals. This raises the question: can we pool information across genes to enhance the statistical power of our tests? For example, one might consider smoothing the expression matrix to reduce noise.</li>
</ul>
<p>(Recall that 70%+ of a single-cell dataset is 0’s. This means you should expect little power by default. Hence, different DE methods deploy different strategies to improve the power as much as possible.)</p>
<p>However, pooling or smoothing introduces a delicate tradeoff. While it can increase power by borrowing strength from other genes, it risks inflating false positives if overdone. If the smoothing is too aggressive, what might have been a single DE gene could appear as a broader, artificial signal across multiple genes. Designing models that balance this tradeoff, while maintaining statistical validity, is a key challenge in single-cell DE analyses.</p>
<p>Hence, DE can be approached with classical tests, the nuances of single-cell data – ranging from technical noise to sparse data and confounding factors – necessitate specialized models and methods. The ultimate goal is to extract biologically meaningful insights while ensuring robust statistical inference.</p>
</section>
<section id="de-between-two-data-driven-grouping-of-cells" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="de-between-two-data-driven-grouping-of-cells"><span class="header-section-number">4.4.2</span> DE between two data-driven grouping of cells</h3>
<p>Performing differential expression (DE) analysis between two data-driven groupings of cells, such as clusters identified during analysis, poses unique statistical challenges. A key issue is circularity: the same genes used to define the cell clusters may bias the DE results, complicating the interpretation of identified marker genes. This lack of statistical independence can undermine the validity of formal inference. However, despite these limitations, this type of DE analysis holds substantial exploratory value. It provides a practical way to highlight key genes that distinguish cell types or states. These genes are often called <strong>marker genes</strong>. The marker genes identified in this manner can still serve as useful entry points for understanding the biological roles of different cell groups, even if their statistical rigor is limited.</p>
</section>
<section id="wilcoxon-rank-sum-test-for-differential-expression-testing" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="wilcoxon-rank-sum-test-for-differential-expression-testing"><span class="header-section-number">4.4.3</span> Wilcoxon Rank-Sum Test for Differential Expression Testing</h3>
<p>The Wilcoxon rank-sum test is a non-parametric statistical test used to assess whether the distributions of a gene’s expression values differ significantly between two groups of cells. It is particularly well-suited for single-cell RNA-seq data that has been normalized, as it does not assume the data follows a specific distribution, such as normality. The test is based on the ranks of the data rather than the raw expression values, making it robust to outliers and noise.</p>
<div class="block">
<p><strong>Remark (Wilcoxon test after normalization and feature selection).</strong> The test below is typically done after we’ve normalized and found HVGs. As we’ll discuss in <a href="#sec-de_normalization-vs-count" class="quarto-xref"><span>Section 4.4.15</span></a> next, this is typically <em>before</em> we any imputation or PCA (and we are not worried about batch effects in this scenario).</p>
</div>
<p>Below, we explain the Wilcoxon rank-sum test, generically applied to gene <span class="math inline">\(j\)</span> (i.e., the <span class="math inline">\(j\)</span>-th column of the normalized scRNA-seq matrix <span class="math inline">\(X\)</span>). We will slightly overload the notation just to keep the notation of the Wilcoxon test itself simple.</p>
<ul>
<li><p><strong>Setting up the hypothesis</strong>: Let the expression values in two groups of cells be <span class="math inline">\(X_1, X_2, \ldots, X_m\)</span> (group 1) and <span class="math inline">\(Y_1, Y_2, \ldots, Y_n\)</span> (group 2). The null and alternative hypotheses are: <span class="math display">\[
H_0: \text{The distributions of } X \text{ and } Y \text{ are identical.}
\]</span> <span class="math display">\[
H_a: \text{The distribution of } X \text{ is shifted relative to } Y.
\]</span></p></li>
<li><p><strong>Ranking the data</strong>: All observations from both groups are combined and ranked from smallest to largest. Tied values are assigned the average of their ranks. Let <span class="math inline">\(R(X_i)\)</span> represent the rank of <span class="math inline">\(X_i\)</span> in the combined data.</p></li>
<li><p><strong>Test statistic</strong>: The test statistic <span class="math inline">\(W\)</span> is calculated as the sum of ranks for one of the groups, typically group 1: <span class="math display">\[
W = \sum_{i=1}^m R(X_i).
\]</span> Under the null hypothesis, <span class="math inline">\(W\)</span> is expected to follow a known distribution based on the ranks.</p></li>
<li><p><strong>Expected Value and Variance Under</strong> <span class="math inline">\(H_0\)</span>: Under the null hypothesis, the expected value and variance of <span class="math inline">\(W\)</span> are given by: <span class="math display">\[
\mathbb{E}(W) = \frac{m(m + n + 1)}{2},
\]</span> <span class="math display">\[
\text{Var}(W) = \frac{mn(m + n + 1)}{12}.
\]</span></p></li>
<li><p><strong>p-Value calculation</strong>:</p></li>
</ul>
<p>The p-value is computed by comparing the observed <span class="math inline">\(W\)</span> to its null distribution. For large sample sizes, <span class="math inline">\(W\)</span> can be approximated by a normal distribution: <span class="math display">\[
Z = \frac{W - \mathbb{E}(W) }{\sqrt{\text{Var}(W)}}.
\]</span> The p-value is then derived from the standard normal distribution: <span class="math display">\[
p = 2 \cdot P(Z &gt; |z|),
\]</span> where <span class="math inline">\(z\)</span> is the observed value of <span class="math inline">\(Z\)</span>.</p>
<p>In single-cell RNA-seq data, the Wilcoxon rank-sum test is used to compare the expression of each gene between two groups of cells, such as treated versus untreated cells or two clusters identified through clustering. Its non-parametric nature makes it robust to the sparsity and variability inherent in single-cell datasets, providing a reliable method for detecting genes with differential expression.</p>
<div class="block2">
<p><strong>Remark (Reminder: Invalid p-value in a literal statistical sense).</strong> Since the cell groups were defined by clustering, you are likely to find significant genes regardless. This is the <em>“double-dipping”</em> phenomenon. After all, the cells were organized into separate clusters <em>because</em> there were differences between the two cell groups.</p>
<p>Another way to describe this is that the null hypothesis is mis-calibrated. A typical Wilcoxon test is assuming under the null hypothesis that the two distributions <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are identical. This is <em>not</em> the case when you’re applying a Wilcoxon test on two cell clusters. This results in p-values that are more significant than they are actually.</p>
<p>However, this is does <em>not</em> mean it’s useless to perform hypothesis testing in this situation. After all, our goal is to simply find marker genes to describe a cell cluster, and using hypothesis testing gives us a convenient tool to determine which genes are the most meaningful ones to describe what this cluster represents.</p>
</div>
</section>
<section id="how-to-do-this-in-practice-2" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="how-to-do-this-in-practice-2"><span class="header-section-number">4.4.4</span> How to do this in practice</h3>
<p>See the <code>Seurat::FindMarkers</code> function, with more details described in <a href="https://satijalab.org/seurat/articles/de_vignette" class="uri">https://satijalab.org/seurat/articles/de_vignette</a>. This is illustrated in <a href="#fig-de" class="quarto-xref">Figure&nbsp;<span>4.13</span></a>.</p>
<div class="block">
<div id="fig-de" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-de-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/de.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-de-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.13: The differential expression step, where this example is done to find the “marker genes” for Cluster 2. By default, this is using the Wilcoxon test. You typically don’t need to run <code>logfc.threshold = 0, min.pct = 0, min.cells.feature = 0, min.cells.group = 0</code>. This is primarily done to ensure all the highly variable genes are tested. See the tutorial in <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" class="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a> and <a href="https://satijalab.org/seurat/articles/de_vignette" class="uri">https://satijalab.org/seurat/articles/de_vignette</a>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="what-if-you-want-valid-p-value" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="what-if-you-want-valid-p-value"><span class="header-section-number">4.4.5</span> What if you want “valid” p-value?</h3>
<p>There are a few instances where you truly valid p-values. That is, you want a way to perform hypothesis testing that doesn’t inflate the p-values (i.e., does not make the p-values more significant than they should be). Two papers you can look into towards this end are count splitting <span class="citation" data-cites="neufeld2022inference">(<a href="references.html#ref-neufeld2022inference" role="doc-biblioref">Neufeld et al. 2022</a>)</span> or modifying the null distribution <span class="citation" data-cites="song2023clusterde">(<a href="references.html#ref-song2023clusterde" role="doc-biblioref">Song et al. 2023</a>)</span>.</p>
</section>
<section id="a-brief-note-on-other-approaches-2" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-2"><span class="header-section-number">4.4.6</span> A brief note on other approaches</h3>
<p>There are an endless number of review and benchmarking papers for this topic. See <span class="citation" data-cites="das2022differential">(<a href="references.html#ref-das2022differential" role="doc-biblioref">Das, Rai, and Rai 2022</a>)</span> for an overview of many methods, and <span class="citation" data-cites="dal2017single jaakkola2017comparison wang2019comparative li2021large">(<a href="references.html#ref-dal2017single" role="doc-biblioref">Dal Molin, Baruzzo, and Di Camillo 2017</a>; <a href="references.html#ref-jaakkola2017comparison" role="doc-biblioref">Jaakkola et al. 2017</a>; <a href="references.html#ref-wang2019comparative" role="doc-biblioref">T. Wang et al. 2019</a>; <a href="references.html#ref-li2021large" role="doc-biblioref">Li et al. 2022</a>)</span> for benchmarkings. This will also help you get a sense of how diversity of DE methods. Note that all the methods we mentioned so far are about <em>differential mean</em> (i.e., there is a shift in the average expression, relative to the variance). There are also mentions dedicated to <em>differential variance</em> (see <span class="citation" data-cites="liu2023differential">(<a href="references.html#ref-liu2023differential" role="doc-biblioref">J. Liu, Kreimer, and Li 2023</a>)</span> for example) and <em>differential distribution</em> (see <span class="citation" data-cites="schefzik2021fast">(<a href="references.html#ref-schefzik2021fast" role="doc-biblioref">Schefzik, Flesch, and Goncalves 2021</a>)</span> for example).</p>
</section>
<section id="a-brief-reminder-about-multiple-testing" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="a-brief-reminder-about-multiple-testing"><span class="header-section-number">4.4.7</span> (A brief reminder about multiple testing)</h3>
<p>In many scientific studies, particularly in genomics and high-throughput experiments, researchers perform thousands of statistical tests simultaneously. For example, in differential expression analysis of RNA-seq data, each gene is tested for association with a condition or phenotype. However, performing multiple tests increases the likelihood of false positives—tests that appear significant purely by chance. This challenge necessitates methods to control error rates, ensuring that conclusions drawn from these analyses are reliable. While traditional corrections like the Bonferroni method are overly stringent and reduce power, modern approaches such as the Benjamini-Hochberg procedure provide a balance between identifying true positives and controlling the rate of false discoveries.</p>
</section>
<section id="benjamini-hochberg-procedure" class="level3" data-number="4.4.8">
<h3 data-number="4.4.8" class="anchored" data-anchor-id="benjamini-hochberg-procedure"><span class="header-section-number">4.4.8</span> Benjamini-Hochberg procedure</h3>
<p>The Benjamini-Hochberg (BH) procedure is a widely used method to control the False Discovery Rate (FDR), defined as the expected proportion of false positives among all significant results. The procedure is particularly suited for large-scale testing scenarios where identifying as many true positives as possible is critical, while still limiting false discoveries.</p>
<ul>
<li><p><strong>Ordered p-values</strong>: Let <span class="math inline">\(p_1, p_2, \ldots, p_m\)</span> represent the p-values for <span class="math inline">\(m\)</span> hypothesis tests. First, these p-values are ordered in ascending order: <span class="math display">\[
p_{(1)} \leq p_{(2)} \leq \cdots \leq p_{(m)}.
\]</span> The index <span class="math inline">\((i)\)</span> denotes the position of the p-value in the sorted list.</p></li>
<li><p><strong>Critical threshold</strong>: For a chosen FDR level <span class="math inline">\(\alpha\)</span>, the BH procedure identifies the largest <span class="math inline">\(k\)</span> such that: <span class="math display">\[
p_{(k)} \leq \frac{k}{m} \alpha.
\]</span> Here:</p></li>
<li><p><span class="math inline">\(k\)</span> is the rank of the p-value,</p></li>
<li><p><span class="math inline">\(m\)</span> is the total number of hypotheses tested,</p></li>
<li><p><span class="math inline">\(\alpha\)</span> is the desired FDR threshold (e.g., 0.05).</p></li>
<li><p><strong>Significant results</strong>: Once <span class="math inline">\(k\)</span> is identified, all hypotheses corresponding to <span class="math inline">\(p_{(1)}, p_{(2)}, \ldots, p_{(k)}\)</span> are considered significant. This ensures that the expected proportion of false discoveries among these selected hypotheses is controlled at <span class="math inline">\(\alpha\)</span>.</p></li>
</ul>
<p>The BH procedure achieves a balance between discovery and error control. Unlike family-wise error rate (FWER) methods such as Bonferroni, which aim to control the probability of any false positives, the BH method allows for a controlled proportion of false positives. This flexibility makes it more powerful in scenarios with a large number of tests, where the likelihood of finding true discoveries would otherwise be severely diminished.</p>
<p>The Benjamini-Hochberg procedure is a cornerstone of modern statistical analysis in high-dimensional data contexts. By controlling the FDR, it provides a practical and interpretable way to identify meaningful signals while accounting for the multiple testing problem. This approach is particularly valuable in genomics, proteomics, and other fields involving large-scale hypothesis testing.</p>
</section>
<section id="how-to-do-this-in-practice-3" class="level3" data-number="4.4.9">
<h3 data-number="4.4.9" class="anchored" data-anchor-id="how-to-do-this-in-practice-3"><span class="header-section-number">4.4.9</span> How to do this in practice</h3>
<p>Most DE methods compute the adjusted p-values for you. However, if you need to to do it manually, you can use the <code>stats::p.adjust</code> function with the setting <code>method="BH"</code>.</p>
</section>
<section id="a-brief-note-on-other-approaches-3" class="level3" data-number="4.4.10">
<h3 data-number="4.4.10" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-3"><span class="header-section-number">4.4.10</span> A brief note on other approaches</h3>
<p>BH can control a particular family of dependency structure called PRDS <span class="citation" data-cites="benjamini2001control">(<a href="references.html#ref-benjamini2001control" role="doc-biblioref">Benjamini and Yekutieli 2001</a>)</span>.</p>
</section>
<section id="the-volcano-plot" class="level3" data-number="4.4.11">
<h3 data-number="4.4.11" class="anchored" data-anchor-id="the-volcano-plot"><span class="header-section-number">4.4.11</span> The volcano plot</h3>
<p>A volcano plot is a scatterplot used in differential expression analysis to visualize the relationship between statistical significance and fold change for each gene. Genes are plotted with the magnitude of fold change on the x-axis and the negative logarithm of the p-value on the y-axis, making it easy to identify genes that are both significantly and highly differentially expressed. This intuitive layout highlights genes of interest as points far from the origin, often with up- and downregulated genes in separate clusters. See <a href="#fig-de-illustration" class="quarto-xref">Figure&nbsp;<span>4.12</span></a> for an example of a volcano plot, and <a href="#fig-de-fig" class="quarto-xref">Figure&nbsp;<span>4.14</span></a> on how to make one.</p>
<div class="block">
<div id="fig-de-fig" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-de-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/de-fig.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-de-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.14: Using the <code>EnhancedVolcano::EnhancedVolcano(cluster2.markers, lab = rownames(cluster2.markers), x = 'avg_log2FC', y = 'p_val')</code> function to make the volcano plot. See the tutorial in <a href="https://bioconductor.org/packages/devel/bioc/vignettes/EnhancedVolcano/inst/doc/EnhancedVolcano.html" class="uri">https://bioconductor.org/packages/devel/bioc/vignettes/EnhancedVolcano/inst/doc/EnhancedVolcano.html</a>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="sec-de_cohort" class="level3" data-number="4.4.12">
<h3 data-number="4.4.12" class="anchored" data-anchor-id="sec-de_cohort"><span class="header-section-number">4.4.12</span> DE in human cohorts</h3>
<p>Differential expression (DE) analysis in human cohorts introduces additional complexity due to the presence of numerous confounding variables. Factors such as age, sex, smoking status, genetic background, and even environmental exposures can influence gene expression and obscure the true biological signal related to the condition of interest. Effective DE analysis in this context requires robust statistical frameworks to adjust for these confounders, ensuring that observed differences in gene expression are genuinely associated with the biological or clinical variable being studied. While these adjustments add layers of complexity, they are critical for generating biologically meaningful and reproducible insights that can translate to broader human populations.</p>
<p>The broad strategies are:</p>
<ol type="1">
<li><strong>Pseudo-bulk analysis (the most common approach)</strong>: Pseudo-bulk analysis aggregates single-cell data from each individual into a “bulk” profile by summing or averaging gene expression counts across cells of the same type. This approach treats each individual as a unit of analysis, enabling the application of well-established bulk RNA-seq differential expression methods, such as edgeR <span class="citation" data-cites="robinson2007moderated">(<a href="references.html#ref-robinson2007moderated" role="doc-biblioref">Robinson and Smyth 2007</a>)</span> or DESeq2 <span class="citation" data-cites="love2014moderated">(<a href="references.html#ref-love2014moderated" role="doc-biblioref">Love, Huber, and Anders 2014</a>)</span>. (This methods were created for bulk-sequencing data.) By effectively reducing the dimensionality of the data, pseudo-bulk analysis accounts for inter-individual variability, which is critical in human cohorts. This method is particularly advantageous in case-control studies, where differences in gene expression between cases and controls can be analyzed while maintaining statistical power and controlling for confounders like age, sex, or sequencing depth.</li>
</ol>
<p>Pseudo-bulk samples are created by aggregating single-cell gene expression data across cells within each sample/replicate/donor (depending on the context of the analysis). For donor <span class="math inline">\(r\)</span>, the pseudo-bulk expression count <span class="math inline">\(\tilde{X}_{rj}\)</span> for gene <span class="math inline">\(j\)</span> is obtained by summing the observed counts across all <span class="math inline">\(n_{r}\)</span> cells belonging to that donor: <span class="math display">\[
\tilde{X}_{rj} = \sum_{i \in \text{donor }r} X_{ij},
\]</span> where <span class="math inline">\(X_{ij}\)</span> is the observed count for gene <span class="math inline">\(j\)</span> in cell <span class="math inline">\(i\)</span> that came from donor <span class="math inline">\(r\)</span>. This aggregation reduces the sparsity inherent in single-cell data. Since some of the donors are “cases” and some are “controls”, pseudob-bulking allowing the use of standard bulk RNA-seq differential expression methods while preserving biological replicate structure.</p>
<ol start="2" type="1">
<li><strong>Mixture modeling</strong>: Mixture modeling is a more nuanced approach that acknowledges the heterogeneity within individual samples by modeling gene expression distributions across all cells. Instead of aggregating data, this approach identifies subpopulations of cells with distinct expression profiles and estimates the contribution of each subpopulation to the overall gene expression. In case-control studies, mixture models can distinguish changes in cellular composition (e.g., shifts in cell type proportions) from changes in gene expression within a given cell type. Mixture modeling is computationally intensive but offers a detailed view of the biological processes underlying disease states in human cohorts. This is mainly using the <code>lme4</code> R package (or packages that build upon this, like <code>MAST::zlm</code>), such as in <span class="citation" data-cites="liu2022idesc">(<a href="references.html#ref-liu2022idesc" role="doc-biblioref">Y. Liu et al. 2023</a>)</span>, or NEBULA <span class="citation" data-cites="he2021nebula">(<a href="references.html#ref-he2021nebula" role="doc-biblioref">He et al. 2021</a>)</span>.</li>
</ol>
<p>Briefly, in its simplest form, a mixture model accounts for the hierarchical structure of the data, where cells are nested within donors. Consider a single gene <span class="math inline">\(j\)</span>. The observed expression <span class="math inline">\(X_{i(r),j}\)</span> for cell <span class="math inline">\(i\)</span> from donor <span class="math inline">\(r\)</span> is modeled as: <span class="math display">\[
X_{i(r),j} \sim P(X \mid \mu_r, \sigma^2),
\]</span> where <span class="math inline">\(\mu_r\)</span> is the donor-specific mean expression, and <span class="math inline">\(\sigma^2\)</span> captures the residual variability across cells within the donor. The donor-specific means <span class="math inline">\(\mu_r\)</span> are modeled as: <span class="math display">\[
\mu_r  \sim \mathcal{N}(\beta_0 + \beta_1 z_r, \tau^2),
\]</span> where <span class="math inline">\(z_r\)</span> is an indicator for case (<span class="math inline">\(z_r = 1\)</span>) or control (<span class="math inline">\(z_r = 0\)</span>) status, <span class="math inline">\(\beta_1\)</span> is the effect of the condition, and <span class="math inline">\(\tau^2\)</span> captures the variability in expression across donors. This hierarchical mixture approach explicitly separates within-donor variability from between-donor differences, ensuring that the analysis correctly attributes variability to its appropriate source.</p>
<ol start="3" type="1">
<li><strong>Distributional analysis</strong>: Another strategy is to leverage the fact that you have a <em>distribution</em> of cells for each donor. Hence, you can compute the mean and variance of the gene expression for each donor, and compare the donors through their mean and variance. One example of this is eSVD-De <span class="citation" data-cites="lin2023esvd">(<a href="references.html#ref-lin2023esvd" role="doc-biblioref">Lin, Qiu, and Roeder 2024</a>)</span>. However, this can also be done fully non-parametrically, such as in IDEAS <span class="citation" data-cites="zhang2021individual">(<a href="references.html#ref-zhang2021individual" role="doc-biblioref">M. Zhang et al. 2022</a>)</span>.</li>
</ol>
</section>
<section id="the-standard-procedure-deseq2-pseudo-bulk-analysis" class="level3" data-number="4.4.13">
<h3 data-number="4.4.13" class="anchored" data-anchor-id="the-standard-procedure-deseq2-pseudo-bulk-analysis"><span class="header-section-number">4.4.13</span> The standard procedure: DESeq2 (Pseudo-bulk analysis)</h3>
<p>DESeq2 <span class="citation" data-cites="love2014moderated">(<a href="references.html#ref-love2014moderated" role="doc-biblioref">Love, Huber, and Anders 2014</a>)</span> models read counts <span class="math inline">\(X_{ij}\)</span> for gene <span class="math inline">\(j\)</span> in sample <span class="math inline">\(i\)</span> using a negative binomial (NB) distribution<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>: <span class="math display">\[
X_{ij} \sim \text{NB}(\mu_{ij}, r_j),
\]</span> where <span class="math inline">\(X_{ij}\)</span> is the total counts in sample <span class="math inline">\(i\)</span> for gene <span class="math inline">\(j\)</span> (which is the sum across all the cells in sample <span class="math inline">\(j\)</span>), and <span class="math inline">\(\mu_{ij} = s_i q_{ij}\)</span>. Here, <span class="math inline">\(s_j\)</span> is a normalization factor accounting for sequencing depth, and <span class="math inline">\(q_{ij}\)</span> represents the normalized mean expression for gene <span class="math inline">\(j\)</span> in sample <span class="math inline">\(i\)</span>. The NB distribution’s overdispersion is captured by <span class="math inline">\(r_j\)</span>, which varies across genes.</p>
<p>The design matrix <span class="math inline">\(Z\)</span> specifies the <span class="math inline">\(r\)</span> covariates of the samples (one of which is the experimental condition). Then, the log of the normalized mean expression <span class="math inline">\(q_{ij}\)</span> is modeled as: <span class="math display">\[
\log q_{ij} = \sum_{r} Z_{ir} \beta_{jr},
\]</span> where <span class="math inline">\(\beta_{ir}\)</span> are coefficients relating the covariates to the gene expression.</p>
<p>Dispersion parameters <span class="math inline">\(r_j\)</span> are estimated using a shrinkage approach, where gene-wise estimates are pulled toward a trend fitted across genes with similar mean expression. Hypothesis testing for differential expression is based on Wald tests for the corresponding value of <span class="math inline">\(\beta_{jr}\)</span>.</p>
</section>
<section id="a-brief-note-on-other-approaches-4" class="level3" data-number="4.4.14">
<h3 data-number="4.4.14" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-4"><span class="header-section-number">4.4.14</span> A brief note on other approaches</h3>
<p>See <span class="citation" data-cites="squair2021confronting">(<a href="references.html#ref-squair2021confronting" role="doc-biblioref">Squair et al. 2021</a>)</span> and <span class="citation" data-cites="junttila2022benchmarking">(<a href="references.html#ref-junttila2022benchmarking" role="doc-biblioref">Junttila, Smolander, and Elo 2022</a>)</span> for more references.</p>
</section>
<section id="sec-de_normalization-vs-count" class="level3" data-number="4.4.15">
<h3 data-number="4.4.15" class="anchored" data-anchor-id="sec-de_normalization-vs-count"><span class="header-section-number">4.4.15</span> Aside: DE testing on normalized vs.&nbsp;count data</h3>
<p>There are two fundamentally different approaches to performing differential expression (DE) analysis in single-cell RNA-seq data:</p>
<ol type="1">
<li><strong>DE on the Original Count Data</strong>: This approach involves applying statistical methods directly to the raw count data obtained from sequencing. It accounts for the inherent technical noise and sparsity characteristic of single-cell data by using models tailored to handle count distributions (e.g., negative binomial models). This method preserves the original variability and avoids introducing biases from data manipulation. Most of the different DE methods occur in this category (which we’ll discuss more in <a href="#sec-de_cohort" class="quarto-xref"><span>Section 4.4.12</span></a>).</li>
</ol>
<div id="rem-de_guideline" class="block proof remark">
<p><span class="proof-title"><em>Remark 4.4</em>. </span><strong>Remark (Personal guideline on when to use).</strong> In general, a lot of biological replicates (see <a href="#sec-de_cohort" class="quarto-xref"><span>Section 4.4.12</span></a>) or have many covariates to adjust for, this is a more appealing option. Generally, you want to default to this option when you really want to have “valid” p-values (i.e., not just markers for convenient usage). That is, you expect your markers to be investigated in detail in followup work. This is because by modeling the original count nature, if you have an appropriate statistical model, you are more likely to have validity.</p>
</div>
<ol start="2" type="1">
<li><strong>DE on Processed Data</strong>: In this paradigm, the data undergoes preprocessing steps such as normalization, scaling, or transformation before DE analysis. Typically, when you’re using strategy, most people defer to the Wilcoxon test.</li>
</ol>
<div class="block">
<p><strong>Remark (Personal guideline on when to use).</strong> In general, this option is most appealing when you want something “quick and dirty,” such as getting some interesting genes in a preliminary analysis to look at. This is because you’re off-loading all your concerns about statistical modeling to how the data was processed (i.e., the normalization, batch correction, etc.).</p>
</div>
<p><strong>Caution on Processed Data</strong>: Do not impute or denoise your data by pooling information across genes or cells prior to DE analysis – unless you are fully aware of the consequences. Imputation or aggressive smoothing can introduce artificial correlations and inflate the signal, potentially leading to false positives and erroneous conclusions. This is because the “signal” from “true DE genes” is smoothed to impact the null genes. These processes can mask true biological variability and create spurious patterns that reflect the imputation model rather than the underlying biology. See <a href="#fig-de-imputed" class="quarto-xref">Figure&nbsp;<span>4.15</span></a> for an illustration of this. There <em>are</em> some exceptions of this though – see eSVD-DE <span class="citation" data-cites="lin2023esvd">(<a href="references.html#ref-lin2023esvd" role="doc-biblioref">Lin, Qiu, and Roeder 2024</a>)</span> and lvm-DE <span class="citation" data-cites="boyeau2023empirical">(<a href="references.html#ref-boyeau2023empirical" role="doc-biblioref">Boyeau et al. 2023</a>)</span> for example.</p>
<div class="block">
<div id="fig-de-imputed" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-de-imputed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/de-imputed.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-de-imputed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.15: (Left) DE using the raw or normalized counts, which is what you should use. (Right) DE using the smoothed counts where the data is “smoothed” across all the genes. <span class="citation" data-cites="prater2024all">(<a href="references.html#ref-prater2024all" role="doc-biblioref">Prater and Lin 2024</a>)</span>
</figcaption>
</figure>
</div>
</div>
<p>In summary, while both paradigms aim to identify differentially expressed genes, they rely on different assumptions and have different risks associated with them. Performing DE on the original count data is generally safer and more reliable, provided that appropriate statistical models are employed. If you choose to perform DE on processed data, proceed with caution and be mindful of the potential pitfalls associated with data manipulation.</p>
<p>See <span class="citation" data-cites="nguyen2023benchmarking">(<a href="references.html#ref-nguyen2023benchmarking" role="doc-biblioref">H. C. Nguyen et al. 2023</a>)</span> for empirical evidence on how DE interacts with batch-correction across different methods.</p>
</section>
<section id="pooling-of-overdispersion-parameters-is-usually-the-most-de-methods-share-information-across-genes-if-at-all" class="level3" data-number="4.4.16">
<h3 data-number="4.4.16" class="anchored" data-anchor-id="pooling-of-overdispersion-parameters-is-usually-the-most-de-methods-share-information-across-genes-if-at-all"><span class="header-section-number">4.4.16</span> Pooling of overdispersion parameters is usually the most DE methods “share information across genes,” if at all</h3>
<p>Most DE methods analyze one gene at a time, where each gene’s analysis does not influence another gene. As we mentioned above in <a href="#rem-de_guideline" class="quarto-xref">Remark&nbsp;<span>4.4</span></a>, we typically do not perform DE methods on the smoothed data. However, if any information is shared across genes, usually it is at most the overdispersion parameters <span class="math inline">\(r_j\)</span> that is often “averaged/shrunk” across all the genes. See DESeq2 <span class="citation" data-cites="love2014moderated">(<a href="references.html#ref-love2014moderated" role="doc-biblioref">Love, Huber, and Anders 2014</a>)</span>.</p>
</section>
<section id="de-for-a-continuous-covariate" class="level3" data-number="4.4.17">
<h3 data-number="4.4.17" class="anchored" data-anchor-id="de-for-a-continuous-covariate"><span class="header-section-number">4.4.17</span> “DE” for a continuous covariate</h3>
<p>As we’ll see later in <a href="#sec-trajectory" class="quarto-xref"><span>Section 4.7</span></a>, sometimes you want to see if a gene is correlated with a continuous covariate (often the estimated developmental stage of a cell). Typically, the way this is done is: fit a regression model (typically a form of GLM) to predict the continuous covariate based on a gene’s expression, and then perform a hypothesis test on whether the gene was relevant for the prediction. See <span class="citation" data-cites="hou2023statistical">(<a href="references.html#ref-hou2023statistical" role="doc-biblioref">Hou et al. 2023</a>)</span> and its related papers for how methods do this.</p>
<div class="block">
<p><strong>Remark (Personal opinion: The distinct between categorical and continuous phenotypes).</strong> If you study a <strong>clinical</strong> phenotype (typically about the organism or overall tissue), you typically want to treat the phenotype as binary (or categorical). After all, a doctor cannot declare someone to “kinda” have cancer. You either have it or you don’t. (Think about how chaotic medication prescriptions, health insurance, follow-up treatments, etc. would be if doctors gave “kinda” assessments.) In medical practice, doctors are constantly updating the guidelines on how to diagnose samples accordingly discrete buckets of categorizations.</p>
<p>If you study a <strong>basic biology</strong> phenotype, you typically want to treat the phenotype as continuous variable. After all, nothing about a cell is ever discrete. Nothing is truly either “on” or “off”, and most ways to understand cells is along a gradient. For example, if you study DNA damage, it’s not very useful to simply know when a cell’s DNA is damaged. (It probably always is – however, most DNA damage present in a cell is probably minor and infrequent.)</p>
</div>
</section>
</section>
<section id="pathway-analysis" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="pathway-analysis"><span class="header-section-number">4.5</span> Pathway analysis</h2>
<p>Pathway analysis is a critical step in single-cell RNA-sequencing studies, providing a systems-level understanding of the biological processes and pathways underlying gene expression changes. Tools like Gene Ontology (GO) and Gene Set Enrichment Analysis (GSEA) are commonly used to identify functional themes within a set of differentially expressed or highly variable genes. Gene Ontology categorizes genes into hierarchical groups based on their roles in biological processes, molecular functions, or cellular components, offering a structured framework for interpreting gene expression patterns. GSEA takes this further by testing whether predefined gene sets, representing pathways or functional categories, are enriched in a given cell cluster or condition. These approaches are particularly valuable in single-cell analysis, where individual genes may have noisy or sparse expression patterns. By focusing on groups of related genes, pathway analysis mitigates noise, enhances biological interpretability, and highlights broader functional insights that single genes alone may not reveal.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The input to a pathway analysis is: 1) a vector of <span class="math inline">\(p\)</span> values, one for each gene, and 2) a database that contains many pathways (and which genes belong to that pathway). Importantly, this must be a <em>named</em> vector (i.e., you know which value corresponds to which gene). The output is one p-value per pathway which denotes how significant the genes in the pathway are <em>not</em> randomly distributed based on their value. That is, a significant pathway is one where many of genes are have simultaneously very large (or very small) values.</p>
</div>
<section id="the-standard-procedure-gsea" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="the-standard-procedure-gsea"><span class="header-section-number">4.5.1</span> The standard procedure: GSEA</h3>
<p>Gene Set Enrichment Analysis (GSEA) is a widely used computational method designed to determine whether predefined sets of genes exhibit statistically significant differences in expression between two biological states. Unlike single-gene analyses, which focus on individual genes, GSEA evaluates groups of related genes (gene sets) to identify coordinated changes in expression patterns. This approach provides a more systems-level understanding of the underlying biology, particularly in settings where individual genes show subtle expression changes.</p>
<p>The goal of GSEA is to test whether a predefined gene set <span class="math inline">\(S\)</span>, such as a pathway or functional group, is overrepresented among the genes most differentially expressed between two conditions. GSEA leverages ranked gene lists, focusing on the distribution of gene set members within the list to detect enrichment. See <a href="#fig-gsea1" class="quarto-xref">Figure&nbsp;<span>4.16</span></a> for an illustration of how the method works visually.</p>
<ul>
<li><strong>Input data</strong>: GSEA requires the following inputs:</li>
</ul>
<ol type="1">
<li>A ranked list of genes <span class="math inline">\(G = \{g_1, g_2, \ldots, g_N\}\)</span>, sorted by their differential expression scores (e.g., fold change, t-statistics, or signal-to-noise ratio) between two conditions.</li>
<li>A predefined gene set <span class="math inline">\(S \subseteq G\)</span>, typically representing a biological pathway, molecular function, or cellular process.</li>
</ol>
<ul>
<li><strong>The test statistic (Enrichment score, i.e., ES)</strong>: The core of GSEA is the calculation of an enrichment score (ES), which reflects the degree to which the genes in <span class="math inline">\(S\)</span> are concentrated at the top (or bottom) of the ranked list <span class="math inline">\(G\)</span>. The ES is computed by walking down the ranked list and increasing a running-sum statistic when encountering a gene in <span class="math inline">\(S\)</span>, or decreasing it otherwise: <span class="math display">\[
\text{ES} = \max_k \left| P_S(k) - P_G(k) \right|,
\]</span> where:</li>
<li><span class="math inline">\(P_S(k)\)</span>: Cumulative sum of weights for genes in <span class="math inline">\(S\)</span> up to rank <span class="math inline">\(k\)</span>.</li>
<li><span class="math inline">\(P_G(k)\)</span>: Cumulative sum of weights for all genes up to rank <span class="math inline">\(k\)</span>.</li>
</ul>
<p>The weights often depend on the absolute value of the gene’s differential expression score, emphasizing genes with larger effects.</p>
<ul>
<li><strong>The null distribution</strong>: To assess the significance of the observed ES, GSEA employs a permutation-based strategy:</li>
</ul>
<ol type="1">
<li>Permute the condition labels to generate randomized ranked lists.</li>
<li>Recalculate the ES for the gene set <span class="math inline">\(S\)</span> in each randomized list.</li>
<li>Compare the observed ES to the null distribution of ES values from the permutations to compute a p-value.</li>
</ol>
<ul>
<li><strong>Multiple testing adjustment</strong>: Since many gene sets are tested in a typical GSEA analysis, corrections for multiple hypothesis testing are essential. GSEA uses the false discovery rate (FDR) to control for false positives, reporting gene sets with significant enrichment after correction.</li>
</ul>
<div class="block">
<div id="fig-gsea1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gsea1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/gsea1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gsea1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.16: The typical “random walk” illustration of a GSEA. <span class="citation" data-cites="subramanian2005gene">(<a href="references.html#ref-subramanian2005gene" role="doc-biblioref">Subramanian et al. 2005</a>)</span>
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-gsea2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gsea2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/gsea2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gsea2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.17: The typical “random walk” illustration of a GSEA. <span class="citation" data-cites="subramanian2005gene">(<a href="references.html#ref-subramanian2005gene" role="doc-biblioref">Subramanian et al. 2005</a>)</span>
</figcaption>
</figure>
</div>
</div>
<p>GSEA outputs enriched gene sets ranked by their statistical significance and direction of change (positive or negative ES). These results highlight biological pathways or processes that are upregulated or downregulated between conditions. For example: (1) In cancer studies, GSEA might identify pathways like “cell cycle” or “apoptosis” as significantly enriched. (2) In immune response research, pathways such as “inflammatory response” or “antigen processing” may be highlighted.</p>
<p>Some advantages of GSEA:</p>
<ul>
<li><strong>Sensitivity to Subtle Changes:</strong> GSEA detects coordinated changes in groups of genes, even when individual genes show modest differential expression.</li>
<li><strong>Biological Context:</strong> By focusing on gene sets, GSEA provides results that are easier to interpret in the context of known biological processes or pathways.</li>
<li><strong>Robustness:</strong> GSEA is less affected by noise or variability in individual genes, as it aggregates signals across entire gene sets.</li>
</ul>
<p>Despite its strengths, GSEA has limitations:</p>
<ul>
<li><strong>Gene Set Overlap:</strong> Many gene sets share overlapping genes, complicating interpretation.</li>
<li><strong>Ranking Dependence:</strong> Results depend heavily on the ranking metric used.</li>
<li><strong>Predefined Gene Sets:</strong> GSEA relies on the quality and relevance of predefined gene sets, which may not fully capture novel or context-specific biology.</li>
</ul>
</section>
<section id="a-brief-note-on-other-approaches-5" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-5"><span class="header-section-number">4.5.2</span> A brief note on other approaches</h3>
<p>Extensions to GSEA address some of these issues, including pathway-specific weighting, time-series GSEA, and single-cell adaptations of the method. One example to illustrate this is iDEA <span class="citation" data-cites="ma2020integrative1">(<a href="references.html#ref-ma2020integrative1" role="doc-biblioref">Ma et al. 2020</a>)</span>. These methods aren’t hugely popular since this procedure is quite literally often one of the last stages of a single-cell analyses – using a fancy method here usually requires you to have faith that every analyses beforehand was performed reliably. (For instance, if you don’t think you performed batch correction properly, it doesn’t matter if you use the fanciest variant of GSEA – you’ll probably still find nothing biologically relevant.) See <span class="citation" data-cites="mubeen2022influence">(<a href="references.html#ref-mubeen2022influence" role="doc-biblioref">Mubeen et al. 2022</a>)</span> for an overview of many methods.</p>
</section>
<section id="how-to-do-this-in-practice-4" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="how-to-do-this-in-practice-4"><span class="header-section-number">4.5.3</span> How to do this in practice</h3>
<p>The most popular package to perform a GSEA analysis is <code>clusterProfiler::gseGO</code>. See <a href="https://yulab-smu.top/biomedical-knowledge-mining-book/clusterprofiler-go.html" class="uri">https://yulab-smu.top/biomedical-knowledge-mining-book/clusterprofiler-go.html</a> for tutorials on how to do this. If you’re working on human data, the database used for GSEA is often the <code>org.Hs.eg.db</code> package, see <a href="https://bioconductor.org/packages/release/data/annotation/html/org.Hs.eg.db.html" class="uri">https://bioconductor.org/packages/release/data/annotation/html/org.Hs.eg.db.html</a>. See the following code snippet and the outputs in <a href="#fig-gsea_ex1" class="quarto-xref">Figure&nbsp;<span>4.18</span></a> and <a href="#fig-gsea_dotplot" class="quarto-xref">Figure&nbsp;<span>4.20</span></a> as an example.</p>
<div class="block2">
<p>teststat_vec &lt;- cluster2.markers$avg_log2FC names(teststat_vec) &lt;- rownames(cluster2.markers) teststat_vec &lt;- sort(teststat_vec, decreasing = TRUE) set.seed(10) gse &lt;- clusterProfiler::gseGO( teststat_vec, ont = “BP”, # what kind of pathways are you interested in keyType = “SYMBOL”, OrgDb = “org.Hs.eg.db”, pvalueCutoff = 1, # p-value threshold for pathways minGSSize = 10, # minimum gene set size maxGSSize = 500 # maximum gene set size ) head(as.data.frame(gse))</p>
</div>
<div class="block">
<div id="fig-gsea_ex1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gsea_ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/gsea_ex2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gsea_ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.18: Output of <code>head(as.data.frame(gse))</code>
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-gsea_ex2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gsea_ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/gsea_ex1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gsea_ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.19: Output of <code>head(as.data.frame(gse))</code>
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-gsea_dotplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gsea_dotplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/gsea_dotplot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gsea_dotplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.20: Output of <code>clusterProfiler::dotplot(gse, showCategory=30)</code>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="sec-celltype_labeling" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="sec-celltype_labeling"><span class="header-section-number">4.6</span> Cell-type labeling, transfer learning</h2>
<p>Cell-type labeling is a critical step in single-cell RNA-sequencing analysis, where the goal is to assign meaningful biological identities to cell clusters or groups. Traditionally, this process relies on manual annotation using known marker genes, which can be time-consuming and subjective. Transfer learning has emerged as a powerful alternative, leveraging reference datasets with well-annotated cell types to predict labels for new datasets. By applying machine learning models trained on these references, transfer learning enables automated, scalable, and more consistent cell-type annotation. This approach is particularly valuable for studies with large datasets or when analyzing data from underexplored tissues or conditions. Despite its utility, challenges remain, such as aligning datasets across technical platforms or accounting for differences in cell-state diversity, but the method continues to refine and enhance the accuracy and efficiency of cell-type labeling.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The input to cell-type labeling is two matrices, a reference dataset <span class="math inline">\(X^{(\text{ref})} \in \mathbb{R}^{n_1\times p}\)</span> for <span class="math inline">\(n_1\)</span> cells and <span class="math inline">\(p\)</span> features (i.e., genes) where all <span class="math inline">\(n_1\)</span> cells are labeled (and hence, why it’s called a “reference” dataset), and another dataset which is unlabeled and is the interest of your study, <span class="math inline">\(X^{(\text{target})} \in \mathbb{R}^{n_2\times p}\)</span> for <span class="math inline">\(n_2\)</span> cells and the same <span class="math inline">\(p\)</span> features. If there are <span class="math inline">\(K\)</span> clusters in <span class="math inline">\(X^{(\text{ref})}\)</span>, the goal is to label each of the <span class="math inline">\(n_2\)</span> cells in <span class="math inline">\(X^{(\text{target})}\)</span> with one (or more, or possible none) of the <span class="math inline">\(K\)</span> clusters.</p>
</div>
<section id="sec-marker_gene_labeling" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="sec-marker_gene_labeling"><span class="header-section-number">4.6.1</span> Strategy 1: Good’ol marker genes</h3>
<p>Cell-type identification using marker genes is a typical choice in single-cell RNA-seq analysis. This is typically performed after clustering cells into groups with similar gene expression profiles. This process involves leveraging existing literature to associate marker genes identified for each cluster with known cell types. While this approach requires significant manual effort and domain expertise – making it a human-in-the-loop process – this can be both its strength and its limitation. The manual aspect ensures transparency and allows researchers to contextualize results within the biology of the experiment, drawing on their understanding of the literature and experimental design.</p>
<p>Some drawbacks of this approach: 1) It can be labor-intensive, dependent on the quality of prior knowledge, and requires the data analyst to have quite some expertise with the biological system. After all, <em>you</em> will need to figure out the most reliable set of genes to use – this will inevitably require you know have read quite a few papers to see which markers are commonly used by the community. 2) A more limiting drawback is that you will not be able to label “new” cell types in your dataset that do not have already established marker genes. After all, if you are “missing” the marker genes for a particular cell type, you might not even realize that that cell type is in your dataset.</p>
<p>Despite these challenges, this method remains the most widely used because it minimizes the risk of major errors going unnoticed, making it a reliable approach for annotating cell types.</p>
<div class="block">
<div id="fig-celltype" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-celltype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/celltype.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-celltype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.21: The cell-type labeling step. See the tutorial in <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" class="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a>.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-celltype-fig1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-celltype-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/tutorial_markers.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-celltype-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.22: The markers for various cell types in this system.
</figcaption>
</figure>
</div>
</div>
<div class="block">
<div id="fig-celltype-fig2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-celltype-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/celltype-fig.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-celltype-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.23: Using the <code>DimPlot(pbmc, reduction = "umap", label = TRUE, pt.size = 0.5) + Seurat::NoLegend()</code> function to visualize the data with the cell-type labels. (By default, the “labels” come from <code>Seurat::Idents</code>, which is set to the latest clustering by default. See the tutorial in <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html" class="uri">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="in-relation-to-scoring-a-gene-set" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="in-relation-to-scoring-a-gene-set"><span class="header-section-number">4.6.2</span> In relation to scoring a gene-set</h3>
<p>Recall in <a href="chapter2_sequencing.html#sec-cell_filtering" class="quarto-xref"><span>Section 3.3.3</span></a> that we often create a score for the percentage of expression originating from the mitochondria genes for cell-filtering. The <code>Seurat::PercentageFeatureSet</code> function to do this does exactly what it sounds like – it computes the percentage of counts originating from the genes in the gene set (relative to all the counts in the cell).</p>
<p>There are fancier methods to compute this enrichment score (i.e., a score where a higher number denotes that that gene set is “more active” in a cell). Two popular methods for this account for the “background distribution” (UCell, <span class="citation" data-cites="andreatta2021ucell">(<a href="references.html#ref-andreatta2021ucell" role="doc-biblioref">Andreatta and Carmona 2021</a>)</span>) or the gene regulatory network (AUCell, <span class="citation" data-cites="aibar2017scenic">(<a href="references.html#ref-aibar2017scenic" role="doc-biblioref">Aibar et al. 2017</a>)</span>).</p>
</section>
<section id="strategy-2-deploying-a-classifiertransfer-learning" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="strategy-2-deploying-a-classifiertransfer-learning"><span class="header-section-number">4.6.3</span> Strategy 2: Deploying a classifier/Transfer learning</h3>
<p>In the earlier days of single-cell analyses, there were quite a few methods that had you build a cell-type classifier on a reference dataset which had cell-type labels (typically developed by a large consortia, where you trust the cell-type labels) and you deploy the classifier on your dataset of interest. The classifier here predicts the cell type based on the gene expression. For instance, you can see <span class="citation" data-cites="abdelaal2019comparison">(<a href="references.html#ref-abdelaal2019comparison" role="doc-biblioref">Abdelaal et al. 2019</a>)</span> which has relevant references. While these are probably the most statistically transparent, it usually takes a bit of time to learn the details of these methods to understand how statistically sound they are.</p>
<p>There are a few aspects of statistical interest in this direction:</p>
<ul>
<li><p>Classification with abstain/rejection: It is possible to design a classifier with a “reject” or “abstain” option. This way, if the classifier is unsure about the cell type label, then it can refuse to give a cell-type prediction. For instance, see scPred <span class="citation" data-cites="alquicira2019scpred">(<a href="references.html#ref-alquicira2019scpred" role="doc-biblioref">Alquicira-Hernandez et al. 2019</a>)</span> and Hierarchical Reject <span class="citation" data-cites="theunissen2024uncertainty">(<a href="references.html#ref-theunissen2024uncertainty" role="doc-biblioref">Theunissen et al. 2024</a>)</span> for one way this can be done.</p></li>
<li><p>Conformal inference: Conformal inference is a large statistical theoretical field. Essentially, instead of predicting one cell type, the method returns a set of potential cell types. (This is a different way to design methods with an abstain option, since a cell with an empty prediction set would essentially “abstain.”) See <span class="citation" data-cites="khatri2022uncertainty">(<a href="references.html#ref-khatri2022uncertainty" role="doc-biblioref">Khatri and Bonn 2022</a>)</span> for an example.</p></li>
<li><p>Transfer learning: This is the more commonly option done nowadays in this category. The term “transfer learning” refers to training a classifier on the reference dataset and then slightly modifying it (i.e., “transfer”) in order to your dataset of interest. Some examples of this is scArches <span class="citation" data-cites="lotfollahi2022mapping">(<a href="references.html#ref-lotfollahi2022mapping" role="doc-biblioref">Lotfollahi et al. 2022</a>)</span> and its extension in treeArches <span class="citation" data-cites="michielsen2023single">(<a href="references.html#ref-michielsen2023single" role="doc-biblioref">Michielsen et al. 2023</a>)</span>.</p></li>
</ul>
<p>Some drawbacks: The main drawback is due to batch effects. After all, “by definition,” the dataset you’re analyzing is very likely coming from a different research lab/consortium that produced the reference dataset. While statistical theory offers great ways to diagnose a classifer <em>assuming the training and test data originate from the same source</em>, it is much harder to take advantage of this statistical theory if you blatantly know this is not the case.</p>
</section>
<section id="strategy-3-data-integration" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="strategy-3-data-integration"><span class="header-section-number">4.6.4</span> Strategy 3: Data integration</h3>
<p>Dataset integration has become a widely used approach for cell-type labeling, especially when marker genes are not readily available. This strategy involves integrating a new dataset with an existing reference, often using methods that align the datasets in a shared space. Once integrated, cells in the new dataset are labeled based on their nearest neighbors in the reference. While this approach is powerful, it has limitations. A key advantage of this method is its visual interpretability; researchers can assess the alignment of the datasets in a low-dimensional embedding, adding a layer of protection against mislabeling or other errors. See <a href="#fig-chap3_integration" class="quarto-xref">Figure&nbsp;<span>4.24</span></a> for a schematic.</p>
<div class="block">
<div id="fig-chap3_integration" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chap3_integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/integration.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap3_integration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.24: Illustration of how to conceptualize data integration. <span class="citation" data-cites="stuart2019comprehensive">(<a href="references.html#ref-stuart2019comprehensive" role="doc-biblioref">Stuart et al. 2019</a>)</span>
</figcaption>
</figure>
</div>
</div>
<p>A few notes:</p>
<ul>
<li>We sometimes use the verb “align” two datasets or “project” one dataset onto another. Note that we’re just using these verbs conceptually, not in a literal statistical sense.</li>
<li>Many methods used for batch correction (see <a href="chapter2_sequencing.html#sec-batch_correction" class="quarto-xref"><span>Section 3.3.19</span></a>) can be repurposed for this task.</li>
<li>Be warned though: integration can sometimes “collapse” distinct points in the data, potentially masking subtle differences or even preventing the discovery of new cell types.</li>
</ul>
<p>For some canonical examples of these methods: Using CCA (<span class="citation" data-cites="butler2018integrating">(<a href="references.html#ref-butler2018integrating" role="doc-biblioref">Butler et al. 2018</a>)</span> and its followup, <span class="citation" data-cites="stuart2019comprehensive">(<a href="references.html#ref-stuart2019comprehensive" role="doc-biblioref">Stuart et al. 2019</a>)</span>), using cell-cell graphs (MNN <span class="citation" data-cites="haghverdi2018batch">(<a href="references.html#ref-haghverdi2018batch" role="doc-biblioref">Haghverdi et al. 2018</a>)</span> and Harmony <span class="citation" data-cites="korsunsky2019fast">(<a href="references.html#ref-korsunsky2019fast" role="doc-biblioref">Korsunsky et al. 2019</a>)</span>), and regression (COMBAT-seq <span class="citation" data-cites="zhang2020combat">(<a href="references.html#ref-zhang2020combat" role="doc-biblioref">Yuqing Zhang, Parmigiani, and Johnson 2020</a>)</span>). However, by far the most common way to do this currently is through deep-learning (which can be interpreted as a form of transfer learning, see scANVI <span class="citation" data-cites="xu2021probabilistic">(<a href="references.html#ref-xu2021probabilistic" role="doc-biblioref">Xu et al. 2021</a>)</span> for example).</p>
<p>Just to give you small taste of some of these above methods:</p>
<ul>
<li><p><strong>Anchor pairs via CCA</strong>: <span class="citation" data-cites="stuart2019comprehensive">(<a href="references.html#ref-stuart2019comprehensive" role="doc-biblioref">Stuart et al. 2019</a>)</span> essentially is a 3 step process: 1) first find many pairs of cells (one in your dataset, one in the reference) that are similar based on CCA, and then 2) use those pairs of cells to learn a transformation on how to convert the cells in your dataset into the cells in the reference dataset. Then, apply this transformation to all cells in your dataset.</p></li>
<li><p><strong>Clustering and shrinking via Harmony</strong>: <span class="citation" data-cites="korsunsky2019fast">(<a href="references.html#ref-korsunsky2019fast" role="doc-biblioref">Korsunsky et al. 2019</a>)</span> essentially is a 2 step process: 1) first cluster all the cells in both datasets together (yours with the reference dataset), where you want a clustering where each cluster represents a good mixture of cells from each dataset, then 2) “shrink” all the cells in each cluster towards its cluster center. Essentially, you treat the differences between cluster as “biological signal,” while the variability within a cluster as “technical noise.”</p></li>
<li><p><strong>Deep-learning (i.e., a really fancy regression), via scANVI</strong>: <span class="citation" data-cites="xu2021probabilistic">(<a href="references.html#ref-xu2021probabilistic" role="doc-biblioref">Xu et al. 2021</a>)</span> essentially use one framework to: 1) learn a way to project all the cells in both datasets into one low-dimensional space where the low-dimensional space is “independent” of the dataset label (i.e., given a cell’s low-dimensional space, you can’t predict which dataset the cell came from), and then 2) combine a cell’s low-dimensional space with its dataset label to reconstruct the original gene expression (which is to ensure that the low-dimensional space was a meaningful representation).</p></li>
</ul>
</section>
<section id="how-to-do-this-in-practice-5" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="how-to-do-this-in-practice-5"><span class="header-section-number">4.6.5</span> How to do this in practice</h3>
<p>There’s not standardize way to do this, but I would personally recommend data integration using Harmony, where you integrate your (unlabeled) dataset of interest with a reference dataset with cell-type labels. See <a href="chapter2_sequencing.html#sec-batch_correction" class="quarto-xref"><span>Section 3.3.19</span></a>.</p>
</section>
<section id="a-brief-note-on-other-approaches-6" class="level3" data-number="4.6.6">
<h3 data-number="4.6.6" class="anchored" data-anchor-id="a-brief-note-on-other-approaches-6"><span class="header-section-number">4.6.6</span> A brief note on other approaches</h3>
<p>See <span class="citation" data-cites="abdelaal2019comparison molbert2023adjustments">(<a href="references.html#ref-abdelaal2019comparison" role="doc-biblioref">Abdelaal et al. 2019</a>; <a href="references.html#ref-molbert2023adjustments" role="doc-biblioref">Mölbert and Haghverdi 2023</a>)</span> for benchmarking of cell-type labeling methods.</p>
<p>Note that cell-type labeling is popularly being integrating into web-based all-in-one (i.e., “one-stop-shop”) platforms that automatically label your cells (see Azimuth (<a href="https://azimuth.hubmapconsortium.org/" class="uri">https://azimuth.hubmapconsortium.org/</a>) and CellTypist (<a href="https://www.celltypist.org/" class="uri">https://www.celltypist.org/</a>) as an example). This is because cell-type labeling through writing your own code can be quite fickle that requires a lot of biological expertise to know what is “sensible”, so it’s beneficial to offload this concern to a platform. See <span class="citation" data-cites="tran2020benchmark luecken2022benchmarking lance2022multimodal">(<a href="references.html#ref-tran2020benchmark" role="doc-biblioref">Tran et al. 2020</a>; <a href="references.html#ref-luecken2022benchmarking" role="doc-biblioref">Luecken et al. 2022</a>; <a href="references.html#ref-lance2022multimodal" role="doc-biblioref">Lance et al. 2022</a>)</span> (among many) that benchmark the dataset integration methods.</p>
<div class="block">
<p><strong>Remark (The big challenges in cell-type integration).</strong> Broadly speaking, there are three major challenges in cell-type integration:</p>
<ol type="1">
<li><p><strong>How do you pick the appropriate reference dataset?</strong>: <span class="citation" data-cites="molbert2023adjustments">(<a href="references.html#ref-molbert2023adjustments" role="doc-biblioref">Mölbert and Haghverdi 2023</a>)</span> discusses the impact of the reference dataset itself. (Of course, using a different reference dataset will change your cell type labeling, so it’s important to plan beforehand how you will defend the critique of whether you even have an appropriate reference dataset.)</p></li>
<li><p><strong>How “heavy-handed” do you want your integration to be?</strong>: If you have longitudinal samples (i.e., tissue from the same donors at different points, say, based on followup visits after therapy), these samples might be on different sequencing batches. This presents a unique conundrum – how can you differentiate between a “batch effect” and a “true biological effect due to different timepoints”? You might be interested to see papers such as CellANOVA for this <span class="citation" data-cites="zhang2024recovery">(<a href="references.html#ref-zhang2024recovery" role="doc-biblioref">Z. Zhang et al. 2024</a>)</span>. Even if you don’t have longitudinal samples, sometimes certain integration methods to overboard and merge <em>too much</em> together. For example, one of the reasons some researchers prefer reciprocal PCA to do integration (see <a href="https://satijalab.org/seurat/articles/integration_rpca.html" class="uri">https://satijalab.org/seurat/articles/integration_rpca.html</a>) is precisely because it’s more “conservative” (i.e., is less aggressive in trying to remove batch effects). How will you, as the data analyst, determine how much is too much?</p></li>
<li><p><strong>How do you know if your dataset contains cell types not in the reference?</strong>: If your dataset of interest has many cell types that aren’t in the reference, your data integration method might unknowingly wipe all this signal away since it is doing its job – it’s trying to integrate the two datasets together, under the pretense that both datasets are “similar.” This is where different methods start to exhibit different behavior. You might be interested in looking at methods such as popV <span class="citation" data-cites="ergen2024consensus">(<a href="references.html#ref-ergen2024consensus" role="doc-biblioref">Ergen et al. 2024</a>)</span> that try to build a “uncertainty score.” (Many modern dataset integration methods now have this feature. However, you should always take these scores with a grain of salt since you can’t be too sure how calibrated these scores are.) CASi <span class="citation" data-cites="wang2024casi">(<a href="references.html#ref-wang2024casi" role="doc-biblioref">Y. Wang et al. 2024</a>)</span> offers a different perspective on how to answer “in a longitudinal experiment, how do I even know if a new celltype emerges?”</p></li>
</ol>
<p>My personal opinion? The best batch correction strategy is to do careful experimental design. One common strategy is to have a “control” tissue that you put into every sequencing run. That way, even across your different sequencing batches, you will have one set of cells that should be the same across every batch. This helps you get some additional clues on when a batch correction method is performing well.</p>
</div>
</section>
</section>
<section id="sec-trajectory" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="sec-trajectory"><span class="header-section-number">4.7</span> Trajectory analysis</h2>
<p>Trajectory analysis aims to reconstruct the dynamic processes underlying cellular transitions, such as differentiation or response to stimuli, by organizing cells along a pseudotime axis. This is particularly valuable in single-cell RNA-sequencing studies, where cells are often sampled as a snapshot, rather than longitudinally, making it challenging to infer temporal relationships. Methods for trajectory analysis typically rely on one of two approaches: geometric relationships or biophysical models. Geometric methods use structures like cell-cell nearest-neighbor graphs to infer trajectories and identify branching points, capturing transitions and bifurcations in cell states. Alternatively, biophysical models leverage biological priors, such as splicing kinetics, gene-regulatory network dynamics, or metabolic states, to assign cells to pseudotime. Despite the complexities of inferring trajectories from static data, these approaches have proven effective in uncovering developmental pathways, understanding disease progression, and identifying rare transitional cell states. Trajectory analysis thus provides a framework to explore cellular dynamics in the absence of direct time-course experiments.</p>
<div class="block3">
<p><strong>Input/Output.</strong> The input to trajectory analysis is typically a matrix <span class="math inline">\(X\in \mathbb{R}^{n\times k}\)</span> for <span class="math inline">\(n\)</span> cells and <span class="math inline">\(k\)</span> latent dimensions. Depending on which trajectory method you’re using, you might need more inputs (such as cell clusters, specific cells that denote the start or end of the trajectory, etc.). The output is typically two things: 1) the pseudotime for each cell (i.e., a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> for each cell), and 2) the trajectories (i.e., the order of which cells or cell clusters develop/reprogram into which other cells or cell clusters).</p>
</div>
<section id="a-typical-choice-monocle" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="a-typical-choice-monocle"><span class="header-section-number">4.7.1</span> A typical choice: Monocle</h3>
<p>Monocle <span class="citation" data-cites="trapnell2014dynamics">(<a href="references.html#ref-trapnell2014dynamics" role="doc-biblioref">Trapnell et al. 2014</a>)</span> is a computational framework designed to infer the trajectory of single-cell gene expression profiles as they progress through a dynamic biological process, such as differentiation or reprogramming. It constructs a “pseudotime” ordering, which assigns a continuous value to each cell based on its transcriptional state, representing its progression along the biological process. This method is illustrated as a schematic in <a href="#fig-monocle" class="quarto-xref">Figure&nbsp;<span>4.25</span></a>.</p>
<p>The method begins by representing the gene expression profile of each cell as a point in a high-dimensional space <span class="math inline">\(\mathbb{R}^d\)</span>, where <span class="math inline">\(d\)</span> is the number of genes measured. To reduce noise and computational complexity, Monocle uses dimensionality reduction techniques, such as Independent Component Analysis (ICA), to project the data into a lower-dimensional space.</p>
<p>Next, Monocle constructs a Minimum Spanning Tree (MST) in this reduced space. Each cell is treated as a node, and edges represent transcriptional similarity between cells, with weights corresponding to distances in the reduced space. The MST serves as the backbone for the trajectory and is used to identify the longest connected path, representing the main pseudotemporal progression.</p>
<p>Mathematically, pseudotime <span class="math inline">\(\tau_i\)</span> for a cell <span class="math inline">\(i\)</span> is defined along this trajectory as: <span class="math display">\[
\tau_i = \sum_{j=1}^{i} d(c_j, c_{j+1}),
\]</span> where <span class="math inline">\(d(c_j, c_{j+1})\)</span> is the geodesic distance between successive cells <span class="math inline">\(c_j\)</span> and <span class="math inline">\(c_{j+1}\)</span> along the path.</p>
<div class="block">
<div id="fig-monocle" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-monocle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/monocle.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-monocle-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.25: From <span class="citation" data-cites="trapnell2014dynamics">(<a href="references.html#ref-trapnell2014dynamics" role="doc-biblioref">Trapnell et al. 2014</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="how-to-do-this-in-practice-6" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="how-to-do-this-in-practice-6"><span class="header-section-number">4.7.2</span> How to do this in practice</h3>
<p>There is no standardized way for trajectory analysis. However, Monocle<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> is quite popular because: 1) it was one of the first ways developed to do trajectory analyses, 2) it is quite modular (so different researchers can switch out specific aspects for another), 3) each step is quite transparent mathematically, and 4) the software is well maintained and runs reasonably quickly.</p>
</section>
<section id="a-highly-active-area-of-research-how-much-biology-does-your-premise-assume-is-true" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="a-highly-active-area-of-research-how-much-biology-does-your-premise-assume-is-true"><span class="header-section-number">4.7.3</span> A highly active area of research: How much biology does your premise assume is true?</h3>
<p>Methods such as Monocle intrinsically assume that two cells in gene expression is a good proxy of both cells at a similar biological stage. In general, this is a <em>huge</em> assumption, and it has been shown to not hold in various settings. For instance, see <span class="citation" data-cites="saunders2023embryo">(<a href="references.html#ref-saunders2023embryo" role="doc-biblioref">Saunders et al. 2023</a>)</span>, or multi-omics in <a href="./chapter5_epigenetics.html">Chapter 5</a> and lineage-tracing in <a href="./chapter8_lineage.html">Chapter 8</a>. (It’s possible that the transcriptome is not the most accurate omic to track cell development/response.)</p>
<p>However, other methods based on the transcriptome could rely on different assumptions on how the biology relates to the math. Just to give some examples, Slingshot <span class="citation" data-cites="street2018slingshot">(<a href="references.html#ref-street2018slingshot" role="doc-biblioref">Street et al. 2018</a>)</span> assumes the biological premise of Monocle <em>and</em> adds that the trajectory must be strictly branching. CytoTRACE <span class="citation" data-cites="gulati2020single">(<a href="references.html#ref-gulati2020single" role="doc-biblioref">Gulati et al. 2020</a>)</span> instead assumes that as cells develop, there are less genes that are expressed. RNA velocity methods such as velocyto <span class="citation" data-cites="la2018rna">(<a href="references.html#ref-la2018rna" role="doc-biblioref">La Manno et al. 2018</a>)</span> assume there is spliced/unspliced relation in mRNA fragments that can be used to learn a cell’s developmental stage, which offers a potentially more mechanistic perspective on how to learn the cell trajectories.</p>
<p>A brief note on other approaches: See <span class="citation" data-cites="saelens2019comparison cannoodt2021spearheading zhang2023robust">(<a href="references.html#ref-saelens2019comparison" role="doc-biblioref">Saelens et al. 2019</a>; <a href="references.html#ref-cannoodt2021spearheading" role="doc-biblioref">Cannoodt et al. 2021</a>; <a href="references.html#ref-zhang2023robust" role="doc-biblioref">Yifan Zhang et al. 2023</a>)</span> for large benchmarkings of various RNA velocity methods. See <span class="citation" data-cites="ancheta2024challenges">(<a href="references.html#ref-ancheta2024challenges" role="doc-biblioref">Ancheta et al. 2024</a>)</span> for a benchmarking specific to RNA velocity.</p>
</section>
<section id="talk-to-me-about-statistics-what-makes-this-topic-criminally-difficult" class="level3" data-number="4.7.4">
<h3 data-number="4.7.4" class="anchored" data-anchor-id="talk-to-me-about-statistics-what-makes-this-topic-criminally-difficult"><span class="header-section-number">4.7.4</span> Talk to me about statistics: What makes this topic criminally difficult?</h3>
<p>Trajectory inference is a challenging statistical problem because it combines elements of both unsupervised and supervised learning in a highly complex setting. On one hand, it is unsupervised because you do not know the true pseudotime or branching structure of the data – these must be inferred from the observed high-dimensional gene expression profiles. On the other hand, it has a supervised flavor, as the goal is often to reconstruct a biologically meaningful trajectory that aligns with an underlying developmental or dynamic process. This dual nature makes the problem particularly tricky.</p>
<p>Several assumptions exacerbate the difficulty (see <span class="citation" data-cites="saelens2019comparison">(<a href="references.html#ref-saelens2019comparison" role="doc-biblioref">Saelens et al. 2019</a>)</span>):</p>
<ul>
<li><strong>Unknown time and branching structure</strong>: The exact ordering of cells and the number or nature of branches in the trajectory are unknown. Inferring these from noisy and sparse single-cell data is highly nontrivial.</li>
<li><strong>Assumption of a trajectory</strong>: You are implicitly assuming that the data follows a trajectory, but not all biological processes have a well-defined or continuous progression. If the underlying process is more stochastic or does not follow a clear path, the trajectory inference may be misleading.</li>
<li><strong>Equal representation across pseudotime</strong>: Many methods assume an approximately equal number of cells sampled across all stages of the trajectory, but real datasets often have uneven representation, which can bias the inferred pseudotime or branching structure.</li>
</ul>
<div class="block2">
<p><strong>Remark (Personal opinion: Lack of flushed-out statistical theory).</strong> A typical statistical theorem goes: 1) I have a specific data model in mind that tells me how data is generated, 2) I have an specific aspect about this model that I do not get to observe, but I wish to estimate from data, and then 3) based on a novel estimator, I can prove that as I get more data, under some reasonable assumptions, I can estimate the unknown aspects better and better.</p>
<p>In general, I have <em>not</em> seen this convincingly been done at all for almost any trajectory analysis for single-cell methods. This is due to the complexity of the biological assumptions you have justify, all the modeling assumptions you have justify (shown above), <em>and then</em> all the crazy proof techniques you would need to carefully manage to show how you can cast a natively unsupervised statistical problem into a supervised one.</p>
<p>This isn’t to say trajectory methods are not trustworthy. Certainly, these methods have uncovered tremendous biological insights. My comment here is that a lot of our understanding of trajectory methods is driven by the biological context, not so much by our mathematical insight.</p>
</div>
</section>
</section>
<section id="sec-beyond_scrna" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="sec-beyond_scrna"><span class="header-section-number">4.8</span> Concluding thoughts about scRNA-seq: Why bother with anything else?</h2>
<section id="limited-biological-insights-from-scrna-seq-matrices" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="limited-biological-insights-from-scrna-seq-matrices"><span class="header-section-number">4.8.1</span> Limited biological insights from scRNA-seq matrices</h3>
<p>Recall <a href="#rem-biology_thrown" class="quarto-xref">Remark&nbsp;<span>4.1</span></a>, which highlights how much biological information is discarded during typical scRNA-seq workflows, particularly by tools like CellRanger. While the raw reads may contain rich and valuable insights – such as information on splicing, untranslated regions (UTRs), and alternative polyadenylation sites (APAs) – these are often overlooked in downstream analyses. If your analysis starts solely from the count matrix, you might miss significant aspects of cellular biology. For a broader perspective on what scRNA-seq still lacks, both biologically and methodologically, see review papers like <span class="citation" data-cites="lahnemann2020eleven">(<a href="references.html#ref-lahnemann2020eleven" role="doc-biblioref">Lahnemann et al. 2020</a>)</span>. Additionally, for those interested in computational challenges in single-cell analysis, resources like <a href="https://openproblems.bio/events/" class="uri">https://openproblems.bio/events/</a> provide an excellent starting point.</p>
</section>
<section id="limited-biological-understanding-of-mrna-fragments" class="level3" data-number="4.8.2">
<h3 data-number="4.8.2" class="anchored" data-anchor-id="limited-biological-understanding-of-mrna-fragments"><span class="header-section-number">4.8.2</span> Limited biological understanding of mRNA fragments</h3>
<p>It’s important to remember that scRNA-seq primarily focuses on associating gene expression with biological phenomena. While we have a detailed map of gene expression, there is often limited context or understanding of how these genes interact functionally. mRNA fragments don’t act in isolation; their roles are inherently connected to proteins, cellular structures, and interactions with other cells. Moreover, scRNA-seq lacks direct insights into the functional impact of gene expression changes (as opposed to massively parallelized reporter assays), ignores temporal dynamics (as time information is lost when cells are lysed, as opposed to live-cell imaging), and omits structural context like cellular shape and protein localization (as opposed to other imaging technologies).</p>
</section>
<section id="translational-limitation-of-scrna-seq-and-bulk-deconvolution" class="level3" data-number="4.8.3">
<h3 data-number="4.8.3" class="anchored" data-anchor-id="translational-limitation-of-scrna-seq-and-bulk-deconvolution"><span class="header-section-number">4.8.3</span> Translational limitation of scRNA-seq, and bulk deconvolution</h3>
<p>As we showed in the footnotes of <a href="#sec-chapter_3_tech" class="quarto-xref"><span>Section 4.2</span></a>, scRNA-seq is extremely expensive. This makes any scRNA-seq technology quite unlikely to become a routine tool in clinical settings like hospitals. This is one of the main appeals of bulk deconvolution methods (where you can estimate cell-type proportions for many tissues for many donors, see <span class="citation" data-cites="cobos2023effective nguyen2024fourteen maden2023challenges">(<a href="references.html#ref-cobos2023effective" role="doc-biblioref">Cobos et al. 2023</a>; <a href="references.html#ref-nguyen2024fourteen" role="doc-biblioref">H. Nguyen et al. 2024</a>; <a href="references.html#ref-maden2023challenges" role="doc-biblioref">Maden et al. 2023</a>)</span>), since bulk RNA sequencing is a lot cheaper than scRNA sequencing.</p>
</section>
<section id="not-all-rna-is-mrna" class="level3" data-number="4.8.4">
<h3 data-number="4.8.4" class="anchored" data-anchor-id="not-all-rna-is-mrna"><span class="header-section-number">4.8.4</span> Not all RNA is mRNA</h3>
<p>If you have not studied biology before, it might shock you to realize that mRNA is only one specific type of RNA molecules. See <a href="#fig-rna-types" class="quarto-xref">Figure&nbsp;<span>4.26</span></a> for all the different types of mRNA molecules. mRNA is simply the only RNA molecules to become translated into proteins. In fact, this is only from 1%-5% of all RNA molecules in a cell<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. There is incredible biology being done to investigate the other roles of the other RNA molecules, for instance lncRNA <span class="citation" data-cites="statello2021gene">(<a href="references.html#ref-statello2021gene" role="doc-biblioref">Statello et al. 2021</a>)</span> and microRNA <span class="citation" data-cites="shang2023micrornas">(<a href="references.html#ref-shang2023micrornas" role="doc-biblioref">Shang et al. 2023</a>)</span>.</p>
<div class="block">
<div id="fig-rna-types" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rna-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/rna-types.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rna-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.26: From <a href="https://www.youtube.com/watch?v=FThA4Vxs3v4" class="uri">https://www.youtube.com/watch?v=FThA4Vxs3v4</a>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="importance-of-other-omics" class="level3" data-number="4.8.5">
<h3 data-number="4.8.5" class="anchored" data-anchor-id="importance-of-other-omics"><span class="header-section-number">4.8.5</span> Importance of other omics</h3>
<p>To truly understand the complexity of cellular systems, we need to integrate information from multiple modalities. This idea can be illustrated by the “blind men and the elephant” analogy, <a href="#fig-elephant" class="quarto-xref">Figure&nbsp;<span>4.27</span></a>: each single-cell modality provides only a partial perspective of the whole, and no single technology can offer a complete picture. For instance, scRNA-seq captures transcriptional snapshots, while other methods focus on proteins, chromatin, or spatial organization. Combining these modalities is essential to gain a holistic view of cellular function and dynamics.</p>
<div class="block">
<div id="fig-elephant" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-elephant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fig/chap3/elephant.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elephant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.27: The “blind men and the elephant” analogy. Each omic gives you one perspective of the cell, and it’s important to put all these omics together to get the full picture.
</figcaption>
</figure>
</div>
</div>
<div class="block2">
<p><strong>Remark (Personal opinion: The abundance of computational tools for scRNA-seq doesn’t necessarily reflect its importance as an omic, but rather its standardization and well-organized data structure).</strong> The explosion of computational tools for scRNA-seq, particularly from 3’ short-read technologies, is less about it being the most biologically critical modality and more about the ease of working with the data. The technology is highly standardized, producing consistent and structured outputs, such as count matrices, that are straightforward to analyze. This standardization has enabled rapid tool development and widespread adoption, creating a feedback loop where more tools emerge as the data becomes more accessible. See <span class="citation" data-cites="eisenstein2020secret">(<a href="references.html#ref-eisenstein2020secret" role="doc-biblioref">Eisenstein 2020</a>)</span> for an opinion piece.</p>
</div>
<div class="block">
<p><strong>Remark (The quadruple threat in cell biology).</strong> Suppose you collect data, analyze it, and realize your findings don’t align with current biological knowledge. Depending on your expertise, you might blame one of these four major aspects:</p>
<ul>
<li><p><strong>Your computational/statistical methods aren’t good</strong>: This is often the perspective of a computational/statistical person, where you blame the way you analyzed the data. This might imply there is room for better analytical tools.</p></li>
<li><p><strong>You didn’t collect data using the appropriate technology</strong>: This is often the perspective of a bio-engineering person, where you blame the technology used or the omic being assayed. This might imply there’s a better technology that can be developed to measure something much more directly relevant to your biological question.</p></li>
<li><p><strong>You didn’t collect enough data from a diverse set of tissues/donors</strong>: This is often the perspective of a large consortium, where you blame the limited number of samples being used to draw this conclusion. Perhaps by pooling together manpower, funding, and expertise, the collective group of researchers can have enough power to learn the desired biology.</p></li>
<li><p><strong>The biology is much more complicated than you realize</strong>: This is often the perspective of a biologist – how are you so sure your finding isn’t a fluke, but instead, it’s biological novelty? Is there a biological premise on why your findings might be reflective of reality?</p></li>
</ul>
<p>This is showcase: 1) the thrill and unending expanse of cell biology, and 2) cell biology is now so complicated that it is unrealistic to learn it all. We (as researchers) need to specialize in a particular area, gain a preliminary understanding of all the other aspects of cell biology, and find great collaborators who complement your own expertise. For instance, developing better computational methods is not very impactful if the community knows that the scientific limitation isn’t the computational methods.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-abdelaal2019comparison" class="csl-entry" role="listitem">
Abdelaal, Tamim, Lieke Michielsen, Davy Cats, Dylan Hoogduin, Hailiang Mei, Marcel JT Reinders, and Ahmed Mahfouz. 2019. <span>“A Comparison of Automatic Cell Identification Methods for Single-Cell <span>RNA</span> Sequencing Data.”</span> <em>Genome Biology</em> 20 (1): 1–19.
</div>
<div id="ref-aibar2017scenic" class="csl-entry" role="listitem">
Aibar, Sara, Carmen Bravo González-Blas, Thomas Moerman, Vân Anh Huynh-Thu, Hana Imrichova, Gert Hulselmans, Florian Rambow, et al. 2017. <span>“SCENIC: Single-Cell Regulatory Network Inference and Clustering.”</span> <em>Nature Methods</em> 14 (11): 1083–86.
</div>
<div id="ref-alquicira2019scpred" class="csl-entry" role="listitem">
Alquicira-Hernandez, Jose, Anuja Sathe, Hanlee P Ji, Quan Nguyen, and Joseph E Powell. 2019. <span>“scPred: Accurate Supervised Method for Cell-Type Classification from Single-Cell RNA-Seq Data.”</span> <em>Genome Biology</em> 20: 1–17.
</div>
<div id="ref-ancheta2024challenges" class="csl-entry" role="listitem">
Ancheta, Sarah, Leah Dorman, Guillaume Le Treut, Abel Gurung, Loic Alain Royer, Alejandro Granados, and Merlin Lange. 2024. <span>“Challenges and Progress in RNA Velocity: Comparative Analysis Across Multiple Biological Contexts.”</span> <em>bioRxiv</em>, 2024–06.
</div>
<div id="ref-andreatta2021ucell" class="csl-entry" role="listitem">
Andreatta, Massimo, and Santiago J Carmona. 2021. <span>“UCell: Robust and Scalable Single-Cell Gene Signature Scoring.”</span> <em>Computational and Structural Biotechnology Journal</em> 19: 3796–98.
</div>
<div id="ref-arabi2023brain" class="csl-entry" role="listitem">
Arabi, Tarek Ziad, Aliyah Abdulmohsen Alabdulqader, Belal Nedal Sabbah, and Abderrahman Ouban. 2023. <span>“Brain-Inhabiting Bacteria and Neurodegenerative Diseases: The <span>‘Brain Microbiome’</span> Theory.”</span> <em>Frontiers in Aging Neuroscience</em> 15: 1240945.
</div>
<div id="ref-arora2022role" class="csl-entry" role="listitem">
Arora, Ankita, Raeann Goering, Hei Yong G Lo, Joelle Lo, Charlie Moffatt, and J Matthew Taliaferro. 2022. <span>“The Role of Alternative Polyadenylation in the Regulation of Subcellular RNA Localization.”</span> <em>Frontiers in Genetics</em> 12: 818668.
</div>
<div id="ref-baran2019metacell" class="csl-entry" role="listitem">
Baran, Yael, Akhiad Bercovich, Arnau Sebe-Pedros, Yaniv Lubling, Amir Giladi, Elad Chomsky, Zohar Meir, Michael Hoichman, Aviezer Lifshitz, and Amos Tanay. 2019. <span>“MetaCell: Analysis of Single-Cell <span>RNA</span>-Seq Data Using k-Nn Graph Partitions.”</span> <em>Genome Biology</em> 20 (1): 1–19.
</div>
<div id="ref-benjamini2001control" class="csl-entry" role="listitem">
Benjamini, Yoav, and Daniel Yekutieli. 2001. <span>“The Control of the False Discovery Rate in Multiple Testing Under Dependency.”</span> <em>Annals of Statistics</em>, 1165–88.
</div>
<div id="ref-bilous2024building" class="csl-entry" role="listitem">
Bilous, Mariia, Léonard Hérault, Aurélie AG Gabriel, Matei Teleman, and David Gfeller. 2024. <span>“Building and Analyzing Metacells in Single-Cell Genomics Data.”</span> <em>Molecular Systems Biology</em>, 1–23.
</div>
<div id="ref-boyeau2023empirical" class="csl-entry" role="listitem">
Boyeau, Pierre, Jeffrey Regier, Adam Gayoso, Michael I Jordan, Romain Lopez, and Nir Yosef. 2023. <span>“An Empirical Bayes Method for Differential Expression Analysis of Single Cells with Deep Generative Models.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (21): e2209124120.
</div>
<div id="ref-butler2018integrating" class="csl-entry" role="listitem">
Butler, Andrew, Paul Hoffman, Peter Smibert, Efthymia Papalexi, and Rahul Satija. 2018. <span>“Integrating Single-Cell Transcriptomic Data Across Different Conditions, Technologies, and Species.”</span> <em>Nature Biotechnology</em> 36 (5): 411–20.
</div>
<div id="ref-cannoodt2021spearheading" class="csl-entry" role="listitem">
Cannoodt, Robrecht, Wouter Saelens, Louise Deconinck, and Yvan Saeys. 2021. <span>“Spearheading Future Omics Analyses Using Dyngen, a Multi-Modal Simulator of Single Cells.”</span> <em>Nature Communications</em> 12 (1): 3942.
</div>
<div id="ref-cao2021umi" class="csl-entry" role="listitem">
Cao, Yingying, Simo Kitanovski, Ralf Küppers, and Daniel Hoffmann. 2021. <span>“UMI or Not UMI, That Is the Question for scRNA-Seq Zero-Inflation.”</span> <em>Nature Biotechnology</em>, 1–2.
</div>
<div id="ref-chen2015alternative" class="csl-entry" role="listitem">
Chen, J, and WA Weiss. 2015. <span>“Alternative Splicing in Cancer: Implications for Biology and Therapy.”</span> <em>Oncogene</em> 34 (1): 1–14.
</div>
<div id="ref-chen2018umi" class="csl-entry" role="listitem">
Chen, Wenan, Yan Li, John Easton, David Finkelstein, Gang Wu, and Xiang Chen. 2018. <span>“<span>UMI</span>-Count Modeling and Differential Expression Analysis for Single-Cell <span>RNA</span> Sequencing.”</span> <em>Genome Biology</em> 19 (1): 70.
</div>
<div id="ref-cobos2023effective" class="csl-entry" role="listitem">
Cobos, Francisco Avila, Mohammad Javad Najaf Panah, Jessica Epps, Xiaochen Long, Tsz-Kwong Man, Hua-Sheng Chiu, Elad Chomsky, et al. 2023. <span>“Effective Methods for Bulk RNA-Seq Deconvolution Using scnRNA-Seq Transcriptomes.”</span> <em>Genome Biology</em> 24 (1): 177.
</div>
<div id="ref-dal2017single" class="csl-entry" role="listitem">
Dal Molin, Alessandra, Giacomo Baruzzo, and Barbara Di Camillo. 2017. <span>“Single-Cell <span>RNA</span>-Sequencing: Assessment of Differential Expression Analysis Methods.”</span> <em>Frontiers in Genetics</em> 8: 62.
</div>
<div id="ref-das2022differential" class="csl-entry" role="listitem">
Das, Samarendra, Anil Rai, and Shesh N Rai. 2022. <span>“Differential Expression Analysis of Single-Cell Rna-Seq Data: Current Statistical Approaches and Outstanding Challenges.”</span> <em>Entropy</em> 24 (7): 995.
</div>
<div id="ref-denisenko2020systematic" class="csl-entry" role="listitem">
Denisenko, Elena, Belinda B Guo, Matthew Jones, Rui Hou, Leanne De Kock, Timo Lassmann, Daniel Poppe, et al. 2020. <span>“Systematic Assessment of Tissue Dissociation and Storage Biases in Single-Cell and Single-Nucleus RNA-Seq Workflows.”</span> <em>Genome Biology</em> 21 (1): 1–25.
</div>
<div id="ref-ding2020systematic" class="csl-entry" role="listitem">
Ding, Jiarui, Xian Adiconis, Sean K Simmons, Monika S Kowalczyk, Cynthia C Hession, Nemanja D Marjanovic, Travis K Hughes, et al. 2020. <span>“Systematic Comparison of Single-Cell and Single-Nucleus RNA-Sequencing Methods.”</span> <em>Nature Biotechnology</em> 38 (6): 737–46.
</div>
<div id="ref-eisenstein2020secret" class="csl-entry" role="listitem">
Eisenstein, Michael. 2020. <span>“The Secret Life of Cells.”</span> <em>Nature Methods</em> 17: 7–10.
</div>
<div id="ref-ergen2024consensus" class="csl-entry" role="listitem">
Ergen, Can, Galen Xing, Chenling Xu, Martin Kim, Michael Jayasuriya, Erin McGeever, Angela Oliveira Pisco, Aaron Streets, and Nir Yosef. 2024. <span>“Consensus Prediction of Cell Type Labels in Single-Cell Data with popV.”</span> <em>Nature Genetics</em>, 1–8.
</div>
<div id="ref-grishkevich2014gene" class="csl-entry" role="listitem">
Grishkevich, Vladislav, and Itai Yanai. 2014. <span>“Gene Length and Expression Level Shape Genomic Novelties.”</span> <em>Genome Research</em> 24 (9): 1497–1503.
</div>
<div id="ref-gulati2020single" class="csl-entry" role="listitem">
Gulati, Gunsagar S, Shaheen S Sikandar, Daniel J Wesche, Anoop Manjunath, Anjan Bharadwaj, Mark J Berger, Francisco Ilagan, et al. 2020. <span>“Single-Cell Transcriptional Diversity Is a Hallmark of Developmental Potential.”</span> <em>Science</em> 367 (6476): 405–11.
</div>
<div id="ref-haghverdi2018batch" class="csl-entry" role="listitem">
Haghverdi, Laleh, Aaron TL Lun, Michael D Morgan, and John C Marioni. 2018. <span>“Batch Effects in Single-Cell <span>RNA</span>-Sequencing Data Are Corrected by Matching Mutual Nearest Neighbors.”</span> <em>Nature Biotechnology</em> 36 (5): 421–27.
</div>
<div id="ref-he2021nebula" class="csl-entry" role="listitem">
He, Liang, Jose Davila-Velderrain, Tomokazu S Sumida, David A Hafler, Manolis Kellis, and Alexander M Kulminski. 2021. <span>“<span>NEBULA</span> Is a Fast Negative Binomial Mixed Model for Differential or Co-Expression Analysis of Large-Scale Multi-Subject Single-Cell Data.”</span> <em>Communications Biology</em> 4 (1): 629.
</div>
<div id="ref-hou2023statistical" class="csl-entry" role="listitem">
Hou, Wenpin, Zhicheng Ji, Zeyu Chen, E John Wherry, Stephanie C Hicks, and Hongkai Ji. 2023. <span>“A Statistical Framework for Differential Pseudotime Analysis with Multiple Single-Cell RNA-Seq Samples.”</span> <em>Nature Communications</em> 14 (1): 7286.
</div>
<div id="ref-jaakkola2017comparison" class="csl-entry" role="listitem">
Jaakkola, Maria K, Fatemeh Seyednasrollah, Arfa Mehmood, and Laura L Elo. 2017. <span>“Comparison of Methods to Detect Differentially Expressed Genes Between Single-Cell Populations.”</span> <em>Briefings in Bioinformatics</em> 18 (5): 735–43.
</div>
<div id="ref-jiang2022statistics" class="csl-entry" role="listitem">
Jiang, Ruochen, Tianyi Sun, Dongyuan Song, and Jingyi Jessica Li. 2022. <span>“Statistics or Biology: The Zero-Inflation Controversy about scRNA-Seq Data.”</span> <em>Genome Biology</em> 23 (1): 31.
</div>
<div id="ref-junttila2022benchmarking" class="csl-entry" role="listitem">
Junttila, Sini, Joahnnes Smolander, and Laura L Elo. 2022. <span>“Benchmarking Methods for Detecting Differential States Between Conditions from Multi-Subject Single-Cell <span>RNA</span>-Seq Data.”</span> <em>Briefings in Bioinformatics</em> 23 (5): bbac286.
</div>
<div id="ref-khatri2022uncertainty" class="csl-entry" role="listitem">
Khatri, Robin, and Stefan Bonn. 2022. <span>“Uncertainty Estimation for Single-Cell Label Transfer.”</span> In <em>Conformal and Probabilistic Prediction with Applications</em>, 109–28. PMLR.
</div>
<div id="ref-kim2020demystifying" class="csl-entry" role="listitem">
Kim, Tae Hyun, Xiang Zhou, and Mengjie Chen. 2020. <span>“Demystifying <span>‘Drop-Outs’</span> in Single-Cell UMI Data.”</span> <em>Genome Biology</em> 21 (1): 196.
</div>
<div id="ref-korsunsky2019fast" class="csl-entry" role="listitem">
Korsunsky, Ilya, Nghia Millard, Jean Fan, Kamil Slowikowski, Fan Zhang, Kevin Wei, Yuriy Baglaenko, Michael Brenner, Po-ru Loh, and Soumya Raychaudhuri. 2019. <span>“Fast, Sensitive and Accurate Integration of Single-Cell Data with Harmony.”</span> <em>Nature Methods</em>, 1–8.
</div>
<div id="ref-la2018rna" class="csl-entry" role="listitem">
La Manno, Gioele, Ruslan Soldatov, Amit Zeisel, Emelie Braun, Hannah Hochgerner, Viktor Petukhov, Katja Lidschreiber, et al. 2018. <span>“<span>RNA</span> Velocity of Single Cells.”</span> <em>Nature</em> 560 (7719): 494–98.
</div>
<div id="ref-lahnemann2020eleven" class="csl-entry" role="listitem">
Lahnemann, David, Johannes Koster, Ewa Szczurek, Davis J McCarthy, Stephanie C Hicks, Mark D Robinson, Catalina A Vallejos, et al. 2020. <span>“Eleven Grand Challenges in Single-Cell Data Science.”</span> <em>Genome Biology</em> 21 (1): 1–35.
</div>
<div id="ref-lance2022multimodal" class="csl-entry" role="listitem">
Lance, Christopher, Malte D Luecken, Daniel B Burkhardt, Robrecht Cannoodt, Pia Rautenstrauch, Anna Laddach, Aidyn Ubingazhibov, et al. 2022. <span>“Multimodal Single Cell Data Integration Challenge: Results and Lessons Learned.”</span> <em>BioRxiv</em>, 2022–04.
</div>
<div id="ref-leung2021full" class="csl-entry" role="listitem">
Leung, Szi Kay, Aaron R Jeffries, Isabel Castanho, Ben T Jordan, Karen Moore, Jonathan P Davies, Emma L Dempster, et al. 2021. <span>“Full-Length Transcript Sequencing of Human and Mouse Cerebral Cortex Identifies Widespread Isoform Diversity and Alternative Splicing.”</span> <em>Cell Reports</em> 37 (7).
</div>
<div id="ref-li2021large" class="csl-entry" role="listitem">
Li, Yumei, Xinzhou Ge, Fanglue Peng, Wei Li, and Jingyi Jessica Li. 2022. <span>“Exaggerated False Positives by Popular Differential Expression Methods When Analyzing Human Population Samples.”</span> <em>Genome Biology</em> 23 (1): 1–13.
</div>
<div id="ref-lin2023esvd" class="csl-entry" role="listitem">
Lin, Kevin Z, Yixuan Qiu, and Kathryn Roeder. 2024. <span>“<span class="nocase">eSVD-DE</span>: Cohort-Wide Differential Expression in Single-Cell <span>RNA</span>-Seq Data Using Exponential-Family Embeddings.”</span> <em>BMC Bioinformatics</em> 25 (1): 113.
</div>
<div id="ref-liu2023differential" class="csl-entry" role="listitem">
Liu, Jiayi, Anat Kreimer, and Wei Vivian Li. 2023. <span>“Differential Variability Analysis of Single-Cell Gene Expression Data.”</span> <em>Briefings in Bioinformatics</em> 24 (5): bbad294.
</div>
<div id="ref-liu2022idesc" class="csl-entry" role="listitem">
Liu, Yunqing, Jiayi Zhao, Taylor S Adams, Ningya Wang, Jonas C Schupp, Weimiao Wu, John E McDonough, et al. 2023. <span>“<span class="nocase">iDESC</span>: Identifying Differential Expression in Single-Cell <span>RNA</span> Sequencing Data with Multiple Subjects.”</span> <em>BMC Bioinformatics</em> 24 (1): 318.
</div>
<div id="ref-lopes2021gene" class="csl-entry" role="listitem">
Lopes, Inês, Gulam Altab, Priyanka Raina, and JoãO Pedro De Magalhães. 2021. <span>“Gene Size Matters: An Analysis of Gene Length in the Human Genome.”</span> <em>Frontiers in Genetics</em> 12: 559998.
</div>
<div id="ref-lotfollahi2022mapping" class="csl-entry" role="listitem">
Lotfollahi, Mohammad, Mohsen Naghipourfar, Malte D Luecken, Matin Khajavi, Maren Büttner, Marco Wagenstetter, Žiga Avsec, et al. 2022. <span>“Mapping Single-Cell Data to Reference Atlases by Transfer Learning.”</span> <em>Nature Biotechnology</em> 40 (1): 121–30.
</div>
<div id="ref-love2014moderated" class="csl-entry" role="listitem">
Love, Michael I, Wolfgang Huber, and Simon Anders. 2014. <span>“Moderated Estimation of Fold Change and Dispersion for <span>RNA</span>-Seq Data with <span>DESeq2</span>.”</span> <em>Genome Biology</em> 15 (12): 550.
</div>
<div id="ref-luecken2022benchmarking" class="csl-entry" role="listitem">
Luecken, Malte D, Maren Büttner, Kridsadakorn Chaichoompu, Anna Danese, Marta Interlandi, Michaela F Müller, Daniel C Strobl, et al. 2022. <span>“Benchmarking Atlas-Level Data Integration in Single-Cell Genomics.”</span> <em>Nature Methods</em> 19 (1): 41–50.
</div>
<div id="ref-ma2020integrative1" class="csl-entry" role="listitem">
Ma, Ying, Shiquan Sun, Xuequn Shang, Evan T Keller, Mengjie Chen, and Xiang Zhou. 2020. <span>“Integrative Differential Expression and Gene Set Enrichment Analysis Using Summary Statistics for <span class="nocase">scRNA</span>-Seq Studies.”</span> <em>Nature Communications</em> 11 (1): 1–13.
</div>
<div id="ref-maden2023challenges" class="csl-entry" role="listitem">
Maden, Sean K, Sang Ho Kwon, Louise A Huuki-Myers, Leonardo Collado-Torres, Stephanie C Hicks, and Kristen R Maynard. 2023. <span>“Challenges and Opportunities to Computationally Deconvolve Heterogeneous Tissue with Varying Cell Sizes Using Single-Cell RNA-Sequencing Datasets.”</span> <em>Genome Biology</em> 24 (1): 288.
</div>
<div id="ref-mattick2023long" class="csl-entry" role="listitem">
Mattick, John S, Paulo P Amaral, Piero Carninci, Susan Carpenter, Howard Y Chang, Ling-Ling Chen, Runsheng Chen, et al. 2023. <span>“Long Non-Coding RNAs: Definitions, Functions, Challenges and Recommendations.”</span> <em>Nature Reviews Molecular Cell Biology</em> 24 (6): 430–47.
</div>
<div id="ref-michielsen2023single" class="csl-entry" role="listitem">
Michielsen, Lieke, Mohammad Lotfollahi, Daniel Strobl, Lisa Sikkema, Marcel JT Reinders, Fabian J Theis, and Ahmed Mahfouz. 2023. <span>“Single-Cell Reference Mapping to Construct and Extend Cell-Type Hierarchies.”</span> <em>NAR Genomics and Bioinformatics</em> 5 (3): lqad070.
</div>
<div id="ref-molbert2023adjustments" class="csl-entry" role="listitem">
Mölbert, Carla, and Laleh Haghverdi. 2023. <span>“Adjustments to the Reference Dataset Design Improve Cell Type Label Transfer.”</span> <em>Frontiers in Bioinformatics</em> 3: 1150099.
</div>
<div id="ref-mubeen2022influence" class="csl-entry" role="listitem">
Mubeen, Sarah, Alpha Tom Kodamullil, Martin Hofmann-Apitius, and Daniel Domingo-Fernández. 2022. <span>“On the Influence of Several Factors on Pathway Enrichment Analysis.”</span> <em>Briefings in Bioinformatics</em> 23 (3): bbac143.
</div>
<div id="ref-neufeld2022inference" class="csl-entry" role="listitem">
Neufeld, Anna, Lucy L Gao, Joshua Popp, Alexis Battle, and Daniela Witten. 2022. <span>“Inference After Latent Variable Estimation for Single-Cell RNA Sequencing Data.”</span> <em>arXiv Preprint arXiv:2207.00554</em>.
</div>
<div id="ref-nguyen2023benchmarking" class="csl-entry" role="listitem">
Nguyen, Hai CT, Bukyung Baik, Sora Yoon, Taesung Park, and Dougu Nam. 2023. <span>“Benchmarking Integration of Single-Cell Differential Expression.”</span> <em>Nature Communications</em> 14 (1): 1570.
</div>
<div id="ref-nguyen2024fourteen" class="csl-entry" role="listitem">
Nguyen, Hung, Ha Nguyen, Duc Tran, Sorin Draghici, and Tin Nguyen. 2024. <span>“Fourteen Years of Cellular Deconvolution: Methodology, Applications, Technical Evaluation and Outstanding Challenges.”</span> <em>Nucleic Acids Research</em> 52 (9): 4761–83.
</div>
<div id="ref-peng2021cell" class="csl-entry" role="listitem">
Peng, Minshi, Brie Wamsley, Andrew G Elkins, Daniel M Geschwind, Yuting Wei, and Kathryn Roeder. 2021. <span>“Cell Type Hierarchy Reconstruction via Reconciliation of Multi-Resolution Cluster Tree.”</span> <em>bioRxiv</em>.
</div>
<div id="ref-prater2024all" class="csl-entry" role="listitem">
Prater, Katherine E, and Kevin Z Lin. 2024. <span>“All the Single Cells: Single-Cell Transcriptomics/Epigenomics Experimental Design and Analysis Considerations for Glial Biologists.”</span> <em>Glia</em>.
</div>
<div id="ref-robinson2007moderated" class="csl-entry" role="listitem">
Robinson, Mark D, and Gordon K Smyth. 2007. <span>“Moderated Statistical Tests for Assessing Differences in Tag Abundance.”</span> <em>Bioinformatics</em> 23 (21): 2881–87.
</div>
<div id="ref-robles2021allele" class="csl-entry" role="listitem">
Robles-Espinoza, Carla Daniela, Pejman Mohammadi, Ximena Bonilla, and Maria Gutierrez-Arcelus. 2021. <span>“Allele-Specific Expression: Applications in Cancer and Technical Considerations.”</span> <em>Current Opinion in Genetics &amp; Development</em> 66: 10–19.
</div>
<div id="ref-saelens2019comparison" class="csl-entry" role="listitem">
Saelens, Wouter, Robrecht Cannoodt, Helena Todorov, and Yvan Saeys. 2019. <span>“A Comparison of Single-Cell Trajectory Inference Methods.”</span> <em>Nature Biotechnology</em> 37 (5): 547–54.
</div>
<div id="ref-sato2018cell" class="csl-entry" role="listitem">
Sato, Yuma, Shumpei Watanabe, Yoshinari Fukuda, Takao Hashiguchi, Yusuke Yanagi, and Shinji Ohno. 2018. <span>“Cell-to-Cell Measles Virus Spread Between Human Neurons Is Dependent on Hemagglutinin and Hyperfusogenic Fusion Protein.”</span> <em>Journal of Virology</em> 92 (6): 10–1128.
</div>
<div id="ref-saunders2023embryo" class="csl-entry" role="listitem">
Saunders, Lauren M, Sanjay R Srivatsan, Madeleine Duran, Michael W Dorrity, Brent Ewing, Tor H Linbo, Jay Shendure, et al. 2023. <span>“Embryo-Scale Reverse Genetics at Single-Cell Resolution.”</span> <em>Nature</em> 623 (7988): 782–91.
</div>
<div id="ref-schefzik2021fast" class="csl-entry" role="listitem">
Schefzik, Roman, Julian Flesch, and Angela Goncalves. 2021. <span>“Fast Identification of Differential Distributions in Single-Cell <span>RNA</span>-Sequencing Data with <span class="nocase">waddR</span>.”</span> <em>Bioinformatics</em> 37 (19): 3204–11.
</div>
<div id="ref-shang2023micrornas" class="csl-entry" role="listitem">
Shang, Renfu, Seungjae Lee, Gayan Senavirathne, and Eric C Lai. 2023. <span>“microRNAs in Action: Biogenesis, Function and Regulation.”</span> <em>Nature Reviews Genetics</em> 24 (12): 816–33.
</div>
<div id="ref-siletti2023transcriptomic" class="csl-entry" role="listitem">
Siletti, Kimberly, Rebecca Hodge, Alejandro Mossi Albiach, Ka Wai Lee, Song-Lin Ding, Lijuan Hu, Peter Lönnerberg, et al. 2023. <span>“Transcriptomic Diversity of Cell Types Across the Adult Human Brain.”</span> <em>Science</em> 382 (6667): eadd7046.
</div>
<div id="ref-song2023clusterde" class="csl-entry" role="listitem">
Song, Dongyuan, Kexin Li, Xinzhou Ge, and Jingyi Jessica Li. 2023. <span>“ClusterDE: A Post-Clustering Differential Expression (DE) Method Robust to False-Positive Inflation Caused by Double Dipping.”</span> <em>Research Square</em>.
</div>
<div id="ref-squair2021confronting" class="csl-entry" role="listitem">
Squair, Jordan W, Matthieu Gautier, Claudi Kathe, Mark A Anderson, Nicholas D James, Thomas H Hutson, Rémi Hudelle, et al. 2021. <span>“Confronting False Discoveries in Single-Cell Differential Expression.”</span> <em>Nature Communications</em> 12 (1): 5692.
</div>
<div id="ref-statello2021gene" class="csl-entry" role="listitem">
Statello, Luisa, Chun-Jie Guo, Ling-Ling Chen, and Maite Huarte. 2021. <span>“Gene Regulation by Long Non-Coding RNAs and Its Biological Functions.”</span> <em>Nature Reviews Molecular Cell Biology</em> 22 (2): 96–118.
</div>
<div id="ref-street2018slingshot" class="csl-entry" role="listitem">
Street, Kelly, Davide Risso, Russell B Fletcher, Diya Das, John Ngai, Nir Yosef, Elizabeth Purdom, and Sandrine Dudoit. 2018. <span>“Slingshot: Cell Lineage and Pseudotime Inference for Single-Cell Transcriptomics.”</span> <em>BMC Genomics</em> 19 (1): 477.
</div>
<div id="ref-stuart2019comprehensive" class="csl-entry" role="listitem">
Stuart, Tim, Andrew Butler, Paul Hoffman, Christoph Hafemeister, Efthymia Papalexi, William M Mauck III, Yuhan Hao, Marlon Stoeckius, Peter Smibert, and Rahul Satija. 2019. <span>“Comprehensive Integration of Single-Cell Data.”</span> <em>Cell</em> 177 (7): 1888–1902.
</div>
<div id="ref-subramanian2005gene" class="csl-entry" role="listitem">
Subramanian, Aravind, Pablo Tamayo, Vamsi K Mootha, Sayan Mukherjee, Benjamin L Ebert, Michael A Gillette, Amanda Paulovich, et al. 2005. <span>“Gene Set Enrichment Analysis: A Knowledge-Based Approach for Interpreting Genome-Wide Expression Profiles.”</span> <em>Proceedings of the National Academy of Sciences</em> 102 (43): 15545–50.
</div>
<div id="ref-svensson2020droplet" class="csl-entry" role="listitem">
Svensson, Valentine. 2020. <span>“Droplet scRNA-Seq Is Not Zero-Inflated.”</span> <em>Nature Biotechnology</em> 38 (2): 147–50.
</div>
<div id="ref-svensson2021reply" class="csl-entry" role="listitem">
———. 2021. <span>“Reply to: UMI or Not UMI, That Is the Question for scRNA-Seq Zero-Inflation.”</span> <em>Nature Biotechnology</em> 39 (2): 160–60.
</div>
<div id="ref-swaminath2024use" class="csl-entry" role="listitem">
Swaminath, Sharmada, and Alistair B Russell. 2024. <span>“The Use of Single-Cell RNA-Seq to Study Heterogeneity at Varying Levels of Virus–Host Interactions.”</span> <em>PLoS Pathogens</em> 20 (1): e1011898.
</div>
<div id="ref-theunissen2024uncertainty" class="csl-entry" role="listitem">
Theunissen, Lauren, Thomas Mortier, Yvan Saeys, and Willem Waegeman. 2024. <span>“Uncertainty-Aware Single-Cell Annotation with a Hierarchical Reject Option.”</span> <em>Bioinformatics</em> 40 (3): btae128.
</div>
<div id="ref-traag2019louvain" class="csl-entry" role="listitem">
Traag, Vincent A, Ludo Waltman, and Nees Jan Van Eck. 2019. <span>“From Louvain to Leiden: Guaranteeing Well-Connected Communities.”</span> <em>Scientific Reports</em> 9 (1): 1–12.
</div>
<div id="ref-tran2020benchmark" class="csl-entry" role="listitem">
Tran, Hoa Thi Nhu, Kok Siong Ang, Marion Chevrier, Xiaomeng Zhang, Nicole Yee Shin Lee, Michelle Goh, and Jinmiao Chen. 2020. <span>“A Benchmark of Batch-Effect Correction Methods for Single-Cell <span>RNA</span> Sequencing Data.”</span> <em>Genome Biology</em> 21 (1): 1–32.
</div>
<div id="ref-trapnell2014dynamics" class="csl-entry" role="listitem">
Trapnell, Cole, Davide Cacchiarelli, Jonna Grimsby, Prapti Pokharel, Shuqiang Li, Michael Morse, Niall J Lennon, Kenneth J Livak, Tarjei S Mikkelsen, and John L Rinn. 2014. <span>“The Dynamics and Regulators of Cell Fate Decisions Are Revealed by Pseudotemporal Ordering of Single Cells.”</span> <em>Nature Biotechnology</em> 32 (4): 381.
</div>
<div id="ref-wang2019comparative" class="csl-entry" role="listitem">
Wang, Tianyu, Boyang Li, Craig E Nelson, and Sheida Nabavi. 2019. <span>“Comparative Analysis of Differential Gene Expression Analysis Tools for Single-Cell <span>RNA</span> Sequencing Data.”</span> <em>BMC Bioinformatics</em> 20 (1): 1–16.
</div>
<div id="ref-wang2024casi" class="csl-entry" role="listitem">
Wang, Yizhuo, Christopher R Flowers, Michael Wang, Xuelin Huang, and Ziyi Li. 2024. <span>“CASi: A Framework for Cross-Timepoint Analysis of Single-Cell RNA Sequencing Data.”</span> <em>Scientific Reports</em> 14 (1): 10633.
</div>
<div id="ref-wolf2019paga" class="csl-entry" role="listitem">
Wolf, F Alexander, Fiona K Hamey, Mireya Plass, Jordi Solana, Joakim S Dahlin, Berthold Göttgens, Nikolaus Rajewsky, Lukas Simon, and Fabian J Theis. 2019. <span>“PAGA: Graph Abstraction Reconciles Clustering with Trajectory Inference Through a Topology Preserving Map of Single Cells.”</span> <em>Genome Biology</em> 20 (1): 59.
</div>
<div id="ref-xu2021probabilistic" class="csl-entry" role="listitem">
Xu, Chenling, Romain Lopez, Edouard Mehlman, Jeffrey Regier, Michael I Jordan, and Nir Yosef. 2021. <span>“Probabilistic Harmonization and Annotation of Single-Cell Transcriptomics Data with Deep Generative Models.”</span> <em>Molecular Systems Biology</em> 17 (1): e9620.
</div>
<div id="ref-yu2022benchmarking" class="csl-entry" role="listitem">
Yu, Lijia, Yue Cao, Jean YH Yang, and Pengyi Yang. 2022. <span>“Benchmarking Clustering Algorithms on Estimating the Number of Cell Types from Single-Cell RNA-Sequencing Data.”</span> <em>Genome Biology</em> 23 (1): 49.
</div>
<div id="ref-zeng2022cell" class="csl-entry" role="listitem">
Zeng, Hongkui. 2022. <span>“What Is a Cell Type and How to Define It?”</span> <em>Cell</em> 185 (15): 2739–55.
</div>
<div id="ref-zhang2021individual" class="csl-entry" role="listitem">
Zhang, Mengqi, Si Liu, Zhen Miao, Fang Han, Raphael Gottardo, and Wei Sun. 2022. <span>“<span>IDEAS</span>: Individual Level Differential Expression Analysis for Single-Cell <span>RNA</span>-Seq Data.”</span> <em>Genome Biology</em> 23 (1): 1–17.
</div>
<div id="ref-zhang2020review" class="csl-entry" role="listitem">
Zhang, Shixiong, Xiangtao Li, Qiuzhen Lin, and Ka-Chun Wong. 2020. <span>“Review of Single-Cell <span>RNA</span>-Seq Data Clustering for Cell Type Identification and Characterization.”</span> <em>arXiv Preprint arXiv:2001.01006</em>.
</div>
<div id="ref-zhang2023robust" class="csl-entry" role="listitem">
Zhang, Yifan, Duc Tran, Tin Nguyen, Sergiu M Dascalu, and Frederick C Harris Jr. 2023. <span>“A Robust and Accurate Single-Cell Data Trajectory Inference Method Using Ensemble Pseudotime.”</span> <em>BMC Bioinformatics</em> 24 (1): 55.
</div>
<div id="ref-zhang2020combat" class="csl-entry" role="listitem">
Zhang, Yuqing, Giovanni Parmigiani, and W Evan Johnson. 2020. <span>“ComBat-Seq: Batch Effect Adjustment for RNA-Seq Count Data.”</span> <em>NAR Genomics and Bioinformatics</em> 2 (3): lqaa078.
</div>
<div id="ref-zhang2024recovery" class="csl-entry" role="listitem">
Zhang, Zhaojun, Divij Mathew, Tristan L Lim, Kaishu Mason, Clara Morral Martinez, Sijia Huang, E John Wherry, et al. 2024. <span>“Recovery of Biological Signals Lost in Single-Cell Batch Integration with CellANOVA.”</span> <em>Nature Biotechnology</em>, 1–17.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Technically, genomics (as a field) is a broader categorization and encapsulates genetics. But usually when people say they work on “genomics,” they are colloquially implying they work on biology that is <em>not</em> genetics (otherwise, they usually say they’re a geneticist).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This term is not very often used anymore. It was an umbrella label popularized in the mid-2000s. We instead typically refer to a more specific category of technology. For example, most of the data in this scRNA-seq chapter are referred to as “short-read 3′ single-cell RNA-sequencing.” (You could throw in “droplet-based” and “UMI” to be even more precise, but that’s usually not needed in most casual contexts.)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>See <a href="https://cole-trapnell-lab.github.io/monocle3/docs/introduction/" class="uri">https://cole-trapnell-lab.github.io/monocle3/docs/introduction/</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>See <a href="https://www.qiagen.com/us/resources/faq?id=06a192c2-e72d-42e8-9b40-3171e1eb4cb8" class="uri">https://www.qiagen.com/us/resources/faq?id=06a192c2-e72d-42e8-9b40-3171e1eb4cb8</a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>For more context about PCR, see: <a href="https://www.youtube.com/watch?v=zaXKQ70q4KQ" class="uri">https://www.youtube.com/watch?v=zaXKQ70q4KQ</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This can be a bit confusing. When we refer to the “10x machine” (e.g., the 10x Chromium platform, as described at <a href="https://www.10xgenomics.com/products/universal-three-prime-gene-expression" class="uri">https://www.10xgenomics.com/products/universal-three-prime-gene-expression</a>), we are typically talking about the steps involved in droplet formation, cDNA synthesis. PCR and library preparation are usually not done in the 10x machine itself. Also, the resulting libraries are not sequenced on the 10x machine itself. Instead, sequencing is performed on a separate platform, such as an Illumina machine (e.g., see <a href="https://www.illumina.com/systems/sequencing-platforms.html" class="uri">https://www.illumina.com/systems/sequencing-platforms.html</a>).<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>See <a href="https://kb.10xgenomics.com/hc/en-us/articles/360000939852-What-is-the-difference-between-Single-Cell-3-and-5-Gene-Expression-libraries" class="uri">https://kb.10xgenomics.com/hc/en-us/articles/360000939852-What-is-the-difference-between-Single-Cell-3-and-5-Gene-Expression-libraries</a> and <a href="https://kb.10xgenomics.com/hc/en-us/articles/218137123-What-is-the-expected-size-range-for-amplified-cDNA" class="uri">https://kb.10xgenomics.com/hc/en-us/articles/218137123-What-is-the-expected-size-range-for-amplified-cDNA</a> for typical length of the cDNA fragment.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Just to give you context, a “typical” gene is thousands of base pairs (it depends on if you’re talking about the transcript itself, with or without introns, etc.) See <span class="citation" data-cites="lopes2021gene grishkevich2014gene leung2021full">(<a href="references.html#ref-lopes2021gene" role="doc-biblioref">Lopes et al. 2021</a>; <a href="references.html#ref-grishkevich2014gene" role="doc-biblioref">Grishkevich and Yanai 2014</a>; <a href="references.html#ref-leung2021full" role="doc-biblioref">Leung et al. 2021</a>)</span>. So what “short-read 3’ RNA-sequencing” is referring to is that we only measure (roughly) 400 base pairs on the 3’ side of the gene.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>See <a href="https://satijalab.org/costpercell" class="uri">https://satijalab.org/costpercell</a> (but most institutions publish their own rates. For example, see <a href="https://www.bumc.bu.edu/microarray/pricing/" class="uri">https://www.bumc.bu.edu/microarray/pricing/</a> (for BU) and <a href="https://cat.ucsf.edu/sequencing" class="uri">https://cat.ucsf.edu/sequencing</a> (UCSF) for typical rates. For students who are not familiar with wet-lab experiments, a rough ballpark sense of cost is that a “reasonable” setting (i.e., sequencing depth of 20,000 reads per cell across 10,000 cells) costs about $2000. This is usually for just one sample (i.e., one tissue for one donor), so as your experiment involves more tissues or more donors, you multiply $2000 by the total number of samples you’re thinking of. Remember, this is gets you a random set of 10,000 cells in the sample – your biological question might only care about a small cell population among these 10,000 cells.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>See <a href="https://www.10xgenomics.com/support/software/cell-ranger/latest/algorithms-overview/cr-gex-algorithm" class="uri">https://www.10xgenomics.com/support/software/cell-ranger/latest/algorithms-overview/cr-gex-algorithm</a> on how CellRanger works. See <a href="https://www.10xgenomics.com/analysis-guides/quality-assessment-using-the-cell-ranger-web-summary" class="uri">https://www.10xgenomics.com/analysis-guides/quality-assessment-using-the-cell-ranger-web-summary</a> for the typical output of CellRanger. Importantly, usually only 60%-70% of the reads get mapped to the transcriptome (i.e., “genes”). So remember: 1) not all the 20,000 expected reads get mapped to the transcriptome, and 2) these are reads <em>before</em> you account for UMI duplicates. A reasonable ballpark is that 20,000 reads yields 4,000 UMIs, so this means in your scRNA-seq matrix, the total reads per cell is roughly 4,000 (across roughly 20,000 genes). See <a href="https://cf.10xgenomics.com/samples/cell-exp/2.1.0/pbmc8k/pbmc8k_web_summary.html" class="uri">https://cf.10xgenomics.com/samples/cell-exp/2.1.0/pbmc8k/pbmc8k_web_summary.html</a> for an example, or <a href="https://www.10xgenomics.com/datasets" class="uri">https://www.10xgenomics.com/datasets</a> for other examples.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>See <a href="https://cole-trapnell-lab.github.io/monocle3/docs/introduction/" class="uri">https://cole-trapnell-lab.github.io/monocle3/docs/introduction/</a>.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>See <a href="https://cole-trapnell-lab.github.io/monocle3/docs/introduction/" class="uri">https://cole-trapnell-lab.github.io/monocle3/docs/introduction/</a>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>See <a href="https://cole-trapnell-lab.github.io/monocle3/docs/introduction/" class="uri">https://cole-trapnell-lab.github.io/monocle3/docs/introduction/</a>.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>See <a href="https://www.qiagen.com/us/resources/faq?id=06a192c2-e72d-42e8-9b40-3171e1eb4cb8" class="uri">https://www.qiagen.com/us/resources/faq?id=06a192c2-e72d-42e8-9b40-3171e1eb4cb8</a>.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter2_sequencing.html" class="pagination-link" aria-label="Single-cell sequencing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single-cell sequencing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter4_protein.html" class="pagination-link" aria-label="'Single-cell' proteomics">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">‘Single-cell’ proteomics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>